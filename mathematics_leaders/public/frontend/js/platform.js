const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/ScoresView.js","js/vue.js","js/SettingsView.js"])))=>i.map(i=>d[i]);
import{r as Et,c as r,o as n,a as H,b as z,d as W,w as ge,e as _e,f as Ye,g as e,t,u as K,F as te,h as le,i as ie,n as re,j as ke,T as $e,k as Ve,l as Me,v as Le,m as J,p as Je,q as ve,s as De,x as je,y as ue,z as zt,A as tt,B as Bt,C as Ot,D as jt,E as Rt,G as It,H as Ft}from"./vue.js";(function(){const A=document.createElement("link").relList;if(A&&A.supports&&A.supports("modulepreload"))return;for(const S of document.querySelectorAll('link[rel="modulepreload"]'))a(S);new MutationObserver(S=>{for(const O of S)if(O.type==="childList")for(const $ of O.addedNodes)$.tagName==="LINK"&&$.rel==="modulepreload"&&a($)}).observe(document,{childList:!0,subtree:!0});function l(S){const O={};return S.integrity&&(O.integrity=S.integrity),S.referrerPolicy&&(O.referrerPolicy=S.referrerPolicy),S.crossOrigin==="use-credentials"?O.credentials="include":S.crossOrigin==="anonymous"?O.credentials="omit":O.credentials="same-origin",O}function a(S){if(S.ep)return;S.ep=!0;const O=l(S);fetch(S.href,O)}})();const me=(ee,A)=>{const l=ee.__vccOpts||ee;for(const[a,S]of A)l[a]=S;return l},Ut={},qt={class:"p-6"};function Qt(ee,A){const l=Et("RouterView");return n(),r("main",qt,[H(l)])}const Ht=me(Ut,[["render",Qt]]),Vt="modulepreload",Gt=function(ee){return"/assets/mathematics_leaders/frontend/"+ee},rt={},it=function(A,l,a){let S=Promise.resolve();if(l&&l.length>0){let Y=function(N){return Promise.all(N.map(D=>Promise.resolve(D).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const $=document.querySelector("meta[property=csp-nonce]"),E=($==null?void 0:$.nonce)||($==null?void 0:$.getAttribute("nonce"));S=Y(l.map(N=>{if(N=Gt(N),N in rt)return;rt[N]=!0;const D=N.endsWith(".css"),m=D?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${N}"]${m}`))return;const v=document.createElement("link");if(v.rel=D?"stylesheet":Vt,D||(v.as="script"),v.crossOrigin="",v.href=N,E&&v.setAttribute("nonce",E),document.head.appendChild(v),D)return new Promise((T,M)=>{v.addEventListener("load",T),v.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${N}`)))})}))}function O($){const E=new Event("vite:preloadError",{cancelable:!0});if(E.payload=$,window.dispatchEvent(E),!E.defaultPrevented)throw $}return S.then($=>{for(const E of $||[])E.status==="rejected"&&O(E.reason);return A().catch(O)})},Wt=["dir"],Kt={class:"floating-controls"},Yt=["aria-label"],Jt={class:"control-icon","aria-hidden":"true"},Xt={key:0,viewBox:"0 0 24 24",focusable:"false"},Zt={key:1,viewBox:"0 0 24 24",focusable:"false"},ea={class:"control-text"},ta=["aria-label"],aa={class:"landing__wrapper"},na={class:"landing__intro"},la={class:"logo-card"},sa=["src"],oa={class:"intro__title"},ra={class:"intro__subtitle"},ia={class:"feature-grid"},ca={class:"feature-index"},ua={class:"feature-text"},da={class:"stats-row"},va={class:"stat-value"},ha={class:"stat-label"},pa={class:"landing__auth"},fa={class:"auth-card"},ma={class:"auth-tabs",role:"tablist"},ga=["aria-selected"],_a=["aria-selected"],ya={class:"input-field"},ba=["for"],ka=["id","placeholder"],wa={class:"input-field"},$a=["for"],Ca=["id","placeholder"],xa={class:"form-meta"},Sa={href:"#"},Aa=["disabled"],Da={class:"switch-text"},Ta={class:"input-field"},Ma=["for"],La=["id","placeholder"],Na={class:"input-field"},Pa=["for"],Ea=["id","placeholder"],za={class:"input-field"},Ba=["for"],Oa=["id","placeholder"],ja=["disabled"],Ra={class:"switch-text"},Ia={key:0,class:"auth-notice"},Fa="",Ua={__name:"Index",setup(ee){const A=z(localStorage.getItem("ml_lang")||"ar"),l=W(()=>A.value==="ar"?"rtl":"ltr"),a=_=>({en:{signin:"Sign In",signup:"Create Account",username:"Username",password:"Password",confirm:"Confirm Password",login:"Login",register:"Signup",toSignup:"Create account",toSignin:"Back to login",forgot:"Forgot password?"},ar:{signin:"تسجيل الدخول",signup:"إنشاء حساب",username:"اسم المستخدم",password:"كلمة المرور",confirm:"تأكيد كلمة المرور",login:"دخول",register:"تسجيل",toSignup:"إنشاء حساب",toSignin:"العودة لتسجيل الدخول",forgot:"نسيت كلمة المرور؟"}})[A.value][_],S=W(()=>A.value==="ar");function O(){A.value=S.value?"en":"ar"}const $=z(localStorage.getItem("ml_theme")||"light"),E=W(()=>$.value==="dark"),Y=W(()=>S.value?E.value?"فاتح":"داكن":E.value?"Light":"Dark"),N=W(()=>S.value?E.value?"التبديل إلى الوضع الفاتح":"التبديل إلى الوضع الداكن":E.value?"Switch to light theme":"Switch to dark theme");function D(){$.value=E.value?"light":"dark"}function m(_){document.documentElement.setAttribute("data-ml-theme",_)}ge(A,_=>{localStorage.setItem("ml_lang",_),document.documentElement.dir=l.value,document.documentElement.lang=_}),ge($,_=>{localStorage.setItem("ml_theme",_),m(_)}),_e(()=>{document.documentElement.dir=l.value,document.documentElement.lang=A.value,m($.value)});const v=z(!1),T=z({username:"",password:""}),M=z({username:"",password:"",confirm:""}),U=z(!1),P=z(null);ge(v,()=>{P.value=null});const Q=new URL("/assets/mathematics_leaders/frontend/assets/logo3.jpeg",import.meta.url).href,Z=W(()=>S.value?"منصة زعماء الرياضيات":"Mathematics Leaders Platform"),j=W(()=>S.value?"تعلم الرياضيات بأسلوب ممتع وتفاعلي مصمم للقادة الصغار.":"Master mathematics with playful, interactive journeys built for young leaders."),R=W(()=>S.value?["برامج تفاعلية مدعومة بالذكاء الاصطناعي","تتبع تقدّم ذكي ومباشر","مجتمع محفّز من المعلمين والطلاب"]:["Interactive, AI-guided programmes","Real-time progress insights","A supportive teacher & student community"]),I=W(()=>S.value?[{value:"12+",label:"وحدة تعليمية متدرجة"},{value:"4K",label:"طالب نشط"},{value:"92%",label:"نسبة إكمال المهام"}]:[{value:"12+",label:"Adaptive learning tracks"},{value:"4K",label:"Active learners"},{value:"92%",label:"Task completion rate"}]);async function V(_,u={}){const f=new URLSearchParams(u).toString(),x=await fetch(Fa+_+(f?`?${f}`:""),{method:"GET",credentials:"include"}),b=await x.json().catch(()=>({}));if(!x.ok)throw b;return b}function X(_){if(typeof _=="string")return _;if(_!=null&&_._server_messages)try{const u=JSON.parse(_._server_messages),f=(u==null?void 0:u[0])&&JSON.parse(u[0]);return(f==null?void 0:f.message)||(f==null?void 0:f._error_message)||"Invalid Request"}catch{}return(_==null?void 0:_.message)||(_==null?void 0:_.exc)||"Invalid Request"}function L(_){const u=_||{username:T.value.username};localStorage.setItem("ml_profile",JSON.stringify({...u,language:A.value})),window.location.href="/math-leaders-games/#/home"}async function w(){var _,u;U.value=!0,P.value=null;try{if(v.value){if(!M.value.username||!M.value.password||!M.value.confirm)throw{message:S.value?"الرجاء ملء كل الحقول.":"Please fill all fields."};if(M.value.password!==M.value.confirm)throw{message:S.value?"كلمتا المرور غير متطابقتين.":"Passwords do not match."};await V("/api/method/mathematics_leaders.api.signup_and_login.signup_user",{username:M.value.username,password:M.value.password,language:A.value});const f=await V("/api/method/mathematics_leaders.api.signup_and_login.verify_login",{usr:M.value.username,pwd:M.value.password});L(((_=f==null?void 0:f.message)==null?void 0:_.profile)||{username:M.value.username})}else{const f=await V("/api/method/mathematics_leaders.api.signup_and_login.verify_login",{usr:T.value.username,pwd:T.value.password});L(((u=f==null?void 0:f.message)==null?void 0:u.profile)||{username:T.value.username})}}catch(f){P.value=X(f)}finally{U.value=!1}}return(_,u)=>(n(),r("section",{class:re(["landing",$.value]),dir:l.value},[u[11]||(u[11]=Ye('<div class="background" aria-hidden="true" data-v-9ae221db><span class="glow glow-one" data-v-9ae221db></span><span class="glow glow-two" data-v-9ae221db></span><span class="glow glow-three" data-v-9ae221db></span><span class="grid" data-v-9ae221db></span></div>',1)),e("div",Kt,[e("button",{type:"button",class:"control-btn theme-toggle","aria-label":N.value,onClick:D},[e("span",Jt,[E.value?(n(),r("svg",Xt,[...u[9]||(u[9]=[Ye('<circle cx="12" cy="12" r="4.2" fill="none" stroke="currentColor" stroke-width="1.6" data-v-9ae221db></circle><line x1="12" y1="2.4" x2="12" y2="5.4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="12" y1="18.6" x2="12" y2="21.6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="2.4" y1="12" x2="5.4" y2="12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="18.6" y1="12" x2="21.6" y2="12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="5.4" y1="5.4" x2="7.7" y2="7.7" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="16.3" y1="16.3" x2="18.6" y2="18.6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="5.4" y1="18.6" x2="7.7" y2="16.3" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="16.3" y1="7.7" x2="18.6" y2="5.4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line>',9)])])):(n(),r("svg",Zt,[...u[10]||(u[10]=[e("path",{d:"M15.8 21.2a7.6 7.6 0 0 1-6.9-10.6 6.9 6.9 0 0 0 8.5 8.5 7.6 7.6 0 0 1-1.6 2.1Z",fill:"none",stroke:"currentColor","stroke-width":"1.6","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))]),e("span",ea,t(Y.value),1)],8,Yt),e("button",{type:"button",class:"control-btn lang-toggle","aria-label":S.value?"Switch to English":"التبديل إلى العربية",onClick:O},[e("span",null,t(S.value?"EN":"ع"),1)],8,ta)]),e("div",aa,[e("div",na,[e("div",la,[e("img",{src:K(Q),alt:"شعار زعماء الرياضيات"},null,8,sa)]),e("h1",oa,t(Z.value),1),e("p",ra,t(j.value),1),e("ul",ia,[(n(!0),r(te,null,le(R.value,(f,x)=>(n(),r("li",{key:x,class:"feature-item"},[e("span",ca,"0"+t(x+1),1),e("span",ua,t(f),1)]))),128))]),e("div",da,[(n(!0),r(te,null,le(I.value,(f,x)=>(n(),r("div",{key:x,class:"stat-card"},[e("span",va,t(f.value),1),e("span",ha,t(f.label),1)]))),128))])]),e("div",pa,[e("div",fa,[e("div",ma,[e("button",{type:"button",class:re(["tab-btn",{active:!v.value}]),role:"tab","aria-selected":!v.value,onClick:u[0]||(u[0]=f=>v.value=!1)},t(a("signin")),11,ga),e("button",{type:"button",class:re(["tab-btn",{active:v.value}]),role:"tab","aria-selected":v.value,onClick:u[1]||(u[1]=f=>v.value=!0)},t(a("signup")),11,_a)]),H($e,{name:"slide-fade",mode:"out-in"},{default:ke(()=>[v.value?(n(),r("form",{key:"signup",class:"auth-form",onSubmit:Ve(w,["prevent"])},[e("div",Ta,[e("label",{for:S.value?"signup-username-ar":"signup-username-en"},t(a("username")),9,Ma),Me(e("input",{id:S.value?"signup-username-ar":"signup-username-en","onUpdate:modelValue":u[5]||(u[5]=f=>M.value.username=f),type:"text",placeholder:a("username"),autocomplete:"username",required:""},null,8,La),[[Le,M.value.username]])]),e("div",Na,[e("label",{for:S.value?"signup-password-ar":"signup-password-en"},t(a("password")),9,Pa),Me(e("input",{id:S.value?"signup-password-ar":"signup-password-en","onUpdate:modelValue":u[6]||(u[6]=f=>M.value.password=f),type:"password",placeholder:a("password"),autocomplete:"new-password",required:""},null,8,Ea),[[Le,M.value.password]])]),e("div",za,[e("label",{for:S.value?"signup-confirm-ar":"signup-confirm-en"},t(a("confirm")),9,Ba),Me(e("input",{id:S.value?"signup-confirm-ar":"signup-confirm-en","onUpdate:modelValue":u[7]||(u[7]=f=>M.value.confirm=f),type:"password",placeholder:a("confirm"),autocomplete:"new-password",required:""},null,8,Oa),[[Le,M.value.confirm]])]),e("button",{class:"primary-btn",type:"submit",disabled:U.value},[e("span",null,t(a("register")),1)],8,ja),e("p",Ra,[J(t(S.value?"لديك حساب بالفعل؟":"Already have an account?")+" ",1),e("button",{type:"button",onClick:u[8]||(u[8]=f=>v.value=!1)},t(a("toSignin")),1)])],32)):(n(),r("form",{key:"signin",class:"auth-form",onSubmit:Ve(w,["prevent"])},[e("div",ya,[e("label",{for:S.value?"signin-username-ar":"signin-username-en"},t(a("username")),9,ba),Me(e("input",{id:S.value?"signin-username-ar":"signin-username-en","onUpdate:modelValue":u[2]||(u[2]=f=>T.value.username=f),type:"text",placeholder:a("username"),autocomplete:"username",required:""},null,8,ka),[[Le,T.value.username]])]),e("div",wa,[e("label",{for:S.value?"signin-password-ar":"signin-password-en"},t(a("password")),9,$a),Me(e("input",{id:S.value?"signin-password-ar":"signin-password-en","onUpdate:modelValue":u[3]||(u[3]=f=>T.value.password=f),type:"password",placeholder:a("password"),autocomplete:"current-password",required:""},null,8,Ca),[[Le,T.value.password]])]),e("div",xa,[e("a",Sa,t(a("forgot")),1)]),e("button",{class:"primary-btn",type:"submit",disabled:U.value},[e("span",null,t(a("login")),1)],8,Aa),e("p",Da,[J(t(S.value?"لا تملك حساباً؟":"Don't have an account?")+" ",1),e("button",{type:"button",onClick:u[4]||(u[4]=f=>v.value=!0)},t(a("toSignup")),1)])],32))]),_:1}),P.value?(n(),r("p",Ia,t(P.value),1)):ie("",!0)])])])],10,Wt))}},qa=me(Ua,[["__scopeId","data-v-9ae221db"]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=ee=>ee.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Qa=ee=>ee.replace(/^([A-Z])|[\s-_]+(\w)/g,(A,l,a)=>a?a.toUpperCase():l.toLowerCase()),Ha=ee=>{const A=Qa(ee);return A.charAt(0).toUpperCase()+A.slice(1)},Va=(...ee)=>ee.filter((A,l,a)=>!!A&&A.trim()!==""&&a.indexOf(A)===l).join(" ").trim(),ut=ee=>ee==="";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Re={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=({name:ee,iconNode:A,absoluteStrokeWidth:l,"absolute-stroke-width":a,strokeWidth:S,"stroke-width":O,size:$=Re.width,color:E=Re.stroke,...Y},{slots:N})=>Je("svg",{...Re,...Y,width:$,height:$,stroke:E,"stroke-width":ut(l)||ut(a)||l===!0||a===!0?Number(S||O||Re["stroke-width"])*24/Number($):S||O||Re["stroke-width"],class:Va("lucide",Y.class,...ee?[`lucide-${ct(Ha(ee))}-icon`,`lucide-${ct(ee)}`]:["lucide-icon"])},[...A.map(D=>Je(...D)),...N.default?[N.default()]:[]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=(ee,A)=>(l,{slots:a,attrs:S})=>Je(Ga,{...S,...l,iconNode:A,name:ee},a);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=fe("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=fe("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=fe("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=fe("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=fe("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=fe("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=fe("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=fe("diamond",[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=fe("eraser",[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=fe("hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=fe("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=fe("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=fe("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=fe("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=fe("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=fe("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=fe("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=fe("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=fe("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=fe("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=fe("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=fe("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=fe("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=fe("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=fe("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=fe("triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=fe("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),kt="/assets/mathematics_leaders/frontend/assets/success.mp3",xe="/assets/mathematics_leaders/frontend/assets/clap.mp3",at="/assets/mathematics_leaders/frontend/assets/wrong.mp3",un=["dir","data-theme"],dn={class:"hdr"},vn={class:"sub"},hn={class:"board"},pn={class:"assign",dir:"ltr"},fn=["onDrop"],mn={class:"actions"},gn=["disabled"],_n={class:"col-sum",dir:"ltr"},yn={class:"row"},bn={key:0},kn={class:"row"},wn={key:0},$n={class:"row"},Cn={key:0},xn={class:"digits",dir:"ltr"},Sn={class:"tiles"},An=["onDragstart"],Dn={key:0,class:"overlay"},Tn={class:"sheet"},Mn={class:"big"},Ln={class:"toasts"},Nn={__name:"challenge_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l=z(A.lang),a=z(A.theme);ge(()=>A.lang,y=>l.value=y),ge(()=>A.theme,y=>a.value=y);async function S(y,B={}){const d=new URLSearchParams(B).toString(),s=await fetch(y+(d?`?${d}`:""),{method:"GET",credentials:"include"}),o=await s.json().catch(()=>({}));if(!s.ok)throw o;return o}const O=W(()=>l.value==="ar"?"rtl":"ltr"),$={ar:{title:"التحدي 1: عملية جمع عمودية بأرقام مفقودة (رموز)",subtitle:"اسحب الأرقام وضعها مكان الرموز حتى تكتمل العملية.",digits:"الأرقام",check:"تحقق",reset:"إعادة ضبط",newQ:"سؤال جديد",correctBig:"أحسنت!",correctSub:"حل صحيح 👏 لقد كسبت نقطة.",wrong:"حاول مرة أخرى 🤔"},en:{title:"Challenge 1: Column addition with missing (symbol) digits",subtitle:"Drag digits onto symbols until the addition becomes correct.",digits:"Digits",check:"Check",reset:"Reset",newQ:"New Question",correctBig:"Great!",correctSub:"Correct 👏 You earned a point.",wrong:"Try again 🤔"}},E=y=>$[l.value][y],Y=new Audio(kt),N=new Audio(xe),D=new Audio(at);Y.preload="auto",N.preload="auto",D.preload="auto";const m={circle:vt,square:ln,triangle:rn,diamond:Ja},v=["circle","square","triangle","diamond"],T=y=>m[y]||vt;function M(y,B){return y+Math.floor(Math.random()*(B-y+1))}function U(y){return y.slice().sort(()=>Math.random()-.5)}const P=ve({aStr:"",bStr:"",sStr:"",hiddenMap:{},assignMap:{},usedShapes:[]}),Q=z([]),Z=z([]),j=z([]);function R(){const y=M(2,3),B=M(2,3),d=M(10**(y-1),10**y-1),s=M(10**(B-1),10**B-1),o=d+s;P.aStr=String(d),P.bStr=String(s),P.sStr=String(o);const i=Array.from(new Set((P.aStr+P.bStr+P.sStr).split("").map(F=>+F))),g=Math.min(M(2,3),i.length),q=U(i).slice(0,g),C=U(v).slice(0,g);P.hiddenMap={},q.forEach((F,G)=>{P.hiddenMap[C[G]]=F});const h=new Set;function k(F){return F.split("").map(G=>{var ce;const ae=+G,oe=(ce=Object.entries(P.hiddenMap).find(([be,he])=>he===ae))==null?void 0:ce[0];return oe?(h.add(oe),{t:"shape",v:oe}):{t:"digit",v:G}})}Q.value=k(P.aStr),Z.value=k(P.bStr),j.value=k(P.sStr),P.usedShapes=Array.from(h),P.assignMap=Object.fromEntries(P.usedShapes.map(F=>[F,null])),P.usedShapes.length===0&&R()}function I(y,B){y.dataTransfer.setData("text/plain",String(B))}function V(y,B){const d=Number(y.dataTransfer.getData("text/plain"));Number.isNaN(d)||Object.values(P.assignMap).includes(d)&&P.assignMap[B]!==d||(P.assignMap[B]=d,x())}function X(y){y.preventDefault()}function L(){Object.keys(P.assignMap).forEach(y=>P.assignMap[y]=null)}const w=W(()=>P.usedShapes.every(y=>Number.isInteger(P.assignMap[y])));function _(y){return Number(y.map(B=>{var d;return B.t==="digit"?B.v:(d=P.assignMap[B.v])!=null?d:"?"}).join(""))}function u(){if(!w.value)return!1;const y=_(Q.value),B=_(Z.value),d=_(j.value);return![y,B,d].some(s=>String(s).includes("?"))&&y+B===d}const f=ve({open:!1,good:!0});async function x(){if(w.value)if(u()){try{Y.currentTime=0,Y.play().catch(()=>{})}catch{}try{N.currentTime=0,N.play().catch(()=>{})}catch{}f.open=!0,f.good=!0,S("/api/method/mathematics_leaders.api.game_points.add_point",{amount:1}).catch(()=>{})}else{try{D.currentTime=0,D.play().catch(()=>{})}catch{}p(E("wrong"),"warn")}}function b(){f.open=!1,R()}const c=z([]);function p(y,B="ok"){const d=Math.random().toString(36).slice(2);c.value.push({id:d,msg:y,type:B}),setTimeout(()=>c.value=c.value.filter(s=>s.id!==d),1800)}return _e(()=>R()),(y,B)=>(n(),r("section",{class:"wrap challenge-surface",dir:O.value,"data-theme":a.value},[e("header",dn,[e("h2",null,t(E("title")),1),e("p",vn,t(E("subtitle")),1)]),e("div",hn,[e("div",pn,[(n(!0),r(te,null,le(P.usedShapes,d=>(n(),r("div",{key:d,class:"slot",onDrop:s=>V(s,d),onDragover:X},[(n(),De(je(T(d)),{class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}})),e("div",{class:re(["val",{empty:P.assignMap[d]==null}])},t(P.assignMap[d]==null?"…":P.assignMap[d]),3)],40,fn))),128)),e("div",mn,[e("button",{class:"ghost",onClick:L},t(E("reset")),1),e("button",{class:"primary",disabled:!w.value,onClick:x},t(E("check")),9,gn),e("button",{class:"ghost",onClick:R},t(E("newQ")),1)])]),e("div",_n,[e("div",yn,[(n(!0),r(te,null,le(Q.value,(d,s)=>(n(),r("span",{key:"a"+s,class:re(["cell",d.t])},[d.t==="digit"?(n(),r("span",bn,t(d.v),1)):(n(),De(je(T(d.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))]),B[0]||(B[0]=e("div",{class:"row plus"},[e("span",null,"+")],-1)),e("div",kn,[(n(!0),r(te,null,le(Z.value,(d,s)=>(n(),r("span",{key:"b"+s,class:re(["cell",d.t])},[d.t==="digit"?(n(),r("span",wn,t(d.v),1)):(n(),De(je(T(d.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))]),B[1]||(B[1]=e("div",{class:"line"},null,-1)),e("div",$n,[(n(!0),r(te,null,le(j.value,(d,s)=>(n(),r("span",{key:"s"+s,class:re(["cell",d.t])},[d.t==="digit"?(n(),r("span",Cn,t(d.v),1)):(n(),De(je(T(d.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))])]),e("div",xn,[e("h4",null,t(E("digits")),1),e("div",Sn,[(n(),r(te,null,le(10,d=>e("button",{key:d-1,class:"tile",draggable:"true",onDragstart:s=>I(s,d-1)},t(d-1),41,An)),64))])])]),H($e,{name:"fade"},{default:ke(()=>[f.open?(n(),r("div",Dn,[e("div",Tn,[e("div",Mn,t(E("correctBig")),1),e("p",null,t(E("correctSub")),1),e("button",{class:"primary",onClick:b},t(E("newQ")),1)])])):ie("",!0)]),_:1}),e("div",Ln,[(n(!0),r(te,null,le(c.value,d=>(n(),r("div",{key:d.id,class:re(["toast",d.type])},t(d.msg),3))),128))])],8,un))}},Pn=me(Nn,[["__scopeId","data-v-9c65b80b"]]),ze="/assets/mathematics_leaders/frontend/assets/success2.mp3",Ne="/assets/mathematics_leaders/frontend/assets/wrong2.mp3",En=["data-theme"],zn={class:"title"},Bn={class:"rule"},On={class:"layout"},jn={class:"grid"},Rn=["onDrop"],In={key:1,class:"placeholder"},Fn=["value","onInput","onChange","onBlur","placeholder"],Un=["onClick"],qn={class:"bank"},Qn={class:"bank-title"},Hn={class:"bank-items"},Vn=["onDragstart"],Gn={class:"actions"},Wn={key:0,class:"overlay"},Kn={class:"card"},Yn={class:"big"},Jn={__name:"challenge_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"التحدي 2: شبكة أعداد تزيد بمقدار {STEP}",rule:"كل خانة تزيد {STEP} عن اليسار وعن الأعلى. اسحب الأعداد المفقودة إلى أماكنها.",newQ:"سؤال جديد",check:"تحقّق",reset:"إعادة تعيين",correct:"إجابة صحيحة",wrong:"تحقق من القيم",bank:"لوحة الأعداد",clear:"تفريغ الخلية"},en:{title:"Challenge 2: Number grid with step {STEP}",rule:"Each cell increases by {STEP} from its left and its top. Drag the missing numbers into place.",newQ:"New puzzle",check:"Check",reset:"Reset",correct:"Correct answer",wrong:"Check your values",bank:"Number bank",clear:"Clear cell"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(ze):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Ne):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");const E=[100,200,500,1e3,2e3];function Y(C,h){return Math.floor(Math.random()*(h-C+1))+C}function N(C){const h=C.slice();for(let k=h.length-1;k>0;k--){const F=Math.floor(Math.random()*(k+1));[h[k],h[F]]=[h[F],h[k]]}return h}const D=z(3),m=z(1e3),v=z(0),T=z([]),M=z(new Set),U=z({}),P=z({}),Q=z({}),Z=z(!1),j=z(null),R=W(()=>l[a.value].title.replaceAll("{STEP}",m.value)),I=W(()=>l[a.value].rule.replaceAll("{STEP}",m.value)),V=(C,h)=>`${C},${h}`;function X(C,h,k){const F=[];for(let G=0;G<C;G++){const ae=[];for(let oe=0;oe<C;oe++)ae.push(h+k*(G+oe));F.push(ae)}return F}function L(C){const h=[];for(let G=0;G<C;G++)for(let ae=0;ae<C;ae++)h.push([G,ae]);const k=h.filter(([G,ae])=>!(G===0&&ae===0)),F=Y(3,5);return new Set(N(k).slice(0,F).map(([G,ae])=>V(G,ae)))}function w(){const C={};M.value.forEach(h=>{const[k,F]=h.split(",").map(Number),G=T.value[k][F];C[G]=(C[G]||0)+1}),Q.value=C}const _=W(()=>{const C=[];for(const[h,k]of Object.entries(Q.value))for(let F=0;F<k;F++)C.push(Number(h));return N(C)});function u(){Z.value=!1,j.value=null,U.value={},P.value={},m.value=E[Y(0,E.length-1)];const C=Y(5,19)*100;v.value=C;const h=D.value;T.value=X(h,v.value,m.value),M.value=L(h),w()}function f(){for(const C of M.value)if(U.value[C]==null)return!1;return!0}function x(){if(!f())return!1;for(const C of M.value){const[h,k]=C.split(",").map(Number);if(U.value[C]!==T.value[h][k])return!1}return!0}async function b(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function c(){if(!f()){j.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",$&&$.play();return}x()?(Z.value=!0,j.value=l[a.value].correct,S&&S.play(),O&&O.play(),await b()):(j.value=l[a.value].wrong,$&&$.play())}function p(){U.value={},P.value={},w(),j.value=null,Z.value=!1}function y(C,h,{fromManual:k=!1}={}){if(!Number.isNaN(h)){if(U.value[C]!=null){const F=U.value[C];Q.value[F]=(Q.value[F]||0)+1}if(k)(Q.value[h]||0)>0&&(Q.value[h]-=1);else{if((Q.value[h]||0)===0)return;Q.value[h]-=1}U.value[C]=h,P.value={...P.value,[C]:String(h)},j.value=null}}function B(C,h){C.dataTransfer.setData("text/plain",String(h))}function d(C){C.preventDefault()}function s(C,h){C.preventDefault();const k=Number(C.dataTransfer.getData("text/plain"));y(h,k)}function o(C){if(U.value[C]!=null){const h=U.value[C];Q.value[h]=(Q.value[h]||0)+1,delete U.value[C]}P.value={...P.value,[C]:""}}function i(C,h){P.value={...P.value,[C]:h}}function g(C){var F;const h=((F=P.value[C])!=null?F:"").trim();if(h===""){o(C);return}const k=Number(h);Number.isFinite(k)&&y(C,k,{fromManual:!0})}const q=W(()=>({direction:"ltr",unicodeBidi:"isolate"}));return _e(u),ge(()=>A.lang,()=>j.value=null),(C,h)=>(n(),r("div",{class:"challenge2 challenge-surface","data-theme":A.theme},[e("h2",zn,t(R.value),1),e("p",Bn,t(I.value),1),e("div",On,[e("div",jn,[(n(!0),r(te,null,le(D.value,k=>(n(),r("div",{key:"r"+k,class:"row"},[(n(!0),r(te,null,le(D.value,F=>{var G;return n(),r("div",{key:"c"+k+"-"+F,class:"cell"},[M.value.has(`${k-1},${F-1}`)?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:d,onDrop:ae=>s(ae,`${k-1},${F-1}`)},[U.value[`${k-1},${F-1}`]!=null?(n(),r("span",{key:0,class:"num",style:ue(q.value)},t(U.value[`${k-1},${F-1}`]),5)):(n(),r("span",In,"؟"))],40,Rn),e("input",{class:"manual-entry",type:"number",value:(G=P.value[`${k-1},${F-1}`])!=null?G:"",onInput:ae=>i(`${k-1},${F-1}`,ae.target.value),onChange:ae=>g(`${k-1},${F-1}`),onBlur:ae=>g(`${k-1},${F-1}`),placeholder:A.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,Fn),e("button",{class:"clear",onClick:ae=>o(`${k-1},${F-1}`)},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)],8,Un)],64)):(n(),r("span",{key:0,class:"num",style:ue(q.value)},t(T.value[k-1][F-1]),5))])}),128))]))),128))]),e("div",qn,[e("div",Qn,t(l[a.value].bank),1),e("div",Hn,[(n(!0),r(te,null,le(_.value,k=>(n(),r("button",{key:k+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:F=>B(F,k),style:ue(q.value)},t(k),45,Vn))),128))]),e("div",Gn,[e("button",{class:"btn",onClick:p},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:c},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:u},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),j.value?(n(),r("div",{key:0,class:re(["toast",{ok:Z.value}])},t(j.value),3)):ie("",!0)])]),Z.value?(n(),r("div",Wn,[e("div",Kn,[e("div",Yn,t(l[a.value].correct),1),e("button",{class:"btn",onClick:u},t(l[a.value].newQ),1)])])):ie("",!0)],8,En))}},Xn=me(Jn,[["__scopeId","data-v-f172099e"]]),Pe="/assets/mathematics_leaders/frontend/assets/success3.mp3",Fe="/assets/mathematics_leaders/frontend/assets/wrong3.mp3",Zn=["data-theme"],el={class:"title"},tl={class:"rule"},al={class:"qs"},nl={class:"qtext"},ll={class:"opts"},sl=["onClick"],ol=["onClick"],rl={class:"toolbar"},il={class:"status"},cl={key:0,class:"done"},ul={class:"actions"},dl=4,vl={__name:"challenge_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"التحدي 3: إيجاد عددين من المجموع والفرق",rule:"اختر الزوج الصحيح (أكبر، أصغر) بحيث يكون مجموعهما S والفرق بينهما D.",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"إجابة غير صحيحة",done:"أكملت هذه الجولة",q:(j,R,I)=>`(${j}) جد عددين ناتج جمعهما ${R} والفرق بينهما ${I}`},en:{title:"Challenge 3: Find two numbers from sum and difference",rule:"Pick the correct pair (greater, smaller) with sum S and difference D.",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Incorrect",done:"Round completed",q:(j,R,I)=>`(${j}) Find two numbers with sum ${R} and difference ${I}`}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(Pe):null,O=typeof Audio!="undefined"?new Audio(Fe):null;S&&(S.preload="auto"),O&&(O.preload="auto");function $(j,R){return Math.floor(Math.random()*(R-j+1))+j}function E(j){const R=j.slice();for(let I=R.length-1;I>0;I--){const V=Math.floor(Math.random()*(I+1));[R[I],R[V]]=[R[V],R[I]]}return R}const Y=z([]),N=W(()=>Y.value.filter(j=>{var R;return j.judged&&((R=j.options[j.pickedIndex])==null?void 0:R.isAns)}).length),D=W(()=>Y.value.length>0&&Y.value.every(j=>j.judged));function m(j,R){return[(j+R)/2,(j-R)/2]}function v(j){return Number.isInteger(j)&&j>=0}function T(){let j,R,I,V;for(;j=$(10,60),R=$(0,20),!((j&1)===(R&1)&&!(j<R)&&([I,V]=m(j,R),v(I)&&v(V))););const X=new Set,L=(_,u)=>{const f=`${_},${u}`;_>=0&&u>=0&&Number.isInteger(_)&&Number.isInteger(u)&&f!==`${I},${V}`&&X.add(f)};L(I+1,V-1),L(I-1,V+1),L(I+2,V-2),L(I-2,V+2),L(I+1,V),L(I,V+1);const w=[{a:I,b:V,isAns:!0}];for(const _ of Array.from(X).slice(0,3)){const[u,f]=_.split(",").map(x=>Number(x));if(w.push({a:u,b:f,isAns:!1}),w.length===4)break}for(;w.length<4;){const _=$(-3,3),u=$(-3,3),f=Math.max(0,I+_),x=Math.max(0,V+u);f===I&&x===V||w.push({a:f,b:x,isAns:!1})}return{S:j,D:R,ans:[I,V],options:E(w),pickedIndex:null,judged:!1,firstTry:!0}}function M(){Y.value=Array.from({length:dl},()=>T())}function U(){for(const j of Y.value)j.pickedIndex=null,j.judged=!1,j.firstTry=!0}async function P(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function Q(j,R){if(j.judged)return;j.pickedIndex=R,j.judged=!0,j.options[R].isAns?(S&&S.play(),D.value&&S&&S.play(),j.firstTry&&await P()):O&&O.play()}function Z(j){j.judged=!1,j.firstTry=!1,j.pickedIndex=null}return _e(M),ge(()=>A.lang,()=>{}),(j,R)=>(n(),r("div",{class:"challenge3 challenge-surface","data-theme":A.theme},[e("h2",el,t(l[a.value].title),1),e("p",tl,t(l[a.value].rule),1),e("div",al,[(n(!0),r(te,null,le(Y.value,(I,V)=>(n(),r("div",{key:V,class:"qcard"},[e("div",nl,t(l[a.value].q(V+1,I.S,I.D)),1),e("div",ll,[(n(!0),r(te,null,le(I.options,(X,L)=>(n(),r("button",{key:L,class:re(["opt",{chosen:I.pickedIndex===L,ok:I.judged&&I.options[L].isAns,bad:I.judged&&I.pickedIndex===L&&!I.options[L].isAns}]),onClick:w=>Q(I,L)}," ( "+t(X.a)+" ، "+t(X.b)+" ) ",11,sl))),128))]),I.judged?(n(),r("div",{key:0,class:re(["feedback",{ok:I.options[I.pickedIndex].isAns}])},[J(t(I.options[I.pickedIndex].isAns?l[a.value].correct:l[a.value].wrong)+" ",1),I.options[I.pickedIndex].isAns?ie("",!0):(n(),r("button",{key:0,class:"retry",onClick:X=>Z(I)},"↺",8,ol))],2)):ie("",!0)]))),128))]),e("div",rl,[e("div",il,[H(K(we),{class:"ic"}),J(" "+t(N.value)+" / "+t(Y.value.length)+" ",1),D.value&&N.value===Y.value.length?(n(),r("span",cl," · "+t(l[a.value].done),1)):ie("",!0)]),e("div",ul,[e("button",{class:"btn",onClick:U},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:M},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])])])],8,Zn))}},hl=me(vl,[["__scopeId","data-v-fd4f6cf1"]]),wt="/assets/mathematics_leaders/frontend/assets/success4.mp3",$t="/assets/mathematics_leaders/frontend/assets/wrong4.mp3",pl=["data-theme"],fl={class:"title"},ml={class:"rule"},gl={class:"table"},_l=["onDrop"],yl={key:1,class:"placeholder"},bl=["value","onInput","onChange","onBlur","placeholder"],kl=["onClick"],wl={class:"side"},$l={class:"bank-title"},Cl={class:"bank-items"},xl=["onDragstart"],Sl={class:"actions"},Al={key:0,class:"overlay"},Dl={class:"card"},Tl={class:"big"},Oe=3,Ml={__name:"challenge_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"التحدي 4: أكمل جدول الضرب",rule:"جدول ضرب بعناوين صفوف وأعمدة. اسحب القيم الصحيحة من الأسفل إلى الخانات الفارغة.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 4: Complete the multiplication table",rule:"A multiplication table with row/column headers. Drag correct values into the blanks.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check your values",clear:"Clear cell"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(wt):null,O=typeof Audio!="undefined"?new Audio($t):null;S&&(S.preload="auto"),O&&(O.preload="auto");function $(s,o){return Math.floor(Math.random()*(o-s+1))+s}function E(s){const o=s.slice();for(let i=o.length-1;i>0;i--){const g=Math.floor(Math.random()*(i+1));[o[i],o[g]]=[o[g],o[i]]}return o}const Y=z([]),N=z([]),D=z(new Set),m=z({}),v=z({}),T=z({}),M=z(!1),U=z(null);function P(s,o){return s===0&&o===0?"×":s===0?N.value[o-1]:o===0?Y.value[s-1]:Y.value[s-1]*N.value[o-1]}const Q=(s,o)=>s===0||o===0?`h:${s},${o}`:`c:${s},${o}`;function Z(s){return E([1,2,3,4,5,6,7,8,9]).slice(0,s).sort((o,i)=>o-i)}function j(){const s=[];for(let h=0;h<=Oe;h++)for(let k=0;k<=Oe;k++)h===0&&k===0||s.push([h,k]);const o=s.filter(([h,k])=>h>0&&k>0),i=E(o)[0],g=s.filter(([h,k])=>!(h===i[0]&&k===i[1])),q=$(5,8),C=E(g).slice(0,q);return new Set(C.map(([h,k])=>Q(h,k)))}function R(){const s={};D.value.forEach(o=>{const[i,g]=o.split(":"),[q,C]=g.split(",").map(Number),h=P(q,C);s[h]=(s[h]||0)+1});for(const[o,i]of Object.entries(m.value))s[i]=(s[i]||0)-1;for(const[o,i]of Object.entries(s))i<=0&&delete s[o];T.value=s}const I=W(()=>{const s=[];for(const[o,i]of Object.entries(T.value))for(let g=0;g<i;g++)s.push(Number(o));return E(s)});function V(){M.value=!1,U.value=null,m.value={},v.value={},Y.value=Z(Oe),N.value=Z(Oe),D.value=j(),R()}function X(){for(const s of D.value)if(m.value[s]==null)return!1;return!0}function L(){if(!X())return!1;for(const s of D.value){const[o,i]=s.split(":"),[g,q]=i.split(",").map(Number);if(m.value[s]!==P(g,q))return!1}return!0}async function w(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function _(){if(!X()){U.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",O&&O.play();return}L()?(M.value=!0,U.value=l[a.value].correct,S&&S.play(),await w()):(U.value=l[a.value].wrong,O&&O.play())}function u(){m.value={},v.value={},R(),U.value=null,M.value=!1}function f(s,o,{fromManual:i=!1}={}){if(!Number.isNaN(o)){if(m.value[s]!=null){const g=m.value[s];T.value[g]=(T.value[g]||0)+1}if(i)(T.value[o]||0)>0&&(T.value[o]-=1);else{if((T.value[o]||0)===0)return;T.value[o]-=1}m.value[s]=o,v.value={...v.value,[s]:String(o)},U.value=null}}function x(s,o){s.dataTransfer.setData("text/plain",String(o))}function b(s){s.preventDefault()}function c(s,o){s.preventDefault();const i=Number(s.dataTransfer.getData("text/plain"));f(o,i)}function p(s){if(m.value[s]!=null){const o=m.value[s];T.value[o]=(T.value[o]||0)+1,delete m.value[s]}v.value={...v.value,[s]:""}}function y(s,o){v.value={...v.value,[s]:o}}function B(s){var g;const o=((g=v.value[s])!=null?g:"").trim();if(o===""){p(s);return}const i=Number(o);Number.isFinite(i)&&f(s,i,{fromManual:!0})}const d=W(()=>({direction:"ltr",unicodeBidi:"isolate"}));return _e(V),ge(()=>A.lang,()=>{}),(s,o)=>(n(),r("div",{class:"challenge4 challenge-surface","data-theme":A.theme},[e("h2",fl,t(l[a.value].title),1),e("p",ml,t(l[a.value].rule),1),e("div",gl,[(n(!0),r(te,null,le(Oe+1,i=>(n(),r("div",{class:"row",key:"r"+i},[(n(!0),r(te,null,le(Oe+1,g=>{var q;return n(),r("div",{class:re(["cell header",{th:i===1||g===1,corner:i===1&&g===1}]),key:"c"+i+"-"+g},[i===1&&g===1?(n(),r(te,{key:0},[J(" × ")],64)):D.value.has(i===1||g===1?`h:${i-1},${g-1}`:`c:${i-1},${g-1}`)?(n(),r(te,{key:2},[e("div",{class:"dropzone",onDragover:b,onDrop:C=>c(C,i===1||g===1?`h:${i-1},${g-1}`:`c:${i-1},${g-1}`)},[m.value[i===1||g===1?`h:${i-1},${g-1}`:`c:${i-1},${g-1}`]!=null?(n(),r("span",{key:0,class:"num",style:ue(d.value)},t(m.value[i===1||g===1?`h:${i-1},${g-1}`:`c:${i-1},${g-1}`]),5)):(n(),r("span",yl,"؟"))],40,_l),e("input",{class:"manual-entry",type:"number",value:(q=v.value[i===1||g===1?`h:${i-1},${g-1}`:`c:${i-1},${g-1}`])!=null?q:"",onInput:C=>y(i===1||g===1?`h:${i-1},${g-1}`:`c:${i-1},${g-1}`,C.target.value),onChange:C=>B(i===1||g===1?`h:${i-1},${g-1}`:`c:${i-1},${g-1}`),onBlur:C=>B(i===1||g===1?`h:${i-1},${g-1}`:`c:${i-1},${g-1}`),placeholder:A.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,bl),e("button",{class:"clear",onClick:C=>p(i===1||g===1?`h:${i-1},${g-1}`:`c:${i-1},${g-1}`)},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)],8,kl)],64)):(n(),r("span",{key:1,class:"num",style:ue(d.value)},t(P(i-1,g-1)),5))],2)}),128))]))),128))]),e("div",wl,[e("div",$l,t(l[a.value].bank),1),e("div",Cl,[(n(!0),r(te,null,le(I.value,i=>(n(),r("button",{key:i+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:g=>x(g,i),style:ue(d.value)},t(i),45,xl))),128))]),e("div",Sl,[e("button",{class:"btn",onClick:u},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:_},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:V},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),U.value?(n(),r("div",{key:0,class:re(["toast",{ok:M.value}])},t(U.value),3)):ie("",!0)]),M.value?(n(),r("div",Al,[e("div",Dl,[e("div",Tl,t(l[a.value].correct),1),e("button",{class:"btn",onClick:V},t(l[a.value].newQ),1)])])):ie("",!0)],8,pl))}},Ll=me(Ml,[["__scopeId","data-v-f63f0f22"]]),Nl="/assets/mathematics_leaders/frontend/assets/wrong5.mp3",Pl=["data-theme"],El={class:"title"},zl={class:"rule"},Bl={class:"tri-wrap"},Ol={class:"square left-sq"},jl={key:1,class:"placeholder"},Rl=["value","placeholder"],Il={class:"square right-sq"},Fl={key:1,class:"placeholder"},Ul=["value","placeholder"],ql={class:"square base-sq"},Ql={key:1,class:"placeholder"},Hl=["value","placeholder"],Vl={class:"side"},Gl={class:"bank-title"},Wl={class:"bank-items"},Kl=["onDragstart"],Yl={class:"actions"},Jl={key:0,class:"overlay"},Xl={class:"card"},Zl={class:"big"},es=4,ts={__name:"challenge_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"التحدي 5: مخطط مثلث (ضرب)",rule:"كل مربع على الضلع يساوي حاصل ضرب العدديْن في الدائرتيْن المجاورتين له. اسحب القيم المفقودة إلى المربعات.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 5: Triangle product",rule:"Each edge-square equals the product of the two adjacent circles. Drag missing values into the squares.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check your values",clear:"Clear cell"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(ze):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Nl):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");function E(d,s){return Math.floor(Math.random()*(s-d+1))+d}function Y(d){const s=d.slice();for(let o=s.length-1;o>0;o--){const i=Math.floor(Math.random()*(o+1));[s[o],s[i]]=[s[i],s[o]]}return s}const N=z([2,3,4]),D=z({t:0,l:0,r:0}),m=z(new Set),v=z({}),T=z({}),M=z({}),U=z(!1),P=z(null);function Q(){const d=Y([2,3,4,5,6,7,8,9]).slice(0,3);N.value=[d[0],d[1],d[2]];const[s,o,i]=N.value;D.value={l:s*o,r:s*i,t:o*i}}function Z(){const d=["l","r","t"],s=E(2,3);m.value=new Set(Y(d).slice(0,s))}function j(){const d={};m.value.forEach(o=>{const i=D.value[o];d[i]=(d[i]||0)+1});for(const[o,i]of Object.entries(v.value))d[i]=(d[i]||0)-1;for(const[o,i]of Object.entries(d))i<=0&&delete d[o];const s=es;{const o=new Set(Object.keys(d).map(Number)),i=new Set(Object.values(D.value)),g=[];for(let q=4;q<=81;q++)!o.has(q)&&!i.has(q)&&g.push(q);for(let q=0;q<s&&g.length;q++){const C=Math.floor(Math.random()*g.length),h=g.splice(C,1)[0];d[h]=(d[h]||0)+1}}M.value=d}const R=W(()=>{const d=[];for(const[s,o]of Object.entries(M.value))for(let i=0;i<o;i++)d.push(Number(s));return Y(d)});function I(){U.value=!1,P.value=null,v.value={},T.value={},Q(),Z(),j()}function V(){for(const d of m.value)if(v.value[d]==null)return!1;return!0}function X(){if(!V())return!1;for(const d of m.value)if(v.value[d]!==D.value[d])return!1;return!0}async function L(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function w(){if(!V()){P.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",$&&$.play();return}X()?(U.value=!0,P.value=l[a.value].correct,S&&S.play(),O&&O.play(),await L()):(P.value=l[a.value].wrong,$&&$.play())}function _(){v.value={},j(),P.value=null,U.value=!1}function u(d,s){d.dataTransfer.setData("text/plain",String(s))}function f(d){d.preventDefault()}function x(d,s,{fromManual:o=!1}={}){if(!Number.isNaN(s)){if(v.value[d]!=null){const i=v.value[d];M.value[i]=(M.value[i]||0)+1}if(o)(M.value[s]||0)>0&&(M.value[s]-=1);else{if((M.value[s]||0)===0)return;M.value[s]-=1}v.value[d]=s,T.value={...T.value,[d]:String(s)},P.value=null}}function b(d,s){d.preventDefault();const o=Number(d.dataTransfer.getData("text/plain"));x(s,o)}function c(d){if(v.value[d]!=null){const s=v.value[d];M.value[s]=(M.value[s]||0)+1,delete v.value[d]}T.value={...T.value,[d]:""}}function p(d,s){T.value={...T.value,[d]:s}}function y(d){var i;const s=((i=T.value[d])!=null?i:"").trim();if(s===""){c(d);return}const o=Number(s);Number.isFinite(o)&&x(d,o,{fromManual:!0})}const B=W(()=>({direction:"ltr",unicodeBidi:"isolate"}));return _e(I),ge(()=>A.lang,()=>{}),(d,s)=>{var o,i,g;return n(),r("div",{class:"challenge5 challenge-surface","data-theme":A.theme},[e("h2",El,t(l[a.value].title),1),e("p",zl,t(l[a.value].rule),1),e("div",Bl,[s[15]||(s[15]=e("svg",{class:"links",viewBox:"0 0 300 260",preserveAspectRatio:"none"},[e("line",{x1:"150",y1:"40",x2:"60",y2:"140"}),e("line",{x1:"150",y1:"40",x2:"240",y2:"140"}),e("line",{x1:"60",y1:"140",x2:"240",y2:"140"})],-1)),e("div",{class:"circle top",style:ue(B.value)},t(N.value[0]),5),e("div",{class:"circle left",style:ue(B.value)},t(N.value[1]),5),e("div",{class:"circle right",style:ue(B.value)},t(N.value[2]),5),e("div",Ol,[m.value.has("l")?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:f,onDrop:s[0]||(s[0]=q=>b(q,"l"))},[v.value.l!=null?(n(),r("span",{key:0,class:"num",style:ue(B.value)},t(v.value.l),5)):(n(),r("span",jl,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(o=T.value.l)!=null?o:"",onInput:s[1]||(s[1]=q=>p("l",q.target.value)),onChange:s[2]||(s[2]=q=>y("l")),onBlur:s[3]||(s[3]=q=>y("l")),placeholder:A.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,Rl),e("button",{class:"clear",onClick:s[4]||(s[4]=q=>c("l"))},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)])],64)):(n(),r("span",{key:0,class:"num",style:ue(B.value)},t(D.value.l),5))]),e("div",Il,[m.value.has("r")?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:f,onDrop:s[5]||(s[5]=q=>b(q,"r"))},[v.value.r!=null?(n(),r("span",{key:0,class:"num",style:ue(B.value)},t(v.value.r),5)):(n(),r("span",Fl,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(i=T.value.r)!=null?i:"",onInput:s[6]||(s[6]=q=>p("r",q.target.value)),onChange:s[7]||(s[7]=q=>y("r")),onBlur:s[8]||(s[8]=q=>y("r")),placeholder:A.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,Ul),e("button",{class:"clear",onClick:s[9]||(s[9]=q=>c("r"))},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)])],64)):(n(),r("span",{key:0,class:"num",style:ue(B.value)},t(D.value.r),5))]),e("div",ql,[m.value.has("t")?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:f,onDrop:s[10]||(s[10]=q=>b(q,"t"))},[v.value.t!=null?(n(),r("span",{key:0,class:"num",style:ue(B.value)},t(v.value.t),5)):(n(),r("span",Ql,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(g=T.value.t)!=null?g:"",onInput:s[11]||(s[11]=q=>p("t",q.target.value)),onChange:s[12]||(s[12]=q=>y("t")),onBlur:s[13]||(s[13]=q=>y("t")),placeholder:A.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,Hl),e("button",{class:"clear",onClick:s[14]||(s[14]=q=>c("t"))},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)])],64)):(n(),r("span",{key:0,class:"num",style:ue(B.value)},t(D.value.t),5))])]),e("div",Vl,[e("div",Gl,t(l[a.value].bank),1),e("div",Wl,[(n(!0),r(te,null,le(R.value,q=>(n(),r("button",{key:q+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:C=>u(C,q),style:ue(B.value)},t(q),45,Kl))),128))]),e("div",Yl,[e("button",{class:"btn",onClick:_},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:w},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:I},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),P.value?(n(),r("div",{key:0,class:re(["toast",{ok:U.value}])},t(P.value),3)):ie("",!0)]),U.value?(n(),r("div",Jl,[e("div",Xl,[e("div",Zl,t(l[a.value].correct),1),e("button",{class:"btn",onClick:I},t(l[a.value].newQ),1)])])):ie("",!0)],8,Pl)}}},as=me(ts,[["__scopeId","data-v-d3434538"]]),ns=["data-theme"],ls={class:"title"},ss={class:"rule"},os=["onClick"],rs={class:"panel"},is={class:"actions"},cs={__name:"challenge_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"التحدي 6: اختر ثلاث خلايا من شبكة بحيث لا تكون في الصف أو العمود نفسه ويكون مجموعها الهدف",rule:(L,w)=>`شبكة ${L}×${L}. اختر ثلاث خلايا كلٌّ منها في صف وعمود مختلفين بحيث يساوي مجموعها ${w}.`,newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيود أو من المجموع",picked:"المختار: "},en:{title:"Challenge 6: Pick 3 cells in different rows and columns to reach the target sum",rule:(L,w)=>`A ${L}×${L} grid. Pick three cells, one per distinct row and column, whose sum equals ${w}.`,newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check the constraints or the sum",picked:"Picked: "}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(kt):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Fe):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");function E(L,w){return Math.floor(Math.random()*(w-L+1))+L}function Y(L){const w=L.slice();for(let _=w.length-1;_>0;_--){const u=Math.floor(Math.random()*(_+1));[w[_],w[u]]=[w[u],w[_]]}return w}const N=z(3),D=z([]),m=z(0),v=z([]),T=z(!1),M=z(null),U=W(()=>({direction:"ltr",unicodeBidi:"isolate"})),P=W(()=>v.value.reduce((L,w)=>L+D.value[w.r][w.c],0));function Q(){T.value=!1,M.value=null,v.value=[],N.value=[3,4][E(0,1)],D.value=Array.from({length:N.value},()=>Array.from({length:N.value},()=>E(1,9)));const L=Y([...Array(N.value).keys()]).slice(0,3),w=Y([...Array(N.value).keys()]).slice(0,3),_=Y(w.slice()),u=L.map((f,x)=>({r:f,c:_[x]}));m.value=u.reduce((f,x)=>f+D.value[x.r][x.c],0)}function Z(){v.value=[],M.value=null,T.value=!1}function j(L,w){if(T.value)return;const _=v.value.findIndex(u=>u.r===L&&u.c===w);if(_>=0){v.value.splice(_,1);return}v.value.length!==3&&v.value.push({r:L,c:w})}function R(){const L=v.value.map(w=>w.r);return new Set(L).size===v.value.length}function I(){const L=v.value.map(w=>w.c);return new Set(L).size===v.value.length}async function V(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function X(){if(v.value.length!==3){M.value=a.value==="ar"?"اختر ثلاث خلايا":"Pick three cells",$&&$.play();return}if(!R()||!I()){M.value=l[a.value].wrong,$&&$.play();return}P.value===m.value?(T.value=!0,M.value=l[a.value].correct,S&&S.play(),O&&O.play(),await V()):(M.value=l[a.value].wrong,$&&$.play())}return _e(Q),(L,w)=>(n(),r("div",{class:"challenge6 challenge-surface","data-theme":A.theme},[e("h2",ls,t(l[a.value].title),1),e("p",ss,t(l[a.value].rule(N.value,m.value)),1),(n(!0),r(te,null,le(D.value,(_,u)=>(n(),r("div",{class:"grid",key:"r"+u,style:ue({"--n":N.value})},[(n(!0),r(te,null,le(_,(f,x)=>(n(),r("button",{key:u+"-"+x,class:re(["cell",{picked:v.value.some(b=>b.r===u&&b.c===x)}]),onClick:b=>j(u,x),style:ue(U.value)},t(f),15,os))),128))],4))),128)),e("div",rs,[e("div",is,[e("button",{class:"btn",onClick:Z},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:X},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:Q},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),M.value?(n(),r("div",{key:0,class:re(["toast",{ok:T.value}])},t(M.value),3)):ie("",!0)])],8,ns))}},us=me(cs,[["__scopeId","data-v-b5e71b4a"]]),ds=["data-theme"],vs={class:"title"},hs={class:"rule"},ps={class:"pyramid"},fs=["onDrop"],ms={key:1,class:"placeholder"},gs=["value","onInput","onChange","onBlur","placeholder"],_s=["onClick"],ys={class:"side"},bs={class:"bank-title"},ks={class:"bank-items"},ws=["onDragstart"],$s={class:"actions"},Cs=6,xs={__name:"challenge_7",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"التحدي 7: جدار أعداد (هرم جمع)",rule:"كل خانة تساوي مجموع الخليتين اللتين تحتها مباشرة. اسحب القيم المفقودة لإكمال الهرم.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 7: Sum Pyramid",rule:"Each cell equals the sum of the two cells directly below. Drag missing values to complete the pyramid.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check your values",clear:"Clear cell"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(Pe):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(at):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");function E(s,o){return Math.floor(Math.random()*(o-s+1))+s}function Y(s){const o=s.slice();for(let i=o.length-1;i>0;i--){const g=Math.floor(Math.random()*(i+1));[o[i],o[g]]=[o[g]]=[o[g],o[i]]}return o}const N=z(4),D=z([]),m=z(new Set),v=z({}),T=z({}),M=z({}),U=z(!1),P=z(null),Q=W(()=>({direction:"ltr",unicodeBidi:"isolate"}));function Z(s){const o=[];o[0]=Array.from({length:s},()=>E(1,9));for(let i=1;i<s;i++)o[i]=Array.from({length:s-i},(g,q)=>o[i-1][q]+o[i-1][q+1]);return o}function j(s,o){return`${s},${o}`}function R(s){const o=[];for(let h=0;h<s;h++)for(let k=0;k<D.value[h].length;k++)o.push([h,k]);const i=new Set;for(let h=1;h<s;h++){const k=E(0,D.value[h].length-1);i.add(j(h,k))}const g=o.filter(([h,k])=>h>0&&!i.has(j(h,k))),q=E(4,6),C=Y(g).slice(0,q);return new Set(C.map(([h,k])=>j(h,k)))}function I(){const s={};m.value.forEach(o=>{const[i,g]=o.split(",").map(Number),q=D.value[i][g];s[q]=(s[q]||0)+1});for(const[o,i]of Object.entries(v.value))s[i]=(s[i]||0)-1;for(const[o,i]of Object.entries(s))i<=0&&delete s[o];{const o=new Set(Object.keys(s).map(Number)),i=new Set;D.value.forEach(h=>h.forEach(k=>i.add(k)));const g=[],q=2,C=120;for(let h=q;h<=C;h++)!o.has(h)&&!i.has(h)&&g.push(h);for(let h=0;h<Cs&&g.length;h++){const k=Math.floor(Math.random()*g.length),F=g.splice(k,1)[0];s[F]=(s[F]||0)+1}}M.value=s}const V=W(()=>{const s=[];for(const[o,i]of Object.entries(M.value))for(let g=0;g<i;g++)s.push(Number(o));return Y(s)});function X(){U.value=!1,P.value=null,v.value={},T.value={},D.value=Z(N.value),m.value=R(N.value),I()}function L(){for(const s of m.value)if(v.value[s]==null)return!1;return!0}function w(){if(!L())return!1;for(const s of m.value){const[o,i]=s.split(",").map(Number);if(v.value[s]!==D.value[o][i])return!1}return!0}async function _(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function u(){if(!L()){P.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",$&&$.play();return}w()?(U.value=!0,P.value=l[a.value].correct,S&&S.play(),O&&O.play(),await _()):(P.value=l[a.value].wrong,$&&$.play())}function f(){v.value={},T.value={},I(),P.value=null,U.value=!1}function x(s,o,{fromManual:i=!1}={}){if(!Number.isNaN(o)){if(v.value[s]!=null){const g=v.value[s];M.value[g]=(M.value[g]||0)+1}if(i)(M.value[o]||0)>0&&(M.value[o]-=1);else{if((M.value[o]||0)===0)return;M.value[o]-=1}v.value[s]=o,T.value={...T.value,[s]:String(o)},P.value=null}}function b(s,o){s.dataTransfer.setData("text/plain",String(o))}function c(s){s.preventDefault()}function p(s,o){s.preventDefault();const i=Number(s.dataTransfer.getData("text/plain"));x(o,i)}function y(s){if(v.value[s]!=null){const o=v.value[s];M.value[o]=(M.value[o]||0)+1,delete v.value[s]}T.value={...T.value,[s]:""}}_e(X),ge(()=>A.lang,()=>{});function B(s,o){T.value={...T.value,[s]:o}}function d(s){var g;const o=((g=T.value[s])!=null?g:"").trim();if(o===""){y(s);return}const i=Number(o);Number.isFinite(i)&&x(s,i,{fromManual:!0})}return(s,o)=>(n(),r("div",{class:"challenge7 challenge-surface","data-theme":A.theme},[e("h2",vs,t(l[a.value].title),1),e("p",hs,t(l[a.value].rule),1),e("div",ps,[(n(!0),r(te,null,le(D.value,(i,g)=>(n(),r("div",{class:"prow",key:"r"+g,style:ue({"--cols":i.length})},[(n(!0),r(te,null,le(i,(q,C)=>{var h;return n(),r("div",{class:"cell",key:g+"-"+C},[m.value.has(`${g},${C}`)?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:c,onDrop:k=>p(k,`${g},${C}`)},[v.value[`${g},${C}`]!=null?(n(),r("span",{key:0,class:"num",style:ue(Q.value)},t(v.value[`${g},${C}`]),5)):(n(),r("span",ms,"؟"))],40,fs),e("input",{class:"manual-entry",type:"number",value:(h=T.value[`${g},${C}`])!=null?h:"",onInput:k=>B(`${g},${C}`,k.target.value),onChange:k=>d(`${g},${C}`),onBlur:k=>d(`${g},${C}`),placeholder:A.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,gs),e("button",{class:"clear",onClick:k=>y(`${g},${C}`)},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)],8,_s)],64)):(n(),r("span",{key:0,class:"num",style:ue(Q.value)},t(q),5))])}),128))],4))),128))]),e("div",ys,[e("div",bs,t(l[a.value].bank),1),e("div",ks,[(n(!0),r(te,null,le(V.value,i=>(n(),r("button",{key:i+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:g=>b(g,i),style:ue(Q.value)},t(i),45,ws))),128))]),e("div",$s,[e("button",{class:"btn",onClick:f},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:u},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:X},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),P.value?(n(),r("div",{key:0,class:re(["toast",{ok:U.value}])},t(P.value),3)):ie("",!0)])],8,ds))}},Ss=me(xs,[["__scopeId","data-v-48f5f33c"]]),As="/assets/mathematics_leaders/frontend/assets/oh_no.mp3",Ds=["data-theme"],Ts={class:"title"},Ms={class:"rule"},Ls={class:"panel"},Ns=["placeholder"],Ps={class:"usage"},Es={class:"keypad"},zs={class:"label"},Bs={class:"row"},Os=["onClick"],js=["onClick"],Rs={class:"actions"},Is={class:"hint"},Fs={__name:"challenge_level_two_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"التحدي 1 (المستوى الثاني): كوّن جملة عددية تستعمل 1،2،3،4،5 دون تكرار",rule:L=>`اكتب تعبيراً حسابياً يستخدم الأرقام ١،٢،٣،٤،٥ كلٌّ مرة واحدة فقط ويكون ناتجه ${L}. يمكن استعمال + - × ÷ والأقواس، ولا يُسمح بأي أرقام أخرى أو تكرار.`,inputPH:"اكتب التعبير هنا… مثل: (5*4)*(3+2)*1",keys:"لوحة المفاتيح",newQ:"سؤال جديد",reset:"مسح",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من الشروط أو من النتيجة",used:"استخدام الأرقام:",note:"تلميح: يمكنك دائماً استعمال ×1 دون تغيير النتيجة."},en:{title:"Level 2 – Challenge 1: Build an expression with 1..5 once each",rule:L=>`Write an expression that uses digits 1,2,3,4,5 exactly once and evaluates to ${L}. Allowed: + - * / and parentheses. No other digits or repeats.`,inputPH:"Type expression… e.g., (5*4)*(3+2)*1",keys:"Keypad",newQ:"New puzzle",reset:"Clear",check:"Check",correct:"Correct",wrong:"Check constraints or value",used:"Digits usage:",note:"Hint: multiplying by 1 keeps the value unchanged."}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(ze):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(As):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");function E(L,w){return Math.floor(Math.random()*(w-L+1))+L}function Y(L){const w=L.slice();for(let _=w.length-1;_>0;_--){const u=Math.floor(Math.random()*(_+1));[w[_],w[u]]=[w[u],w[_]]}return w}const N=z(""),D=z(0),m=z(null),v=z(!1),T=[1,2,3,4,5],M=["+","-","*","/","(",")"];function U(){const L=Y([2,3,4,5]),[w,_,u,f]=L,x=o=>o[E(0,o.length-1)],b=x(["+","-","*","/"]),c=x(["+","-","*","/"]),p=x(["+","-","*","/"]),y=o=>{try{return Function(`return (${o});`)()}catch{return null}};let B=`( ${w} ${b} ${_} ) ${c} ( ${u} ${p} ${f} )`,d=y(B),s=0;for(;(d==null||!isFinite(d))&&s<20;)return U();Math.random()<.7?(B=`(${B}) * 1`,d=y(B)):(B=`((${B}) + 1) - 1`,d=y(B)),D.value=d,N.value="",m.value=null,v.value=!1}function P(L){N.value+=L}function Q(){N.value=N.value.slice(0,-1)}function Z(){N.value="",m.value=null,v.value=!1}const j=W(()=>{const L={1:0,2:0,3:0,4:0,5:0};for(const w of N.value)"12345".includes(w)&&L[w]++;return L});function R(L){return/^[\d\+\-\*\/\(\)\s]*$/.test(L)}function I(){if(/[06789]/.test(N.value))return!1;const L=j.value;return T.every(w=>L[w]===1)}function V(L){try{return!R(L)||(L=L.replace(/×/g,"*").replace(/÷/g,"/"),/\b(?![1-5]\b)\d+\b/.test(L))?null:Function(`"use strict"; return (${L});`)()}catch{return null}}async function X(){const L=V(N.value);if(L==null||!isFinite(L)||!I()){m.value=l[a.value].wrong,$&&$.play();return}if(Math.abs(L-D.value)<1e-9){v.value=!0,m.value=l[a.value].correct,S&&S.play(),O&&O.play();try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}else m.value=l[a.value].wrong,$&&$.play()}return _e(U),(L,w)=>(n(),r("div",{class:"lvl2c1 challenge-surface","data-theme":A.theme},[e("h2",Ts,t(l[a.value].title),1),e("p",Ms,t(l[a.value].rule(D.value)),1),e("div",Ls,[Me(e("input",{class:"expr",placeholder:l[a.value].inputPH,"onUpdate:modelValue":w[0]||(w[0]=_=>N.value=_),dir:"ltr",inputmode:"numeric",autocomplete:"off",spellcheck:"false"},null,8,Ns),[[Le,N.value]]),e("div",Ps,[J(t(l[a.value].used)+" ",1),(n(),r(te,null,le(T,_=>e("span",{key:_,class:re(["u",{ok:j.value[_]===1,bad:j.value[_]>1}])},t(_)+": "+t(j.value[_]),3)),64))]),e("div",Es,[e("div",zs,t(l[a.value].keys),1),e("div",Bs,[(n(),r(te,null,le(T,_=>e("button",{class:"k",key:"d"+_,onClick:u=>P(String(_))},t(_),9,Os)),64)),(n(),r(te,null,le(M,_=>e("button",{class:"k",key:"o"+_,onClick:u=>P(_)},t(_),9,js)),64)),e("button",{class:"k wide",onClick:Q},"⌫")])]),e("div",Rs,[e("button",{class:"btn",onClick:Z},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:X},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:U},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),e("div",Is,t(l[a.value].note),1),m.value?(n(),r("div",{key:0,class:re(["toast",{ok:v.value}])},t(m.value),3)):ie("",!0)])],8,Ds))}},Us=me(Fs,[["__scopeId","data-v-ac84a4b0"]]),qs=["data-theme"],Qs={class:"title"},Hs={class:"rule"},Vs={class:"board"},Gs=["onDrop"],Ws={key:1,class:"placeholder"},Ks=["onClick"],Ys={class:"side"},Js={class:"bank-title"},Xs={class:"bank-items"},Zs=["onDragstart"],eo={class:"actions"},to={__name:"challenge_level_two_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثاني – التحدي 2: أكمل مربعاً سحرياً",rule:o=>`ضع الأعداد بحيث يكون مجموع كل صف وعمود وقطر مساوياً ${o}. اسحب القيم المفقودة إلى أماكنها. الأعداد جميعها مختلفة.`,bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من المجاميع أو التكرار",clear:"تفريغ الخلية"},en:{title:"Level 2 – Challenge 2: Complete a magic square",rule:o=>`Place numbers so each row, column, and diagonal sums to ${o}. Drag the missing values into place. All numbers are distinct.`,bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check sums or duplicates",clear:"Clear cell"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(ze):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Ne):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");function E(o,i){return Math.floor(Math.random()*(i-o+1))+o}function Y(o){const i=o.slice();for(let g=i.length-1;g>0;g--){const q=Math.floor(Math.random()*(g+1));[i[g],i[q]]=[i[q],i[g]]}return i}const N=[[8,1,6],[3,5,7],[4,9,2]];function D(o){const i=F=>[[F[2][0],F[1][0],F[0][0]],[F[2][1],F[1][1],F[0][1]],[F[2][2],F[1][2],F[0][2]]],g=F=>F.map(G=>G.slice().reverse()),q=[];let C=o;for(let F=0;F<4;F++)q.push(C),q.push(g(C)),C=i(C);const h=[],k=new Set;for(const F of q){const G=JSON.stringify(F);k.has(G)||(h.push(F),k.add(G))}return h}const m=D(N),v=z([[0,0,0],[0,0,0],[0,0,0]]),T=z(0),M=z(new Set),U=z({}),P=z({}),Q=z(!1),Z=z(null),j=W(()=>({direction:"ltr",unicodeBidi:"isolate"})),R=(o,i)=>`${o},${i}`;function I(){const o=m[E(0,m.length-1)],i=[1,2,3,4,5][E(0,4)],g=E(0,6),q=Array.from({length:3},()=>Array(3).fill(0));for(let C=0;C<3;C++)for(let h=0;h<3;h++)q[C][h]=g+i*o[C][h];v.value=q,T.value=i*15+3*g}function V(){const o=[];for(let C=0;C<3;C++)for(let h=0;h<3;h++)o.push([C,h]);const i=Y(o).slice(0,E(3,4)),g=new Set(i.map(([C,h])=>R(C,h))),q=o.filter(([C,h])=>!g.has(R(C,h)));M.value=new Set(q.map(([C,h])=>R(C,h)))}function X(){const o={};M.value.forEach(i=>{const[g,q]=i.split(",").map(Number),C=v.value[g][q];o[C]=(o[C]||0)+1});for(const[i,g]of Object.entries(U.value))o[g]=(o[g]||0)-1;for(const[i,g]of Object.entries(o))g<=0&&delete o[i];P.value=o}const L=W(()=>{const o=[];for(const[i,g]of Object.entries(P.value))for(let q=0;q<g;q++)o.push(Number(i));return Y(o)});function w(){Q.value=!1,Z.value=null,U.value={},I(),V(),X()}function _(){for(const o of M.value)if(U.value[o]==null)return!1;return!0}function u(){const o=v.value.map(i=>i.slice());for(const i of M.value){const[g,q]=i.split(",").map(Number);o[g][q]=U.value[i]}return o}function f(o){const i=new Set;for(const g of o)for(const q of g){if(i.has(q))return!1;i.add(q)}return!0}function x(o){const i=(g,q,C)=>g+q+C;for(let g=0;g<3;g++)if(i(o[g][0],o[g][1],o[g][2])!==T.value||i(o[0][g],o[1][g],o[2][g])!==T.value)return!1;return!(i(o[0][0],o[1][1],o[2][2])!==T.value||i(o[0][2],o[1][1],o[2][0])!==T.value)}async function b(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function c(){if(!_()){Z.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",$&&$.play();return}const o=u();f(o)&&x(o)?(Q.value=!0,Z.value=l[a.value].correct,S&&S.play(),O&&O.play(),await b()):(Z.value=l[a.value].wrong,$&&$.play())}function p(){U.value={},X(),Z.value=null,Q.value=!1}function y(o,i){o.dataTransfer.setData("text/plain",String(i))}function B(o){o.preventDefault()}function d(o,i){o.preventDefault();const g=Number(o.dataTransfer.getData("text/plain"));if(U.value[i]!=null){const q=U.value[i];P.value[q]=(P.value[q]||0)+1}(P.value[g]||0)!==0&&(P.value[g]-=1,U.value[i]=g,Z.value=null)}function s(o){if(U.value[o]!=null){const i=U.value[o];P.value[i]=(P.value[i]||0)+1,delete U.value[o]}}return _e(w),ge(()=>A.lang,()=>{}),(o,i)=>(n(),r("div",{class:"lvl2c2 challenge-surface","data-theme":A.theme},[e("h2",Qs,t(l[a.value].title),1),e("p",Hs,t(l[a.value].rule(T.value)),1),e("div",Vs,[(n(),r(te,null,le(3,g=>e("div",{class:"row",key:"r"+g},[(n(),r(te,null,le(3,q=>e("div",{class:"cell",key:"c"+g+"-"+q},[M.value.has(`${g-1},${q-1}`)?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:B,onDrop:C=>d(C,`${g-1},${q-1}`)},[U.value[`${g-1},${q-1}`]!=null?(n(),r("span",{key:0,class:"num",style:ue(j.value)},t(U.value[`${g-1},${q-1}`]),5)):(n(),r("span",Ws,"؟"))],40,Gs),e("button",{class:"clear",onClick:C=>s(`${g-1},${q-1}`)},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)],8,Ks)],64)):(n(),r("span",{key:0,class:"num",style:ue(j.value)},t(v.value[g-1][q-1]),5))])),64))])),64))]),e("div",Ys,[e("div",Js,t(l[a.value].bank),1),e("div",Xs,[(n(!0),r(te,null,le(L.value,g=>(n(),r("button",{key:g+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:q=>y(q,g),style:ue(j.value)},t(g),45,Zs))),128))]),e("div",eo,[e("button",{class:"btn",onClick:p},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:c},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:w},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),Z.value?(n(),r("div",{key:0,class:re(["toast",{ok:Q.value}])},t(Z.value),3)):ie("",!0)])],8,qs))}},ao=me(to,[["__scopeId","data-v-741125f1"]]),no=["data-theme"],lo={class:"title"},so={class:"rule"},oo={class:"cards"},ro={class:"card"},io={class:"label"},co={key:0,class:"num"},uo={key:1,class:"placeholder"},vo={class:"card"},ho={class:"label"},po={key:0,class:"num"},fo={key:1,class:"placeholder"},mo={class:"card"},go={class:"label"},_o={key:0,class:"num"},yo={key:1,class:"placeholder"},bo={class:"card"},ko={class:"label"},wo={key:0,class:"num"},$o={key:1,class:"placeholder"},Co={class:"bank"},xo={class:"bank-title"},So={class:"bank-items"},Ao=["disabled","onDragstart"],Do={key:0},To={class:"actions"},Mo={__name:"challenge_level_two_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثاني – التحدي 3: أوصل المسألة بالنتيجة الصحيحة",rule:"اسحب عدداً من ستة أرقام إلى كل خانة بحسب الخاصية المطلوبة: مضاعف 2، 3، 4، 5. كل عدد يُستخدم مرة واحدة.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من الخواص",clear:"تفريغ الخلية",lab2:"مضاعفًا للعدد 2",lab3:"مضاعفًا للعدد 3",lab4:"مضاعفًا للعدد 4",lab5:"مضاعفًا للعدد 5"},en:{title:"Level 2 – Challenge 3: Match each rule to a six-digit number",rule:"Drag one six-digit number to each rule: multiple of 2, 3, 4, 5. Each number can be used once.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check the properties",clear:"Clear cell",lab2:"Multiple of 2",lab3:"Multiple of 3",lab4:"Multiple of 4",lab5:"Multiple of 5"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(Pe):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Ne):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");function E(b,c){return Math.floor(Math.random()*(c-b+1))+b}function Y(b){const c=b.slice();for(let p=c.length-1;p>0;p--){const y=Math.floor(Math.random()*(p+1));[c[p],c[y]]=[c[y],c[p]]}return c}const N=z([]),D=z({}),m=z({m2:null,m3:null,m4:null,m5:null}),v=z(null),T=z(!1),M=b=>b%2===0,U=b=>String(b).split("").reduce((c,p)=>c+ +p,0)%3===0,P=b=>b%100%4===0,Q=b=>b%10===0||b%10===5;function Z(b=c=>!0){for(;;){const c=E(1,9);let p=String(c);for(let B=0;B<5;B++)p+=String(E(0,9));const y=Number(p);if(b(y))return y}}function j(b,c=()=>!0){for(;;){const p=E(1,9);let y=String(p);for(let d=0;d<4;d++)y+=String(E(0,9));y+=String(b);const B=Number(y);if(c(B))return B}}function R(){T.value=!1,v.value=null,m.value={m2:null,m3:null,m4:null,m5:null};const b=new Set,c=i=>{const g=String(i);return b.has(g)?!1:(b.add(g),!0)};let p=j(5,i=>!U(i)||E(0,1));for(;!c(p);)p=j(5);let y=j([0,2,4,6,8][E(0,4)],i=>!Q(i)&&!P(i));for(;!c(y);)y=j([0,2,4,6,8][E(0,4)],i=>!Q(i)&&!P(i));let B=Z(i=>P(i));for(;!c(B);)B=Z(i=>P(i));let d=Z(i=>U(i)&&!Q(i));for(;!c(d);)d=Z(i=>U(i)&&!Q(i));const s=[y,d,B,p],o=[];for(;o.length<4;){let i=Z(g=>g%2!==0&&!U(g)&&!Q(g)&&!P(g));c(i)&&o.push(i)}N.value=Y(s.concat(o)),D.value=Object.fromEntries(N.value.map(i=>[i,1]))}function I(b,c){b.dataTransfer.setData("text/plain",String(c))}function V(b){b.preventDefault()}function X(b,c){c.preventDefault();const p=Number(c.dataTransfer.getData("text/plain"));(D.value[p]||0)!==0&&(m.value[b]!=null&&(D.value[m.value[b]]=(D.value[m.value[b]]||0)+1),m.value[b]=p,D.value[p]-=1,v.value=null)}function L(b){m.value[b]!=null&&(D.value[m.value[b]]=(D.value[m.value[b]]||0)+1,m.value[b]=null)}function w(){return["m2","m3","m4","m5"].every(b=>m.value[b]!=null)}function _(){return M(m.value.m2)&&U(m.value.m3)&&P(m.value.m4)&&Q(m.value.m5)}async function u(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function f(){if(!w()){v.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",$&&$.play();return}_()?(T.value=!0,v.value=l[a.value].correct,S&&S.play(),O&&O.play(),await u()):(v.value=l[a.value].wrong,$&&$.play())}function x(){m.value={m2:null,m3:null,m4:null,m5:null},D.value=Object.fromEntries(N.value.map(b=>[b,1])),v.value=null,T.value=!1}return _e(R),ge(()=>A.lang,()=>{}),(b,c)=>(n(),r("div",{class:"lvl2c3 challenge-surface","data-theme":A.theme},[e("h2",lo,t(l[a.value].title),1),e("p",so,t(l[a.value].rule),1),e("div",oo,[e("div",ro,[e("div",io,t(l[a.value].lab2),1),e("div",{class:"drop",onDragover:V,onDrop:c[0]||(c[0]=p=>X("m2",p))},[m.value.m2!=null?(n(),r("span",co,t(m.value.m2),1)):(n(),r("span",uo,"؟"))],32),e("button",{class:"clear",onClick:c[1]||(c[1]=p=>L("m2"))},[H(K(Se),{class:"ic"}),J(t(l[a.value].clear),1)])]),e("div",vo,[e("div",ho,t(l[a.value].lab3),1),e("div",{class:"drop",onDragover:V,onDrop:c[2]||(c[2]=p=>X("m3",p))},[m.value.m3!=null?(n(),r("span",po,t(m.value.m3),1)):(n(),r("span",fo,"؟"))],32),e("button",{class:"clear",onClick:c[3]||(c[3]=p=>L("m3"))},[H(K(Se),{class:"ic"}),J(t(l[a.value].clear),1)])]),e("div",mo,[e("div",go,t(l[a.value].lab4),1),e("div",{class:"drop",onDragover:V,onDrop:c[4]||(c[4]=p=>X("m4",p))},[m.value.m4!=null?(n(),r("span",_o,t(m.value.m4),1)):(n(),r("span",yo,"؟"))],32),e("button",{class:"clear",onClick:c[5]||(c[5]=p=>L("m4"))},[H(K(Se),{class:"ic"}),J(t(l[a.value].clear),1)])]),e("div",bo,[e("div",ko,t(l[a.value].lab5),1),e("div",{class:"drop",onDragover:V,onDrop:c[6]||(c[6]=p=>X("m5",p))},[m.value.m5!=null?(n(),r("span",wo,t(m.value.m5),1)):(n(),r("span",$o,"؟"))],32),e("button",{class:"clear",onClick:c[7]||(c[7]=p=>L("m5"))},[H(K(Se),{class:"ic"}),J(t(l[a.value].clear),1)])])]),e("div",Co,[e("div",xo,t(l[a.value].bank),1),e("div",So,[(n(!0),r(te,null,le(N.value,p=>(n(),r("button",{key:p,class:"chip",disabled:(D.value[p]||0)===0,draggable:"true",onDragstart:y=>I(y,p)},[J(t(p)+" ",1),(D.value[p]||0)===0?(n(),r("small",Do,"✓")):ie("",!0)],40,Ao))),128))])]),e("div",To,[e("button",{class:"btn",onClick:x},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:f},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:R},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),v.value?(n(),r("div",{key:0,class:re(["toast",{ok:T.value}])},t(v.value),3)):ie("",!0)],8,no))}},Lo=me(Mo,[["__scopeId","data-v-a01ad243"]]),No=["data-theme"],Po={class:"title"},Eo={class:"rule"},zo={class:"choices"},Bo=["onClick"],Oo=["checked"],jo={class:"pair"},Ro={class:"actions"},Io={__name:"challenge_level_two_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثاني – التحدي 4: اختر الإجابة الصحيحة",rule:(R,I)=>`ما العددان اللذان حاصل جمعهما ${R} والفرق بينهما ${I}؟ اختر الزوج الصحيح.`,choices:"الخيارات",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"إجابة غير صحيحة"},en:{title:"Level 2 – Challenge 4: Pick the correct pair",rule:(R,I)=>`Which two numbers have sum ${R} and difference ${I}? Pick the correct pair.`,choices:"Choices",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Incorrect"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(wt):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio($t):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");function E(R,I){return Math.floor(Math.random()*(I-R+1))+R}function Y(R){const I=R.slice();for(let V=I.length-1;V>0;V--){const X=Math.floor(Math.random()*(V+1));[I[V],I[X]]=[I[X],I[V]]}return I}const N=z(0),D=z(0),m=z([0,0]),v=z([]),T=z(null),M=z(null),U=z(!1);function P(){U.value=!1,M.value=null,T.value=null;let R,I;R=E(6,60),I=E(1,R-1);const V=Math.max(R,I),X=Math.min(R,I);N.value=V+X,D.value=V-X,m.value=[V,X];const L=[[V,X]],w=()=>{let _=E(1,65),u=E(1,65);return _<u&&([_,u]=[u,_]),[_,u]};for(;L.length<6;){let _=w();if(!(_[0]+_[1]===N.value&&_[0]-_[1]===D.value)){if(E(0,1)===0){const u=N.value,f=E(1,u-1),x=u-f,b=[Math.max(f,x),Math.min(f,x)];b[0]-b[1]!==D.value&&(_=b)}else{const u=D.value,f=E(1,50),b=[f+u,f];b[0]+b[1]!==N.value&&(_=b)}L.some(u=>u[0]===_[0]&&u[1]===_[1])||L.push(_)}}v.value=Y(L)}async function Q(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function Z(){if(T.value==null){M.value=a.value==="ar"?"اختر إجابة":"Pick an answer",$&&$.play();return}const R=v.value[T.value];R[0]+R[1]===N.value&&R[0]-R[1]===D.value?(U.value=!0,M.value=l[a.value].correct,S&&S.play(),O&&O.play(),await Q()):(M.value=l[a.value].wrong,$&&$.play())}function j(){T.value=null,M.value=null,U.value=!1}return _e(P),ge(()=>A.lang,()=>{}),(R,I)=>(n(),r("div",{class:"lvl2c4 challenge-surface","data-theme":A.theme},[e("h2",Po,t(l[a.value].title),1),e("p",Eo,t(l[a.value].rule(N.value,D.value)),1),e("div",zo,[(n(!0),r(te,null,le(v.value,(V,X)=>(n(),r("div",{class:re(["choice",{sel:T.value===X}]),key:X,onClick:L=>T.value=X},[e("input",{type:"radio",checked:T.value===X},null,8,Oo),e("span",jo,t(V[0])+" ، "+t(V[1]),1)],10,Bo))),128))]),e("div",Ro,[e("button",{class:"btn",onClick:j},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:Z},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:P},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),M.value?(n(),r("div",{key:0,class:re(["toast",{ok:U.value}])},t(M.value),3)):ie("",!0)],8,No))}},Fo=me(Io,[["__scopeId","data-v-15425afc"]]),Uo=["data-theme"],qo={class:"title"},Qo={class:"rule"},Ho=["dir"],Vo={class:"frac"},Go={class:"top"},Wo={key:0,class:"num"},Ko={key:1,class:"placeholder"},Yo={class:"bot"},Jo={class:"frac"},Xo={class:"bot"},Zo={key:0,class:"num"},er={key:1,class:"placeholder"},tr={class:"frac"},ar={class:"bot"},nr={key:0,class:"num"},lr={key:1,class:"placeholder"},sr={class:"frac"},or={class:"top"},rr={key:0,class:"num"},ir={key:1,class:"placeholder"},cr={class:"bot"},ur={class:"frac"},dr={class:"top"},vr={class:"bot"},hr={class:"bank"},pr={class:"bank-title"},fr={class:"bank-items"},mr=["onDragstart"],gr={class:"actions"},_r={__name:"challenge_level_two_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثاني – التحدي 5: أكمل طرح الكسور",rule:c=>`ضع عددًا كليًا في كل مربع لتصبح المعادلة صحيحة:  ${c.num}/${c.den} =  ١/□  −  □/${c.d2}.  اسحب الرقمين من لوحة الأعداد.`,bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Level 2 – Challenge 5: Complete the fraction subtraction",rule:c=>`Place integers to make the equation true:  ${c.num}/${c.den} =  1/□  −  □/${c.d2}.  Drag the two numbers from the bank.`,bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check values",clear:"Clear"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(ze):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Ne):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");function E(c,p){return Math.floor(Math.random()*(p-c+1))+c}function Y(c){const p=c.slice();for(let y=p.length-1;y>0;y--){const B=Math.floor(Math.random()*(y+1));[p[y],p[B]]=[p[B],p[y]]}return p}const N=z({num:1,den:6,d2:6}),D=z([]),m=z({A:null,N:null}),v=z(null),T=z(!1),M=[{id:"p1",target:{num:1,den:6},d2:6,solution:{A:2,N:2},extras:[1,3,4,5,7,8]},{id:"p2",target:{num:1,den:6},d2:9,solution:{A:2,N:3},extras:[1,4,5,6,7,8]},{id:"p3",target:{num:1,den:6},d2:12,solution:{A:2,N:4},extras:[1,3,5,6,7,9]},{id:"p4",target:{num:1,den:6},d2:6,solution:{A:3,N:1},extras:[2,4,5,7,8,9]},{id:"p5",target:{num:2,den:6},d2:6,solution:{A:2,N:1},extras:[3,4,5,7,8,9]},{id:"p6",target:{num:1,den:8},d2:8,solution:{A:2,N:3},extras:[1,2,4,5,6,7]},{id:"p7",target:{num:3,den:8},d2:8,solution:{A:2,N:1},extras:[2,4,5,6,7,9]},{id:"p8",target:{num:1,den:9},d2:9,solution:{A:3,N:2},extras:[1,3,4,5,6,7]},{id:"p9",target:{num:3,den:9},d2:6,solution:{A:2,N:1},extras:[2,4,5,7,8,9]},{id:"p10",target:{num:1,den:10},d2:5,solution:{A:2,N:2},extras:[1,3,4,6,7,8]},{id:"p11",target:{num:2,den:10},d2:10,solution:{A:2,N:3},extras:[1,4,5,6,7,9]},{id:"p12",target:{num:1,den:12},d2:4,solution:{A:3,N:1},extras:[2,5,6,7,8,9]}],U=z(M[0]),P=z(null);function Q(){if(M.length===1)return P.value=M[0].id,M[0];let c;do c=M[Math.floor(Math.random()*M.length)];while(c.id===P.value);return P.value=c.id,c}function Z(c){const p=new Set([c.solution.A,c.solution.N]);for((c.extras||[]).forEach(B=>p.add(B));p.size<8;)p.add(E(1,15));return Y([...p])}const j=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function R(c){const p=String(c);return A.lang==="ar"?p.replace(/[0-9]/g,y=>j[Number(y)]):p}const I=W(()=>a.value==="ar"?`ضع عددًا كليًا في كل مربع لتصبح المعادلة صحيحة:  ${R(N.value.num)}/${R(N.value.den)} =  ١/□  −  □/${R(N.value.d2)}.`:`Place integers to make the equation true:  ${N.value.num}/${N.value.den} =  1/□  −  □/${N.value.d2}.`);function V(){T.value=!1,v.value=null,m.value={A:null,N:null};const c=Q();U.value=c,N.value={num:c.target.num,den:c.target.den,d2:c.d2},D.value=Z(c)}function X(c,p){c.dataTransfer.setData("text/plain",String(p))}function L(c){c.preventDefault()}function w(c,p){p.preventDefault();const y=Number(p.dataTransfer.getData("text/plain"));m.value[c]=y,v.value=null}function _(){return m.value.A!=null&&m.value.N!=null}function u(){if(!_())return!1;const c=m.value.A,p=m.value.N;if(!c||!p)return!1;const y=1/c-p/N.value.d2,B=N.value.num/N.value.den;return Math.abs(y-B)<1e-9}async function f(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function x(){if(!_()){v.value=a.value==="ar"?"أكمل الخانتين":"Fill both blanks",$&&$.play();return}u()?(T.value=!0,v.value=l[a.value].correct,S&&S.play(),O&&O.play(),await f()):(v.value=l[a.value].wrong,$&&$.play())}function b(){m.value={A:null,N:null},v.value=null,T.value=!1}return _e(V),(c,p)=>(n(),r("div",{class:"lvl2c5 challenge-surface","data-theme":A.theme},[e("h2",qo,t(l[a.value].title),1),e("p",Qo,t(I.value),1),e("div",{class:"equation",dir:a.value==="ar"?"rtl":"ltr"},[a.value==="ar"?(n(),r(te,{key:0},[e("div",Vo,[e("div",Go,[e("div",{class:"drop",onDragover:L,onDrop:p[0]||(p[0]=y=>w("N",y))},[m.value.N!=null?(n(),r("span",Wo,t(R(m.value.N)),1)):(n(),r("span",Ko,"□"))],32)]),p[4]||(p[4]=e("div",{class:"bar"},null,-1)),e("div",Yo,t(R(N.value.d2)),1)]),p[7]||(p[7]=e("span",{class:"minus"},"−",-1)),e("div",Jo,[p[5]||(p[5]=e("div",{class:"top"},"1",-1)),p[6]||(p[6]=e("div",{class:"bar"},null,-1)),e("div",Xo,[e("div",{class:"drop",onDragover:L,onDrop:p[1]||(p[1]=y=>w("A",y))},[m.value.A!=null?(n(),r("span",Zo,t(R(m.value.A)),1)):(n(),r("span",er,"□"))],32)])])],64)):(n(),r(te,{key:1},[e("div",tr,[p[8]||(p[8]=e("div",{class:"top"},"1",-1)),p[9]||(p[9]=e("div",{class:"bar"},null,-1)),e("div",ar,[e("div",{class:"drop",onDragover:L,onDrop:p[2]||(p[2]=y=>w("A",y))},[m.value.A!=null?(n(),r("span",nr,t(R(m.value.A)),1)):(n(),r("span",lr,"□"))],32)])]),p[11]||(p[11]=e("span",{class:"minus"},"−",-1)),e("div",sr,[e("div",or,[e("div",{class:"drop",onDragover:L,onDrop:p[3]||(p[3]=y=>w("N",y))},[m.value.N!=null?(n(),r("span",rr,t(R(m.value.N)),1)):(n(),r("span",ir,"□"))],32)]),p[10]||(p[10]=e("div",{class:"bar"},null,-1)),e("div",cr,t(R(N.value.d2)),1)])],64)),p[13]||(p[13]=e("span",{class:"eq"},"=",-1)),e("div",ur,[e("div",dr,t(R(N.value.num)),1),p[12]||(p[12]=e("div",{class:"bar"},null,-1)),e("div",vr,t(R(N.value.den)),1)])],8,Ho),e("div",hr,[e("div",pr,t(l[a.value].bank),1),e("div",fr,[(n(!0),r(te,null,le(D.value,y=>(n(),r("button",{key:y,class:"chip",draggable:"true",onDragstart:B=>X(B,y)},t(R(y)),41,mr))),128))])]),e("div",gr,[e("button",{class:"btn",onClick:b},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:x},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:V},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),v.value?(n(),r("div",{key:0,class:re(["toast",{ok:T.value}])},t(v.value),3)):ie("",!0)],8,Uo))}},yr=me(_r,[["__scopeId","data-v-51caca4a"]]),br=["data-theme"],kr={class:"head"},wr={class:"title"},$r={class:"question"},Cr={class:"options"},xr=["value"],Sr={class:"text"},Ar={class:"actions"},Dr={__name:"challenge_level_two_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثاني – التحدي 6: مقارنة الأوزان",question:"ما وزن المربع الواحد مقارنة بالمثلث؟",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة! أحسنت في مقارنة الأوزان.",wrong:"إجابة غير صحيحة. أعد التفكير في المعادلات.",pick:"اختر إجابة أولاً."},en:{title:"Level 2 – Challenge 6: Comparing weights",question:"How does the weight of the square compare to the triangle?",newQ:"New question",reset:"Reset",check:"Check",correct:"Correct! Great job comparing the weights.",wrong:"That is incorrect. Revisit the equations.",pick:"Select an option first."}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(ze):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Ne):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");const E=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function Y(c){return String(c).replace(/[0-9]/g,p=>E[Number(p)])}function N(c,p){return p==="ar"?Y(c):String(c)}function D(c,p){return p==="ar"?c<=2?"وحدة":"وحدات":c===1?"unit":"units"}const m={ar:{double:"ضعف وزن المثلث",equal:"يساوي وزن المثلث",half:"نصف وزن المثلث",less:c=>`أقل بـ${Y(c)} ${D(c,"ar")} من وزن المثلث`,more:c=>`أكثر بـ${Y(c)} ${D(c,"ar")} من وزن المثلث`},en:{double:"Twice the triangle",equal:"Equal to the triangle",half:"Half the triangle",less:c=>`${c} ${D(c,"en")} less than the triangle`,more:c=>`${c} ${D(c,"en")} more than the triangle`}};function v(c,p){const y=Math.abs(c.difference),B=m[p];return[{id:"a",text:B.double},{id:"b",text:B.equal},{id:"c",text:B.half},{id:"d",text:B.less(y)},{id:"e",text:B.more(y)}]}function T(c,p){const y=N(c.totals.square,p),B=N(c.totals.triangle,p);return p==="ar"?[`وزن كرتان ومربع واحد يساويان ${y} وحدات.`,`وزن كرتان ومثلث واحد يساويان ${B} وحدات.`]:[`Two balls and one square weigh ${y} units.`,`Two balls and one triangle weigh ${B} units.`]}const M=[{id:"p1",totals:{square:8,triangle:6},difference:2,correctId:"e"},{id:"p2",totals:{square:10,triangle:7},difference:3,correctId:"e"},{id:"p3",totals:{square:9,triangle:11},difference:-2,correctId:"d"},{id:"p4",totals:{square:12,triangle:8},difference:4,correctId:"e"},{id:"p5",totals:{square:7,triangle:10},difference:-3,correctId:"d"}],U=z(M[0]),P=z(null),Q=W(()=>U.value.correctId);function Z(){if(M.length===1)return P.value=M[0].id,M[0];let c;do c=M[Math.floor(Math.random()*M.length)];while(c.id===P.value);return P.value=c.id,c}function j(c){return c.slice().sort(()=>Math.random()-.5)}const R=z(null),I=z(null),V=z(!1),X=z(null);function L(){X.value=j(v(U.value,a.value))}function w(){R.value=null,I.value=null,V.value=!1}async function _(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function u(){if(!R.value){I.value=l[a.value].pick,$&&$.play();return}if(R.value===Q.value){const c=V.value;V.value=!0,I.value=l[a.value].correct,S&&S.play(),O&&O.play(),c||await _()}else V.value=!1,I.value=l[a.value].wrong,$&&$.play()}function f(){const c=Z();U.value=c,w(),L()}ge(()=>A.lang,()=>{w(),L()});const x=W(()=>X.value||v(U.value,a.value)),b=W(()=>T(U.value,a.value));return _e(()=>{f()}),(c,p)=>(n(),r("div",{class:"lvl2c6 challenge-surface","data-theme":A.theme},[e("header",kr,[e("h2",wr,t(l[a.value].title),1),(n(!0),r(te,null,le(b.value,(y,B)=>(n(),r("p",{key:B,class:"premise"},t(y),1))),128)),e("p",$r,t(l[a.value].question),1)]),e("section",Cr,[(n(!0),r(te,null,le(x.value,y=>(n(),r("label",{key:y.id,class:re(["option",{selected:R.value===y.id}])},[Me(e("input",{type:"radio",name:"weight-comparison",value:y.id,"onUpdate:modelValue":p[0]||(p[0]=B=>R.value=B)},null,8,xr),[[zt,R.value]]),p[1]||(p[1]=e("span",{class:"mark"},null,-1)),e("span",Sr,t(y.text),1)],2))),128))]),e("section",Ar,[e("button",{class:"btn",onClick:u},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:w},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:f},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),H($e,{name:"fade"},{default:ke(()=>[I.value?(n(),r("div",{key:0,class:re(["feedback",{ok:V.value}])},t(I.value),3)):ie("",!0)]),_:1})],8,br))}},Tr=me(Dr,[["__scopeId","data-v-15b62468"]]),Mr=["data-theme"],Lr={class:"title"},Nr={class:"rule"},Pr={class:"hint"},Er=["dir"],zr=["onDrop"],Br={key:1,class:"placeholder"},Or=["onClick"],jr={class:"bank"},Rr={class:"bank-title"},Ir={class:"bank-items"},Fr=["onDragstart"],Ur={class:"actions"},qr={__name:"challenge_level_three_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثالث – التحدي 1: هرم الضرب",rule:"املأ مربعات الهرم بحيث يساوي كل مربع أعلى حاصل ضرب الخليتين تحته. اسحب الأرقام الصحيحة من اللوحة حتى يكتمل الهرم.",hint:"تذكّر أن كل خطوة نحو الأعلى هي نتيجة ضرب الخليتين في الأسفل مباشرة.",bank:"لوحة الأرقام",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"أحسنت! اكتمل الهرم.",wrong:"تحقّق مرة أخرى، هناك قيمة في غير مكانها.",clear:"تفريغ الخلية"},en:{title:"Level 3 – Challenge 1: Multiplication Pyramid",rule:"Fill the pyramid so that every cell above equals the product of the two cells directly beneath it. Drag the correct numbers from the bank.",hint:"Remember: each step upward is the product of the two numbers underneath.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Great! The pyramid is complete.",wrong:"Something is off. Recheck the placements.",clear:"Clear cell"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(Pe):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Fe):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");function E(y,B){return Math.floor(Math.random()*(B-y+1))+y}function Y(y){const B=y.slice();for(let d=B.length-1;d>0;d--){const s=Math.floor(Math.random()*(d+1));[B[d],B[s]]=[B[s],B[d]]}return B}function N(y,B){return`${y},${B}`}const D=z([]),m=z(new Set),v=ve({}),T=ve({}),M=ve({}),U=z(null),P=z(!1),Q=W(()=>({direction:"ltr",unicodeBidi:"isolate"})),Z=W(()=>D.value.map((y,B)=>({cells:y,index:B})).slice().reverse());function j(y){let B=0;for(const d in v)v[d]===y&&B++;return B}function R(){const y={};for(const[B,d]of Object.entries(T)){const s=Number(B),o=d-j(s);o>0&&(y[s]=o)}for(const B in M)delete M[B];for(const[B,d]of Object.entries(y))M[B]=d}function I(){for(;;){const B=[Array.from({length:4},()=>E(2,6))];for(let s=1;s<4;s++){const o=B[s-1],i=[];for(let g=0;g<o.length-1;g++)i.push(o[g]*o[g+1]);B.push(i)}if(B[3][0]<=5e4)return B}}function V(){P.value=!1,U.value=null;const y=I();D.value=y,m.value=new Set;for(const d in v)delete v[d];for(let d=1;d<D.value.length;d++)for(let s=0;s<D.value[d].length;s++)m.value.add(N(d,s));const B={};m.value.forEach(d=>{const[s,o]=d.split(",").map(Number),i=D.value[s][o];B[i]=(B[i]||0)+1});for(const d in T)delete T[d];for(const[d,s]of Object.entries(B))T[d]=s;R()}function X(y){y.preventDefault()}function L(y,B){y.dataTransfer.setData("text/plain",String(B))}function w(y,B){if(B.preventDefault(),!m.value.has(y))return;const d=B.dataTransfer.getData("text/plain"),s=Number(d);if(Number.isNaN(s)||!T[s])return;const o=v[y];o===s||j(s)>=T[s]||(o!=null&&delete v[y],v[y]=s,R(),U.value=null)}function _(y){v[y]!=null&&(delete v[y],R())}function u(){for(const y of m.value)if(v[y]==null)return!1;return!0}function f(){for(const y of m.value){const[B,d]=y.split(",").map(Number);if(v[y]!==D.value[B][d])return!1}return!0}async function x(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function b(){if(!u()){U.value=a.value==="ar"?"أكمل كل الخانات أولاً.":"Fill all blanks first.",$&&$.play();return}f()?(P.value=!0,U.value=l[a.value].correct,S&&S.play(),O&&O.play(),await x()):(U.value=l[a.value].wrong,$&&$.play())}function c(){for(const y in v)delete v[y];P.value=!1,U.value=null,R()}const p=W(()=>{const y=[];for(const[B,d]of Object.entries(M))for(let s=0;s<d;s++)y.push(Number(B));return Y(y)});return _e(V),ge(()=>A.lang,()=>{U.value&&(U.value=null)}),(y,B)=>(n(),r("div",{class:"lvl3c1 challenge-surface","data-theme":A.theme},[e("h2",Lr,t(l[a.value].title),1),e("p",Nr,t(l[a.value].rule),1),e("p",Pr,t(l[a.value].hint),1),e("div",{class:"pyramid",dir:A.lang==="ar"?"rtl":"ltr"},[(n(!0),r(te,null,le(Z.value,d=>(n(),r("div",{class:"p-row",key:d.index},[(n(!0),r(te,null,le(d.cells,(s,o)=>(n(),r("div",{class:"brick",key:d.index+"-"+o},[m.value.has(N(d.index,o))?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:X,onDrop:i=>w(N(d.index,o),i)},[v[N(d.index,o)]!=null?(n(),r("span",{key:0,class:"num",style:ue(Q.value)},t(v[N(d.index,o)]),5)):(n(),r("span",Br,"؟"))],40,zr),e("button",{class:"clear",onClick:i=>_(N(d.index,o))},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)],8,Or)],64)):(n(),r("span",{key:0,class:"num",style:ue(Q.value)},t(s),5))]))),128))]))),128))],8,Er),e("div",jr,[e("div",Rr,t(l[a.value].bank),1),e("div",Ir,[(n(!0),r(te,null,le(p.value,(d,s)=>(n(),r("button",{key:d+"_"+s,class:"chip",draggable:"true",onDragstart:o=>L(o,d),style:ue(Q.value)},t(d),45,Fr))),128))])]),e("div",Ur,[e("button",{class:"btn",onClick:c},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:b},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:V},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),U.value?(n(),r("div",{key:0,class:re(["toast",{ok:P.value}])},t(U.value),3)):ie("",!0)],8,Mr))}},Qr=me(qr,[["__scopeId","data-v-cecd74e3"]]),Hr=["data-theme"],Vr={class:"head"},Gr={class:"title"},Wr={class:"rule"},Kr={class:"board"},Yr={class:"cards"},Jr=["onDrop"],Xr={key:0,class:"num"},Zr={key:1,class:"placeholder"},ei=["value","onInput","onChange","onBlur","placeholder"],ti=["onClick"],ai={class:"facts"},ni={class:"bank"},li={class:"bank-title"},si={class:"bank-items"},oi=["onDragstart"],ri={class:"actions"},ii=4,ci={__name:"challenge_level_three_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثالث – التحدي 2: الأرقام المفقودة على البطاقات",rule:"أمامك بطاقات ملوّنة بأرقام مفقودة. استخدم المعلومات المعطاة (المجموع، المتوسط، الوسيط، المدى) لتحديد الرقم المناسب لكل بطاقة، ثم اسحبه من لوحة الأعداد أو اكتبه يدويًا.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"مسح",check:"تحقّق",correct:"أحسنت! الأرقام صحيحة.",wrong:"تحقّق من القيم مرة أخرى.",clear:"تفريغ البطاقة",hints:{sum:"المجموع",mean:"المتوسط الحسابي",median:"الوسيط",range:"المدى"},manualPlaceholder:"أدخل رقمًا"},en:{title:"Level 3 – Challenge 2: Missing numbers on the cards",rule:"Each coloured card is missing its number. Use the given information (sum, mean, median, range) to deduce the correct value for every card, then drag a number from the bank or type it manually.",bank:"Number bank",newQ:"New puzzle",reset:"Clear",check:"Check",correct:"Great! All numbers are correct.",wrong:"Something is off – recheck the values.",clear:"Clear card",hints:{sum:"Sum",mean:"Mean",median:"Median",range:"Range"},manualPlaceholder:"Type value"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=W(()=>A.lang==="ar"?"ar-EG":"en-US"),O=typeof Audio!="undefined"?new Audio(Pe):null,$=typeof Audio!="undefined"?new Audio(xe):null,E=typeof Audio!="undefined"?new Audio(Ne):null;O&&(O.preload="auto"),$&&($.preload="auto"),E&&(E.preload="auto");const Y=["green","gold","teal","magenta","sky","orange","crimson"],N=[{numbers:[4,8,12,16,20]},{numbers:[5,9,11,13,22]},{numbers:[7,10,12,18,23]},{numbers:[6,8,15,19,22]},{numbers:[9,11,14,20,26]}];function D(C){const h=C.slice().sort((oe,ce)=>oe-ce),k=h.reduce((oe,ce)=>oe+ce,0),F=k/h.length,G=h[Math.floor(h.length/2)],ae=h[h.length-1]-h[0];return{sum:k,mean:F,median:G,range:ae}}const m=z([]),v=ve({}),T=z(new Set),M=ve({}),U=ve({}),P=ve({}),Q=ve({}),Z=ve({}),j=ve({}),R=z({sum:0,mean:0,median:0,range:0}),I=z(null),V=z(!1);function X(C){for(const h of Object.keys(C))delete C[h]}function L(){const h=N[Math.floor(Math.random()*N.length)].numbers.slice(),k=Y.slice(0,h.length);k.sort(()=>Math.random()-.5);const F=h.slice().sort(()=>Math.random()-.5);m.value=[],T.value=new Set,X(v),X(Q),X(Z),X(j),X(M),X(U),X(P),F.forEach((he,pe)=>{const Te=`card-${pe}`;m.value.push({id:Te,value:he,color:k[pe%k.length]}),v[Te]=he,T.value.add(Te),M[he]=(M[he]||0)+1});for(const[he,pe]of Object.entries(M))P[he]=pe;const G=Math.min(...h),ae=Math.max(...h),oe=Math.max(1,G-12),ce=ae+12,be=new Set;for(;be.size<ii;){const he=Math.floor(Math.random()*(ce-oe+1))+oe;M[he]||be.add(he)}be.forEach(he=>{U[he]=(U[he]||0)+1,P[he]=(P[he]||0)+1}),R.value=D(h),I.value=null,V.value=!1}function w(C,h){C.dataTransfer.setData("text/plain",String(h))}function _(C){C.preventDefault()}function u(C,h,k){if(Number.isNaN(h))return!1;if(Q[C]!=null&&Z[C]==="bank"){const F=Q[C];P[F]=(P[F]||0)+1}if(k==="bank"){if((P[h]||0)<=0)return!1;P[h]=(P[h]||0)-1}return Q[C]=h,Z[C]=k,j[C]=String(h),I.value=null,V.value=!1,!0}function f(C,h){C.preventDefault();const k=C.dataTransfer.getData("text/plain"),F=Number(k);Number.isNaN(F)||u(h,F,"bank")}function x(C){if(Q[C]!=null&&Z[C]==="bank"){const h=Q[C];P[h]=(P[h]||0)+1}delete Q[C],delete Z[C],j[C]="",I.value=null,V.value=!1}function b(){for(const C of T.value)if(Q[C]==null)return!1;return!0}function c(){for(const C of T.value)if(Q[C]!==v[C])return!1;return!0}async function p(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function y(){if(!b()){I.value=a.value==="ar"?"أكمل كل البطاقات أولاً.":"Fill every card first.",E&&E.play();return}c()?(V.value=!0,I.value=l[a.value].correct,O&&O.play(),$&&$.play(),await p()):(I.value=l[a.value].wrong,E&&E.play())}function B(){X(Q),X(Z),X(j),X(P);for(const[C,h]of Object.entries(M))P[C]=h;for(const[C,h]of Object.entries(U))P[C]=(P[C]||0)+h;I.value=null,V.value=!1}const d=W(()=>{const C=[];for(const[h,k]of Object.entries(P))for(let F=0;F<k;F++)C.push({value:Number(h),key:`${h}-${F}`});return C});function s(C,h){j[C]=h}function o(C){var F;const h=((F=j[C])!=null?F:"").trim();if(h===""){x(C);return}const k=Number(h);Number.isFinite(k)&&u(C,k,"manual")}const i=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function g(C){const h=String(C);return A.lang!=="ar"?h:h.replace(/[0-9]/g,k=>i[Number(k)])}function q(C,h={}){return new Intl.NumberFormat(S.value,h).format(C)}return _e(L),ge(()=>A.lang,()=>{I.value&&V.value||(I.value=null)}),(C,h)=>(n(),r("div",{class:"lvl3c2 challenge-surface","data-theme":A.theme},[e("header",Vr,[e("h2",Gr,t(l[a.value].title),1),e("p",Wr,t(l[a.value].rule),1)]),e("section",Kr,[e("div",Yr,[(n(!0),r(te,null,le(m.value,k=>{var F;return n(),r("div",{key:k.id,class:re(["card","color-"+k.color])},[e("div",{class:"drop",onDragover:_,onDrop:G=>f(G,k.id)},[Q[k.id]!=null?(n(),r("span",Xr,t(g(Q[k.id])),1)):(n(),r("span",Zr,"؟"))],40,Jr),e("input",{class:"manual-entry",type:"number",inputmode:"numeric",value:(F=j[k.id])!=null?F:"",onInput:G=>s(k.id,G.target.value),onChange:G=>o(k.id),onBlur:G=>o(k.id),placeholder:l[a.value].manualPlaceholder},null,40,ei),e("button",{class:"clear",onClick:G=>x(k.id)},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)],8,ti)],2)}),128))]),e("aside",ai,[e("h3",null,t(A.lang==="ar"?"المعلومات المتاحة":"Given facts"),1),e("ul",null,[e("li",null,[e("strong",null,t(l[a.value].hints.sum)+":",1),J(" "+t(q(R.value.sum)),1)]),e("li",null,[e("strong",null,t(l[a.value].hints.mean)+":",1),J(" "+t(q(R.value.mean,{maximumFractionDigits:2})),1)]),e("li",null,[e("strong",null,t(l[a.value].hints.median)+":",1),J(" "+t(q(R.value.median)),1)]),e("li",null,[e("strong",null,t(l[a.value].hints.range)+":",1),J(" "+t(q(R.value.range)),1)])])])]),e("section",ni,[e("div",li,t(l[a.value].bank),1),e("div",si,[(n(!0),r(te,null,le(d.value,k=>(n(),r("button",{key:k.key,class:"chip",draggable:"true",onDragstart:F=>w(F,k.value)},t(g(k.value)),41,oi))),128))])]),e("section",ri,[e("button",{class:"btn",onClick:B},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:y},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:L},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),H($e,{name:"fade"},{default:ke(()=>[I.value?(n(),r("div",{key:0,class:re(["toast",{ok:V.value}])},t(I.value),3)):ie("",!0)]),_:1})],8,Hr))}},ui=me(ci,[["__scopeId","data-v-9b49ee36"]]),di=["data-theme"],vi={class:"head"},hi={class:"title"},pi={class:"rule"},fi={class:"status"},mi={class:"chip target"},gi={class:"chip sum"},_i={class:"grid"},yi=["onClick"],bi={class:"actions"},ki={__name:"challenge_level_three_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثالث – التحدي 3: خطوط المجموع العشري",rule:"اختر أرقامًا متجاورة على خط مستقيم (أفقي، عمودي أو قطري) بحيث يساوي مجموعها القيمة المطلوبة.",targetLabel:"المجموع المطلوب",selected:"المجموع الحالي",check:"تحقّق",reset:"إعادة اختيار",newQ:"سؤال جديد",needSelection:"اختر خانات أولاً.",wrongLine:"يجب أن تكون الخانات المختارة على خط مستقيم ومتجاورة.",wrongSum:"المجموع لا يساوي القيمة المطلوبة.",correct:"رائع! خط صحيح."},en:{title:"Level 3 – Challenge 3: Decimal Sum Lines",rule:"Pick numbers lying on one straight line (horizontal, vertical, or diagonal) so their sum equals the target.",targetLabel:"Target sum",selected:"Current sum",check:"Check",reset:"Reset selection",newQ:"New puzzle",needSelection:"Select cells first.",wrongLine:"Selections must be contiguous on a straight line.",wrongSum:"The sum does not match the target.",correct:"Great! You found a valid line."}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(Pe):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(at):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");const E=[{id:"p1",target:10,grid:[[1.2,.8,2.5,1.3,.9],[2.1,3.4,2,.6,1.5],[1.8,2.2,1.5,3,1.1],[.5,1.6,1.7,2,3.5],[1.4,1.3,2.3,1.8,2.7]],solution:[{r:0,c:2},{r:1,c:2},{r:2,c:2},{r:3,c:2},{r:4,c:2}]},{id:"p2",target:10,grid:[[.8,1.7,2.1,.9,1.4],[2.6,1.5,1.9,1.1,2.9],[1.3,2.4,1.2,2.2,1.6],[.7,1.8,2.5,1.7,2.3],[1.9,.6,1.8,2.6,.9]],solution:[{r:1,c:0},{r:1,c:1},{r:1,c:2},{r:1,c:3},{r:1,c:4}]},{id:"p3",target:10,grid:[[2.5,1.1,.8,1.4,1.2],[.9,2,1.3,1.7,1],[1.6,1.2,1.8,1.1,1.3],[1.4,1.9,1.5,1.5,1.8],[1.3,1.4,.9,1.6,2.2]],solution:[{r:0,c:0},{r:1,c:1},{r:2,c:2},{r:3,c:3},{r:4,c:4}]},{id:"p4",target:10,grid:[[1.1,.9,1.7,1.3,2.1],[2,1.4,2,1.1,1.6],[1.5,2.2,1.8,1.4,1.3],[.8,1.9,2.3,1.2,1.1],[1.6,1.5,2.2,1.7,.9]],solution:[{r:0,c:2},{r:1,c:2},{r:2,c:2},{r:3,c:2},{r:4,c:2}]},{id:"p5",target:10.2,grid:[[1,1.3,.9,1.5,1.9],[1.6,1.2,1.4,1.8,1],[1.7,1.1,2.1,1.4,1.2],[2.4,2,1.5,1.3,.8],[2.4,1.5,1.6,1.1,.7]],solution:[{r:0,c:4},{r:1,c:3},{r:2,c:2},{r:3,c:1},{r:4,c:0}]},{id:"p6",target:9,grid:[[1.8,2.2,1.6,1.5,1.9],[1.3,.9,2.1,2.5,1.1],[1.4,1.7,1.2,1.8,1.6],[1,2.3,1.5,1.4,2.2],[1.6,1.1,2,1.7,.8]],solution:[{r:0,c:0},{r:0,c:1},{r:0,c:2},{r:0,c:3},{r:0,c:4}]},{id:"p7",target:9.3,grid:[[1.2,1.5,2.1,1,1.4],[.9,2,1.7,1.9,1.2],[1.3,1.8,2.2,1.6,1.1],[1.5,1.9,1.4,1.7,2.3],[1,2.1,1.5,1.2,1.8]],solution:[{r:0,c:1},{r:1,c:1},{r:2,c:1},{r:3,c:1},{r:4,c:1}]},{id:"p8",target:9,grid:[[1.4,1.2,2,1.6,.9],[1.1,1.8,1.4,2.3,1.5],[2.2,1.3,1.7,1.2,1.1],[1.5,2.4,1.6,1.5,1.9],[2,1.7,1.5,1.4,2.6]],solution:[{r:0,c:0},{r:1,c:1},{r:2,c:2},{r:3,c:3},{r:4,c:4}]},{id:"p9",target:10,grid:[[1.6,1,1.2,1.9,2.1],[1.3,1.5,2.2,1.8,1.1],[2,1.8,1.4,1.5,1.7],[1.2,2.3,1.6,1.7,1],[2.4,1.9,1.5,1.2,.8]],solution:[{r:0,c:4},{r:1,c:3},{r:2,c:2},{r:3,c:1},{r:4,c:0}]},{id:"p10",target:9,grid:[[1,1.7,1.3,2.1,1.6],[1.5,1.1,2.4,1.6,1.8],[1.9,2,1.5,1.2,1.3],[1.4,1.9,1.7,2,1.1],[2.1,2,1.8,1.5,1.6]],solution:[{r:4,c:0},{r:4,c:1},{r:4,c:2},{r:4,c:3},{r:4,c:4}]}],Y=z(E[0]),N=z(null),D=z(new Set),m=z(!1),v=z(null);function T(L,w){return`${L},${w}`}function M(){if(E.length===1)return N.value=E[0].id,E[0];let L;do L=E[Math.floor(Math.random()*E.length)];while(L.id===N.value);return N.value=L.id,L}function U(){D.value=new Set,m.value=!1,v.value=null}function P(){const L=M();Y.value=L,U()}function Q(L,w){const _=T(L,w),u=new Set(D.value);u.has(_)?u.delete(_):u.add(_),D.value=u,m.value=!1,v.value=null}const Z=W(()=>Array.from(D.value).map(L=>{const[w,_]=L.split(",").map(Number);return{r:w,c:_}})),j=W(()=>Z.value.reduce((L,w)=>L+Y.value.grid[w.r][w.c],0));function R(L){if(L.length<2)return!0;const w=L.map(p=>p.r),_=L.map(p=>p.c),u=w.every(p=>p===w[0]),f=_.every(p=>p===_[0]),x=w.every((p,y)=>p-_[y]===w[0]-_[0]),b=w.every((p,y)=>p+_[y]===w[0]+_[0]);if(!u&&!f&&!x&&!b)return!1;const c=[...L];if(u){c.sort((p,y)=>p.c-y.c);for(let p=1;p<c.length;p++)if(c[p].c-c[p-1].c!==1)return!1;return!0}if(f){c.sort((p,y)=>p.r-y.r);for(let p=1;p<c.length;p++)if(c[p].r-c[p-1].r!==1)return!1;return!0}if(x){c.sort((p,y)=>p.r-y.r);for(let p=1;p<c.length;p++)if(c[p].r-c[p-1].r!==1||c[p].c-c[p-1].c!==1)return!1;return!0}c.sort((p,y)=>p.r-y.r);for(let p=1;p<c.length;p++)if(c[p].r-c[p-1].r!==1||c[p-1].c-c[p].c!==1)return!1;return!0}async function I(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function V(){if(!D.value.size){v.value=l[a.value].needSelection,$&&$.play();return}const L=Z.value;if(!R(L)){v.value=l[a.value].wrongLine,$&&$.play();return}const w=j.value;if(Math.abs(w-Y.value.target)>1e-6){v.value=l[a.value].wrongSum,$&&$.play();return}m.value=!0,v.value=l[a.value].correct,S&&S.play(),O&&O.play(),await I()}function X(L,w){return Y.value.solution.some(_=>_.r===L&&_.c===w)}return _e(()=>{P()}),(L,w)=>(n(),r("div",{class:"lvl3c3 challenge-surface","data-theme":A.theme},[e("header",vi,[e("h2",hi,t(l[a.value].title),1),e("p",pi,t(l[a.value].rule),1)]),e("section",fi,[e("div",mi,[J(t(l[a.value].targetLabel)+": ",1),e("strong",null,t(Y.value.target.toFixed(1)),1)]),e("div",gi,[J(t(l[a.value].selected)+": ",1),e("strong",null,t(j.value.toFixed(1)),1)])]),e("section",_i,[(n(!0),r(te,null,le(Y.value.grid,(_,u)=>(n(),r("div",{key:u,class:"row"},[(n(!0),r(te,null,le(_,(f,x)=>(n(),r("button",{key:x,class:re(["cell",{selected:D.value.has(T(u,x)),success:m.value&&X(u,x)}]),onClick:b=>Q(u,x)},t(f.toFixed(1)),11,yi))),128))]))),128))]),e("section",bi,[e("button",{class:"btn",onClick:V},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:U},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:P},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),H($e,{name:"fade"},{default:ke(()=>[v.value?(n(),r("div",{key:0,class:re(["feedback",{ok:m.value}])},t(v.value),3)):ie("",!0)]),_:1})],8,di))}},wi=me(ki,[["__scopeId","data-v-413d5506"]]),$i=["data-theme"],Ci={class:"head"},xi={class:"title"},Si={class:"equations"},Ai={class:"expression"},Di=["innerHTML"],Ti=["onDrop"],Mi=["innerHTML"],Li={key:1,class:"placeholder"},Ni=["onClick"],Pi={class:"bank"},Ei={class:"bank-title"},zi={class:"bank-items"},Bi=["onDragstart","innerHTML"],Oi={class:"actions"},mt="⁦",gt="⁩",_t=" ",ji={__name:"challenge_level_three_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثالث – التحدي 4: أزل النقطة الحمراء",intro:["هذه المعادلات للتفكير في العمليات على الأعداد العشرية.","كل نقطة ● تمثل رقمًا واحدًا. اسحب الرقم الصحيح من لوحة الأرقام إلى مكانه حتى تصبح المعادلات صحيحة."],check:"تحقّق",reset:"مسح الكل",newQ:"سؤال جديد",incomplete:"أكمل كل الخانات أولًا.",wrong:"هناك معادلة غير صحيحة.",correct:"أحسنت! جميع المعادلات صحيحة.",bank:"لوحة الأرقام",clear:"تفريغ"},en:{title:"Level 3 – Challenge 4: Replace the red dot",intro:["These equations practice decimal operations.","Each red dot ● hides a single digit. Drag the correct digit from the number bank to make every equation true."],check:"Check",reset:"Clear all",newQ:"New puzzle",incomplete:"Fill every blank first.",wrong:"One or more equations are incorrect.",correct:"Great! All equations are valid.",bank:"Number bank",clear:"Clear"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(ze):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Ne):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");const E=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function Y(d,s){const i=(typeof d=="number"&&s!=null?d.toFixed(s):String(d)).replace(/[0-9]/g,g=>E[+g]).replace(/\./g,`${_t}٫${_t}`);return mt+i+gt}function N(d){const s=String(d);return A.lang==="ar"?mt+s.replace(/[0-9]/g,o=>E[+o])+gt:s}function D({multiplier:d,offset:s,aDigit:o,bDigit:i}){const g=Y(d,1),q=d.toFixed(1),C=s.toFixed(2),h=C.slice(1),k=Y(C).slice(1);return{id:"eqA",slots:{a:o,b:i},order:["a","b"],template:{ar:["أ. ",{num:!0,text:g}," × ",{num:!0,text:"٠"},"٫",{slot:"a"}," = ",{slot:"b"},{num:!0,text:k}],en:["A. ",{num:!0,text:q}," × 0.",{slot:"a"}," = ",{slot:"b"},h]},evaluate(F){const G=d*(F.a/10),ae=F.b+s;return Math.abs(G-ae)<1e-6}}}function m({baseLeft:d,baseRight:s,cDigit:o,dDigit:i,result:g,decimals:q=2}){const C=Y(d,0),h=Y(s,0),k=`${d}`,F=`${s}`,G=q!=null?g.toFixed(q):String(g),ae=Y(G);return{id:"eqB",slots:{c:o,d:i},order:["c","d"],template:{ar:["ب. ",{num:!0,text:C},"٫",{slot:"c"}," × ",{num:!0,text:h},"٫",{slot:"d"}," = ",{num:!0,text:ae}],en:["B. ",{num:!0,text:k},".",{slot:"c"}," × ",{num:!0,text:F},".",{slot:"d"}," = ",G]},evaluate(oe){const ce=(d+oe.c/10)*(s+oe.d/10);return Math.abs(ce-g)<1e-6}}}function v({secondBase:d,eDigit:s,fDigit:o,result:i,decimals:g=2}){const q=Y(d,0),C=`${d}`,h=g!=null?i.toFixed(g):String(i),k=Y(h);return{id:"eqC",slots:{e:s,f:o},order:["e","f"],template:{ar:["ج. ",{slot:"e"},"٫",{num:!0,text:Y(9,0).slice(1,-1)}," × ",{num:!0,text:q},"٫",{slot:"f"}," = ",{num:!0,text:k}],en:["C. ",{slot:"e"},".9 × ",{num:!0,text:C},".",{slot:"f"}," = ",h]},evaluate(F){const G=(F.e+.9)*(d+F.f/10);return Math.abs(G-i)<1e-6}}}function T({gDigit:d,hDigit:s}){return{id:"eqD",slots:{g:d,h:s},order:["g","h"],template:{ar:["د. ",{num:!0,text:"٤"},"٫",{slot:"g"}," + ",{num:!0,text:"١٫٢٥"}," = ",{num:!0,text:"٥"},"٫",{slot:"h"},{num:!0,text:"٥"}],en:["D. 4.",{slot:"g"}," + 1.25 = 5.",{slot:"h"},"5"]},evaluate(o){const i=4+o.g/10+1.25,g=5+o.h/10+.05;return Math.abs(i-g)<1e-6}}}const M=[{id:"p1",equations:[D({multiplier:9.3,offset:.44,aDigit:8,bDigit:7}),m({baseLeft:2,baseRight:2,cDigit:4,dDigit:9,result:6.96,decimals:2}),v({secondBase:3,eDigit:4,fDigit:7,result:18.13,decimals:2}),T({gDigit:7,hDigit:9})]},{id:"p2",equations:[D({multiplier:8.6,offset:.16,aDigit:6,bDigit:5}),m({baseLeft:2,baseRight:2,cDigit:1,dDigit:6,result:5.46,decimals:2}),v({secondBase:3,eDigit:2,fDigit:5,result:10.15,decimals:2}),T({gDigit:3,hDigit:5})]},{id:"p3",equations:[D({multiplier:7.8,offset:.24,aDigit:8,bDigit:6}),m({baseLeft:2,baseRight:2,cDigit:5,dDigit:2,result:5.5,decimals:2}),v({secondBase:3,eDigit:3,fDigit:6,result:14.04,decimals:2}),T({gDigit:2,hDigit:4})]},{id:"p4",equations:[D({multiplier:6.4,offset:.28,aDigit:2,bDigit:1}),m({baseLeft:2,baseRight:2,cDigit:8,dDigit:3,result:6.44,decimals:2}),v({secondBase:3,eDigit:5,fDigit:2,result:18.88,decimals:2}),T({gDigit:4,hDigit:6})]},{id:"p5",equations:[D({multiplier:6.4,offset:.12,aDigit:8,bDigit:5}),m({baseLeft:2,baseRight:2,cDigit:0,dDigit:9,result:5.8,decimals:2}),v({secondBase:3,eDigit:6,fDigit:1,result:21.39,decimals:2}),T({gDigit:1,hDigit:3})]}],U=z(M[0]),P=z(null),Q=ve({}),Z=ve({}),j=ve({}),R=z([]),I=z(null),V=z(!1);function X(d){return d.slice().sort(()=>Math.random()-.5)}function L(){if(M.length===1)return P.value=M[0].id,M[0];let d;do d=M[Math.floor(Math.random()*M.length)];while(d.id===P.value);return P.value=d.id,d}function w(){const d=L();U.value=d,I.value=null,V.value=!1,Object.keys(Q).forEach(o=>delete Q[o]),Object.keys(Z).forEach(o=>delete Z[o]),Object.keys(j).forEach(o=>delete j[o]);const s=[];d.equations.forEach(o=>{o.order.forEach(i=>{const g=`${o.id}-${i}`;s.push({key:g,eq:o,slotName:i}),Q[g]=null;const q=o.slots[i];Z[q]=(Z[q]||0)+1,j[q]=(j[q]||0)+1})}),R.value=s}function _(d){d.preventDefault()}function u(d,s){d.dataTransfer.setData("text/plain",String(s))}function f(d,s){d.preventDefault();const o=Number(d.dataTransfer.getData("text/plain"));if(!Number.isNaN(o)&&!((j[o]||0)<=0&&Q[s]!==o)){if(Q[s]!=null){const i=Q[s];j[i]=(j[i]||0)+1}Q[s]!==o&&(j[o]=(j[o]||0)-1,j[o]<0&&(j[o]=0)),Q[s]=o,I.value=null,V.value=!1}}function x(d){if(Q[d]!=null){const s=Q[d];j[s]=(j[s]||0)+1,Q[d]=null,I.value=null,V.value=!1}}const b=W(()=>{const d=[];for(const[s,o]of Object.entries(j))for(let i=0;i<o;i++)d.push({value:Number(s),key:`${s}-${i}`});return X(d)});function c(){return R.value.every(d=>Q[d.key]!=null)}async function p(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function y(){if(!c()){I.value=l[a.value].incomplete,$&&$.play();return}const{equations:d}=U.value;for(const s of d){const o={};for(const i of s.order)o[i]=Q[`${s.id}-${i}`];if(!s.evaluate(o)){I.value=l[a.value].wrong,$&&$.play();return}}I.value=l[a.value].correct,V.value=!0,S&&S.play(),O&&O.play(),await p()}function B(){R.value.forEach(d=>{if(Q[d.key]!=null){const s=Q[d.key];j[s]=(j[s]||0)+1,Q[d.key]=null}}),I.value=null,V.value=!1}return _e(w),ge(()=>A.lang,()=>{V.value||(I.value=null)}),(d,s)=>(n(),r("div",{class:"lvl3c4 challenge-surface","data-theme":A.theme},[e("header",Ci,[e("h2",xi,t(l[a.value].title),1),(n(!0),r(te,null,le(l[a.value].intro,(o,i)=>(n(),r("p",{key:i,class:"intro"},t(o),1))),128))]),e("section",Si,[(n(!0),r(te,null,le(U.value.equations,o=>(n(),r("div",{key:o.id,class:"card"},[e("div",Ai,[(n(!0),r(te,null,le(A.lang==="ar"?o.template.ar:o.template.en,(i,g)=>(n(),r("span",{key:g},[typeof i=="string"?(n(),r(te,{key:0},[J(t(i),1)],64)):i.num?(n(),r("span",{key:1,class:"num",innerHTML:i.text},null,8,Di)):(n(),r(te,{key:2},[e("span",{class:"slot",onDragover:_,onDrop:q=>f(q,o.id+"-"+i.slot)},[Q[o.id+"-"+i.slot]!=null?(n(),r("span",{key:0,class:"digit",innerHTML:N(Q[o.id+"-"+i.slot])},null,8,Mi)):(n(),r("span",Li,"●"))],40,Ti),e("button",{class:"clear",onClick:q=>x(o.id+"-"+i.slot)},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)],8,Ni)],64))]))),128))])]))),128))]),e("section",Pi,[e("div",Ei,t(l[a.value].bank),1),e("div",zi,[(n(!0),r(te,null,le(b.value,o=>(n(),r("button",{key:o.key,class:"chip",draggable:"true",onDragstart:i=>u(i,o.value),innerHTML:N(o.value)},null,40,Bi))),128))])]),e("section",Oi,[e("button",{class:"btn",onClick:y},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:B},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:w},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),H($e,{name:"fade"},{default:ke(()=>[I.value?(n(),r("div",{key:0,class:re(["feedback",{ok:V.value}])},t(I.value),3)):ie("",!0)]),_:1})],8,$i))}},Ri=me(ji,[["__scopeId","data-v-ac7a90d7"]]),Ii=["data-theme"],Fi={class:"head"},Ui={class:"title"},qi={class:"equation"},Qi={class:"fraction"},Hi={class:"row"},Vi=["onDrop"],Gi={key:0,class:"digit"},Wi={key:1,class:"placeholder"},Ki={class:"row"},Yi=["onDrop"],Ji={key:0,class:"digit"},Xi={key:1,class:"placeholder"},Zi={class:"fraction"},ec={class:"row"},tc=["onDrop"],ac={key:0,class:"digit"},nc={key:1,class:"placeholder"},lc={class:"row"},sc=["onDrop"],oc={key:0,class:"digit"},rc={key:1,class:"placeholder"},ic={key:0,class:"digit"},cc={key:1,class:"placeholder"},uc={class:"controls"},dc={class:"bank"},vc={class:"bank-title"},hc={class:"bank-items"},pc=["onDragstart"],fc={__name:"challenge_level_three_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثالث – التحدي 5: بطاقات الكسر المفقود",intro:["استخدم البطاقات المرقّمة من ١ إلى ٩ مرة واحدة فقط لتكوين الكسرين بحيث يكون الناتج مساويًا للقيمة المطلوبة.","اسحب الرقم المناسب إلى كل خانة للبسط أو المقام، ثم تحقّق من صحة الناتج."],bank:"البطاقات المتاحة",check:"تحقّق",reset:"مسح الاختيار",newQ:"تحدٍ جديد",clear:"تفريغ",needAll:"املأ كل الخانات أولًا.",wrong:"المعادلة غير صحيحة، جرّب ترتيبًا آخر.",correct:"أحسنت! أنتجت الكسور الصحيحة."},en:{title:"Level 3 – Challenge 5: Missing Fraction Cards",intro:["Use the cards labelled 1 through 9 exactly once to build two fractions whose sum matches the target.","Drag each digit into the correct numerator or denominator, then check your result."],bank:"Available cards",check:"Check",reset:"Reset selection",newQ:"New challenge",clear:"Clear",needAll:"Fill every slot first.",wrong:"The equation is not satisfied—try another arrangement.",correct:"Great! The fractions are correct."}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(Pe):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Fe):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");const E={n1:["n1a","n1b"],d1:["d1a","d1b"],n2:["n2a","n2b"],d2:["d2a","d2b"],res:["res"]},Y=[{id:"p1",solution:{n1:["2","9"],d1:["1","6"],n2:["5","7"],d2:["4","8"],res:["3"]}},{id:"p2",solution:{n1:["3","9"],d1:["2","7"],n2:["6","4"],d2:["1","8"],res:["5"]}},{id:"p3",solution:{n1:["5","7"],d1:["1","3"],n2:["9","4"],d2:["2","6"],res:["8"]}}],N=z(Y[0]),D=ve({}),m=ve({}),v=ve({}),T=z(null),M=z(!1),U=["1","2","3","4","5","6","7","8","9"],P=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function Q(x){if(x==null)return"";const b=String(x);return A.lang==="ar"?b.replace(/[0-9]/g,c=>P[Number(c)]):b}function Z(){Object.keys(D).forEach(x=>delete D[x]),Object.keys(m).forEach(x=>delete m[x]),Object.keys(v).forEach(x=>delete v[x])}function j(){const x=Y[Math.floor(Math.random()*Y.length)];N.value=x,Z(),T.value=null,M.value=!1,U.forEach(b=>{v[b]=1});for(const[b,c]of Object.entries(E)){const p=x.solution[b];p&&c.forEach((y,B)=>{D[y]=null,m[y]=p[B]})}}function R(x){x.preventDefault()}function I(x,b){x.dataTransfer.setData("text/plain",b)}function V(x,b){x.preventDefault();const c=x.dataTransfer.getData("text/plain");if(c&&!((v[c]||0)<=0&&D[b]!==c)){if(D[b]!=null){const p=D[b];v[p]=(v[p]||0)+1}D[b]!==c&&(v[c]=(v[c]||0)-1,v[c]<0&&(v[c]=0)),D[b]=c,T.value=null,M.value=!1}}const X=W(()=>{const x=[];for(const[b,c]of Object.entries(v))for(let p=0;p<c;p++)x.push({digit:b,key:`${b}-${p}`});return x});function L(){return Object.keys(m).every(x=>D[x]!=null)}function w(x){const c=E[x].map(p=>D[p]);return Number(c.join(""))}async function _(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function u(){if(!L()){T.value=l[a.value].needAll,$&&$.play();return}const x=w("n1"),b=w("d1"),c=w("n2"),p=w("d2"),y=Number(D.res);if(!b||!p){T.value=l[a.value].wrong,$&&$.play();return}const B=x/b+c/p;Math.abs(B-y)<1e-6?(T.value=l[a.value].correct,M.value=!0,S&&S.play(),O&&O.play(),await _()):(T.value=l[a.value].wrong,$&&$.play())}function f(){for(const x of Object.keys(D))if(D[x]!=null){const b=D[x];v[b]=(v[b]||0)+1,D[x]=null}T.value=null,M.value=!1}return _e(j),ge(()=>A.lang,()=>{M.value||(T.value=null)}),(x,b)=>(n(),r("div",{class:"lvl3c5 challenge-surface","data-theme":A.theme},[e("header",Fi,[e("h2",Ui,t(l[a.value].title),1),(n(!0),r(te,null,le(l[a.value].intro,(c,p)=>(n(),r("p",{key:p,class:"intro"},t(c),1))),128))]),e("section",qi,[e("div",Qi,[e("div",Hi,[(n(!0),r(te,null,le(E.n1,c=>(n(),r("div",{key:c,class:"slot",onDragover:R,onDrop:p=>V(p,c)},[D[c]?(n(),r("span",Gi,t(Q(D[c])),1)):(n(),r("span",Wi,"?"))],40,Vi))),128))]),b[1]||(b[1]=e("div",{class:"bar"},null,-1)),e("div",Ki,[(n(!0),r(te,null,le(E.d1,c=>(n(),r("div",{key:c,class:"slot",onDragover:R,onDrop:p=>V(p,c)},[D[c]?(n(),r("span",Ji,t(Q(D[c])),1)):(n(),r("span",Xi,"?"))],40,Yi))),128))])]),b[3]||(b[3]=e("span",{class:"op"},"+",-1)),e("div",Zi,[e("div",ec,[(n(!0),r(te,null,le(E.n2,c=>(n(),r("div",{key:c,class:"slot",onDragover:R,onDrop:p=>V(p,c)},[D[c]?(n(),r("span",ac,t(Q(D[c])),1)):(n(),r("span",nc,"?"))],40,tc))),128))]),b[2]||(b[2]=e("div",{class:"bar"},null,-1)),e("div",lc,[(n(!0),r(te,null,le(E.d2,c=>(n(),r("div",{key:c,class:"slot",onDragover:R,onDrop:p=>V(p,c)},[D[c]?(n(),r("span",oc,t(Q(D[c])),1)):(n(),r("span",rc,"?"))],40,sc))),128))])]),b[4]||(b[4]=e("span",{class:"op"},"=",-1)),e("div",{class:"target-slot",onDragover:R,onDrop:b[0]||(b[0]=c=>V(c,"res"))},[D.res?(n(),r("span",ic,t(Q(D.res)),1)):(n(),r("span",cc,"?"))],32)]),e("section",uc,[e("button",{class:"btn",onClick:u},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:f},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:j},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),e("section",dc,[e("div",vc,t(l[a.value].bank),1),e("div",hc,[(n(!0),r(te,null,le(X.value,c=>(n(),r("button",{key:c.key,class:"chip",draggable:"true",onDragstart:p=>I(p,c.digit)},t(Q(c.digit)),41,pc))),128))])]),H($e,{name:"fade"},{default:ke(()=>[T.value?(n(),r("div",{key:0,class:re(["feedback",{ok:M.value}])},t(T.value),3)):ie("",!0)]),_:1})],8,Ii))}},mc=me(fc,[["__scopeId","data-v-7304f2b0"]]),gc=["data-theme"],_c={class:"head"},yc={class:"title"},bc={class:"intro"},kc={class:"problem"},wc={class:"decimal-card"},$c={class:"label"},Cc={class:"decimal-display"},xc={class:"slots"},Sc=["onDrop"],Ac={key:0,class:"digit"},Dc={key:1,class:"placeholder"},Tc=["onClick"],Mc={class:"fraction-card"},Lc={class:"label"},Nc={class:"fraction"},Pc={class:"row"},Ec=["onDrop"],zc={key:0,class:"digit"},Bc={key:1,class:"placeholder"},Oc=["onClick"],jc={class:"row"},Rc=["onDrop"],Ic={key:0,class:"digit"},Fc={key:1,class:"placeholder"},Uc=["onClick"],qc={class:"controls"},Qc={class:"bank"},Hc={class:"bank-title"},Vc={class:"bank-items"},Gc=["onDragstart"],Wc={__name:"challenge_level_three_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثالث – التحدي 6: كسور مكافئة",intro:"اسحب الأرقام المتاحة وضعها في الخانات بحيث يكون الكسر الاعتيادي مساويًا للقيمة العشرية المعطاة.",decimals:"القيمة العشرية",fraction:"الكسر المكافئ",bank:"البطاقات المتاحة",check:"تحقّق",reset:"مسح",newQ:"تحدٍ جديد",clear:"تفريغ",needAll:"املأ كل الخانات أولًا.",wrong:"القيم غير متكافئة، حاول ترتيبًا مختلفًا.",correct:"أحسنت! الكسور مكافئة."},en:{title:"Level 3 – Challenge 6: Equivalent Fractions",intro:"Drag the available digits into the slots so the fraction equals the given decimal value.",decimals:"Decimal value",fraction:"Equivalent fraction",bank:"Available cards",check:"Check",reset:"Clear",newQ:"New challenge",clear:"Clear",needAll:"Fill every slot first.",wrong:"Values are not equivalent. Try another arrangement.",correct:"Great! They are equivalent."}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(ze):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Ne):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");const E=[{id:"p1",decimal:{slots:["dec1","dec2"],digits:["2","5"]},fraction:{num:{slots:["num1"],digits:["1"]},den:{slots:["den1"],digits:["4"]}},digits:["1","2","4","5"]},{id:"p2",decimal:{slots:["dec1","dec2"],digits:["7","5"]},fraction:{num:{slots:["num1"],digits:["3"]},den:{slots:["den1"],digits:["4"]}},digits:["3","4","5","7"]},{id:"p3",decimal:{slots:["dec1"],digits:["6"]},fraction:{num:{slots:["num1"],digits:["3"]},den:{slots:["den1"],digits:["5"]}},digits:["3","5","6"]},{id:"p4",decimal:{slots:["dec1","dec2"],digits:["3","3"]},fraction:{num:{slots:["num1"],digits:["1"]},den:{slots:["den1"],digits:["3"]}},digits:["1","3"]}],Y=z(E[0]),N=ve({}),D=ve({}),m=ve({}),v=z(null),T=z(!1);function M(){Object.keys(N).forEach(u=>delete N[u]),Object.keys(D).forEach(u=>delete D[u]),Object.keys(m).forEach(u=>delete m[u])}function U(){const u=E[Math.floor(Math.random()*E.length)];Y.value=u,M(),v.value=null,T.value=!1;const{decimal:f,fraction:x}=u;f.slots.forEach((b,c)=>{N[b]=null,D[b]=f.digits[c]}),x.num.slots.forEach((b,c)=>{N[b]=null,D[b]=x.num.digits[c]}),x.den.slots.forEach((b,c)=>{N[b]=null,D[b]=x.den.digits[c]}),u.digits.forEach(b=>{m[b]=(m[b]||0)+1})}function P(u){u.preventDefault()}function Q(u,f){u.dataTransfer.setData("text/plain",f)}function Z(u,f){u.preventDefault();const x=u.dataTransfer.getData("text/plain");if(x&&!((m[x]||0)<=0&&N[f]!==x)){if(N[f]!=null){const b=N[f];m[b]=(m[b]||0)+1}N[f]!==x&&(m[x]=(m[x]||0)-1,m[x]<0&&(m[x]=0)),N[f]=x,T.value=!1,v.value=null}}function j(u){if(N[u]!=null){const f=N[u];m[f]=(m[f]||0)+1,N[u]=null,T.value=!1,v.value=null}}const R=W(()=>{const u=[];for(const[f,x]of Object.entries(m))for(let b=0;b<x;b++)u.push({digit:f,key:`${f}-${b}`});return u});function I(){return Object.keys(D).every(u=>N[u]!=null)}function V(){return+`0.${Y.value.decimal.slots.map(x=>N[x]).join("")}`}function X(){const{fraction:u}=Y.value,f=u.num.slots.map(p=>N[p]).join(""),x=u.den.slots.map(p=>N[p]).join(""),b=Number(f),c=Number(x);return c?b/c:null}async function L(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function w(){if(!I()){v.value=l[a.value].needAll,$&&$.play();return}const u=V(),f=X();if(f==null){v.value=l[a.value].wrong,$&&$.play();return}Math.abs(u-f)<1e-6?(v.value=l[a.value].correct,T.value=!0,S&&S.play(),O&&O.play(),await L()):(v.value=l[a.value].wrong,$&&$.play())}function _(){Object.keys(N).forEach(u=>{if(N[u]!=null){const f=N[u];m[f]=(m[f]||0)+1,N[u]=null}}),T.value=!1,v.value=null}return _e(U),ge(()=>A.lang,()=>{T.value||(v.value=null)}),(u,f)=>(n(),r("div",{class:"lvl3c6 challenge-surface","data-theme":A.theme},[e("header",_c,[e("h2",yc,t(l[a.value].title),1),e("p",bc,t(l[a.value].intro),1)]),e("section",kc,[e("div",wc,[e("div",$c,t(l[a.value].decimals),1),e("div",Cc,[f[0]||(f[0]=e("span",{class:"fixed"},"0.",-1)),e("div",xc,[(n(!0),r(te,null,le(Y.value.decimal.slots,x=>(n(),r("div",{key:x,class:"slot",onDragover:P,onDrop:b=>Z(b,x)},[N[x]?(n(),r("span",Ac,t(N[x]),1)):(n(),r("span",Dc,"?")),e("button",{class:"clear",onClick:b=>j(x)},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)],8,Tc)],40,Sc))),128))])])]),f[2]||(f[2]=e("span",{class:"equals"},"=",-1)),e("div",Mc,[e("div",Lc,t(l[a.value].fraction),1),e("div",Nc,[e("div",Pc,[(n(!0),r(te,null,le(Y.value.fraction.num.slots,x=>(n(),r("div",{key:x,class:"slot",onDragover:P,onDrop:b=>Z(b,x)},[N[x]?(n(),r("span",zc,t(N[x]),1)):(n(),r("span",Bc,"?")),e("button",{class:"clear",onClick:b=>j(x)},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)],8,Oc)],40,Ec))),128))]),f[1]||(f[1]=e("div",{class:"bar"},null,-1)),e("div",jc,[(n(!0),r(te,null,le(Y.value.fraction.den.slots,x=>(n(),r("div",{key:x,class:"slot",onDragover:P,onDrop:b=>Z(b,x)},[N[x]?(n(),r("span",Ic,t(N[x]),1)):(n(),r("span",Fc,"?")),e("button",{class:"clear",onClick:b=>j(x)},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)],8,Uc)],40,Rc))),128))])])])]),e("section",qc,[e("button",{class:"btn",onClick:w},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:_},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:U},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),e("section",Qc,[e("div",Hc,t(l[a.value].bank),1),e("div",Vc,[(n(!0),r(te,null,le(R.value,x=>(n(),r("button",{key:x.key,class:"chip",draggable:"true",onDragstart:b=>Q(b,x.digit)},t(x.digit),41,Gc))),128))])]),H($e,{name:"fade"},{default:ke(()=>[v.value?(n(),r("div",{key:0,class:re(["feedback",{ok:T.value}])},t(v.value),3)):ie("",!0)]),_:1})],8,gc))}},Kc=me(Wc,[["__scopeId","data-v-46279352"]]),Yc=["data-theme"],Jc={class:"head"},Xc={class:"title"},Zc={class:"intro"},eu={class:"status"},tu={class:"chip"},au={class:"chip"},nu={class:"graph"},lu={viewBox:"0 0 500 300"},su=["x1","y1","x2","y2"],ou=["x","y"],ru=["onClick"],iu=["cx","cy","r"],cu=["x","y"],uu={class:"controls"},du={__name:"challenge_level_three_7",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثالث – التحدي 7: مسار الضرب",intro:"ابدأ من النقطة أ ثم اختر نقاطًا متصلة للوصول إلى ب بحيث يكون حاصل ضرب الأرقام على الأضلاع مساويًا للقيمة المطلوبة.",target:"القيمة المطلوبة",current:"الحاصل الحالي",check:"تحقّق",reset:"مسح آخر نقطة",newQ:"تحدٍ جديد",clearAll:"إعادة المسار",needStart:"ابدأ من النقطة أ.",invalid:"يجب اختيار نقطة متصلة.",wrong:"المسار لا يعطي القيمة المطلوبة، حاول مرة أخرى.",correct:"أحسنت! المسار يعطي القيمة المطلوبة."},en:{title:"Level 3 – Challenge 7: Multiplication Path",intro:"Start at point A and travel along connected nodes to reach B so the product of edge values equals the required target.",target:"Target product",current:"Current product",check:"Check",reset:"Undo last",newQ:"New challenge",clearAll:"Clear path",needStart:"Start from node A.",invalid:"Pick a connected node.",wrong:"Path does not meet the target—try again.",correct:"Great! The path matches the target."}},a=W(()=>l[A.lang]?A.lang:"ar"),S=typeof Audio!="undefined"?new Audio(Pe):null,O=typeof Audio!="undefined"?new Audio(xe):null,$=typeof Audio!="undefined"?new Audio(Fe):null;S&&(S.preload="auto"),O&&(O.preload="auto"),$&&($.preload="auto");const E=[{id:"p1",target:5,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:90},{id:"RB",x:340,y:210},{id:"CT",x:260,y:70},{id:"C",x:260,y:150},{id:"CB",x:260,y:230},{id:"LT",x:180,y:90},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:.5},{from:"RT",to:"CT",value:1},{from:"CT",to:"C",value:.5},{from:"C",to:"LT",value:2},{from:"LT",to:"B",value:2.5},{from:"A",to:"RB",value:2},{from:"RB",to:"CB",value:1.25},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1},{from:"LB",to:"B",value:2},{from:"CT",to:"CB",value:2},{from:"RT",to:"C",value:1.4},{from:"C",to:"LT",value:1.6}]},{id:"p2",target:6,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:100},{id:"RB",x:340,y:200},{id:"CT",x:260,y:60},{id:"C",x:260,y:150},{id:"CB",x:260,y:240},{id:"LT",x:180,y:100},{id:"LB",x:180,y:200}],edges:[{from:"A",to:"RT",value:1.5},{from:"RT",to:"CT",value:2},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:.5},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:2},{from:"C",to:"LB",value:1},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.2},{from:"C",to:"LT",value:1.5}]},{id:"p3",target:5.4,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:90},{id:"RB",x:340,y:210},{id:"CT",x:260,y:70},{id:"C",x:260,y:150},{id:"CB",x:260,y:230},{id:"LT",x:180,y:90},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:1.2},{from:"RT",to:"CT",value:1.5},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1.5},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:1.4},{from:"RB",to:"CB",value:1.1},{from:"CB",to:"C",value:1.2},{from:"C",to:"LB",value:1.3},{from:"LB",to:"B",value:1.8},{from:"RT",to:"C",value:1.3},{from:"CT",to:"CB",value:1.4}]},{id:"p4",target:4.5,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:110},{id:"RB",x:340,y:210},{id:"CT",x:260,y:90},{id:"C",x:260,y:160},{id:"CB",x:260,y:240},{id:"LT",x:180,y:120},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:1.1},{from:"RT",to:"CT",value:1.3},{from:"CT",to:"C",value:1.2},{from:"C",to:"LT",value:1.25},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:1.5},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1.4},{from:"LB",to:"B",value:1.8},{from:"RT",to:"C",value:1.4},{from:"CT",to:"CB",value:1.1}]},{id:"p5",target:7.2,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:95},{id:"RB",x:340,y:205},{id:"CT",x:260,y:65},{id:"C",x:260,y:150},{id:"CB",x:260,y:235},{id:"LT",x:180,y:105},{id:"LB",x:180,y:205}],edges:[{from:"A",to:"RT",value:1.2},{from:"RT",to:"CT",value:1.5},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1.2},{from:"LT",to:"B",value:1.6},{from:"A",to:"RB",value:.9},{from:"RB",to:"CB",value:1.4},{from:"CB",to:"C",value:1.3},{from:"C",to:"LB",value:2},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.3},{from:"CT",to:"CB",value:1.2}]},{id:"p6",target:4.8,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:105},{id:"RB",x:340,y:215},{id:"CT",x:260,y:75},{id:"C",x:260,y:155},{id:"CB",x:260,y:235},{id:"LT",x:180,y:110},{id:"LB",x:180,y:215}],edges:[{from:"A",to:"RT",value:1.3},{from:"RT",to:"CT",value:1.2},{from:"CT",to:"C",value:1.1},{from:"C",to:"LT",value:1.4},{from:"LT",to:"B",value:1.7},{from:"A",to:"RB",value:1.25},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1.6},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.2},{from:"CT",to:"CB",value:1.3}]}];function Y(_,u){const f=u.find(b=>b.id===_.from),x=u.find(b=>b.id===_.to);return{..._,x1:f.x,y1:f.y,x2:x.x,y2:x.y,midX:(f.x+x.x)/2,midY:(f.y+x.y)/2}}const N=z(E[0]),D=z(null),m=z([]),v=z(null),T=z(!1),M=W(()=>N.value.nodes),U=W(()=>N.value.edges.map(_=>Y(_,M.value))),P=W(()=>{const _=[];for(let u=0;u<m.value.length-1;u++){const f=m.value[u],x=m.value[u+1],b=U.value.find(c=>c.from===f&&c.to===x||c.from===x&&c.to===f);b&&_.push(b)}return _}),Q=W(()=>P.value.reduce((_,u)=>_*u.value,1));function Z(_,u){return U.value.some(f=>f.from===_&&f.to===u||f.from===u&&f.to===_)}function j(){if(E.length===1)return D.value=E[0].id,E[0];let _;do _=E[Math.floor(Math.random()*E.length)];while(_.id===D.value);return D.value=_.id,_}function R(){m.value=[],T.value=!1,v.value=null}function I(){m.value.length>0&&(m.value=m.value.slice(0,-1),T.value=!1,v.value=null)}async function V(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}function X(_){const{start:u,end:f}=N.value;if(!m.value.length){if(_.id!==u){v.value=l[a.value].needStart,$&&$.play();return}m.value=[_.id],v.value=null;return}const x=m.value[m.value.length-1];if(_.id===x)return;if(!Z(x,_.id)){v.value=l[a.value].invalid,$&&$.play();return}const b=m.value.slice();b.push(_.id),m.value=b,v.value=null,_.id===f&&L()}async function L(){const{end:_,target:u}=N.value;if(m.value[m.value.length-1]!==_){v.value=l[a.value].wrong,$&&$.play();return}Math.abs(Q.value-u)<1e-6?(v.value=l[a.value].correct,T.value=!0,S&&S.play(),O&&O.play(),await V()):(v.value=l[a.value].wrong,T.value=!1,$&&$.play())}function w(){const _=j();N.value=_,R()}return _e(w),ge(()=>A.lang,()=>{T.value||(v.value=null)}),(_,u)=>(n(),r("div",{class:"lvl3c8 challenge-surface","data-theme":A.theme},[e("header",Jc,[e("h2",Xc,t(l[a.value].title),1),e("p",Zc,t(l[a.value].intro),1)]),e("section",eu,[e("div",tu,[J(t(l[a.value].target)+": ",1),e("strong",null,t(N.value.target),1)]),e("div",au,[J(t(l[a.value].current)+": ",1),e("strong",null,t(Q.value.toFixed(3)),1)])]),e("section",nu,[(n(),r("svg",lu,[(n(!0),r(te,null,le(U.value,f=>(n(),r("g",{key:f.from+f.to},[e("line",{x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,class:re(["edge",{active:P.value.includes(f)}])},null,10,su),e("text",{x:f.midX,y:f.midY,class:"edge-label"},t(f.value),9,ou)]))),128)),(n(!0),r(te,null,le(M.value,f=>(n(),r("g",{key:f.id,class:"node",onClick:x=>X(f)},[e("circle",{cx:f.x,cy:f.y,r:f.type?20:12,class:re(["point",f.type,{selected:m.value.includes(f.id)}])},null,10,iu),e("text",{x:f.x,y:f.y+4,class:"node-label"},t(f.label||""),9,cu)],8,ru))),128))]))]),e("section",uu,[e("button",{class:"btn",onClick:L},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:I},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:R},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].clearAll),1)]),e("button",{class:"btn",onClick:w},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),H($e,{name:"fade"},{default:ke(()=>[v.value?(n(),r("div",{key:0,class:re(["feedback",{ok:T.value}])},t(v.value),3)):ie("",!0)]),_:1})],8,Yc))}},vu=me(du,[["__scopeId","data-v-db47ac07"]]),hu=["data-theme"],pu={class:"head"},fu={class:"title"},mu={class:"rule"},gu={class:"board"},_u={class:"cards"},yu=["onDrop"],bu={key:1,class:"placeholder"},ku=["value","onInput","onChange","onBlur","placeholder"],wu=["onClick"],$u={class:"facts"},Cu={class:"bank"},xu={class:"bank-title"},Su={class:"bank-items"},Au=["onDragstart"],Du={class:"actions"},Tu=4,Mu={__name:"challenge_level_three_8",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const A=ee,l={ar:{title:"المستوى الثالث – التحدي 2: الأرقام المفقودة على البطاقات",rule:"أمامك بطاقات ملوّنة بأرقام مفقودة. استخدم المعلومات المعطاة (المجموع، المتوسط، الوسيط، المدى) لتحديد الرقم المناسب لكل بطاقة، ثم اسحبه من لوحة الأعداد أو اكتبه يدويًا.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"مسح",check:"تحقّق",correct:"أحسنت! الأرقام صحيحة.",wrong:"تحقّق من القيم مرة أخرى.",clear:"تفريغ البطاقة",hints:{sum:"المجموع",mean:"المتوسط الحسابي",median:"الوسيط",range:"المدى"},manualPlaceholder:"أدخل رقمًا"},en:{title:"Level 3 – Challenge 2: Missing numbers on the cards",rule:"Each coloured card is missing its number. Use the given information (sum, mean, median, range) to deduce the correct value for every card, then drag a number from the bank or type it manually.",bank:"Number bank",newQ:"New puzzle",reset:"Clear",check:"Check",correct:"Great! All numbers are correct.",wrong:"Something is off – recheck the values.",clear:"Clear card",hints:{sum:"Sum",mean:"Mean",median:"Median",range:"Range"},manualPlaceholder:"Type value"}},a=W(()=>l[A.lang]?A.lang:"ar"),S=W(()=>A.lang==="ar"?"ar-EG":"en-US"),O=W(()=>({direction:"ltr",unicodeBidi:"isolate"})),$=typeof Audio!="undefined"?new Audio(Pe):null,E=typeof Audio!="undefined"?new Audio(xe):null,Y=typeof Audio!="undefined"?new Audio(Ne):null;$&&($.preload="auto"),E&&(E.preload="auto"),Y&&(Y.preload="auto");const N=["green","gold","teal","magenta","sky","orange","crimson"],D=[{numbers:[4,8,12,16,20]},{numbers:[5,9,11,13,22]},{numbers:[7,10,12,18,23]},{numbers:[6,8,15,19,22]},{numbers:[9,11,14,20,26]}];function m(h){const k=h.slice().sort((ce,be)=>ce-be),F=k.reduce((ce,be)=>ce+be,0),G=F/k.length,ae=k[Math.floor(k.length/2)],oe=k.at(-1)-k[0];return{sum:F,mean:G,median:ae,range:oe}}const v=z([]),T=ve({}),M=z(new Set),U=ve({}),P=ve({}),Q=ve({}),Z=ve({}),j=ve({}),R=ve({}),I=z({sum:0,mean:0,median:0,range:0}),V=z(null),X=z(!1);function L(h){for(const k of Object.keys(h))delete h[k]}function w(){const k=D[Math.floor(Math.random()*D.length)].numbers.slice(),F=N.slice(0,k.length).sort(()=>Math.random()-.5),G=k.slice().sort(()=>Math.random()-.5);v.value=[],M.value=new Set,L(T),L(Z),L(j),L(R),L(U),L(P),L(Q),G.forEach((pe,Te)=>{const Ee=`card-${Te}`;v.value.push({id:Ee,value:pe,color:F[Te%F.length]}),T[Ee]=pe,M.value.add(Ee),U[pe]=(U[pe]||0)+1});for(const[pe,Te]of Object.entries(U))Q[pe]=Te;const ae=Math.min(...k),oe=Math.max(...k),ce=Math.max(1,ae-12),be=oe+12,he=new Set;for(;he.size<Tu;){const pe=Math.floor(Math.random()*(be-ce+1))+ce;U[pe]||he.add(pe)}he.forEach(pe=>{P[pe]=(P[pe]||0)+1,Q[pe]=(Q[pe]||0)+1}),I.value=m(k),V.value=null,X.value=!1}function _(h,k){h.dataTransfer.setData("text/plain",String(k))}function u(h){h.preventDefault()}function f(h,k,F){if(!Number.isFinite(k))return!1;if(Z[h]!=null&&j[h]==="bank"){const G=Z[h];Q[G]=(Q[G]||0)+1}if(F==="bank"){if((Q[k]||0)<=0)return!1;Q[k]=Math.max(0,(Q[k]||0)-1)}return Z[h]=k,j[h]=F,R[h]=String(k),V.value=null,X.value=!1,!0}function x(h,k){h.preventDefault();const F=Number(h.dataTransfer.getData("text/plain"));Number.isNaN(F)||f(k,F,"bank")}function b(h){if(Z[h]!=null&&j[h]==="bank"){const k=Z[h];Q[k]=(Q[k]||0)+1}delete Z[h],delete j[h],R[h]="",V.value=null,X.value=!1}function c(){for(const h of M.value)if(Z[h]==null)return!1;return!0}function p(){for(const h of M.value)if(Z[h]!==T[h])return!1;return!0}async function y(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function B(){if(!c()){V.value=a.value==="ar"?"أكمل كل البطاقات أولاً.":"Fill every card first.",Y&&Y.play();return}p()?(X.value=!0,V.value=l[a.value].correct,$&&$.play(),E&&E.play(),await y()):(V.value=l[a.value].wrong,Y&&Y.play())}function d(){L(Z),L(j),L(R),L(Q);for(const[h,k]of Object.entries(U))Q[h]=k;for(const[h,k]of Object.entries(P))Q[h]=(Q[h]||0)+k;V.value=null,X.value=!1}const s=W(()=>{const h=[];for(const[k,F]of Object.entries(Q))for(let G=0;G<F;G++)h.push({value:Number(k),key:`${k}-${G}`});return h.sort((k,F)=>k.value-F.value)});function o(h,k){R[h]=k}function i(h){var G;const k=((G=R[h])!=null?G:"").trim();if(k===""){b(h);return}const F=Number(k);Number.isFinite(F)&&f(h,F,"manual")}const g=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function q(h){const k=String(h);return A.lang==="ar"?k.replace(/[0-9]/g,F=>g[Number(F)]):k}function C(h,k={}){return new Intl.NumberFormat(S.value,k).format(h)}return _e(w),ge(()=>A.lang,()=>{X.value||(V.value=null)}),(h,k)=>(n(),r("div",{class:"lvl3c2 challenge-surface","data-theme":A.theme},[e("header",pu,[e("h2",fu,t(l[a.value].title),1),e("p",mu,t(l[a.value].rule),1)]),e("section",gu,[e("div",_u,[(n(!0),r(te,null,le(v.value,F=>{var G;return n(),r("div",{key:F.id,class:re(["card","color-"+F.color])},[e("div",{class:"drop",onDragover:u,onDrop:ae=>x(ae,F.id)},[Z[F.id]!=null?(n(),r("span",{key:0,class:"num",style:ue(O.value)},t(q(Z[F.id])),5)):(n(),r("span",bu,"؟"))],40,yu),e("input",{class:"manual-entry",type:"number",inputmode:"numeric",style:ue(O.value),value:(G=R[F.id])!=null?G:"",onInput:ae=>o(F.id,ae.target.value),onChange:ae=>i(F.id),onBlur:ae=>i(F.id),placeholder:l[a.value].manualPlaceholder},null,44,ku),e("button",{class:"clear",onClick:ae=>b(F.id)},[H(K(Se),{class:"ic"}),J(" "+t(l[a.value].clear),1)],8,wu)],2)}),128))]),e("aside",$u,[e("h3",null,t(A.lang==="ar"?"المعلومات المتاحة":"Given facts"),1),e("ul",null,[e("li",null,[e("strong",null,t(l[a.value].hints.sum)+":",1),k[0]||(k[0]=J()),e("span",{style:ue(O.value)},t(C(I.value.sum)),5)]),e("li",null,[e("strong",null,t(l[a.value].hints.mean)+":",1),k[1]||(k[1]=J()),e("span",{style:ue(O.value)},t(C(I.value.mean,{maximumFractionDigits:2})),5)]),e("li",null,[e("strong",null,t(l[a.value].hints.median)+":",1),k[2]||(k[2]=J()),e("span",{style:ue(O.value)},t(C(I.value.median)),5)]),e("li",null,[e("strong",null,t(l[a.value].hints.range)+":",1),k[3]||(k[3]=J()),e("span",{style:ue(O.value)},t(C(I.value.range)),5)])])])]),e("section",Cu,[e("div",xu,t(l[a.value].bank),1),e("div",Su,[(n(!0),r(te,null,le(s.value,F=>(n(),r("button",{key:F.key,class:"chip",draggable:"true",onDragstart:G=>_(G,F.value),style:ue(O.value)},t(q(F.value)),45,Au))),128))])]),e("section",Du,[e("button",{class:"btn",onClick:d},[H(K(Ce),{class:"ic"}),J(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:B},[H(K(we),{class:"ic"}),J(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:w},[H(K(ye),{class:"ic"}),J(" "+t(l[a.value].newQ),1)])]),H($e,{name:"fade"},{default:ke(()=>[V.value?(n(),r("div",{key:0,class:re(["toast",{ok:X.value}])},t(V.value),3)):ie("",!0)]),_:1})],8,hu))}},Lu=me(Mu,[["__scopeId","data-v-abb006e5"]]),Xe="ml-toast";function Ie({message:ee,type:A="info",duration:l=2600}={}){var a;ee&&window.dispatchEvent(new CustomEvent(Xe,{detail:{message:ee,type:A,duration:l,id:((a=crypto.randomUUID)==null?void 0:a.call(crypto))||Math.random().toString(36).slice(2),timestamp:Date.now()}}))}function Nu(ee){return window.addEventListener(Xe,ee),()=>window.removeEventListener(Xe,ee)}const Ze=z(null),Ct=z(null),xt=z(null),St=z(null),Qe=z(!1),He=z(null),et=z(0),At=z(null),Dt=z(null),Tt=z(null);async function Pu(ee=!1){var l;const A=Date.now();if(!(!ee&&Ze.value!==null&&A-et.value<6e4)&&!Qe.value){Qe.value=!0,He.value=null;try{const a=await fetch("/api/method/mathematics_leaders.api.game_points.get_points",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),S=await a.json();if(!a.ok||!((l=S==null?void 0:S.message)!=null&&l.ok))throw new Error((S==null?void 0:S.message)||"Unable to load score");const O=S.message;Ze.value=Number(O.points||0),Ct.value=O.rank||1,xt.value=O.players||1,St.value=Number(O.best||O.points||0),At.value=O.profile_image||null,Dt.value=O.username||null,Tt.value=O.game_user_name||null,et.value=A}catch(a){He.value=a instanceof Error?a.message:String(a),Ie({message:He.value,type:"danger"})}finally{Qe.value=!1}}}function nt(){return{score:Ze,rank:Ct,totalPlayers:xt,bestScore:St,loading:Qe,error:He,lastUpdated:et,profileImage:At,username:Dt,gameUserName:Tt,refresh:Pu}}const Eu=["dir","data-theme"],zu={class:"overview"},Bu={class:"panel donut-panel"},Ou={class:"panel__header"},ju={class:"tier-chip"},Ru=["disabled"],Iu={class:"donut"},Fu={viewBox:"0 0 160 160","aria-hidden":"true"},Uu={class:"donut__label"},qu={class:"panel__footer"},Qu={class:"progress-caption"},Hu={class:"timestamp"},Vu={class:"panel spark-panel"},Gu={class:"panel__header"},Wu={class:"panel__title"},Ku={class:"spark"},Yu={viewBox:"0 0 180 72","aria-hidden":"true"},Ju=["d"],Xu=["d"],Zu={class:"spark__meta"},ed={class:"spark__hint"},td={class:"metrics"},ad={class:"metric__label"},nd={class:"metric__value"},ld={class:"insights"},sd={class:"insights__grid"},od={class:"insight-card__icon"},rd={class:"insight-card__body"},id={key:0,class:"error"},yt=9,Ke=58,cd={__name:"my_scores",setup(ee){const{score:A,rank:l,totalPlayers:a,bestScore:S,loading:O,error:$,lastUpdated:E,refresh:Y}=nt(),N=()=>(document.documentElement.lang||"").toLowerCase().startsWith("en")||(localStorage.getItem("ml_lang")||"").toLowerCase().startsWith("en")?"en":"ar",D=()=>localStorage.getItem("ml_theme")||"light",m=z(N()),v=z(D()),T=W(()=>m.value==="ar"),M=W(()=>m.value==="ar"?{totalPoints:"إجمالي النقاط",progressLabel:"التقدم نحو الرتبة التالية",refresh:"تحديث النقاط",lastUpdated:"آخر تحديث",insightHeading:"تحليلات سريعة",scoreTrendTitle:"منحنى الأداء",scoreTrendCopy:"يميل الأداء إلى التحسن خلال آخر المحاولات.",percentRankTitle:"موقعك بين اللاعبين",topTierCopy:"لقد بلغت أعلى رتبة متاحة! استمر في التألق.",nextTierLabel:"المتبقي للوصول للرتبة التالية",recordTitle:"أفضل نتيجة مسجلة",sparkLabel:"تحوّل النقاط (آخر الجلسات)",metricsHeading:"مؤشرات سريعة",playersLabel:"عدد اللاعبين",rankLabel:"ترتيبك",recordLabel:"رقمك القياسي",minutesAgo:"منذ دقائق",justNow:"الآن"}:{totalPoints:"Total points",progressLabel:"Progress to next tier",refresh:"Refresh score",lastUpdated:"Last updated",insightHeading:"Quick insights",scoreTrendTitle:"Performance trend",scoreTrendCopy:"Your recent attempts show an upward trend.",percentRankTitle:"Position among players",topTierCopy:"You already sit at the highest tier—keep shining!",nextTierLabel:"To reach the next tier",recordTitle:"Best recorded score",sparkLabel:"Score changes (recent sessions)",metricsHeading:"Key metrics",playersLabel:"Players",rankLabel:"Your rank",recordLabel:"Personal best",minutesAgo:"minutes ago",justNow:"just now"}),U=[{threshold:0,title:{ar:"مبتدئ الأرقام",en:"Number Novice"}},{threshold:25,title:{ar:"مستكشف الأنماط",en:"Pattern Explorer"}},{threshold:75,title:{ar:"مايسترو الرياضيات",en:"Math Maestro"}},{threshold:150,title:{ar:"أسطورة التحديات",en:"Challenge Legend"}}],P=W(()=>Number(A.value||0)),Q=W(()=>Number(S.value||0)),Z=W(()=>{let G=0;return U.forEach((ae,oe)=>{P.value>=ae.threshold&&(G=oe)}),G}),j=W(()=>U[Z.value]),R=W(()=>U[Z.value+1]||null),I=W(()=>{var G,ae,oe,ce;return((ae=(G=j.value)==null?void 0:G.title)==null?void 0:ae[m.value])||((ce=(oe=j.value)==null?void 0:oe.title)==null?void 0:ce.en)||""}),V=W(()=>{if(!R.value)return 1;const G=R.value.threshold-j.value.threshold;return G<=0?1:Math.min(1,(P.value-j.value.threshold)/G)}),X=new Intl.NumberFormat("en-US",{maximumFractionDigits:0}),L=W(()=>X.format(P.value)),w=W(()=>X.format(Q.value)),_=W(()=>l.value!=null?`#${l.value}`:"--"),u=W(()=>a.value!=null?X.format(a.value):"--"),f=W(()=>{if(!E.value)return"--";const G=Date.now()-E.value;return G<6e4?M.value.justNow:`${Math.round(G/6e4)} ${M.value.minutesAgo}`}),x=W(()=>{const G=Math.max(P.value,Q.value,1),ae=Math.max(10,G*.45),oe=[];for(let ce=0;ce<yt;ce+=1){const be=ce/(yt-1),he=Math.sin((P.value+ce)*.35)*G*.05,pe=Math.max(0,ae+(G-ae)*be+he);oe.push(Math.round(pe))}return oe[oe.length-1]=Math.max(P.value,0),oe}),b=W(()=>{const G=x.value;if(!G.length)return[];const ae=180,oe=54,ce=Math.max(...G),be=Math.min(...G),he=ce-be||1;return G.map((pe,Te)=>{const Ee=G.length===1?ae:ae/(G.length-1)*Te,Ue=oe-(pe-be)/he*oe;return{x:Number(Ee.toFixed(2)),y:Number(Ue.toFixed(2)),value:pe}})}),c=W(()=>{const G=b.value;return G.length?G.map((ae,oe)=>`${oe===0?"M":"L"}${ae.x},${ae.y}`).join(" "):""}),p=W(()=>{const G=b.value;if(!G.length)return"";const ae=54,oe=G[0],ce=G[G.length-1],be=G.map((he,pe)=>`L${he.x},${he.y}`).join(" ");return`M${oe.x},${ae} ${be} L${ce.x},${ae} Z`}),y=W(()=>{const G=x.value;return G.length<2?0:G[G.length-1]-G[0]}),B=2*Math.PI*Ke,d=W(()=>B*(1-V.value)),s=W(()=>Math.round(V.value*100)),o=W(()=>!l.value||!a.value?null:Math.max(0,100-Math.round((l.value-1)/a.value*100))),i={trend:on,award:Ka,activity:Wa,target:bt},g=W(()=>{const G=[];if(R.value){const ae=Math.max(0,R.value.threshold-P.value);G.push({icon:"target",title:M.value.nextTierLabel,body:m.value==="ar"?`تبقى ${X.format(ae)} نقطة للوصول إلى «${R.value.title.ar}».`:`${X.format(ae)} pts to unlock “${R.value.title.en}”.`})}else G.push({icon:"target",title:M.value.nextTierLabel,body:(m.value==="ar",M.value.topTierCopy)});return G.push({icon:"trend",title:M.value.scoreTrendTitle,body:m.value==="ar"?`${M.value.scoreTrendCopy} (+${X.format(Math.max(0,y.value))}).`:`${M.value.scoreTrendCopy} (+${X.format(Math.max(0,y.value))}).`}),o.value!=null&&G.push({icon:"award",title:M.value.percentRankTitle,body:m.value==="ar"?`أنت ضمن أفضل ${o.value}% من اللاعبين.`:`You currently outperform ${o.value}% of players.`}),G.push({icon:"activity",title:M.value.recordTitle,body:m.value==="ar"?`أفضل نتيجة حققتها هي ${w.value} نقطة.`:`Your personal best sits at ${w.value} pts.`}),G}),q=W(()=>[{label:M.value.rankLabel,value:_.value},{label:M.value.playersLabel,value:u.value},{label:M.value.recordLabel,value:w.value}]);function C(){Y(!0)}let h=null,k=null,F=null;return _e(()=>{Y(!0);const G=()=>{m.value=N()},ae=()=>{v.value=D()};h=new MutationObserver(G),h.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"]}),k=new MutationObserver(ae),k.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),F=()=>{G(),ae()},window.addEventListener("storage",F)}),tt(()=>{h&&h.disconnect(),k&&k.disconnect(),F&&window.removeEventListener("storage",F)}),(G,ae)=>(n(),r("div",{class:"scores-page",dir:T.value?"rtl":"ltr","data-theme":v.value},[e("section",zu,[e("article",Bu,[e("header",Ou,[e("span",ju,t(I.value),1),e("button",{class:"refresh","data-ripple":"",disabled:K(O),onClick:C},[H(K(ye),{class:re(["ic",{spin:K(O)}])},null,8,["class"]),J(" "+t(M.value.refresh),1)],8,Ru)]),e("div",Iu,[(n(),r("svg",Fu,[ae[0]||(ae[0]=e("defs",null,[e("linearGradient",{id:"donutGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"#c8a03b"}),e("stop",{offset:"100%","stop-color":"#0f8a3e"})])],-1)),e("circle",{class:"track",cx:"80",cy:"80",r:Ke}),e("circle",{class:"progress",cx:"80",cy:"80",r:Ke,style:ue({strokeDasharray:`${B}px`,strokeDashoffset:`${d.value}px`})},null,4)])),e("div",Uu,[e("strong",null,t(L.value),1),e("span",null,t(M.value.totalPoints),1)])]),e("footer",qu,[e("div",Qu,[e("span",null,t(M.value.progressLabel),1),e("span",null,t(s.value)+"%",1)]),e("div",Hu,t(M.value.lastUpdated)+" · "+t(f.value),1)])]),e("article",Vu,[e("header",Gu,[e("span",Wu,t(M.value.sparkLabel),1)]),e("div",Ku,[(n(),r("svg",Yu,[ae[1]||(ae[1]=e("defs",null,[e("linearGradient",{id:"sparkFill",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"rgba(15,138,62,0.35)"}),e("stop",{offset:"100%","stop-color":"rgba(200,160,59,0.05)"})])],-1)),p.value?(n(),r("path",{key:0,class:"spark__area",d:p.value,fill:"url(#sparkFill)"},null,8,Ju)):ie("",!0),c.value?(n(),r("path",{key:1,class:"spark__path",d:c.value},null,8,Xu)):ie("",!0)])),e("div",Zu,[e("span",{class:re(["spark__delta",{up:y.value>=0}])},t(y.value>=0?"+":"")+t(K(X).format(y.value)),3),e("span",ed,t(M.value.scoreTrendCopy),1)])]),e("div",td,[(n(!0),r(te,null,le(q.value,oe=>(n(),r("div",{key:oe.label,class:"metric"},[e("span",ad,t(oe.label),1),e("strong",nd,t(oe.value),1)]))),128))])])]),e("section",ld,[e("h3",null,t(M.value.insightHeading),1),e("div",sd,[(n(!0),r(te,null,le(g.value,(oe,ce)=>(n(),r("article",{key:ce,class:"insight-card"},[e("div",od,[(n(),De(je(i[oe.icon]),{class:"glyph"}))]),e("div",rd,[e("h4",null,t(oe.title),1),e("p",null,t(oe.body),1)])]))),128))]),K($)?(n(),r("p",id,t(K($)),1)):ie("",!0)])],8,Eu))}},ud=me(cd,[["__scopeId","data-v-d7a1a530"]]),dd=["dir","data-theme"],vd={class:"settings__header"},hd={class:"page-title"},pd={class:"settings__grid"},fd={class:"settings-card profile-card"},md={class:"card-header"},gd={class:"title"},_d={class:"card-body"},yd={class:"avatar-stack"},bd={class:"avatar-orbit"},kd={class:"avatar-ring"},wd=["src"],$d={key:1},Cd={class:"display-name"},xd={class:"controls"},Sd={class:"btn ghost","data-ripple":""},Ad=["disabled"],Dd={key:"avatar-ok",class:"status success"},Td={key:"avatar-err",class:"status error"},Md={class:"settings-card password-card"},Ld={class:"card-header"},Nd={class:"title"},Pd={class:"verify-block"},Ed=["disabled"],zd={key:"verify-ok",class:"status success"},Bd={key:"verify-err",class:"status error"},Od={key:0,class:"password-fields"},jd={class:"form-actions"},Rd=["disabled"],Id={key:"pass-ok",class:"status success"},Fd={key:"pass-err",class:"status error"},Ud={__name:"settings",setup(ee){const A=nt(),l=()=>(document.documentElement.lang||"").toLowerCase().startsWith("en")||(localStorage.getItem("ml_lang")||"").toLowerCase().startsWith("en")?"en":"ar",a=()=>localStorage.getItem("ml_theme")||"light",S=z(l()),O=z(a()),$=W(()=>S.value==="ar"),E=W(()=>S.value==="ar"?{title:"إعدادات الحساب",avatarTitle:"صورة البروفايل",avatarHint:"ارفع صورة مربعة بدقة جيدة (حتى 2 م.ب).",chooseFile:"اختر صورة",cancel:"إزالة التحديد",upload:"حفظ الصورة",loading:"جارٍ الرفع...",changeSuccess:"تم تحديث الصورة بنجاح.",changeError:"تعذر تحديث الصورة، حاول لاحقًا.",passwordTitle:"تغيير كلمة المرور",formHint:"استخدم كلمة مرور قوية تجمع بين الأحرف والأرقام والرموز.",currentPassword:"كلمة المرور الحالية",newPassword:"كلمة المرور الجديدة",confirmPassword:"تأكيد كلمة المرور",verify:"تحقّق",verified:"تم التحقق من كلمة المرور.",verifyError:"تحقق من كلمة المرور الحالية أولًا.",savePassword:"حفظ كلمة المرور",reset:"إعادة التعيين",passwordSuccess:"تم تغيير كلمة المرور بنجاح.",passwordError:"تعذر تغيير كلمة المرور، تحقق من البيانات.",selectImageFirst:"اختر صورة أولًا.",notImage:"الملف ليس صورة.",tooLarge:"حجم الصورة يتجاوز 2 م.ب.",missingPlayer:"تعذر إيجاد ملف اللاعب."}:{title:"Account settings",avatarTitle:"Profile picture",avatarHint:"Upload a crisp square image (up to 2 MB).",chooseFile:"Choose image",cancel:"Remove selection",upload:"Save avatar",loading:"Uploading...",changeSuccess:"Profile picture updated successfully.",changeError:"We could not update your picture. Try again later.",passwordTitle:"Change password",formHint:"Use a strong password that mixes letters, numbers, and symbols.",currentPassword:"Current password",newPassword:"New password",confirmPassword:"Confirm password",verify:"Verify",verified:"Password verified.",verifyError:"Verify your current password first.",savePassword:"Save password",reset:"Reset form",passwordSuccess:"Password updated successfully.",passwordError:"Unable to change password. Check your entries.",selectImageFirst:"Select an image first.",notImage:"The selected file is not an image.",tooLarge:"Image size exceeds 2 MB.",missingPlayer:"Unable to identify player record."}),Y=z(null),N=z(""),D=ve({loading:!1,message:"",error:""}),m=ve({current:"",next:"",confirm:""}),v=ve({loading:!1,verified:!1,message:"",error:""}),T=ve({loading:!1,message:"",error:""}),M=W(()=>A.username.value||"Player"),U=W(()=>M.value.trim().charAt(0).toUpperCase()||"P"),P=W(()=>N.value||A.profileImage.value||null);function Q(_){var f;D.message="",D.error="";const u=(f=_.target.files)==null?void 0:f[0];if(!u){Z();return}if(!u.type.startsWith("image/")){D.error=E.value.notImage;return}if(u.size>2*1024*1024){D.error=E.value.tooLarge;return}N.value&&URL.revokeObjectURL(N.value),Y.value=u,N.value=URL.createObjectURL(u)}function Z(){N.value&&URL.revokeObjectURL(N.value),Y.value=null,N.value="",D.message="",D.error=""}async function j(){var u,f;if(!Y.value){D.error=E.value.selectImageFirst;return}A.gameUserName.value||await A.refresh(!0);const _=A.gameUserName.value;if(!_){D.error=E.value.missingPlayer;return}D.loading=!0,D.error="",D.message="";try{const x=new FormData;x.append("file",Y.value),x.append("filename",Y.value.name),x.append("is_private","0"),x.append("attached_to_doctype","Game Users"),x.append("attached_to_name",_);const b=await fetch("/api/method/upload_file",{method:"POST",credentials:"include",body:x}),c=await b.json();if(!b.ok||!((u=c==null?void 0:c.message)!=null&&u.file_url))throw new Error((c==null?void 0:c._server_messages)||(c==null?void 0:c.message)||"Upload failed");const p=c.message.file_url,y=await fetch("/api/method/mathematics_leaders.api.profile.set_profile_image",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_url:p})}),B=await y.json();if(!y.ok||!((f=B==null?void 0:B.message)!=null&&f.ok))throw new Error((B==null?void 0:B.message)||"Unable to store profile image");D.message=E.value.changeSuccess,Ie({message:E.value.changeSuccess,type:"success"}),await A.refresh(!0),Z()}catch(x){D.error=x instanceof Error?x.message:E.value.changeError,Ie({message:D.error,type:"danger"})}finally{D.loading=!1}}async function R(){var _;v.loading=!0,v.error="",v.message="";try{if(!m.current)throw new Error(E.value.verifyError);const u=await fetch("/api/method/mathematics_leaders.api.profile.verify_current_password",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:m.current})}),f=await u.json();if(!u.ok||!((_=f==null?void 0:f.message)!=null&&_.ok))throw new Error((f==null?void 0:f.message)||E.value.verifyError);v.verified=!0,v.message=E.value.verified,T.error=""}catch(u){v.verified=!1,v.error=u instanceof Error?u.message:E.value.verifyError}finally{v.loading=!1}}async function I(){var x;if(!v.verified){v.error=E.value.verifyError;return}T.loading=!0,T.message="",T.error="";const{current:_,next:u,confirm:f}=m;try{if(!_||!u||!f)throw new Error(S.value==="ar"?"املأ كل الحقول.":"Fill in every field.");if(u!==f)throw new Error(S.value==="ar"?"كلمتا المرور غير متطابقتين.":"Passwords do not match.");if(u.length<8)throw new Error(S.value==="ar"?"كلمة المرور يجب أن تكون 8 أحرف على الأقل.":"Password must be at least 8 characters.");const b=await fetch("/api/method/mathematics_leaders.api.profile.change_password",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:_,new_password:u})}),c=await b.json();if(!b.ok||!((x=c==null?void 0:c.message)!=null&&x.ok))throw new Error((c==null?void 0:c.message)||E.value.passwordError);T.message=E.value.passwordSuccess,Ie({message:E.value.passwordSuccess,type:"success"}),m.current="",m.next="",m.confirm="",v.verified=!1,v.message=""}catch(b){T.error=b instanceof Error?b.message:E.value.passwordError,Ie({message:T.error,type:"danger"})}finally{T.loading=!1}}function V(){m.current="",m.next="",m.confirm="",v.loading=!1,v.verified=!1,v.message="",v.error="",T.loading=!1,T.message="",T.error=""}let X=null,L=null,w=null;return _e(()=>{A.score.value==null&&A.refresh(!0);const _=()=>{S.value=l()},u=()=>{O.value=a()};X=new MutationObserver(_),X.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"]}),L=new MutationObserver(u),L.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),w=()=>{_(),u()},window.addEventListener("storage",w)}),tt(()=>{N.value&&URL.revokeObjectURL(N.value),X&&X.disconnect(),L&&L.disconnect(),w&&window.removeEventListener("storage",w)}),(_,u)=>(n(),r("div",{class:"settings",dir:$.value?"rtl":"ltr","data-theme":O.value},[e("header",vd,[H(K(nn),{class:"heading-icon"}),e("h1",hd,t(E.value.title),1)]),e("div",pd,[e("section",fd,[e("header",md,[e("div",gd,[H(K(pt),{class:"icon"}),e("div",null,[e("h2",null,t(E.value.avatarTitle),1),e("p",null,t(E.value.avatarHint),1)])])]),e("div",_d,[e("div",yd,[e("div",bd,[e("div",kd,[P.value?(n(),r("img",{key:0,src:P.value,alt:"avatar preview"},null,8,wd)):(n(),r("span",$d,t(U.value),1))])]),e("span",Cd,t(M.value),1)]),e("div",xd,[e("label",Sd,[H(K(cn),{class:"icon"}),e("span",null,t(E.value.chooseFile),1),e("input",{type:"file",accept:"image/*",onChange:Q,hidden:""},null,32)]),Y.value?(n(),r("button",{key:0,type:"button",class:"btn subtle","data-ripple":"",onClick:Z},t(E.value.cancel),1)):ie("",!0),e("button",{type:"button",class:"btn solid","data-ripple":"",disabled:D.loading,onClick:j},[D.loading?(n(),De(K(qe),{key:0,class:"icon spinner"})):(n(),De(K(pt),{key:1,class:"icon"})),e("span",null,t(D.loading?E.value.loading:E.value.upload),1)],8,Ad)]),H($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[D.message?(n(),r("p",Dd,[H(K(We),{class:"icon"}),e("span",null,t(D.message),1)])):ie("",!0)]),_:1}),H($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[D.error?(n(),r("p",Td,t(D.error),1)):ie("",!0)]),_:1})])]),e("section",Md,[e("header",Ld,[e("div",Nd,[H(K(Za),{class:"icon"}),e("div",null,[e("h2",null,t(E.value.passwordTitle),1),e("p",null,t(E.value.formHint),1)])])]),e("form",{class:"card-body password-form",onSubmit:Ve(I,["prevent"])},[e("div",Pd,[e("label",null,[e("span",null,t(E.value.currentPassword),1),Me(e("input",{type:"password","onUpdate:modelValue":u[0]||(u[0]=f=>m.current=f),autocomplete:"current-password"},null,512),[[Le,m.current]])]),e("button",{type:"button",class:"btn solid","data-ripple":"",disabled:v.loading,onClick:R},[v.loading?(n(),De(K(qe),{key:0,class:"icon spinner"})):(n(),De(K(we),{key:1,class:"icon"})),e("span",null,t(v.loading?E.value.loading:E.value.verify),1)],8,Ed),H($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[v.message?(n(),r("p",zd,[H(K(We),{class:"icon"}),e("span",null,t(v.message),1)])):ie("",!0)]),_:1}),H($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[v.error?(n(),r("p",Bd,t(v.error),1)):ie("",!0)]),_:1})]),H($e,{name:"panel-grow"},{default:ke(()=>[v.verified?(n(),r("div",Od,[e("label",null,[e("span",null,t(E.value.newPassword),1),Me(e("input",{type:"password","onUpdate:modelValue":u[1]||(u[1]=f=>m.next=f),autocomplete:"new-password",required:""},null,512),[[Le,m.next]])]),e("label",null,[e("span",null,t(E.value.confirmPassword),1),Me(e("input",{type:"password","onUpdate:modelValue":u[2]||(u[2]=f=>m.confirm=f),autocomplete:"new-password",required:""},null,512),[[Le,m.confirm]])]),e("div",jd,[e("button",{class:"btn success","data-ripple":"",type:"submit",disabled:T.loading},[T.loading?(n(),De(K(qe),{key:0,class:"icon spinner"})):(n(),De(K(we),{key:1,class:"icon"})),e("span",null,t(T.loading?E.value.loading:E.value.savePassword),1)],8,Rd),e("button",{type:"button",class:"btn subtle","data-ripple":"",onClick:V},[H(K(ye),{class:"icon"}),e("span",null,t(E.value.reset),1)])]),H($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[T.message?(n(),r("p",Id,[H(K(We),{class:"icon"}),e("span",null,t(T.message),1)])):ie("",!0)]),_:1}),H($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[T.error?(n(),r("p",Fd,t(T.error),1)):ie("",!0)]),_:1})])):ie("",!0)]),_:1})],32)])])],8,dd))}},qd=me(Ud,[["__scopeId","data-v-29b78927"]]),Qd=["dir"],Hd=["onClick"],Vd={class:"dashboard__topbar"},Gd={class:"topbar__left"},Wd=["aria-expanded","aria-label"],Kd={class:"brand-chip"},Yd={class:"brand-chip__logo"},Jd=["src"],Xd={class:"brand-chip__text"},Zd={class:"brand-chip__title"},ev={class:"brand-chip__subtitle"},tv={class:"topbar__center"},av={class:"greet"},nv={class:"topbar__actions"},lv=["aria-label"],sv=["aria-label"],ov={class:"avatar"},rv={key:1,class:"avatar__initial"},iv={class:"profile__text"},cv={class:"profile__name"},uv={class:"profile__meta"},dv={key:0,class:"profile__menu"},vv={class:"dashboard__main"},hv={class:"overview-grid"},pv={class:"welcome-card"},fv={class:"welcome-card__icon"},mv={class:"welcome-card__copy"},gv={class:"welcome-card__metrics"},_v={class:"metric"},yv={class:"metric__label"},bv={class:"metric"},kv={class:"metric__label"},wv=["aria-busy"],$v={key:0,class:"score-card__overlay","aria-hidden":"true"},Cv={class:"score-card__ring"},xv={viewBox:"0 0 120 120",role:"presentation"},Sv={class:"score-card__center"},Av={class:"score-card__details"},Dv={class:"score-card__tier"},Tv={class:"score-card__subtitle"},Mv=["aria-valuenow"],Lv={class:"progress__track"},Nv={class:"progress__meta"},Pv={class:"mentor-card"},Ev={class:"mentor-card__badge"},zv={class:"challenge-section"},Bv={class:"challenge-list__header"},Ov={class:"levels"},jv=["onClick"],Rv={class:"level-head__info"},Iv={class:"level-head__title"},Fv={class:"level-head__count"},Uv={key:0,class:"challenge-cards"},qv=["onClick"],Qv={class:"challenge-card__symbol"},Hv={class:"challenge-card__body"},Vv={class:"challenge-card__title"},Gv={class:"challenge-card__summary"},Wv={class:"challenge-card__cta"},Kv={class:"logout-block"},Yv={class:"challenge-preview"},Jv={class:"preview-header"},Xv={key:0,class:"preview-pill"},Zv={class:"preview-text"},eh={key:0},th={key:1},ah={key:2},nh={key:3},lh={key:4},sh={key:5},oh={key:6},rh={key:7},ih={class:"preview-surface"},ch={class:"preview-placeholder",key:"placeholder"},uh={__name:"Dashboard",props:{view:{type:String,default:""}},setup(ee){var ot;const A=Ot(),l=ee,a=[{id:"level1",label:{ar:"المستوى الأول",en:"Level One"},challenges:[{id:"challenge_1",component:Pn,symbol:"∑",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"إكمال عملية جمع عمودية بأرقام مخفية.",en:"Complete a column addition puzzle with hidden digits."}},{id:"challenge_2",component:Xn,symbol:"√",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"شبكة أعداد تتزايد بمقدار ثابت، أعد القيم المفقودة.",en:"Fill a number grid that increases by a fixed step."}},{id:"challenge_3",component:hl,symbol:"π",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"اختر زوج الأعداد الصحيح حسب المجموع والفرق.",en:"Pick the number pair that matches the given sum and difference."}},{id:"challenge_4",component:Ll,symbol:"×",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"استكمل جدول ضرب مصغر.",en:"Complete the mini multiplication table."}},{id:"challenge_5",component:as,symbol:"Δ",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"املأ مثلث الضرب على الأضلاع.",en:"Fill in the edge products of the triangle."}},{id:"challenge_6",component:us,symbol:"≡",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"اختر ثلاث خلايا مختلفة الصف والعمود لتحقيق مجموع محدد.",en:"Pick three distinct-row/column cells to reach the target sum."}},{id:"challenge_7",component:Ss,symbol:"∴",label:{ar:"التحدي 7",en:"Challenge 7"},summary:{ar:"أكمل هرم الجمع بإسقاط القيم الصحيحة.",en:"Complete the sum pyramid with the correct values."}}]},{id:"level2",label:{ar:"المستوى الثاني",en:"Level Two"},challenges:[{id:"challenge_level_two_1",component:Us,symbol:"∫",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"كوّن تعبيرًا يستخدم الأرقام 1 إلى 5 مرة واحدة.",en:"Build an expression that uses digits 1–5 exactly once."}},{id:"challenge_level_two_2",component:ao,symbol:"≠",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"أكمل مربّعًا سحريًا بمجاميع متساوية.",en:"Complete a magic square with equal sums."}},{id:"challenge_level_two_3",component:Lo,symbol:"≈",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"طابق أعدادًا سداسية مع خواص القسمة.",en:"Match six-digit numbers to divisibility rules."}},{id:"challenge_level_two_4",component:Fo,symbol:"∞",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"اختر الزوج الذي يطابق المجموع والفرق.",en:"Choose the pair that matches the required sum and difference."}},{id:"challenge_level_two_5",component:yr,symbol:"∂",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"اكمل طرح الكسور بوضع الأعداد الصحيحة.",en:"Complete the fraction subtraction by placing the right integers."}},{id:"challenge_level_two_6",component:Tr,symbol:"⊗",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"رتّب خطوات حل معادلة الموازين.",en:"Order the solution steps for the balance puzzle."}}]},{id:"level3",label:{ar:"المستوى الثالث",en:"Level Three"},challenges:[{id:"challenge_level_three_1",component:Qr,symbol:"Φ",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"ابن هرم الضرب من أرقام مبعثرة.",en:"Rebuild the multiplication pyramid from scattered numbers."}},{id:"challenge_level_three_2",component:ui,symbol:"Ψ",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"لغز تفكير متقدم في الأعداد.",en:"An advanced numerical reasoning puzzle."}},{id:"challenge_level_three_3",component:wi,symbol:"Λ",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"لغز منطق متقدم لاختبار السرعة.",en:"Advanced logic to test your speed."}},{id:"challenge_level_three_4",component:Ri,symbol:"Ξ",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"تحدٍ عالي المستوى لربط الأنماط.",en:"High-level challenge for spotting patterns."}},{id:"challenge_level_three_5",component:mc,symbol:"Θ",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"مسألة حسابية تحتاج إلى خطوات دقيقة.",en:"A numeric problem that needs careful steps."}},{id:"challenge_level_three_6",component:Kc,symbol:"β",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"إستراتيجية جديدة لبناء الحل خطوة بخطوة.",en:"Strategic puzzle solved step by step."}},{id:"challenge_level_three_7",component:vu,symbol:"η",label:{ar:"التحدي 7",en:"Challenge 7"},summary:{ar:"اختبار المنطق السريع بالأرقام.",en:"Fast-paced numeric logic test."}},{id:"challenge_level_three_8",component:Lu,symbol:"ζ",label:{ar:"التحدي 8",en:"Challenge 8"},summary:{ar:"لغز أخير يجمع بين التفكير والسرعة.",en:"A final puzzle mixing reasoning with speed."}}]}],S=nt(),O=[{threshold:0,title:{ar:"مبتدئ",en:"Novice"}},{threshold:25,title:{ar:"متقدم",en:"Skilled"}},{threshold:80,title:{ar:"قائد",en:"Leader"}},{threshold:160,title:{ar:"أسطورة",en:"Legend"}}],$=W(()=>Number(S.score.value||0)),E=W(()=>{let ne=0;return O.forEach((se,de)=>{$.value>=se.threshold&&(ne=de)}),ne}),Y=W(()=>O[E.value]),N=W(()=>O[E.value+1]||null),D=W(()=>{var ne,se,de,Ae;return((se=(ne=Y.value)==null?void 0:ne.title)==null?void 0:se[w.value])||((Ae=(de=Y.value)==null?void 0:de.title)==null?void 0:Ae.en)||""}),m=W(()=>{if(!N.value)return 1;const ne=N.value.threshold-Y.value.threshold;return ne<=0?1:Math.min(1,($.value-Y.value.threshold)/ne)}),v=new Intl.NumberFormat("en-US",{maximumFractionDigits:0}),T=W(()=>v.format($.value));W(()=>{const ne=S.rank.value;return ne?`#${ne}`:"--"});const M=W(()=>{const ne=S.totalPlayers.value;return ne?v.format(ne):"--"}),U=W(()=>S.loading.value),P=W(()=>Math.round(m.value*100)),Q=W(()=>S.profileImage.value||null),Z=W(()=>(F.value||S.username.value||k.value||"P").trim().charAt(0).toUpperCase()||"P"),j=W(()=>U.value?"loading":`score-${$.value}`),R=z(0),I=z(!1);ge(m,ne=>{R.value=ne},{immediate:!0}),ge(()=>S.score.value,(ne,se)=>{se==null||Number(ne)===Number(se)||(I.value=!1,requestAnimationFrame(()=>{I.value=!0,setTimeout(()=>{I.value=!1},720)}))});function V(){Ee("/scores")}const X={};a.forEach(ne=>{ne.challenges.forEach(se=>{X[se.id]=se.component})});const L={scores:ud,settings:qd},w=z(localStorage.getItem("ml_lang")||"ar"),_=W(()=>w.value==="ar"?"rtl":"ltr"),u={ar:{challenges:"المستوى الأول",challenges2:"المستوى الثاني",myScores:"درجاتي",settings:"الإعدادات",logout:"خروج",hello:"مرحبًا",sub:"اختر تحديًا وابدأ اللعب!",challenge:"التحدي",brand:"زعماء الرياضيات",tagline:"رحلة إنجاز رقمية",pickPrompt:"اختر تحديًا من البطاقات أدناه للبدء.",cardCTA:"ابدأ التحدي",scoreWidgetTitle:"نقاطي",scoreWidgetSubtitle:"نظرة سريعة على تقدّمك",scoreWidgetRank:"الترتيب",scoreWidgetPlayers:"عدد اللاعبين",scoreWidgetProgress:"نحو الرتبة التالية",scoreWidgetView:"عرض التفاصيل",scoreWidgetLoading:"جار تحديث النقاط...",teacherTitle:"الشريك التربوي",teacherSubtitle:"ميعاد سفر المالكي",teacherMessage:"✨ “من هنا بدأت الرحلة… رحلة شغف صاغتها الأستاذة ميعاد سفر المالكي لتلهم طلابها نحو الإبداع والتفكير."},en:{challenges:"Level One",challenges2:"Level Two",myScores:"My Scores",settings:"Settings",logout:"Log out",hello:"Hello",sub:"Pick a challenge and start!",challenge:"Challenge",brand:"Math Leaders",tagline:"Interactive mastery journey",pickPrompt:"Select a challenge from the cards below to get started.",cardCTA:"Start challenge",scoreWidgetTitle:"My points",scoreWidgetSubtitle:"Quick glance at your progress",scoreWidgetRank:"Rank",scoreWidgetPlayers:"Players",scoreWidgetProgress:"To next tier",scoreWidgetView:"View details",scoreWidgetLoading:"Refreshing score...",teacherTitle:"Presented by",teacherSubtitle:"Miyaad Safar Al-Malki",teacherMessage:"A heartfelt thanks to Ms. Miyaad Safar Al-Malki for curating these inspiring challenges."}},f=ne=>u[w.value][ne],x=W(()=>l.view||"");ge(w,ne=>{localStorage.setItem("ml_lang",ne),document.documentElement.dir=_.value,document.documentElement.lang=ne});const b=z(localStorage.getItem("ml_theme")||"light"),c=z(!1),p=z(!1),y=z([]);function B(ne){document.documentElement.setAttribute("data-ml-theme",ne)}let d=null;function s(){c.value=!0,window.clearTimeout(s.timer),s.timer=window.setTimeout(()=>{c.value=!1},360)}function o(ne){y.value=y.value.filter(se=>se.id!==ne)}function i(){s(),w.value=w.value==="ar"?"en":"ar"}function g(){s(),b.value=b.value==="light"?"dark":"light"}ge(b,ne=>{localStorage.setItem("ml_theme",ne),B(ne)});function q(){if(typeof window=="undefined")return;const ne=window.matchMedia("(max-width: 1024px)").matches;p.value=ne,ne||(ce.value=!1)}function C(ne){oe.value&&(oe.value.contains(ne.target)||(ae.value=!1))}async function h(ne,se={}){const de=new URLSearchParams(se).toString(),Ae=await fetch(ne+(de?`?${de}`:""),{method:"GET",credentials:"include"}),Ge=await Ae.json().catch(()=>({}));if(!Ae.ok)throw Ge;return Ge}const k=z("player"),F=z("");async function G(){try{const ne=await h("/api/method/mathematics_leaders.api.get_my_details.get_me"),se=ne==null?void 0:ne.message;if(!(se!=null&&se.ok)){A.replace("/");return}const de=se.profile||{};k.value=de.username||"player",F.value=de.full_name||"",de.language&&!localStorage.getItem("ml_lang")&&(w.value=de.language)}catch{A.replace("/")}}const ae=z(!1),oe=z(null),ce=z(!1),be=ve(Object.fromEntries(a.map(ne=>[ne.id,!1]))),he=z(((ot=a[0])==null?void 0:ot.id)||"level1"),pe=z(null);function Te(){ce.value=!ce.value}function Ee(ne){A.push(ne)}async function Ue(){await h("/api/method/logout"),A.replace("/")}function Mt(ne){be[ne]=!be[ne]}function lt(ne){return!!be[ne]}function Lt(ne,se){be[ne]=!0,he.value=ne,pe.value=se,p.value&&(ce.value=!0),A.currentRoute.value.path!=="/home"&&A.push("/home")}function Nt(ne,se){return he.value===ne&&pe.value===se}const Be=W(()=>{if(l.view&&L[l.view])return{level:null,challenge:null};if(!pe.value)return{level:a.find(se=>se.id===he.value)||null,challenge:null};for(const ne of a){const se=ne.challenges.find(de=>de.id===pe.value);if(se)return{level:ne,challenge:se}}return{level:a.find(ne=>ne.id===he.value)||null,challenge:null}}),st=W(()=>{if(l.view&&L[l.view])return L[l.view];const ne=pe.value;return ne?X[ne]:null});_e(()=>{document.documentElement.dir=_.value,document.documentElement.lang=w.value,B(b.value),G(),S.refresh(),q(),p.value&&(ce.value=!0),typeof window!="undefined"&&window.addEventListener("resize",q),document.addEventListener("click",C),d=Nu(ne=>{const se=ne.detail||{};if(!se.message)return;const de={id:se.id||Math.random().toString(36).slice(2),message:se.message,type:se.type||"info"};y.value.push(de),y.value.length>4&&y.value.shift();const Ae=Math.max(1500,se.duration||2600);window.setTimeout(()=>o(de.id),Ae)})}),tt(()=>{d&&d(),window.clearTimeout(s.timer),typeof window!="undefined"&&window.removeEventListener("resize",q),document.removeEventListener("click",C)});const Pt=new URL("/assets/mathematics_leaders/frontend/assets/logo3.jpeg",import.meta.url).href;return(ne,se)=>(n(),r("div",{class:re(["dashboard",b.value,{transitioning:c.value}]),dir:_.value},[se[7]||(se[7]=Ye('<div class="dashboard__background" aria-hidden="true" data-v-7999c0c0><span class="glow glow-one" data-v-7999c0c0></span><span class="glow glow-two" data-v-7999c0c0></span><span class="glow glow-three" data-v-7999c0c0></span><span class="mesh" data-v-7999c0c0></span></div>',1)),H(Bt,{name:"toast-fade",tag:"div",class:"toasts","aria-live":"polite"},{default:ke(()=>[(n(!0),r(te,null,le(y.value,de=>(n(),r("div",{key:de.id,class:re(["toast",de.type])},[se[2]||(se[2]=e("span",{class:"toast__dot"},null,-1)),e("p",null,t(de.message),1),e("button",{type:"button",class:"toast__close",onClick:Ae=>o(de.id)},"×",8,Hd)],2))),128))]),_:1}),e("header",Vd,[e("div",Gd,[p.value?(n(),r("button",{key:0,class:"topbar__menu",type:"button",onClick:Te,"aria-expanded":!ce.value,"aria-label":ce.value?w.value==="ar"?"فتح قائمة التحديات":"Open challenges":w.value==="ar"?"إخفاء قائمة التحديات":"Hide challenges"},[ce.value?(n(),De(K(en),{key:0})):(n(),De(K(Ya),{key:1,style:ue({transform:_.value==="rtl"?"scaleX(-1)":""})},null,8,["style"]))],8,Wd)):ie("",!0),e("div",Kd,[e("div",Yd,[e("img",{src:K(Pt),alt:"logo"},null,8,Jd)]),e("div",Xd,[e("span",Zd,t(u[w.value].brand),1),e("span",ev,t(u[w.value].tagline),1)])])]),e("div",tv,[H(K(Xa),{class:"wave"}),e("div",av,[e("h1",null,t(u[w.value].hello)+" "+t(F.value||k.value),1),e("p",null,t(f("sub")),1)])]),e("div",nv,[e("button",{class:"action-btn",type:"button","aria-label":b.value==="dark"?w.value==="ar"?"التبديل إلى الوضع الفاتح":"Switch to light theme":w.value==="ar"?"التبديل إلى الوضع الداكن":"Switch to dark theme",onClick:g},[b.value==="light"?(n(),De(K(sn),{key:0})):(n(),De(K(tn),{key:1}))],8,lv),e("button",{class:"action-btn",type:"button","aria-label":w.value==="ar"?"Switch to English":"التبديل إلى العربية",onClick:i},t(w.value==="ar"?"EN":"ع"),9,sv),e("div",{class:"profile",ref_key:"profileRef",ref:oe,onClick:se[1]||(se[1]=Ve(de=>ae.value=!ae.value,["stop"]))},[e("div",ov,[Q.value?(n(),r("span",{key:0,class:"avatar__image",style:ue({backgroundImage:`url(${Q.value})`})},null,4)):(n(),r("span",rv,t(Z.value),1))]),e("div",iv,[e("span",cv,t(F.value||k.value),1),e("span",uv,t(u[w.value].brand),1)]),H(K(dt),{class:re(["profile__chevron",{open:ae.value}])},null,8,["class"]),H($e,{name:"fade"},{default:ke(()=>[ae.value?(n(),r("ul",dv,[e("li",null,[e("button",{type:"button",onClick:se[0]||(se[0]=de=>Ee("/settings"))},[H(K(an)),se[3]||(se[3]=J()),e("span",null,t(u[w.value].settings),1)])]),e("li",null,[e("button",{type:"button",class:"danger",onClick:Ue},[H(K(ft)),se[4]||(se[4]=J()),e("span",null,t(u[w.value].logout),1)])])])):ie("",!0)]),_:1})],512)])]),e("main",vv,[e("section",hv,[e("article",pv,[e("div",fv,[H(K(ht))]),e("div",mv,[e("h2",null,t(u[w.value].brand),1),e("p",null,t(u[w.value].pickPrompt),1)]),e("div",gv,[e("div",_v,[e("span",yv,t(u[w.value].scoreWidgetRank),1),e("strong",null,t(ne.scoreRankDisplay),1)]),e("div",bv,[e("span",kv,t(u[w.value].scoreWidgetPlayers),1),e("strong",null,t(M.value),1)])])]),e("article",{class:re(["score-card",{loading:U.value,pulse:I.value}]),"aria-busy":U.value},[U.value?(n(),r("div",$v,[H(K(qe),{class:"overlay-spinner"})])):ie("",!0),e("div",Cv,[(n(),r("svg",xv,[se[5]||(se[5]=e("defs",null,[e("linearGradient",{id:"dashboardScoreGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"#c6a034"}),e("stop",{offset:"100%","stop-color":"#0f8a3e"})])],-1)),se[6]||(se[6]=e("circle",{class:"ring-bg",cx:"60",cy:"60",r:"52"},null,-1)),e("circle",{class:"ring-fg",cx:"60",cy:"60",r:"52",stroke:"url(#dashboardScoreGradient)",style:ue({"--progress":R.value})},null,4)])),e("div",Sv,[H($e,{name:"score-flip",mode:"out-in"},{default:ke(()=>[(n(),r("span",{class:"score-card__points",key:j.value},t(U.value?"...":T.value),1))]),_:1}),e("small",null,t(u[w.value].scoreWidgetTitle),1)])]),e("div",Av,[e("span",Dv,t(D.value),1),e("p",Tv,t(U.value?u[w.value].scoreWidgetLoading:u[w.value].scoreWidgetSubtitle),1),e("div",{class:"progress",role:"progressbar","aria-valuenow":P.value,"aria-valuemin":"0","aria-valuemax":"100"},[e("div",Lv,[e("div",{class:"progress__fill",style:ue({"--progress":R.value})},null,4)]),e("div",Nv,[e("span",null,t(P.value)+"%",1),e("button",{type:"button",class:"progress__link",onClick:V},t(u[w.value].scoreWidgetView),1)])],8,Mv)])],10,wv),e("article",Pv,[e("div",Ev,t(u[w.value].teacherTitle),1),e("h3",null,t(u[w.value].teacherSubtitle),1),e("p",null,t(u[w.value].teacherMessage),1)])]),e("section",zv,[e("aside",{class:re(["challenge-list",{collapsed:ce.value&&p.value}])},[e("header",Bv,[e("h2",null,t(u[w.value].challenge),1),e("p",null,t(u[w.value].pickPrompt),1)]),e("div",Ov,[(n(),r(te,null,le(a,de=>e("div",{class:"level-block",key:de.id},[e("button",{type:"button",class:"level-head",onClick:Ae=>Mt(de.id)},[e("div",Rv,[H(K(bt),{class:"level-head__icon"}),e("span",Iv,t(de.label[w.value]),1)]),e("span",Fv,t(de.challenges.length),1),H(K(dt),{class:re(["level-head__chevron",{open:lt(de.id)}])},null,8,["class"])],8,jv),H($e,{name:"fade"},{default:ke(()=>[lt(de.id)?(n(),r("div",Uv,[(n(!0),r(te,null,le(de.challenges,Ae=>(n(),r("button",{key:Ae.id,type:"button",class:re(["challenge-card",{active:Nt(de.id,Ae.id)}]),onClick:Ge=>Lt(de.id,Ae.id)},[e("span",Qv,t(Ae.symbol),1),e("div",Hv,[e("span",Vv,t(Ae.label[w.value]),1),e("p",Gv,t(Ae.summary[w.value]),1)]),e("span",Wv,t(u[w.value].cardCTA),1)],10,qv))),128))])):ie("",!0)]),_:2},1024)])),64))]),e("div",Kv,[e("button",{type:"button",class:"logout-btn",onClick:Ue},[H(K(ft)),e("span",null,t(u[w.value].logout),1)])])],2),e("div",Yv,[e("div",Jv,[Be.value.level?(n(),r("span",Xv,t(Be.value.level.label[w.value]),1)):ie("",!0),e("div",Zv,[x.value==="scores"?(n(),r("h3",eh,t(u[w.value].myScores),1)):x.value==="settings"?(n(),r("h3",th,t(u[w.value].settings),1)):Be.value.challenge?(n(),r("h3",ah,t(Be.value.challenge.label[w.value]),1)):(n(),r("h3",nh,t(u[w.value].brand),1)),Be.value.challenge?(n(),r("p",lh,t(Be.value.challenge.summary[w.value]),1)):x.value==="scores"?(n(),r("p",sh,t(u[w.value].scoreWidgetSubtitle),1)):x.value==="settings"?(n(),r("p",oh,t(u[w.value].settings),1)):(n(),r("p",rh,t(u[w.value].pickPrompt),1))])]),e("div",ih,[H($e,{name:"preview-fade",mode:"out-in"},{default:ke(()=>{var de;return[st.value?(n(),De(je(st.value),jt({key:x.value||((de=Be.value.challenge)==null?void 0:de.id)||"welcome",class:"preview-component"},{lang:w.value,theme:b.value}),null,16)):(n(),r("div",ch,[H(K(ht)),e("p",null,t(u[w.value].pickPrompt),1)]))]}),_:1})])])])])],10,Qd))}},dh=me(uh,[["__scopeId","data-v-7999c0c0"]]),vh=Rt({history:It("/math-leaders-games/"),routes:[{path:"/",redirect:"/login"},{path:"/login",component:qa},{path:"/home",component:dh},{path:"/scores",component:()=>it(()=>import("./ScoresView.js"),__vite__mapDeps([0,1]))},{path:"/settings",component:()=>it(()=>import("./SettingsView.js"),__vite__mapDeps([2,1]))}]});Ft(Ht).use(vh).mount("#app");export{dh as D};
//# sourceMappingURL=platform.js.map
