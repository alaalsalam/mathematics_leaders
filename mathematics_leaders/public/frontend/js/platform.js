const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/ScoresView.js","js/vue.js","js/SettingsView.js"])))=>i.map(i=>d[i]);
import{r as Pt,c as o,o as n,a as U,b as B,d as q,w as me,e as ge,f as Ye,g as e,t,u as Q,F as te,h as le,i as re,n as oe,j as ye,T as ke,k as We,l as De,v as Me,m as K,p as Xe,q as pe,s as Se,x as Re,y as de,z as Et,A as tt,B as zt,C as Rt,D as Ot,E as jt,G as It,H as Ft}from"./vue.js";(function(){const D=document.createElement("link").relList;if(D&&D.supports&&D.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))a(x);new MutationObserver(x=>{for(const P of x)if(P.type==="childList")for(const b of P.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&a(b)}).observe(document,{childList:!0,subtree:!0});function l(x){const P={};return x.integrity&&(P.integrity=x.integrity),x.referrerPolicy&&(P.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?P.credentials="include":x.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function a(x){if(x.ep)return;x.ep=!0;const P=l(x);fetch(x.href,P)}})();const fe=(ee,D)=>{const l=ee.__vccOpts||ee;for(const[a,x]of D)l[a]=x;return l},Ut={},qt={class:"p-6"};function Qt(ee,D){const l=Pt("RouterView");return n(),o("main",qt,[U(l)])}const Ht=fe(Ut,[["render",Qt]]),Wt="modulepreload",Gt=function(ee){return"/assets/mathematics_leaders/frontend/"+ee},rt={},it=function(D,l,a){let x=Promise.resolve();if(l&&l.length>0){let V=function(M){return Promise.all(M.map(A=>Promise.resolve(A).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const b=document.querySelector("meta[property=csp-nonce]"),L=(b==null?void 0:b.nonce)||(b==null?void 0:b.getAttribute("nonce"));x=V(l.map(M=>{if(M=Gt(M),M in rt)return;rt[M]=!0;const A=M.endsWith(".css"),m=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${M}"]${m}`))return;const h=document.createElement("link");if(h.rel=A?"stylesheet":Wt,A||(h.as="script"),h.crossOrigin="",h.href=M,L&&h.setAttribute("nonce",L),document.head.appendChild(h),A)return new Promise((S,T)=>{h.addEventListener("load",S),h.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${M}`)))})}))}function P(b){const L=new Event("vite:preloadError",{cancelable:!0});if(L.payload=b,window.dispatchEvent(L),!L.defaultPrevented)throw b}return x.then(b=>{for(const L of b||[])L.status==="rejected"&&P(L.reason);return D().catch(P)})},Vt=["dir"],Kt={class:"floating-controls"},Yt=["aria-label"],Xt={class:"control-icon","aria-hidden":"true"},Jt={key:0,viewBox:"0 0 24 24",focusable:"false"},Zt={key:1,viewBox:"0 0 24 24",focusable:"false"},ea={class:"control-text"},ta=["aria-label"],aa={class:"landing__wrapper"},la={class:"landing__intro"},na={class:"logo-card"},sa=["src"],oa={class:"intro__title"},ra={class:"intro__subtitle"},ia={class:"feature-grid"},ca={class:"feature-index"},ua={class:"feature-text"},da={class:"stats-row"},va={class:"stat-value"},ha={class:"stat-label"},pa={class:"landing__auth"},fa={class:"auth-card"},ma={class:"auth-tabs",role:"tablist"},ga=["aria-selected"],_a=["aria-selected"],ya={class:"input-field"},ba=["for"],ka=["id","placeholder"],wa={class:"input-field"},$a=["for"],Ca=["id","placeholder"],xa={class:"form-meta"},Ta={href:"#"},Aa=["disabled"],Sa={class:"switch-text"},Da={class:"input-field"},Ma=["for"],La=["id","placeholder"],Ba={class:"input-field"},Na=["for"],Pa=["id","placeholder"],Ea={class:"input-field"},za=["for"],Ra=["id","placeholder"],Oa=["disabled"],ja={class:"switch-text"},Ia={key:0,class:"auth-notice"},Fa="",Ua={__name:"Index",setup(ee){const D=B(localStorage.getItem("ml_lang")||"ar"),l=q(()=>D.value==="ar"?"rtl":"ltr"),a=p=>({en:{signin:"Sign In",signup:"Create Account",username:"Username",password:"Password",confirm:"Confirm Password",login:"Login",register:"Signup",toSignup:"Create account",toSignin:"Back to login",forgot:"Forgot password?"},ar:{signin:"تسجيل الدخول",signup:"إنشاء حساب",username:"اسم المستخدم",password:"كلمة المرور",confirm:"تأكيد كلمة المرور",login:"دخول",register:"تسجيل",toSignup:"إنشاء حساب",toSignin:"العودة لتسجيل الدخول",forgot:"نسيت كلمة المرور؟"}})[D.value][p],x=q(()=>D.value==="ar");function P(){D.value=x.value?"en":"ar"}const b=B(localStorage.getItem("ml_theme")||"light"),L=q(()=>b.value==="dark"),V=q(()=>x.value?L.value?"فاتح":"داكن":L.value?"Light":"Dark"),M=q(()=>x.value?L.value?"التبديل إلى الوضع الفاتح":"التبديل إلى الوضع الداكن":L.value?"Switch to light theme":"Switch to dark theme");function A(){b.value=L.value?"light":"dark"}function m(p){document.documentElement.setAttribute("data-ml-theme",p)}me(D,p=>{localStorage.setItem("ml_lang",p),document.documentElement.dir=l.value,document.documentElement.lang=p}),me(b,p=>{localStorage.setItem("ml_theme",p),m(p)}),ge(()=>{document.documentElement.dir=l.value,document.documentElement.lang=D.value,m(b.value)});const h=B(!1),S=B({username:"",password:""}),T=B({username:"",password:"",confirm:""}),F=B(!1),N=B(null);me(h,()=>{N.value=null});const G=new URL("/assets/mathematics_leaders/frontend/assets/logo3.jpeg",import.meta.url).href,J=q(()=>x.value?"منصة زعماء الرياضيات":"Mathematics Leaders Platform"),I=q(()=>x.value?"تعلم الرياضيات بأسلوب ممتع وتفاعلي مصمم للقادة الصغار.":"Master mathematics with playful, interactive journeys built for young leaders."),R=q(()=>x.value?["برامج تفاعلية مدعومة بالذكاء الاصطناعي","تتبع تقدّم ذكي ومباشر","مجتمع محفّز من المعلمين والطلاب"]:["Interactive, AI-guided programmes","Real-time progress insights","A supportive teacher & student community"]),z=q(()=>x.value?[{value:"12+",label:"وحدة تعليمية متدرجة"},{value:"4K",label:"طالب نشط"},{value:"92%",label:"نسبة إكمال المهام"}]:[{value:"12+",label:"Adaptive learning tracks"},{value:"4K",label:"Active learners"},{value:"92%",label:"Task completion rate"}]);async function W(p,c={}){const d=new URLSearchParams(c).toString(),w=await fetch(Fa+p+(d?`?${d}`:""),{method:"GET",credentials:"include"}),_=await w.json().catch(()=>({}));if(!w.ok)throw _;return _}function Y(p){if(typeof p=="string")return p;if(p!=null&&p._server_messages)try{const c=JSON.parse(p._server_messages),d=(c==null?void 0:c[0])&&JSON.parse(c[0]);return(d==null?void 0:d.message)||(d==null?void 0:d._error_message)||"Invalid Request"}catch{}return(p==null?void 0:p.message)||(p==null?void 0:p.exc)||"Invalid Request"}function j(p){const c=p||{username:S.value.username};localStorage.setItem("ml_profile",JSON.stringify({...c,language:D.value})),window.location.href="/math-leaders-games/#/home"}async function k(){var p,c;F.value=!0,N.value=null;try{if(h.value){if(!T.value.username||!T.value.password||!T.value.confirm)throw{message:x.value?"الرجاء ملء كل الحقول.":"Please fill all fields."};if(T.value.password!==T.value.confirm)throw{message:x.value?"كلمتا المرور غير متطابقتين.":"Passwords do not match."};await W("/api/method/mathematics_leaders.api.signup_and_login.signup_user",{username:T.value.username,password:T.value.password,language:D.value});const d=await W("/api/method/mathematics_leaders.api.signup_and_login.verify_login",{usr:T.value.username,pwd:T.value.password});j(((p=d==null?void 0:d.message)==null?void 0:p.profile)||{username:T.value.username})}else{const d=await W("/api/method/mathematics_leaders.api.signup_and_login.verify_login",{usr:S.value.username,pwd:S.value.password});j(((c=d==null?void 0:d.message)==null?void 0:c.profile)||{username:S.value.username})}}catch(d){N.value=Y(d)}finally{F.value=!1}}return(p,c)=>(n(),o("section",{class:oe(["landing",b.value]),dir:l.value},[c[11]||(c[11]=Ye('<div class="background" aria-hidden="true" data-v-9ae221db><span class="glow glow-one" data-v-9ae221db></span><span class="glow glow-two" data-v-9ae221db></span><span class="glow glow-three" data-v-9ae221db></span><span class="grid" data-v-9ae221db></span></div>',1)),e("div",Kt,[e("button",{type:"button",class:"control-btn theme-toggle","aria-label":M.value,onClick:A},[e("span",Xt,[L.value?(n(),o("svg",Jt,[...c[9]||(c[9]=[Ye('<circle cx="12" cy="12" r="4.2" fill="none" stroke="currentColor" stroke-width="1.6" data-v-9ae221db></circle><line x1="12" y1="2.4" x2="12" y2="5.4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="12" y1="18.6" x2="12" y2="21.6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="2.4" y1="12" x2="5.4" y2="12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="18.6" y1="12" x2="21.6" y2="12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="5.4" y1="5.4" x2="7.7" y2="7.7" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="16.3" y1="16.3" x2="18.6" y2="18.6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="5.4" y1="18.6" x2="7.7" y2="16.3" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="16.3" y1="7.7" x2="18.6" y2="5.4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line>',9)])])):(n(),o("svg",Zt,[...c[10]||(c[10]=[e("path",{d:"M15.8 21.2a7.6 7.6 0 0 1-6.9-10.6 6.9 6.9 0 0 0 8.5 8.5 7.6 7.6 0 0 1-1.6 2.1Z",fill:"none",stroke:"currentColor","stroke-width":"1.6","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))]),e("span",ea,t(V.value),1)],8,Yt),e("button",{type:"button",class:"control-btn lang-toggle","aria-label":x.value?"Switch to English":"التبديل إلى العربية",onClick:P},[e("span",null,t(x.value?"EN":"ع"),1)],8,ta)]),e("div",aa,[e("div",la,[e("div",na,[e("img",{src:Q(G),alt:"شعار زعماء الرياضيات"},null,8,sa)]),e("h1",oa,t(J.value),1),e("p",ra,t(I.value),1),e("ul",ia,[(n(!0),o(te,null,le(R.value,(d,w)=>(n(),o("li",{key:w,class:"feature-item"},[e("span",ca,"0"+t(w+1),1),e("span",ua,t(d),1)]))),128))]),e("div",da,[(n(!0),o(te,null,le(z.value,(d,w)=>(n(),o("div",{key:w,class:"stat-card"},[e("span",va,t(d.value),1),e("span",ha,t(d.label),1)]))),128))])]),e("div",pa,[e("div",fa,[e("div",ma,[e("button",{type:"button",class:oe(["tab-btn",{active:!h.value}]),role:"tab","aria-selected":!h.value,onClick:c[0]||(c[0]=d=>h.value=!1)},t(a("signin")),11,ga),e("button",{type:"button",class:oe(["tab-btn",{active:h.value}]),role:"tab","aria-selected":h.value,onClick:c[1]||(c[1]=d=>h.value=!0)},t(a("signup")),11,_a)]),U(ke,{name:"slide-fade",mode:"out-in"},{default:ye(()=>[h.value?(n(),o("form",{key:"signup",class:"auth-form",onSubmit:We(k,["prevent"])},[e("div",Da,[e("label",{for:x.value?"signup-username-ar":"signup-username-en"},t(a("username")),9,Ma),De(e("input",{id:x.value?"signup-username-ar":"signup-username-en","onUpdate:modelValue":c[5]||(c[5]=d=>T.value.username=d),type:"text",placeholder:a("username"),autocomplete:"username",required:""},null,8,La),[[Me,T.value.username]])]),e("div",Ba,[e("label",{for:x.value?"signup-password-ar":"signup-password-en"},t(a("password")),9,Na),De(e("input",{id:x.value?"signup-password-ar":"signup-password-en","onUpdate:modelValue":c[6]||(c[6]=d=>T.value.password=d),type:"password",placeholder:a("password"),autocomplete:"new-password",required:""},null,8,Pa),[[Me,T.value.password]])]),e("div",Ea,[e("label",{for:x.value?"signup-confirm-ar":"signup-confirm-en"},t(a("confirm")),9,za),De(e("input",{id:x.value?"signup-confirm-ar":"signup-confirm-en","onUpdate:modelValue":c[7]||(c[7]=d=>T.value.confirm=d),type:"password",placeholder:a("confirm"),autocomplete:"new-password",required:""},null,8,Ra),[[Me,T.value.confirm]])]),e("button",{class:"primary-btn",type:"submit",disabled:F.value},[e("span",null,t(a("register")),1)],8,Oa),e("p",ja,[K(t(x.value?"لديك حساب بالفعل؟":"Already have an account?")+" ",1),e("button",{type:"button",onClick:c[8]||(c[8]=d=>h.value=!1)},t(a("toSignin")),1)])],32)):(n(),o("form",{key:"signin",class:"auth-form",onSubmit:We(k,["prevent"])},[e("div",ya,[e("label",{for:x.value?"signin-username-ar":"signin-username-en"},t(a("username")),9,ba),De(e("input",{id:x.value?"signin-username-ar":"signin-username-en","onUpdate:modelValue":c[2]||(c[2]=d=>S.value.username=d),type:"text",placeholder:a("username"),autocomplete:"username",required:""},null,8,ka),[[Me,S.value.username]])]),e("div",wa,[e("label",{for:x.value?"signin-password-ar":"signin-password-en"},t(a("password")),9,$a),De(e("input",{id:x.value?"signin-password-ar":"signin-password-en","onUpdate:modelValue":c[3]||(c[3]=d=>S.value.password=d),type:"password",placeholder:a("password"),autocomplete:"current-password",required:""},null,8,Ca),[[Me,S.value.password]])]),e("div",xa,[e("a",Ta,t(a("forgot")),1)]),e("button",{class:"primary-btn",type:"submit",disabled:F.value},[e("span",null,t(a("login")),1)],8,Aa),e("p",Sa,[K(t(x.value?"لا تملك حساباً؟":"Don't have an account?")+" ",1),e("button",{type:"button",onClick:c[4]||(c[4]=d=>h.value=!0)},t(a("toSignup")),1)])],32))]),_:1}),N.value?(n(),o("p",Ia,t(N.value),1)):re("",!0)])])])],10,Vt))}},qa=fe(Ua,[["__scopeId","data-v-9ae221db"]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=ee=>ee.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Qa=ee=>ee.replace(/^([A-Z])|[\s-_]+(\w)/g,(D,l,a)=>a?a.toUpperCase():l.toLowerCase()),Ha=ee=>{const D=Qa(ee);return D.charAt(0).toUpperCase()+D.slice(1)},Wa=(...ee)=>ee.filter((D,l,a)=>!!D&&D.trim()!==""&&a.indexOf(D)===l).join(" ").trim(),ut=ee=>ee==="";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var je={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=({name:ee,iconNode:D,absoluteStrokeWidth:l,"absolute-stroke-width":a,strokeWidth:x,"stroke-width":P,size:b=je.width,color:L=je.stroke,...V},{slots:M})=>Xe("svg",{...je,...V,width:b,height:b,stroke:L,"stroke-width":ut(l)||ut(a)||l===!0||a===!0?Number(x||P||je["stroke-width"])*24/Number(b):x||P||je["stroke-width"],class:Wa("lucide",V.class,...ee?[`lucide-${ct(Ha(ee))}-icon`,`lucide-${ct(ee)}`]:["lucide-icon"])},[...D.map(A=>Xe(...A)),...M.default?[M.default()]:[]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=(ee,D)=>(l,{slots:a,attrs:x})=>Xe(Ga,{...x,...l,iconNode:D,name:ee},a);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=he("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=he("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=he("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=he("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=he("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=he("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=he("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=he("diamond",[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=he("eraser",[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=he("hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=he("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=he("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=he("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=he("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=he("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=he("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=he("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=he("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=he("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=he("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ll=he("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=he("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=he("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=he("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ol=he("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=he("triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=he("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),kt="/assets/mathematics_leaders/frontend/assets/success.mp3",$e="/assets/mathematics_leaders/frontend/assets/clap.mp3",at="/assets/mathematics_leaders/frontend/assets/wrong.mp3",cl=["dir","data-theme"],ul={class:"hdr"},dl={class:"sub"},vl={class:"board"},hl={class:"assign",dir:"ltr"},pl=["onDrop"],fl={class:"actions"},ml=["disabled"],gl={class:"col-sum",dir:"ltr"},_l={class:"row"},yl={key:0},bl={class:"row"},kl={key:0},wl={class:"row"},$l={key:0},Cl={class:"digits",dir:"ltr"},xl={class:"tiles"},Tl=["onDragstart"],Al={key:0,class:"overlay"},Sl={class:"sheet"},Dl={class:"big"},Ml={class:"toasts"},Ll={__name:"challenge_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l=B(D.lang),a=B(D.theme);me(()=>D.lang,$=>l.value=$),me(()=>D.theme,$=>a.value=$);async function x($,E={}){const v=new URLSearchParams(E).toString(),s=await fetch($+(v?`?${v}`:""),{method:"GET",credentials:"include"}),r=await s.json().catch(()=>({}));if(!s.ok)throw r;return r}const P=q(()=>l.value==="ar"?"rtl":"ltr"),b={ar:{title:"التحدي 1: عملية جمع عمودية بأرقام مفقودة (رموز)",subtitle:"اسحب الأرقام وضعها مكان الرموز حتى تكتمل العملية.",digits:"الأرقام",check:"تحقق",reset:"إعادة ضبط",newQ:"سؤال جديد",correctBig:"أحسنت!",correctSub:"حل صحيح 👏 لقد كسبت نقطة.",wrong:"حاول مرة أخرى 🤔"},en:{title:"Challenge 1: Column addition with missing (symbol) digits",subtitle:"Drag digits onto symbols until the addition becomes correct.",digits:"Digits",check:"Check",reset:"Reset",newQ:"New Question",correctBig:"Great!",correctSub:"Correct 👏 You earned a point.",wrong:"Try again 🤔"}},L=$=>b[l.value][$],V=new Audio(kt),M=new Audio($e),A=new Audio(at);V.preload="auto",M.preload="auto",A.preload="auto";const m={circle:vt,square:nl,triangle:rl,diamond:Xa},h=["circle","square","triangle","diamond"],S=$=>m[$]||vt;function T($,E){return $+Math.floor(Math.random()*(E-$+1))}function F($){return $.slice().sort(()=>Math.random()-.5)}const N=pe({aStr:"",bStr:"",sStr:"",hiddenMap:{},assignMap:{},usedShapes:[]}),G=B([]),J=B([]),I=B([]);function R(){const $=T(2,3),E=T(2,3),v=T(10**($-1),10**$-1),s=T(10**(E-1),10**E-1),r=v+s;N.aStr=String(v),N.bStr=String(s),N.sStr=String(r);const i=Array.from(new Set((N.aStr+N.bStr+N.sStr).split("").map(Z=>+Z))),y=Math.min(T(2,3),i.length),g=F(i).slice(0,y),C=F(h).slice(0,y);N.hiddenMap={},g.forEach((Z,X)=>{N.hiddenMap[C[X]]=Z});const O=new Set;function H(Z){return Z.split("").map(X=>{var ue;const se=+X,ie=(ue=Object.entries(N.hiddenMap).find(([Te,ve])=>ve===se))==null?void 0:ue[0];return ie?(O.add(ie),{t:"shape",v:ie}):{t:"digit",v:X}})}G.value=H(N.aStr),J.value=H(N.bStr),I.value=H(N.sStr),N.usedShapes=Array.from(O),N.assignMap=Object.fromEntries(N.usedShapes.map(Z=>[Z,null])),N.usedShapes.length===0&&R()}function z($,E){$.dataTransfer.setData("text/plain",String(E))}function W($,E){const v=Number($.dataTransfer.getData("text/plain"));Number.isNaN(v)||Object.values(N.assignMap).includes(v)&&N.assignMap[E]!==v||(N.assignMap[E]=v,w())}function Y($){$.preventDefault()}function j(){Object.keys(N.assignMap).forEach($=>N.assignMap[$]=null)}const k=q(()=>N.usedShapes.every($=>Number.isInteger(N.assignMap[$])));function p($){return Number($.map(E=>{var v;return E.t==="digit"?E.v:(v=N.assignMap[E.v])!=null?v:"?"}).join(""))}function c(){if(!k.value)return!1;const $=p(G.value),E=p(J.value),v=p(I.value);return![$,E,v].some(s=>String(s).includes("?"))&&$+E===v}const d=pe({open:!1,good:!0});async function w(){if(k.value)if(c()){try{V.currentTime=0,V.play().catch(()=>{})}catch{}try{M.currentTime=0,M.play().catch(()=>{})}catch{}d.open=!0,d.good=!0,x("/api/method/mathematics_leaders.api.game_points.add_point",{amount:1}).catch(()=>{})}else{try{A.currentTime=0,A.play().catch(()=>{})}catch{}f(L("wrong"),"warn")}}function _(){d.open=!1,R()}const u=B([]);function f($,E="ok"){const v=Math.random().toString(36).slice(2);u.value.push({id:v,msg:$,type:E}),setTimeout(()=>u.value=u.value.filter(s=>s.id!==v),1800)}return ge(()=>R()),($,E)=>(n(),o("section",{class:"wrap challenge-surface",dir:P.value,"data-theme":a.value},[e("header",ul,[e("h2",null,t(L("title")),1),e("p",dl,t(L("subtitle")),1)]),e("div",vl,[e("div",hl,[(n(!0),o(te,null,le(N.usedShapes,v=>(n(),o("div",{key:v,class:"slot",onDrop:s=>W(s,v),onDragover:Y},[(n(),Se(Re(S(v)),{class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}})),e("div",{class:oe(["val",{empty:N.assignMap[v]==null}])},t(N.assignMap[v]==null?"…":N.assignMap[v]),3)],40,pl))),128)),e("div",fl,[e("button",{class:"ghost",onClick:j},t(L("reset")),1),e("button",{class:"primary",disabled:!k.value,onClick:w},t(L("check")),9,ml),e("button",{class:"ghost",onClick:R},t(L("newQ")),1)])]),e("div",gl,[e("div",_l,[(n(!0),o(te,null,le(G.value,(v,s)=>(n(),o("span",{key:"a"+s,class:oe(["cell",v.t])},[v.t==="digit"?(n(),o("span",yl,t(v.v),1)):(n(),Se(Re(S(v.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))]),E[0]||(E[0]=e("div",{class:"row plus"},[e("span",null,"+")],-1)),e("div",bl,[(n(!0),o(te,null,le(J.value,(v,s)=>(n(),o("span",{key:"b"+s,class:oe(["cell",v.t])},[v.t==="digit"?(n(),o("span",kl,t(v.v),1)):(n(),Se(Re(S(v.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))]),E[1]||(E[1]=e("div",{class:"line"},null,-1)),e("div",wl,[(n(!0),o(te,null,le(I.value,(v,s)=>(n(),o("span",{key:"s"+s,class:oe(["cell",v.t])},[v.t==="digit"?(n(),o("span",$l,t(v.v),1)):(n(),Se(Re(S(v.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))])]),e("div",Cl,[e("h4",null,t(L("digits")),1),e("div",xl,[(n(),o(te,null,le(10,v=>e("button",{key:v-1,class:"tile",draggable:"true",onDragstart:s=>z(s,v-1)},t(v-1),41,Tl)),64))])])]),U(ke,{name:"fade"},{default:ye(()=>[d.open?(n(),o("div",Al,[e("div",Sl,[e("div",Dl,t(L("correctBig")),1),e("p",null,t(L("correctSub")),1),e("button",{class:"primary",onClick:_},t(L("newQ")),1)])])):re("",!0)]),_:1}),e("div",Ml,[(n(!0),o(te,null,le(u.value,v=>(n(),o("div",{key:v.id,class:oe(["toast",v.type])},t(v.msg),3))),128))])],8,cl))}},Bl=fe(Ll,[["__scopeId","data-v-9c65b80b"]]),Be="/assets/mathematics_leaders/frontend/assets/success2.mp3",Ne="/assets/mathematics_leaders/frontend/assets/wrong2.mp3",Nl=["data-theme"],Pl={class:"title"},El={class:"rule"},zl={class:"layout"},Rl={class:"grid"},Ol=["onDrop"],jl={key:1,class:"placeholder"},Il=["value","onInput","onChange","onBlur","placeholder"],Fl=["onClick"],Ul={class:"bank"},ql={class:"bank-title"},Ql={class:"bank-items"},Hl=["onDragstart"],Wl={class:"actions"},Gl={key:0,class:"overlay"},Vl={class:"card"},Kl={class:"big"},Yl={__name:"challenge_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 2: شبكة أعداد تزيد بمقدار {STEP}",rule:"كل خانة تزيد {STEP} عن اليسار وعن الأعلى. اسحب الأعداد المفقودة إلى أماكنها.",newQ:"سؤال جديد",check:"تحقّق",reset:"إعادة تعيين",correct:"إجابة صحيحة",wrong:"تحقق من القيم",bank:"لوحة الأعداد",clear:"تفريغ الخلية"},en:{title:"Challenge 2: Number grid with step {STEP}",rule:"Each cell increases by {STEP} from its left and from the top. Drag the missing numbers into place.",newQ:"New puzzle",check:"Check",reset:"Reset",correct:"Correct answer",wrong:"Check your values",bank:"Number bank",clear:"Clear cell"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Be):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Ne):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");function L(g,C){return Math.floor(Math.random()*(C-g+1))+g}function V(g){const C=g.slice();for(let O=C.length-1;O>0;O--){const H=Math.floor(Math.random()*(O+1));[C[O],C[H]]=[C[H],C[O]]}return C}const M=B(3),A=B(1e3),m=B(0),h=B([]),S=B(new Set),T=B({}),F=B({}),N=B({}),G=B(!1),J=B(null),I=q(()=>l[a.value].title.replaceAll("{STEP}",A.value)),R=q(()=>l[a.value].rule.replaceAll("{STEP}",A.value));function z(g,C,O){const H=[];for(let Z=0;Z<g;Z++){const X=[];for(let se=0;se<g;se++)X.push(C+O*(Z+se));H.push(X)}return H}function W(g){const C=[];for(let H=0;H<g;H++)for(let Z=0;Z<g;Z++)H===0&&Z===0||C.push([H,Z]);const O=L(3,5);return new Set(V(C).slice(0,O).map(([H,Z])=>`${H},${Z}`))}function Y(){const g={};S.value.forEach(C=>{const[O,H]=C.split(",").map(Number),Z=h.value[O][H];g[Z]=(g[Z]||0)+1}),N.value=g}const j=[100,200,500,1e3,2e3];function k(){G.value=!1,J.value=null,T.value={},F.value={},A.value=j[L(0,j.length-1)],m.value=L(5,19)*100;const g=M.value;h.value=z(g,m.value,A.value),S.value=W(g),Y()}const p=q(()=>{const g=[];for(const[C,O]of Object.entries(N.value))for(let H=0;H<O;H++)g.push(Number(C));return V(g)});function c(g,C,{fromManual:O=!1}={}){if(!Number.isNaN(C)){if(T.value[g]!=null){const H=T.value[g];N.value[H]=(N.value[H]||0)+1}(N.value[C]||0)<=0||(N.value[C]-=1,T.value[g]=C,F.value={...F.value,[g]:String(C)},J.value=null,G.value=!1)}}function d(g,C){g.dataTransfer.setData("text/plain",String(C))}function w(g){g.preventDefault()}function _(g,C){g.preventDefault();const O=Number(g.dataTransfer.getData("text/plain"));c(C,O)}function u(g){if(T.value[g]!=null){const C=T.value[g];N.value[C]=(N.value[C]||0)+1,delete T.value[g]}F.value={...F.value,[g]:""},J.value=null,G.value=!1}function f(g,C){F.value={...F.value,[g]:C}}function $(g){var H;const C=((H=F.value[g])!=null?H:"").trim();if(C===""){u(g);return}const O=Number(C);Number.isFinite(O)&&c(g,O,{fromManual:!0})}function E(){for(const g of S.value)if(T.value[g]==null)return!1;return!0}function v(){if(!E())return!1;for(const g of S.value){const[C,O]=g.split(",").map(Number);if(T.value[g]!==h.value[C][O])return!1}return!0}async function s(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function r(){if(!E()){J.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",b&&b.play();return}v()?(G.value=!0,J.value=l[a.value].correct,x&&x.play(),P&&P.play(),await s()):(J.value=l[a.value].wrong,b&&b.play())}function i(){T.value={},F.value={},Y(),J.value=null,G.value=!1}const y=q(()=>({direction:"ltr",unicodeBidi:"isolate"}));return ge(k),me(()=>D.lang,()=>{G.value||(J.value=null)}),(g,C)=>(n(),o("div",{class:"challenge2 challenge-surface","data-theme":D.theme},[e("h2",Pl,t(I.value),1),e("p",El,t(R.value),1),e("div",zl,[e("div",Rl,[(n(!0),o(te,null,le(M.value,O=>(n(),o("div",{key:"r"+O,class:"row"},[(n(!0),o(te,null,le(M.value,H=>{var Z;return n(),o("div",{key:"c"+O+"-"+H,class:"cell"},[S.value.has(`${O-1},${H-1}`)?(n(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:w,onDrop:X=>_(X,`${O-1},${H-1}`)},[T.value[`${O-1},${H-1}`]!=null?(n(),o("span",{key:0,class:"num filled",style:de(y.value)},t(T.value[`${O-1},${H-1}`]),5)):(n(),o("span",jl,"؟"))],40,Ol),e("input",{class:"manual-entry",type:"number",value:(Z=F.value[`${O-1},${H-1}`])!=null?Z:"",onInput:X=>f(`${O-1},${H-1}`,X.target.value),onChange:X=>$(`${O-1},${H-1}`),onBlur:X=>$(`${O-1},${H-1}`),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,Il),e("button",{class:"clear",onClick:X=>u(`${O-1},${H-1}`)},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)],8,Fl)],64)):(n(),o("span",{key:0,class:"num",style:de(y.value)},t(h.value[O-1][H-1]),5))])}),128))]))),128))]),e("div",Ul,[e("div",ql,t(l[a.value].bank),1),e("div",Ql,[(n(!0),o(te,null,le(p.value,O=>(n(),o("button",{key:O+"_"+Math.random(),class:"chip",style:de(y.value),draggable:"true",onDragstart:H=>d(H,O)},t(O),45,Hl))),128))]),e("div",Wl,[e("button",{class:"btn",onClick:i},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn primary",onClick:r},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:k},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),J.value?(n(),o("div",{key:0,class:oe(["toast",{ok:G.value}])},t(J.value),3)):re("",!0)])]),G.value?(n(),o("div",Gl,[e("div",Vl,[e("div",Kl,t(l[a.value].correct),1),e("button",{class:"btn primary",onClick:k},t(l[a.value].newQ),1)])])):re("",!0)],8,Nl))}},Xl=fe(Yl,[["__scopeId","data-v-540279f2"]]),Le="/assets/mathematics_leaders/frontend/assets/success3.mp3",Oe="/assets/mathematics_leaders/frontend/assets/wrong3.mp3",Jl=["data-theme"],Zl={class:"title"},en={class:"rule"},tn={class:"qs"},an={class:"qtext"},ln={class:"opts"},nn=["onClick"],sn=["onClick"],on={class:"toolbar"},rn={class:"status"},cn={key:0,class:"done"},un={class:"actions"},dn=4,vn={__name:"challenge_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 3: إيجاد عددين من المجموع والفرق",rule:"اختر الزوج الصحيح (أكبر، أصغر) بحيث يكون مجموعهما S والفرق بينهما D.",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"إجابة غير صحيحة",done:"أكملت هذه الجولة",q:(I,R,z)=>`(${I}) جد عددين ناتج جمعهما ${R} والفرق بينهما ${z}`},en:{title:"Challenge 3: Find two numbers from sum and difference",rule:"Pick the correct pair (greater, smaller) with sum S and difference D.",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Incorrect",done:"Round completed",q:(I,R,z)=>`(${I}) Find two numbers with sum ${R} and difference ${z}`}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Le):null,P=typeof Audio!="undefined"?new Audio(Oe):null;x&&(x.preload="auto"),P&&(P.preload="auto");function b(I,R){return Math.floor(Math.random()*(R-I+1))+I}function L(I){const R=I.slice();for(let z=R.length-1;z>0;z--){const W=Math.floor(Math.random()*(z+1));[R[z],R[W]]=[R[W],R[z]]}return R}const V=B([]),M=q(()=>V.value.filter(I=>{var R;return I.judged&&((R=I.options[I.pickedIndex])==null?void 0:R.isAns)}).length),A=q(()=>V.value.length>0&&V.value.every(I=>I.judged));function m(I,R){return[(I+R)/2,(I-R)/2]}function h(I){return Number.isInteger(I)&&I>=0}function S(){let I,R,z,W;for(;I=b(10,60),R=b(0,20),!((I&1)===(R&1)&&!(I<R)&&([z,W]=m(I,R),h(z)&&h(W))););const Y=new Set,j=(p,c)=>{const d=`${p},${c}`;p>=0&&c>=0&&Number.isInteger(p)&&Number.isInteger(c)&&d!==`${z},${W}`&&Y.add(d)};j(z+1,W-1),j(z-1,W+1),j(z+2,W-2),j(z-2,W+2),j(z+1,W),j(z,W+1);const k=[{a:z,b:W,isAns:!0}];for(const p of Array.from(Y).slice(0,3)){const[c,d]=p.split(",").map(w=>Number(w));if(k.push({a:c,b:d,isAns:!1}),k.length===4)break}for(;k.length<4;){const p=b(-3,3),c=b(-3,3),d=Math.max(0,z+p),w=Math.max(0,W+c);d===z&&w===W||k.push({a:d,b:w,isAns:!1})}return{S:I,D:R,ans:[z,W],options:L(k),pickedIndex:null,judged:!1,firstTry:!0}}function T(){V.value=Array.from({length:dn},()=>S())}function F(){for(const I of V.value)I.pickedIndex=null,I.judged=!1,I.firstTry=!0}async function N(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function G(I,R){if(I.judged)return;I.pickedIndex=R,I.judged=!0,I.options[R].isAns?(x&&x.play(),A.value&&x&&x.play(),I.firstTry&&await N()):P&&P.play()}function J(I){I.judged=!1,I.firstTry=!1,I.pickedIndex=null}return ge(T),me(()=>D.lang,()=>{}),(I,R)=>(n(),o("div",{class:"challenge3 challenge-surface","data-theme":D.theme},[e("h2",Zl,t(l[a.value].title),1),e("p",en,t(l[a.value].rule),1),e("div",tn,[(n(!0),o(te,null,le(V.value,(z,W)=>(n(),o("div",{key:W,class:"qcard"},[e("div",an,t(l[a.value].q(W+1,z.S,z.D)),1),e("div",ln,[(n(!0),o(te,null,le(z.options,(Y,j)=>(n(),o("button",{key:j,class:oe(["opt",{chosen:z.pickedIndex===j,ok:z.judged&&z.options[j].isAns,bad:z.judged&&z.pickedIndex===j&&!z.options[j].isAns}]),onClick:k=>G(z,j)}," ( "+t(Y.a)+" ، "+t(Y.b)+" ) ",11,nn))),128))]),z.judged?(n(),o("div",{key:0,class:oe(["feedback",{ok:z.options[z.pickedIndex].isAns}])},[K(t(z.options[z.pickedIndex].isAns?l[a.value].correct:l[a.value].wrong)+" ",1),z.options[z.pickedIndex].isAns?re("",!0):(n(),o("button",{key:0,class:"retry",onClick:Y=>J(z)},"↺",8,sn))],2)):re("",!0)]))),128))]),e("div",on,[e("div",rn,[U(Q(be),{class:"ic"}),K(" "+t(M.value)+" / "+t(V.value.length)+" ",1),A.value&&M.value===V.value.length?(n(),o("span",cn," · "+t(l[a.value].done),1)):re("",!0)]),e("div",un,[e("button",{class:"btn",onClick:F},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:T},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])])])],8,Jl))}},hn=fe(vn,[["__scopeId","data-v-fd4f6cf1"]]),wt="/assets/mathematics_leaders/frontend/assets/success4.mp3",$t="/assets/mathematics_leaders/frontend/assets/wrong4.mp3",pn=["data-theme"],fn={class:"title"},mn={class:"rule"},gn={class:"wrap"},_n={class:"table"},yn=["onDrop"],bn={key:1,class:"placeholder"},kn=["value","onInput","onChange","onBlur","placeholder"],wn=["onClick"],$n={class:"side"},Cn={class:"bank-title"},xn={class:"bank-items"},Tn=["onDragstart"],An={class:"actions"},Sn={key:0,class:"overlay"},Dn={class:"card"},Mn={class:"big"},ze=3,Ln={__name:"challenge_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 4: أكمل جدول الضرب",rule:"جدول ضرب بعناوين صفوف وأعمدة. اسحب القيم الصحيحة من الأسفل إلى الخانات الفارغة.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 4: Complete the multiplication table",rule:"A multiplication table with row/column headers. Drag correct values into the blanks.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check your values",clear:"Clear cell"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(wt):null,P=typeof Audio!="undefined"?new Audio($t):null;x&&(x.preload="auto"),P&&(P.preload="auto");function b(s,r){return Math.floor(Math.random()*(r-s+1))+s}function L(s){const r=s.slice();for(let i=r.length-1;i>0;i--){const y=Math.floor(Math.random()*(i+1));[r[i],r[y]]=[r[y],r[i]]}return r}const V=B([]),M=B([]),A=B(new Set),m=B({}),h=B({}),S=B({}),T=B(!1),F=B(null);function N(s,r){return s===0&&r===0?"×":s===0?M.value[r-1]:r===0?V.value[s-1]:V.value[s-1]*M.value[r-1]}const G=(s,r)=>s===0||r===0?`h:${s},${r}`:`c:${s},${r}`;function J(s){return L([1,2,3,4,5,6,7,8,9]).slice(0,s).sort((r,i)=>r-i)}function I(){const s=[];for(let C=0;C<=ze;C++)for(let O=0;O<=ze;O++)C===0&&O===0||s.push([C,O]);const r=s.filter(([C,O])=>C>0&&O>0),i=L(r)[0],y=s.filter(([C,O])=>!(C===i[0]&&O===i[1])),g=b(6,8);return new Set(L(y).slice(0,g).map(([C,O])=>G(C,O)))}function R(){const s={};A.value.forEach(r=>{const[,i]=r.split(":"),[y,g]=i.split(",").map(Number),C=N(y,g);s[C]=(s[C]||0)+1});for(const[r,i]of Object.entries(m.value))s[i]=(s[i]||0)-1;for(const[r,i]of Object.entries(s))i<=0&&delete s[r];S.value=s}const z=q(()=>{const s=[];for(const[r,i]of Object.entries(S.value))for(let y=0;y<i;y++)s.push(Number(r));return L(s)});function W(){T.value=!1,F.value=null,m.value={},h.value={},V.value=J(ze),M.value=J(ze),A.value=I(),R()}function Y(){for(const s of A.value)if(m.value[s]==null)return!1;return!0}function j(){if(!Y())return!1;for(const s of A.value){const[,r]=s.split(":"),[i,y]=r.split(",").map(Number);if(m.value[s]!==N(i,y))return!1}return!0}async function k(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function p(){if(!Y()){F.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",P&&P.play();return}j()?(T.value=!0,F.value=l[a.value].correct,x&&x.play(),await k()):(F.value=l[a.value].wrong,P&&P.play())}function c(){m.value={},h.value={},R(),F.value=null,T.value=!1}function d(s,r,{fromManual:i=!1}={}){if(!Number.isNaN(r)){if(m.value[s]!=null){const y=m.value[s];S.value[y]=(S.value[y]||0)+1}(S.value[r]||0)!==0&&(S.value[r]-=1,m.value[s]=r,h.value={...h.value,[s]:String(r)},F.value=null,T.value=!1)}}function w(s,r){s.dataTransfer.setData("text/plain",String(r))}function _(s){s.preventDefault()}function u(s,r){s.preventDefault();const i=Number(s.dataTransfer.getData("text/plain"));d(r,i)}function f(s){if(m.value[s]!=null){const r=m.value[s];S.value[r]=(S.value[r]||0)+1,delete m.value[s]}h.value={...h.value,[s]:""},F.value=null,T.value=!1}function $(s,r){h.value={...h.value,[s]:r}}function E(s){var y;const r=((y=h.value[s])!=null?y:"").trim();if(r===""){f(s);return}const i=Number(r);Number.isFinite(i)&&d(s,i,{fromManual:!0})}const v=q(()=>({direction:"ltr",unicodeBidi:"isolate"}));return ge(W),me(()=>D.lang,()=>{T.value||(F.value=null)}),(s,r)=>(n(),o("div",{class:"challenge4 challenge-surface","data-theme":D.theme},[e("h2",fn,t(l[a.value].title),1),e("p",mn,t(l[a.value].rule),1),e("div",gn,[e("div",_n,[(n(!0),o(te,null,le(ze+1,i=>(n(),o("div",{class:"row",key:"r"+i},[(n(!0),o(te,null,le(ze+1,y=>{var g;return n(),o("div",{class:oe(["cell",{head:i===1||y===1,corner:i===1&&y===1,body:!(i===1||y===1)}]),key:"c"+i+"-"+y},[i===1&&y===1?(n(),o(te,{key:0},[K("×")],64)):A.value.has(i===1||y===1?`h:${i-1},${y-1}`:`c:${i-1},${y-1}`)?(n(),o(te,{key:2},[e("div",{class:"dropzone",onDragover:_,onDrop:C=>u(C,i===1||y===1?`h:${i-1},${y-1}`:`c:${i-1},${y-1}`)},[m.value[i===1||y===1?`h:${i-1},${y-1}`:`c:${i-1},${y-1}`]!=null?(n(),o("span",{key:0,class:"num",style:de(v.value)},t(m.value[i===1||y===1?`h:${i-1},${y-1}`:`c:${i-1},${y-1}`]),5)):(n(),o("span",bn,"؟"))],40,yn),e("input",{class:"manual-entry",type:"number",value:(g=h.value[i===1||y===1?`h:${i-1},${y-1}`:`c:${i-1},${y-1}`])!=null?g:"",onInput:C=>$(i===1||y===1?`h:${i-1},${y-1}`:`c:${i-1},${y-1}`,C.target.value),onChange:C=>E(i===1||y===1?`h:${i-1},${y-1}`:`c:${i-1},${y-1}`),onBlur:C=>E(i===1||y===1?`h:${i-1},${y-1}`:`c:${i-1},${y-1}`),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,kn),e("button",{class:"clear",onClick:C=>f(i===1||y===1?`h:${i-1},${y-1}`:`c:${i-1},${y-1}`)},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)],8,wn)],64)):(n(),o("span",{key:1,class:"num",style:de(v.value)},t(N(i-1,y-1)),5))],2)}),128))]))),128))]),e("div",$n,[e("div",Cn,t(l[a.value].bank),1),e("div",xn,[(n(!0),o(te,null,le(z.value,i=>(n(),o("button",{key:i+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:y=>w(y,i),style:de(v.value)},t(i),45,Tn))),128))]),e("div",An,[e("button",{class:"btn",onClick:c},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn primary",onClick:p},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:W},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),F.value?(n(),o("div",{key:0,class:oe(["toast",{ok:T.value}])},t(F.value),3)):re("",!0)])]),T.value?(n(),o("div",Sn,[e("div",Dn,[e("div",Mn,t(l[a.value].correct),1),e("button",{class:"btn primary",onClick:W},t(l[a.value].newQ),1)])])):re("",!0)],8,pn))}},Bn=fe(Ln,[["__scopeId","data-v-dac8e647"]]),Nn="/assets/mathematics_leaders/frontend/assets/wrong5.mp3",Pn=["data-theme"],En={class:"title"},zn={class:"rule"},Rn={class:"tri-wrap"},On={class:"square left-sq"},jn={key:1,class:"placeholder"},In=["value","placeholder"],Fn={class:"square right-sq"},Un={key:1,class:"placeholder"},qn=["value","placeholder"],Qn={class:"square base-sq"},Hn={key:1,class:"placeholder"},Wn=["value","placeholder"],Gn={class:"side"},Vn={class:"bank-title"},Kn={class:"bank-items"},Yn=["onDragstart"],Xn={class:"actions"},Jn={key:0,class:"overlay"},Zn={class:"card"},es={class:"big"},ts=4,as={__name:"challenge_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 5: مخطط مثلث (ضرب)",rule:"كل مربع على الضلع يساوي حاصل ضرب العدديْن في الدائرتيْن المجاورتين له. اسحب القيم المفقودة إلى المربعات.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 5: Triangle product",rule:"Each edge-square equals the product of the two adjacent circles. Drag missing values into the squares.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check your values",clear:"Clear cell"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Be):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Nn):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");function L(v,s){return Math.floor(Math.random()*(s-v+1))+v}function V(v){const s=v.slice();for(let r=s.length-1;r>0;r--){const i=Math.floor(Math.random()*(r+1));[s[r],s[i]]=[s[i],s[r]]}return s}const M=B([2,3,4]),A=B({t:0,l:0,r:0}),m=B(new Set),h=B({}),S=B({}),T=B({}),F=B(!1),N=B(null);function G(){const v=V([2,3,4,5,6,7,8,9]).slice(0,3);M.value=[v[0],v[1],v[2]];const[s,r,i]=M.value;A.value={l:s*r,r:s*i,t:r*i}}function J(){const v=["l","r","t"],s=L(2,3);m.value=new Set(V(v).slice(0,s))}function I(){const v={};m.value.forEach(r=>{const i=A.value[r];v[i]=(v[i]||0)+1});for(const[r,i]of Object.entries(h.value))v[i]=(v[i]||0)-1;for(const[r,i]of Object.entries(v))i<=0&&delete v[r];const s=ts;{const r=new Set(Object.keys(v).map(Number)),i=new Set(Object.values(A.value)),y=[];for(let g=4;g<=81;g++)!r.has(g)&&!i.has(g)&&y.push(g);for(let g=0;g<s&&y.length;g++){const C=Math.floor(Math.random()*y.length),O=y.splice(C,1)[0];v[O]=(v[O]||0)+1}}T.value=v}const R=q(()=>{const v=[];for(const[s,r]of Object.entries(T.value))for(let i=0;i<r;i++)v.push(Number(s));return V(v)});function z(){F.value=!1,N.value=null,h.value={},S.value={},G(),J(),I()}function W(){for(const v of m.value)if(h.value[v]==null)return!1;return!0}function Y(){if(!W())return!1;for(const v of m.value)if(h.value[v]!==A.value[v])return!1;return!0}async function j(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function k(){if(!W()){N.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",b&&b.play();return}Y()?(F.value=!0,N.value=l[a.value].correct,x&&x.play(),P&&P.play(),await j()):(N.value=l[a.value].wrong,b&&b.play())}function p(){h.value={},I(),N.value=null,F.value=!1}function c(v,s){v.dataTransfer.setData("text/plain",String(s))}function d(v){v.preventDefault()}function w(v,s,{fromManual:r=!1}={}){if(!Number.isNaN(s)){if(h.value[v]!=null){const i=h.value[v];T.value[i]=(T.value[i]||0)+1}if(r)(T.value[s]||0)>0&&(T.value[s]-=1);else{if((T.value[s]||0)===0)return;T.value[s]-=1}h.value[v]=s,S.value={...S.value,[v]:String(s)},N.value=null}}function _(v,s){v.preventDefault();const r=Number(v.dataTransfer.getData("text/plain"));w(s,r)}function u(v){if(h.value[v]!=null){const s=h.value[v];T.value[s]=(T.value[s]||0)+1,delete h.value[v]}S.value={...S.value,[v]:""}}function f(v,s){S.value={...S.value,[v]:s}}function $(v){var i;const s=((i=S.value[v])!=null?i:"").trim();if(s===""){u(v);return}const r=Number(s);Number.isFinite(r)&&w(v,r,{fromManual:!0})}const E=q(()=>({direction:"ltr",unicodeBidi:"isolate"}));return ge(z),me(()=>D.lang,()=>{}),(v,s)=>{var r,i,y;return n(),o("div",{class:"challenge5 challenge-surface","data-theme":D.theme},[e("h2",En,t(l[a.value].title),1),e("p",zn,t(l[a.value].rule),1),e("div",Rn,[s[15]||(s[15]=e("svg",{class:"links",viewBox:"0 0 300 260",preserveAspectRatio:"none"},[e("line",{x1:"150",y1:"40",x2:"60",y2:"140"}),e("line",{x1:"150",y1:"40",x2:"240",y2:"140"}),e("line",{x1:"60",y1:"140",x2:"240",y2:"140"})],-1)),e("div",{class:"circle top",style:de(E.value)},t(M.value[0]),5),e("div",{class:"circle left",style:de(E.value)},t(M.value[1]),5),e("div",{class:"circle right",style:de(E.value)},t(M.value[2]),5),e("div",On,[m.value.has("l")?(n(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:d,onDrop:s[0]||(s[0]=g=>_(g,"l"))},[h.value.l!=null?(n(),o("span",{key:0,class:"num",style:de(E.value)},t(h.value.l),5)):(n(),o("span",jn,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(r=S.value.l)!=null?r:"",onInput:s[1]||(s[1]=g=>f("l",g.target.value)),onChange:s[2]||(s[2]=g=>$("l")),onBlur:s[3]||(s[3]=g=>$("l")),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,In),e("button",{class:"clear",onClick:s[4]||(s[4]=g=>u("l"))},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)])],64)):(n(),o("span",{key:0,class:"num",style:de(E.value)},t(A.value.l),5))]),e("div",Fn,[m.value.has("r")?(n(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:d,onDrop:s[5]||(s[5]=g=>_(g,"r"))},[h.value.r!=null?(n(),o("span",{key:0,class:"num",style:de(E.value)},t(h.value.r),5)):(n(),o("span",Un,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(i=S.value.r)!=null?i:"",onInput:s[6]||(s[6]=g=>f("r",g.target.value)),onChange:s[7]||(s[7]=g=>$("r")),onBlur:s[8]||(s[8]=g=>$("r")),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,qn),e("button",{class:"clear",onClick:s[9]||(s[9]=g=>u("r"))},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)])],64)):(n(),o("span",{key:0,class:"num",style:de(E.value)},t(A.value.r),5))]),e("div",Qn,[m.value.has("t")?(n(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:d,onDrop:s[10]||(s[10]=g=>_(g,"t"))},[h.value.t!=null?(n(),o("span",{key:0,class:"num",style:de(E.value)},t(h.value.t),5)):(n(),o("span",Hn,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(y=S.value.t)!=null?y:"",onInput:s[11]||(s[11]=g=>f("t",g.target.value)),onChange:s[12]||(s[12]=g=>$("t")),onBlur:s[13]||(s[13]=g=>$("t")),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,Wn),e("button",{class:"clear",onClick:s[14]||(s[14]=g=>u("t"))},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)])],64)):(n(),o("span",{key:0,class:"num",style:de(E.value)},t(A.value.t),5))])]),e("div",Gn,[e("div",Vn,t(l[a.value].bank),1),e("div",Kn,[(n(!0),o(te,null,le(R.value,g=>(n(),o("button",{key:g+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:C=>c(C,g),style:de(E.value)},t(g),45,Yn))),128))]),e("div",Xn,[e("button",{class:"btn",onClick:p},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:k},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:z},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),N.value?(n(),o("div",{key:0,class:oe(["toast",{ok:F.value}])},t(N.value),3)):re("",!0)]),F.value?(n(),o("div",Jn,[e("div",Zn,[e("div",es,t(l[a.value].correct),1),e("button",{class:"btn",onClick:z},t(l[a.value].newQ),1)])])):re("",!0)],8,Pn)}}},ls=fe(as,[["__scopeId","data-v-d3434538"]]),ns=["data-theme"],ss={class:"title"},os={class:"rule"},rs=["aria-pressed","onClick"],is={class:"panel"},cs={class:"actions"},us={__name:"challenge_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 6: اختر ثلاث خلايا من شبكة بحيث لا تكون في الصف أو العمود نفسه ويكون مجموعها الهدف",rule:(k,p)=>`شبكة ${k}×${k}. اختر ثلاث خلايا كلٌّ منها في صف وعمود مختلفين بحيث يساوي مجموعها ${p}.`,newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيود أو من المجموع",pick3:"اختر ثلاث خلايا"},en:{title:"Challenge 6: Pick 3 cells in different rows and columns to reach the target",rule:(k,p)=>`A ${k}×${k} grid. Pick three cells, one per distinct row and column, that sum to ${p}.`,newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check constraints or sum",pick3:"Pick three cells"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(kt):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Oe):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");function L(k,p){return Math.floor(Math.random()*(p-k+1))+k}function V(k){const p=k.slice();for(let c=p.length-1;c>0;c--){const d=Math.floor(Math.random()*(c+1));[p[c],p[d]]=[p[d],p[c]]}return p}const M=B(3),A=B([]),m=B(0),h=B([]),S=B(!1),T=B(null),F=q(()=>({direction:"ltr",unicodeBidi:"isolate"})),N=q(()=>A.value.flatMap((k,p)=>k.map((c,d)=>({v:c,r:p,c:d})))),G=q(()=>h.value.reduce((k,p)=>k+A.value[p.r][p.c],0));function J(){S.value=!1,T.value=null,h.value=[],M.value=[3,4][L(0,1)],A.value=Array.from({length:M.value},()=>Array.from({length:M.value},()=>L(1,9)));const k=V([...Array(M.value).keys()]).slice(0,3),p=V([...Array(M.value).keys()]).slice(0,3),c=V(p.slice()),d=k.map((w,_)=>({r:w,c:c[_]}));m.value=d.reduce((w,_)=>w+A.value[_.r][_.c],0)}ge(J);function I(){h.value=[],T.value=null,S.value=!1}function R(k,p){if(S.value)return;const c=h.value.findIndex(d=>d.r===k&&d.c===p);if(c>=0){h.value.splice(c,1);return}h.value.length!==3&&h.value.push({r:k,c:p})}function z(){return new Set(h.value.map(k=>k.r)).size===h.value.length}function W(){return new Set(h.value.map(k=>k.c)).size===h.value.length}async function Y(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function j(){if(h.value.length!==3){T.value=l[a.value].pick3,b&&b.play();return}if(!z()||!W()){T.value=l[a.value].wrong,b&&b.play();return}G.value===m.value?(S.value=!0,T.value=l[a.value].correct,x&&x.play(),P&&P.play(),await Y()):(T.value=l[a.value].wrong,b&&b.play())}return(k,p)=>(n(),o("div",{class:"challenge6 challenge-surface","data-theme":D.theme},[e("h2",ss,t(l[a.value].title),1),e("p",os,t(l[a.value].rule(M.value,m.value)),1),e("div",{class:"grid",style:de({"--n":M.value})},[(n(!0),o(te,null,le(N.value,c=>(n(),o("button",{key:c.r+"-"+c.c,class:oe(["cell",{picked:h.value.some(d=>d.r===c.r&&d.c===c.c)}]),"aria-pressed":h.value.some(d=>d.r===c.r&&d.c===c.c),onClick:d=>R(c.r,c.c),style:de(F.value)},t(c.v),15,rs))),128))],4),e("div",is,[e("div",cs,[e("button",{class:"btn",onClick:I},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn primary",onClick:j},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:J},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),T.value?(n(),o("div",{key:0,class:oe(["toast",{ok:S.value}])},t(T.value),3)):re("",!0)])],8,ns))}},ds=fe(us,[["__scopeId","data-v-eae91c5a"]]),vs=["data-theme"],hs={class:"title"},ps={class:"rule"},fs={class:"pyramid"},ms=["onDrop"],gs={key:1,class:"placeholder"},_s=["value","onInput","onChange","onBlur","placeholder"],ys=["onClick"],bs={class:"side"},ks={class:"bank-title"},ws={class:"bank-items"},$s=["onDragstart"],Cs={class:"actions"},xs=6,Ts={__name:"challenge_7",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 7: جدار أعداد (هرم جمع)",rule:"كل خانة تساوي مجموع الخليتين اللتين تحتها مباشرة. اسحب القيم المفقودة لإكمال الهرم.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 7: Sum Pyramid",rule:"Each cell equals the sum of the two cells directly below. Drag missing values to complete the pyramid.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check your values",clear:"Clear cell"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Le):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(at):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");function L(s,r){return Math.floor(Math.random()*(r-s+1))+s}function V(s){const r=s.slice();for(let i=r.length-1;i>0;i--){const y=Math.floor(Math.random()*(i+1));[r[i],r[y]]=[r[y],r[i]]}return r}const M=B(4),A=B([]),m=B(new Set),h=B({}),S=B({}),T=B({}),F=B(!1),N=B(null),G=q(()=>({direction:"ltr",unicodeBidi:"isolate"}));function J(s){const r=[];r[0]=Array.from({length:s},()=>L(1,9));for(let i=1;i<s;i++)r[i]=Array.from({length:s-i},(y,g)=>r[i-1][g]+r[i-1][g+1]);return r}const I=(s,r)=>`${s},${r}`;function R(s){const r=new Set;for(let g=1;g<s;g++){const C=L(0,A.value[g].length-1);r.add(I(g,C))}const i=[];for(let g=1;g<s;g++)for(let C=0;C<A.value[g].length;C++)r.has(I(g,C))||i.push([g,C]);const y=L(4,6);return new Set(V(i).slice(0,y).map(([g,C])=>I(g,C)))}function z(){const s={};m.value.forEach(g=>{const[C,O]=g.split(",").map(Number),H=A.value[C][O];s[H]=(s[H]||0)+1});for(const g of Object.values(h.value))s[g]=(s[g]||0)-1;for(const[g,C]of Object.entries(s))C<=0&&delete s[g];const r=new Set(Object.keys(s).map(Number)),i=new Set(A.value.flat()),y=[];for(let g=2;g<=150;g++)!r.has(g)&&!i.has(g)&&y.push(g);V(y).slice(0,xs).forEach(g=>{s[g]=(s[g]||0)+1}),T.value=s}const W=q(()=>{const s=[];for(const[r,i]of Object.entries(T.value))for(let y=0;y<i;y++)s.push(Number(r));return V(s)});function Y(){F.value=!1,N.value=null,h.value={},S.value={},A.value=J(M.value),m.value=R(M.value),z()}ge(Y),me(()=>D.lang,()=>{F.value||(N.value=null)});function j(){for(const s of m.value)if(h.value[s]==null)return!1;return!0}function k(){if(!j())return!1;for(const s of m.value){const[r,i]=s.split(",").map(Number);if(h.value[s]!==A.value[r][i])return!1}return!0}async function p(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function c(){if(!j()){N.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",b&&b.play();return}k()?(F.value=!0,N.value=l[a.value].correct,x&&x.play(),P&&P.play(),await p()):(N.value=l[a.value].wrong,b&&b.play())}function d(){h.value={},S.value={},z(),N.value=null,F.value=!1}function w(s,r){s.dataTransfer.setData("text/plain",String(r))}function _(s){s.preventDefault()}function u(s,r,{fromManual:i=!1}={}){if(!Number.isNaN(r)){if(h.value[s]!=null){const y=h.value[s];T.value[y]=(T.value[y]||0)+1}!i&&(T.value[r]||0)===0||(T.value[r]=(T.value[r]||0)-1,T.value[r]<0&&(T.value[r]=0),h.value[s]=r,S.value={...S.value,[s]:String(r)},N.value=null)}}function f(s,r){s.preventDefault();const i=Number(s.dataTransfer.getData("text/plain"));u(r,i)}function $(s){if(h.value[s]!=null){const r=h.value[s];T.value[r]=(T.value[r]||0)+1,delete h.value[s]}S.value={...S.value,[s]:""}}function E(s,r){S.value={...S.value,[s]:r}}function v(s){var y;const r=((y=S.value[s])!=null?y:"").trim();if(r===""){$(s);return}const i=Number(r);Number.isFinite(i)&&u(s,i,{fromManual:!0})}return(s,r)=>(n(),o("div",{class:"challenge7 challenge-surface","data-theme":D.theme},[e("h2",hs,t(l[a.value].title),1),e("p",ps,t(l[a.value].rule),1),e("div",fs,[(n(!0),o(te,null,le(A.value,(i,y)=>(n(),o("div",{class:"prow",key:"r"+y,style:de({"--cols":i.length})},[(n(!0),o(te,null,le(i,(g,C)=>{var O;return n(),o("div",{class:"cell",key:y+"-"+C},[m.value.has(`${y},${C}`)?(n(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:_,onDrop:H=>f(H,`${y},${C}`)},[h.value[`${y},${C}`]!=null?(n(),o("span",{key:0,class:"num",style:de(G.value)},t(h.value[`${y},${C}`]),5)):(n(),o("span",gs,"؟"))],40,ms),e("input",{class:"manual-entry",type:"number",value:(O=S.value[`${y},${C}`])!=null?O:"",onInput:H=>E(`${y},${C}`,H.target.value),onChange:H=>v(`${y},${C}`),onBlur:H=>v(`${y},${C}`),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,_s),e("button",{class:"clear",onClick:H=>$(`${y},${C}`)},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)],8,ys)],64)):(n(),o("span",{key:0,class:"num",style:de(G.value)},t(g),5))])}),128))],4))),128))]),e("div",bs,[e("div",ks,t(l[a.value].bank),1),e("div",ws,[(n(!0),o(te,null,le(W.value,i=>(n(),o("button",{key:i+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:y=>w(y,i),style:de(G.value)},t(i),45,$s))),128))]),e("div",Cs,[e("button",{class:"btn",onClick:d},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn primary",onClick:c},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:Y},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),N.value?(n(),o("div",{key:0,class:oe(["toast",{ok:F.value}])},t(N.value),3)):re("",!0)])],8,vs))}},As=fe(Ts,[["__scopeId","data-v-3e993bb9"]]),Ss="/assets/mathematics_leaders/frontend/assets/oh_no.mp3",Ds=["data-theme"],Ms={class:"title"},Ls={class:"rule"},Bs={class:"panel"},Ns=["placeholder"],Ps={class:"usage"},Es={class:"keypad"},zs={class:"label"},Rs={class:"row"},Os=["onClick"],js=["onClick"],Is={class:"actions"},Fs={class:"hint"},Us={__name:"challenge_level_two_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 1 (المستوى الثاني): كوّن جملة عددية تستعمل 1،2،3،4،5 دون تكرار",rule:j=>`اكتب تعبيراً حسابياً يستخدم الأرقام ١،٢،٣،٤،٥ مرة واحدة فقط ويكون ناتجه ${j}. المسموح: + − × ÷ والأقواس. لا أرقام أخرى أو تكرار.`,inputPH:"اكتب التعبير هنا… مثل: (5*4)*(3+2)*1",keys:"لوحة المفاتيح",newQ:"سؤال جديد",reset:"مسح",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من الشروط أو من النتيجة",used:"استخدام الأرقام:",note:"تلميح: يمكنك دائماً استعمال ×1 دون تغيير النتيجة."},en:{title:"Level 2 – Challenge 1: Build an expression with 1..5 once each",rule:j=>`Write an expression that uses digits 1,2,3,4,5 exactly once and evaluates to ${j}. Allowed: + - * / and parentheses. No other digits or repeats.`,inputPH:"Type expression… e.g., (5*4)*(3+2)*1",keys:"Keypad",newQ:"New puzzle",reset:"Clear",check:"Check",correct:"Correct",wrong:"Check constraints or value",used:"Digits usage:",note:"Hint: multiplying by 1 keeps the value unchanged."}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Be):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Ss):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");function L(j,k){return Math.floor(Math.random()*(k-j+1))+j}function V(j){const k=j.slice();for(let p=k.length-1;p>0;p--){const c=Math.floor(Math.random()*(p+1));[k[p],k[c]]=[k[c],k[p]]}return k}const M=B(""),A=B(0),m=B(null),h=B(!1),S=[1,2,3,4,5],T=["+","-","*","/","(",")"];function F(){const j=V([2,3,4,5]),[k,p,c,d]=j,w=i=>i[L(0,i.length-1)],_=w(["+","-","*","/"]),u=w(["+","-","*","/"]),f=w(["+","-","*","/"]),$=i=>{try{return Function(`"use strict";return(${i})`)()}catch{return null}};let E=`( ${k} ${_} ${p} ) ${u} ( ${c} ${f} ${d} )`,v=$(E),s=0;for(;(v==null||!isFinite(v))&&s<20;){const i=V([2,3,4,5]),[y,g,C,O]=i,H=w(["+","-","*","/"]),Z=w(["+","-","*","/"]),X=w(["+","-","*","/"]);E=`( ${y} ${H} ${g} ) ${Z} ( ${C} ${X} ${O} )`,v=$(E),s++}const r=Math.random()<.7?`(${E}) * 1`:`((${E}) + 1) - 1`;A.value=$(r),M.value="",m.value=null,h.value=!1}function N(j){M.value+=j}function G(){M.value=M.value.slice(0,-1)}function J(){M.value="",m.value=null,h.value=!1}const I=q(()=>{const j={1:0,2:0,3:0,4:0,5:0};for(const k of M.value)"12345".includes(k)&&j[k]++;return j});function R(j){return/^[\d\+\-\*\/\(\)\s×÷]*$/.test(j)}function z(){if(/[06789]/.test(M.value))return!1;const j=I.value;return S.every(k=>j[k]===1)}function W(j){try{return!R(j)||(j=j.replace(/×/g,"*").replace(/÷/g,"/"),/\b(?![1-5]\b)\d+\b/.test(j))?null:Function(`"use strict";return(${j})`)()}catch{return null}}async function Y(){const j=W(M.value);if(j==null||!isFinite(j)||!z()){m.value=l[a.value].wrong,b&&b.play();return}if(Math.abs(j-A.value)<1e-9){h.value=!0,m.value=l[a.value].correct,x&&x.play(),P&&P.play();try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}else m.value=l[a.value].wrong,b&&b.play()}return ge(F),(j,k)=>(n(),o("div",{class:"lvl2c1 challenge-surface","data-theme":D.theme},[e("h2",Ms,t(l[a.value].title),1),e("p",Ls,t(l[a.value].rule(A.value)),1),e("div",Bs,[De(e("input",{class:"expr",placeholder:l[a.value].inputPH,"onUpdate:modelValue":k[0]||(k[0]=p=>M.value=p),dir:"ltr",inputmode:"numeric",autocomplete:"off",spellcheck:"false"},null,8,Ns),[[Me,M.value]]),e("div",Ps,[K(t(l[a.value].used)+" ",1),(n(),o(te,null,le(S,p=>e("span",{key:p,class:oe(["u",{ok:I.value[p]===1,bad:I.value[p]>1}])},t(p)+": "+t(I.value[p]),3)),64))]),e("div",Es,[e("div",zs,t(l[a.value].keys),1),e("div",Rs,[(n(),o(te,null,le(S,p=>e("button",{class:"k",key:"d"+p,onClick:c=>N(String(p))},t(p),9,Os)),64)),(n(),o(te,null,le(T,p=>e("button",{class:"k",key:"o"+p,onClick:c=>N(p)},t(p),9,js)),64)),e("button",{class:"k wide",onClick:G},"⌫")])]),e("div",Is,[e("button",{class:"btn",onClick:J},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn primary",onClick:Y},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:F},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),e("div",Fs,t(l[a.value].note),1),m.value?(n(),o("div",{key:0,class:oe(["toast",{ok:h.value}])},t(m.value),3)):re("",!0)])],8,Ds))}},qs=fe(Us,[["__scopeId","data-v-206c1ce3"]]),Qs=["data-theme"],Hs={class:"title"},Ws={class:"rule"},Gs={class:"board"},Vs=["onDrop"],Ks={key:1,class:"placeholder"},Ys=["onClick"],Xs={class:"side"},Js={class:"bank-title"},Zs={class:"bank-items"},eo=["onDragstart"],to={class:"actions"},ao={__name:"challenge_level_two_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثاني – التحدي 2: أكمل مربعاً سحرياً",rule:r=>`ضع الأعداد بحيث يكون مجموع كل صف وعمود وقطر مساوياً ${r}. اسحب القيم المفقودة إلى أماكنها. الأعداد جميعها مختلفة.`,bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من المجاميع أو التكرار",clear:"تفريغ الخلية"},en:{title:"Level 2 – Challenge 2: Complete a magic square",rule:r=>`Place numbers so each row, column, and diagonal sums to ${r}. Drag the missing values into place. All numbers are distinct.`,bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check sums or duplicates",clear:"Clear cell"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Be):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Ne):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");function L(r,i){return Math.floor(Math.random()*(i-r+1))+r}function V(r){const i=r.slice();for(let y=i.length-1;y>0;y--){const g=Math.floor(Math.random()*(y+1));[i[y],i[g]]=[i[g],i[y]]}return i}const M=[[8,1,6],[3,5,7],[4,9,2]];function A(r){const i=Z=>[[Z[2][0],Z[1][0],Z[0][0]],[Z[2][1],Z[1][1],Z[0][1]],[Z[2][2],Z[1][2],Z[0][2]]],y=Z=>Z.map(X=>X.slice().reverse()),g=[];let C=r;for(let Z=0;Z<4;Z++)g.push(C),g.push(y(C)),C=i(C);const O=new Set,H=[];for(const Z of g){const X=JSON.stringify(Z);O.has(X)||(H.push(Z),O.add(X))}return H}const m=A(M),h=B([[0,0,0],[0,0,0],[0,0,0]]),S=B(0),T=B(new Set),F=B({}),N=B({}),G=B(!1),J=B(null),I=q(()=>({direction:"ltr",unicodeBidi:"isolate"})),R=(r,i)=>`${r},${i}`;function z(){const r=m[L(0,m.length-1)],i=[1,2,3,4,5][L(0,4)],y=L(0,6),g=Array.from({length:3},()=>Array(3).fill(0));for(let C=0;C<3;C++)for(let O=0;O<3;O++)g[C][O]=y+i*r[C][O];h.value=g,S.value=i*15+3*y}function W(){const r=[];for(let g=0;g<3;g++)for(let C=0;C<3;C++)r.push([g,C]);const i=new Set(V(r).slice(0,L(3,4)).map(([g,C])=>R(g,C))),y=r.filter(([g,C])=>!i.has(R(g,C)));T.value=new Set(y.map(([g,C])=>R(g,C)))}function Y(){const r={};T.value.forEach(i=>{const[y,g]=i.split(",").map(Number),C=h.value[y][g];r[C]=(r[C]||0)+1});for(const[i,y]of Object.entries(F.value))r[y]=(r[y]||0)-1;for(const[i,y]of Object.entries(r))y<=0&&delete r[i];N.value=r}const j=q(()=>{const r=[];for(const[i,y]of Object.entries(N.value))for(let g=0;g<y;g++)r.push(Number(i));return V(r)});function k(){G.value=!1,J.value=null,F.value={},z(),W(),Y()}function p(){for(const r of T.value)if(F.value[r]==null)return!1;return!0}function c(){const r=h.value.map(i=>i.slice());for(const i of T.value){const[y,g]=i.split(",").map(Number);r[y][g]=F.value[i]}return r}function d(r){const i=new Set;for(const y of r)for(const g of y){if(i.has(g))return!1;i.add(g)}return!0}function w(r){const i=(y,g,C)=>y+g+C;for(let y=0;y<3;y++)if(i(r[y][0],r[y][1],r[y][2])!==S.value||i(r[0][y],r[1][y],r[2][y])!==S.value)return!1;return!(i(r[0][0],r[1][1],r[2][2])!==S.value||i(r[0][2],r[1][1],r[2][0])!==S.value)}async function _(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function u(){if(!p()){J.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",b&&b.play();return}const r=c();d(r)&&w(r)?(G.value=!0,J.value=l[a.value].correct,x&&x.play(),P&&P.play(),await _()):(J.value=l[a.value].wrong,b&&b.play())}function f(){F.value={},Y(),J.value=null,G.value=!1}function $(r,i){r.dataTransfer.setData("text/plain",String(i))}function E(r){r.preventDefault()}function v(r,i){r.preventDefault();const y=Number(r.dataTransfer.getData("text/plain"));if(F.value[i]!=null){const g=F.value[i];N.value[g]=(N.value[g]||0)+1}(N.value[y]||0)!==0&&(N.value[y]-=1,F.value[i]=y,J.value=null)}function s(r){if(F.value[r]!=null){const i=F.value[r];N.value[i]=(N.value[i]||0)+1,delete F.value[r]}}return ge(k),me(()=>D.lang,()=>{}),(r,i)=>(n(),o("div",{class:"lvl2c2 challenge-surface","data-theme":D.theme},[e("h2",Hs,t(l[a.value].title),1),e("p",Ws,t(l[a.value].rule(S.value)),1),e("div",Gs,[(n(),o(te,null,le(3,y=>e("div",{class:"row",key:"r"+y},[(n(),o(te,null,le(3,g=>e("div",{class:"cell",key:"c"+y+"-"+g},[T.value.has(`${y-1},${g-1}`)?(n(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:E,onDrop:C=>v(C,`${y-1},${g-1}`)},[F.value[`${y-1},${g-1}`]!=null?(n(),o("span",{key:0,class:"num",style:de(I.value)},t(F.value[`${y-1},${g-1}`]),5)):(n(),o("span",Ks,"؟"))],40,Vs),e("button",{class:"clear",onClick:C=>s(`${y-1},${g-1}`)},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)],8,Ys)],64)):(n(),o("span",{key:0,class:"num",style:de(I.value)},t(h.value[y-1][g-1]),5))])),64))])),64))]),e("div",Xs,[e("div",Js,t(l[a.value].bank),1),e("div",Zs,[(n(!0),o(te,null,le(j.value,y=>(n(),o("button",{key:y+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:g=>$(g,y),style:de(I.value)},t(y),45,eo))),128))]),e("div",to,[e("button",{class:"btn",onClick:f},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn primary",onClick:u},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:k},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),J.value?(n(),o("div",{key:0,class:oe(["toast",{ok:G.value}])},t(J.value),3)):re("",!0)])],8,Qs))}},lo=fe(ao,[["__scopeId","data-v-4175342f"]]),no=["data-theme"],so={class:"title"},oo={class:"rule"},ro={class:"cards"},io={class:"card"},co={class:"label"},uo={key:0,class:"num"},vo={key:1,class:"placeholder"},ho={class:"card"},po={class:"label"},fo={key:0,class:"num"},mo={key:1,class:"placeholder"},go={class:"card"},_o={class:"label"},yo={key:0,class:"num"},bo={key:1,class:"placeholder"},ko={class:"card"},wo={class:"label"},$o={key:0,class:"num"},Co={key:1,class:"placeholder"},xo={class:"bank"},To={class:"bank-title"},Ao={class:"bank-items"},So=["disabled","onDragstart"],Do={key:0},Mo={class:"actions"},Lo={__name:"challenge_level_two_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثاني – التحدي 3: أوصل المسألة بالنتيجة الصحيحة",rule:"اسحب عدداً من ستة أرقام إلى كل خانة بحسب الخاصية المطلوبة: مضاعف 2، 3، 4، 5. كل عدد يُستخدم مرة واحدة.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من الخواص",clear:"تفريغ الخلية",lab2:"مضاعفًا للعدد 2",lab3:"مضاعفًا للعدد 3",lab4:"مضاعفًا للعدد 4",lab5:"مضاعفًا للعدد 5"},en:{title:"Level 2 – Challenge 3: Match each rule to a six-digit number",rule:"Drag one six-digit number to each rule: multiple of 2, 3, 4, 5. Each number can be used once.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check the properties",clear:"Clear cell",lab2:"Multiple of 2",lab3:"Multiple of 3",lab4:"Multiple of 4",lab5:"Multiple of 5"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Le):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Ne):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");function L(_,u){return Math.floor(Math.random()*(u-_+1))+_}function V(_){const u=_.slice();for(let f=u.length-1;f>0;f--){const $=Math.floor(Math.random()*(f+1));[u[f],u[$]]=[u[$],u[f]]}return u}const M=B([]),A=B({}),m=B({m2:null,m3:null,m4:null,m5:null}),h=B(null),S=B(!1),T=_=>_%2===0,F=_=>String(_).split("").reduce((u,f)=>u+ +f,0)%3===0,N=_=>_%100%4===0,G=_=>_%10===0||_%10===5;function J(_=u=>!0){for(;;){const u=L(1,9);let f=String(u);for(let E=0;E<5;E++)f+=String(L(0,9));const $=Number(f);if(_($))return $}}function I(_,u=()=>!0){for(;;){const f=L(1,9);let $=String(f);for(let v=0;v<4;v++)$+=String(L(0,9));$+=String(_);const E=Number($);if(u(E))return E}}function R(){S.value=!1,h.value=null,m.value={m2:null,m3:null,m4:null,m5:null};const _=new Set,u=i=>{const y=String(i);return _.has(y)?!1:(_.add(y),!0)};let f=I(5,i=>!F(i)||L(0,1));for(;!u(f);)f=I(5);let $=I([0,2,4,6,8][L(0,4)],i=>!G(i)&&!N(i));for(;!u($);)$=I([0,2,4,6,8][L(0,4)],i=>!G(i)&&!N(i));let E=J(i=>N(i));for(;!u(E);)E=J(i=>N(i));let v=J(i=>F(i)&&!G(i));for(;!u(v);)v=J(i=>F(i)&&!G(i));const s=[$,v,E,f],r=[];for(;r.length<4;){let i=J(y=>y%2!==0&&!F(y)&&!G(y)&&!N(y));u(i)&&r.push(i)}M.value=V(s.concat(r)),A.value=Object.fromEntries(M.value.map(i=>[i,1]))}function z(_,u){_.dataTransfer.setData("text/plain",String(u))}function W(_){_.preventDefault()}function Y(_,u){u.preventDefault();const f=Number(u.dataTransfer.getData("text/plain"));(A.value[f]||0)!==0&&(m.value[_]!=null&&(A.value[m.value[_]]=(A.value[m.value[_]]||0)+1),m.value[_]=f,A.value[f]-=1,h.value=null)}function j(_){m.value[_]!=null&&(A.value[m.value[_]]=(A.value[m.value[_]]||0)+1,m.value[_]=null)}function k(){return["m2","m3","m4","m5"].every(_=>m.value[_]!=null)}function p(){return T(m.value.m2)&&F(m.value.m3)&&N(m.value.m4)&&G(m.value.m5)}async function c(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function d(){if(!k()){h.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",b&&b.play();return}p()?(S.value=!0,h.value=l[a.value].correct,x&&x.play(),P&&P.play(),await c()):(h.value=l[a.value].wrong,b&&b.play())}function w(){m.value={m2:null,m3:null,m4:null,m5:null},A.value=Object.fromEntries(M.value.map(_=>[_,1])),h.value=null,S.value=!1}return ge(R),me(()=>D.lang,()=>{}),(_,u)=>(n(),o("div",{class:"lvl2c3 challenge-surface","data-theme":D.theme},[e("h2",so,t(l[a.value].title),1),e("p",oo,t(l[a.value].rule),1),e("div",ro,[e("div",io,[e("div",co,t(l[a.value].lab2),1),e("div",{class:"drop",onDragover:W,onDrop:u[0]||(u[0]=f=>Y("m2",f))},[m.value.m2!=null?(n(),o("span",uo,t(m.value.m2),1)):(n(),o("span",vo,"؟"))],32),e("button",{class:"clear",onClick:u[1]||(u[1]=f=>j("m2"))},[U(Q(xe),{class:"ic"}),K(t(l[a.value].clear),1)])]),e("div",ho,[e("div",po,t(l[a.value].lab3),1),e("div",{class:"drop",onDragover:W,onDrop:u[2]||(u[2]=f=>Y("m3",f))},[m.value.m3!=null?(n(),o("span",fo,t(m.value.m3),1)):(n(),o("span",mo,"؟"))],32),e("button",{class:"clear",onClick:u[3]||(u[3]=f=>j("m3"))},[U(Q(xe),{class:"ic"}),K(t(l[a.value].clear),1)])]),e("div",go,[e("div",_o,t(l[a.value].lab4),1),e("div",{class:"drop",onDragover:W,onDrop:u[4]||(u[4]=f=>Y("m4",f))},[m.value.m4!=null?(n(),o("span",yo,t(m.value.m4),1)):(n(),o("span",bo,"؟"))],32),e("button",{class:"clear",onClick:u[5]||(u[5]=f=>j("m4"))},[U(Q(xe),{class:"ic"}),K(t(l[a.value].clear),1)])]),e("div",ko,[e("div",wo,t(l[a.value].lab5),1),e("div",{class:"drop",onDragover:W,onDrop:u[6]||(u[6]=f=>Y("m5",f))},[m.value.m5!=null?(n(),o("span",$o,t(m.value.m5),1)):(n(),o("span",Co,"؟"))],32),e("button",{class:"clear",onClick:u[7]||(u[7]=f=>j("m5"))},[U(Q(xe),{class:"ic"}),K(t(l[a.value].clear),1)])])]),e("div",xo,[e("div",To,t(l[a.value].bank),1),e("div",Ao,[(n(!0),o(te,null,le(M.value,f=>(n(),o("button",{key:f,class:"chip",disabled:(A.value[f]||0)===0,draggable:"true",onDragstart:$=>z($,f)},[K(t(f)+" ",1),(A.value[f]||0)===0?(n(),o("small",Do,"✓")):re("",!0)],40,So))),128))])]),e("div",Mo,[e("button",{class:"btn",onClick:w},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:d},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:R},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),h.value?(n(),o("div",{key:0,class:oe(["toast",{ok:S.value}])},t(h.value),3)):re("",!0)],8,no))}},Bo=fe(Lo,[["__scopeId","data-v-a01ad243"]]),No=["data-theme"],Po={class:"title"},Eo={class:"rule"},zo={class:"choices",role:"list"},Ro=["onClick"],Oo={class:"pair",style:{direction:"ltr",unicodeBidi:"isolate"}},jo={class:"actions"},Io={__name:"challenge_level_two_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثاني – التحدي 4: اختر الإجابة الصحيحة",rule:(R,z)=>`ما العددان اللذان حاصل جمعهما ${R} والفرق بينهما ${z}؟ اختر الزوج الصحيح.`,choices:"الخيارات",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"إجابة غير صحيحة"},en:{title:"Level 2 – Challenge 4: Pick the correct pair",rule:(R,z)=>`Which two numbers have sum ${R} and difference ${z}? Pick the correct pair.`,choices:"Choices",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Incorrect"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(wt):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio($t):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");function L(R,z){return Math.floor(Math.random()*(z-R+1))+R}function V(R){const z=R.slice();for(let W=z.length-1;W>0;W--){const Y=Math.floor(Math.random()*(W+1));[z[W],z[Y]]=[z[Y],z[W]]}return z}const M=B(0),A=B(0),m=B([0,0]),h=B([]),S=B(null),T=B(null),F=B(!1);function N(){F.value=!1,T.value=null,S.value=null;const R=L(6,60),z=L(1,R-1),W=Math.max(R,z),Y=Math.min(R,z);M.value=W+Y,A.value=W-Y,m.value=[W,Y];const j=[[W,Y]],k=()=>{const c=M.value,d=L(1,c-1),w=c-d,_=[Math.max(d,w),Math.min(d,w)];return _[0]-_[1]===A.value?k():_},p=()=>{const c=A.value,d=L(1,60),_=[d+c,d];return _[0]+_[1]===M.value?p():_};for(;j.length<6;){const c=Math.random()<.5?k():p();j.some(d=>d[0]===c[0]&&d[1]===c[1])||j.push(c)}h.value=V(j)}async function G(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function J(){if(S.value==null){T.value=a.value==="ar"?"اختر إجابة":"Pick an answer",b&&b.play();return}const[R,z]=h.value[S.value];R+z===M.value&&R-z===A.value?(F.value=!0,T.value=l[a.value].correct,x&&x.play(),P&&P.play(),await G()):(T.value=l[a.value].wrong,b&&b.play())}function I(){S.value=null,T.value=null,F.value=!1}return ge(N),me(()=>D.lang,()=>{}),(R,z)=>(n(),o("div",{class:"lvl2c4 challenge-surface","data-theme":D.theme},[e("h2",Po,t(l[a.value].title),1),e("p",Eo,t(l[a.value].rule(M.value,A.value)),1),e("div",zo,[(n(!0),o(te,null,le(h.value,(W,Y)=>(n(),o("button",{key:Y,class:oe(["choice",{sel:S.value===Y}]),onClick:j=>S.value=Y,role:"listitem"},[z[0]||(z[0]=e("span",{class:"dot","aria-hidden":"true"},null,-1)),e("span",Oo,t(W[0])+" , "+t(W[1]),1)],10,Ro))),128))]),e("div",jo,[e("button",{class:"btn",onClick:I},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn primary",onClick:J},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:N},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),T.value?(n(),o("div",{key:0,class:oe(["toast",{ok:F.value}])},t(T.value),3)):re("",!0)],8,No))}},Fo=fe(Io,[["__scopeId","data-v-241569ec"]]),Uo=["data-theme"],qo={class:"title"},Qo={class:"rule"},Ho=["dir"],Wo={class:"frac"},Go={class:"top"},Vo={key:0,class:"num"},Ko={key:1,class:"placeholder"},Yo={class:"bot"},Xo={class:"frac"},Jo={class:"top"},Zo={class:"bot"},er={key:0,class:"num"},tr={key:1,class:"placeholder"},ar={class:"frac"},lr={class:"bot"},nr={key:0,class:"num"},sr={key:1,class:"placeholder"},or={class:"frac"},rr={class:"top"},ir={key:0,class:"num"},cr={key:1,class:"placeholder"},ur={class:"bot"},dr={class:"frac"},vr={class:"top"},hr={class:"bot"},pr={class:"bank"},fr={class:"bank-title"},mr={class:"bank-items"},gr=["onDragstart"],_r={class:"actions"},yr="⁦",br="⁩",kr={__name:"challenge_level_two_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثاني – التحدي 5: أكمل طرح الكسور",rule:u=>`ضع عددًا كليًا في كل مربع لتصبح المعادلة صحيحة:  ${u.num}/${u.den} =  ١/□  −  □/${u.d2}.  اسحب الرقمين من لوحة الأعداد.`,bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Level 2 – Challenge 5: Complete the fraction subtraction",rule:u=>`Place integers to make the equation true:  ${u.num}/${u.den} =  1/□  −  □/${u.d2}.  Drag the two numbers from the bank.`,bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check values",clear:"Clear"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Be):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Ne):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");function L(u,f){return Math.floor(Math.random()*(f-u+1))+u}function V(u){const f=u.slice();for(let $=f.length-1;$>0;$--){const E=Math.floor(Math.random()*($+1));[f[$],f[E]]=[f[E],f[$]]}return f}const M=B({num:1,den:6,d2:6}),A=B([]),m=B({A:null,N:null}),h=B(null),S=B(!1),T=[{id:"p1",target:{num:1,den:6},d2:6,solution:{A:2,N:2},extras:[1,3,4,5,7,8]},{id:"p2",target:{num:1,den:6},d2:9,solution:{A:2,N:3},extras:[1,4,5,6,7,8]},{id:"p3",target:{num:1,den:6},d2:12,solution:{A:2,N:4},extras:[1,3,5,6,7,9]},{id:"p4",target:{num:1,den:6},d2:6,solution:{A:3,N:1},extras:[2,4,5,7,8,9]},{id:"p5",target:{num:2,den:6},d2:6,solution:{A:2,N:1},extras:[3,4,5,7,8,9]},{id:"p6",target:{num:1,den:8},d2:8,solution:{A:2,N:3},extras:[1,2,4,5,6,7]},{id:"p7",target:{num:3,den:8},d2:8,solution:{A:2,N:1},extras:[2,4,5,6,7,9]},{id:"p8",target:{num:1,den:9},d2:9,solution:{A:3,N:2},extras:[1,3,4,5,6,7]},{id:"p9",target:{num:3,den:9},d2:6,solution:{A:2,N:1},extras:[2,4,5,7,8,9]},{id:"p10",target:{num:1,den:10},d2:5,solution:{A:2,N:2},extras:[1,3,4,6,7,8]},{id:"p11",target:{num:2,den:10},d2:10,solution:{A:2,N:3},extras:[1,4,5,6,7,9]},{id:"p12",target:{num:1,den:12},d2:4,solution:{A:3,N:1},extras:[2,5,6,7,8,9]}],F=B(T[0]),N=B(null);function G(){let u;do u=T[Math.floor(Math.random()*T.length)];while(u.id===N.value);return N.value=u.id,u}function J(u){const f=new Set([u.solution.A,u.solution.N,...u.extras||[]]);for(;f.size<8;)f.add(L(1,15));return V([...f])}const I=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function R(u){const f=String(u);return D.lang==="ar"?yr+f.replace(/[0-9]/g,$=>I[+$])+br:f}const z=q(()=>a.value==="ar"?`ضع عددًا كليًا في كل مربع لتصبح المعادلة صحيحة:  ${R(M.value.num)}/${R(M.value.den)} =  ${R(1)}/□  −  □/${R(M.value.d2)}.`:`Place integers to make the equation true:  ${M.value.num}/${M.value.den} =  1/□  −  □/${M.value.d2}.`);function W(){S.value=!1,h.value=null,m.value={A:null,N:null};const u=G();F.value=u,M.value={num:u.target.num,den:u.target.den,d2:u.d2},A.value=J(u)}function Y(u,f){u.dataTransfer.setData("text/plain",String(f))}function j(u){u.preventDefault()}function k(u,f){f.preventDefault(),m.value[u]=Number(f.dataTransfer.getData("text/plain")),h.value=null}function p(){return m.value.A!=null&&m.value.N!=null}function c(){if(!p())return!1;const u=1/m.value.A-m.value.N/M.value.d2,f=M.value.num/M.value.den;return Math.abs(u-f)<1e-9}async function d(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function w(){if(!p()){h.value=a.value==="ar"?"أكمل الخانتين":"Fill both blanks",b&&b.play();return}c()?(S.value=!0,h.value=l[a.value].correct,x&&x.play(),P&&P.play(),await d()):(h.value=l[a.value].wrong,b&&b.play())}function _(){m.value={A:null,N:null},h.value=null,S.value=!1}return ge(W),(u,f)=>(n(),o("div",{class:"lvl2c5 challenge-surface","data-theme":D.theme},[e("h2",qo,t(l[a.value].title),1),e("p",Qo,t(z.value),1),e("div",{class:"equation",dir:a.value==="ar"?"rtl":"ltr"},[a.value==="ar"?(n(),o(te,{key:0},[e("div",Wo,[e("div",Go,[e("div",{class:"drop",onDragover:j,onDrop:f[0]||(f[0]=$=>k("N",$))},[m.value.N!=null?(n(),o("span",Vo,t(R(m.value.N)),1)):(n(),o("span",Ko,"□"))],32)]),f[4]||(f[4]=e("div",{class:"bar"},null,-1)),e("div",Yo,t(R(M.value.d2)),1)]),f[6]||(f[6]=e("span",{class:"minus"},"−",-1)),e("div",Xo,[e("div",Jo,t(R(1)),1),f[5]||(f[5]=e("div",{class:"bar"},null,-1)),e("div",Zo,[e("div",{class:"drop",onDragover:j,onDrop:f[1]||(f[1]=$=>k("A",$))},[m.value.A!=null?(n(),o("span",er,t(R(m.value.A)),1)):(n(),o("span",tr,"□"))],32)])])],64)):(n(),o(te,{key:1},[e("div",ar,[f[7]||(f[7]=e("div",{class:"top"},"1",-1)),f[8]||(f[8]=e("div",{class:"bar"},null,-1)),e("div",lr,[e("div",{class:"drop",onDragover:j,onDrop:f[2]||(f[2]=$=>k("A",$))},[m.value.A!=null?(n(),o("span",nr,t(R(m.value.A)),1)):(n(),o("span",sr,"□"))],32)])]),f[10]||(f[10]=e("span",{class:"minus"},"−",-1)),e("div",or,[e("div",rr,[e("div",{class:"drop",onDragover:j,onDrop:f[3]||(f[3]=$=>k("N",$))},[m.value.N!=null?(n(),o("span",ir,t(R(m.value.N)),1)):(n(),o("span",cr,"□"))],32)]),f[9]||(f[9]=e("div",{class:"bar"},null,-1)),e("div",ur,t(R(M.value.d2)),1)])],64)),f[12]||(f[12]=e("span",{class:"eq"},"=",-1)),e("div",dr,[e("div",vr,t(R(M.value.num)),1),f[11]||(f[11]=e("div",{class:"bar"},null,-1)),e("div",hr,t(R(M.value.den)),1)])],8,Ho),e("div",pr,[e("div",fr,t(l[a.value].bank),1),e("div",mr,[(n(!0),o(te,null,le(A.value,$=>(n(),o("button",{key:$,class:"chip",draggable:"true",onDragstart:E=>Y(E,$)},t(R($)),41,gr))),128))])]),e("div",_r,[e("button",{class:"btn",onClick:_},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn primary",onClick:w},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:W},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),h.value?(n(),o("div",{key:0,class:oe(["toast",{ok:S.value}])},t(h.value),3)):re("",!0)],8,Uo))}},wr=fe(kr,[["__scopeId","data-v-c08f1cfd"]]),$r=["data-theme"],Cr={class:"head"},xr={class:"title"},Tr={class:"question"},Ar={class:"options"},Sr=["value"],Dr={class:"text"},Mr={class:"actions"},Lr={__name:"challenge_level_two_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثاني – التحدي 6: مقارنة الأوزان",question:"ما وزن المربع الواحد مقارنة بالمثلث؟",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة! أحسنت في مقارنة الأوزان.",wrong:"إجابة غير صحيحة. أعد التفكير في المعادلات.",pick:"اختر إجابة أولاً."},en:{title:"Level 2 – Challenge 6: Comparing weights",question:"How does the weight of the square compare to the triangle?",newQ:"New question",reset:"Reset",check:"Check",correct:"Correct! Great job comparing the weights.",wrong:"That is incorrect. Revisit the equations.",pick:"Select an option first."}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Be):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Ne):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");const L=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function V(u){return String(u).replace(/[0-9]/g,f=>L[Number(f)])}function M(u,f){return f==="ar"?V(u):String(u)}function A(u,f){return f==="ar"?u<=2?"وحدة":"وحدات":u===1?"unit":"units"}const m={ar:{double:"ضعف وزن المثلث",equal:"يساوي وزن المثلث",half:"نصف وزن المثلث",less:u=>`أقل بـ${V(u)} ${A(u,"ar")} من وزن المثلث`,more:u=>`أكثر بـ${V(u)} ${A(u,"ar")} من وزن المثلث`},en:{double:"Twice the triangle",equal:"Equal to the triangle",half:"Half the triangle",less:u=>`${u} ${A(u,"en")} less than the triangle`,more:u=>`${u} ${A(u,"en")} more than the triangle`}};function h(u,f){const $=Math.abs(u.difference),E=m[f];return[{id:"a",text:E.double},{id:"b",text:E.equal},{id:"c",text:E.half},{id:"d",text:E.less($)},{id:"e",text:E.more($)}]}function S(u,f){const $=M(u.totals.square,f),E=M(u.totals.triangle,f);return f==="ar"?[`وزن كرتان ومربع واحد يساويان ${$} وحدات.`,`وزن كرتان ومثلث واحد يساويان ${E} وحدات.`]:[`Two balls and one square weigh ${$} units.`,`Two balls and one triangle weigh ${E} units.`]}const T=[{id:"p1",totals:{square:8,triangle:6},difference:2,correctId:"e"},{id:"p2",totals:{square:10,triangle:7},difference:3,correctId:"e"},{id:"p3",totals:{square:9,triangle:11},difference:-2,correctId:"d"},{id:"p4",totals:{square:12,triangle:8},difference:4,correctId:"e"},{id:"p5",totals:{square:7,triangle:10},difference:-3,correctId:"d"}],F=B(T[0]),N=B(null),G=q(()=>F.value.correctId);function J(){if(T.length===1)return N.value=T[0].id,T[0];let u;do u=T[Math.floor(Math.random()*T.length)];while(u.id===N.value);return N.value=u.id,u}function I(u){return u.slice().sort(()=>Math.random()-.5)}const R=B(null),z=B(null),W=B(!1),Y=B(null);function j(){Y.value=I(h(F.value,a.value))}function k(){R.value=null,z.value=null,W.value=!1}async function p(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function c(){if(!R.value){z.value=l[a.value].pick,b&&b.play();return}if(R.value===G.value){const u=W.value;W.value=!0,z.value=l[a.value].correct,x&&x.play(),P&&P.play(),u||await p()}else W.value=!1,z.value=l[a.value].wrong,b&&b.play()}function d(){const u=J();F.value=u,k(),j()}me(()=>D.lang,()=>{k(),j()});const w=q(()=>Y.value||h(F.value,a.value)),_=q(()=>S(F.value,a.value));return ge(()=>{d()}),(u,f)=>(n(),o("div",{class:"lvl2c6 challenge-surface","data-theme":D.theme},[e("header",Cr,[e("h2",xr,t(l[a.value].title),1),(n(!0),o(te,null,le(_.value,($,E)=>(n(),o("p",{key:E,class:"premise"},t($),1))),128)),e("p",Tr,t(l[a.value].question),1)]),e("section",Ar,[(n(!0),o(te,null,le(w.value,$=>(n(),o("label",{key:$.id,class:oe(["option",{selected:R.value===$.id}])},[De(e("input",{type:"radio",name:"weight-comparison",value:$.id,"onUpdate:modelValue":f[0]||(f[0]=E=>R.value=E)},null,8,Sr),[[Et,R.value]]),f[1]||(f[1]=e("span",{class:"mark"},null,-1)),e("span",Dr,t($.text),1)],2))),128))]),e("section",Mr,[e("button",{class:"btn",onClick:c},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:k},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:d},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:ye(()=>[z.value?(n(),o("div",{key:0,class:oe(["feedback",{ok:W.value}])},t(z.value),3)):re("",!0)]),_:1})],8,$r))}},Br=fe(Lr,[["__scopeId","data-v-15b62468"]]),Nr=["data-theme"],Pr={class:"title"},Er={class:"rule"},zr={class:"hint"},Rr=["dir"],Or=["onDrop"],jr={key:1,class:"placeholder"},Ir=["onClick"],Fr={class:"bank"},Ur={class:"bank-title"},qr={class:"bank-items"},Qr=["onDragstart"],Hr={class:"actions"},Wr={__name:"challenge_level_three_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 1: هرم الضرب",rule:"املأ مربعات الهرم بحيث يساوي كل مربع أعلى حاصل ضرب الخليتين تحته. اسحب الأرقام الصحيحة من اللوحة حتى يكتمل الهرم.",hint:"تذكّر أن كل خطوة نحو الأعلى هي نتيجة ضرب الخليتين في الأسفل مباشرة.",bank:"لوحة الأرقام",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"أحسنت! اكتمل الهرم.",wrong:"تحقّق مرة أخرى، هناك قيمة في غير مكانها.",clear:"تفريغ الخلية"},en:{title:"Level 3 – Challenge 1: Multiplication Pyramid",rule:"Fill the pyramid so every cell above equals the product of the two cells directly beneath it.",hint:"Each step upward = product of the two numbers underneath.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Great! The pyramid is complete.",wrong:"Something is off. Recheck placements.",clear:"Clear cell"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Le):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Oe):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");function L($,E){return Math.floor(Math.random()*(E-$+1))+$}function V($){const E=$.slice();for(let v=E.length-1;v>0;v--){const s=Math.floor(Math.random()*(v+1));[E[v],E[s]]=[E[s],E[v]]}return E}function M($,E){return`${$},${E}`}const A=B([]),m=B(new Set),h=pe({}),S=pe({}),T=pe({}),F=B(null),N=B(!1),G=q(()=>({direction:"ltr",unicodeBidi:"isolate"})),J=q(()=>A.value.map(($,E)=>({cells:$,index:E})).slice().reverse());function I($){let E=0;for(const v in h)h[v]===$&&E++;return E}function R(){const $={};for(const[E,v]of Object.entries(S)){const s=Number(E),r=v-I(s);r>0&&($[s]=r)}for(const E in T)delete T[E];Object.entries($).forEach(([E,v])=>T[E]=v)}function z(){for(;;){const E=[Array.from({length:4},()=>L(2,6))];for(let v=1;v<4;v++){const s=E[v-1],r=[];for(let i=0;i<s.length-1;i++)r.push(s[i]*s[i+1]);E.push(r)}if(E[3][0]<=5e4)return E}}function W(){N.value=!1,F.value=null;const $=z();A.value=$,m.value=new Set;for(const v in h)delete h[v];for(let v=1;v<A.value.length;v++)for(let s=0;s<A.value[v].length;s++)m.value.add(M(v,s));const E={};m.value.forEach(v=>{const[s,r]=v.split(",").map(Number),i=A.value[s][r];E[i]=(E[i]||0)+1});for(const v in S)delete S[v];Object.entries(E).forEach(([v,s])=>S[v]=s),R()}function Y($){$.preventDefault()}function j($,E){$.dataTransfer.setData("text/plain",String(E))}function k($,E){if(E.preventDefault(),!m.value.has($))return;const v=Number(E.dataTransfer.getData("text/plain"));Number.isNaN(v)||!S[v]||h[$]!==v&&(I(v)>=S[v]||(h[$]=v,R(),F.value=null))}function p($){h[$]!=null&&(delete h[$],R())}function c(){for(const $ of m.value)if(h[$]==null)return!1;return!0}function d(){for(const $ of m.value){const[E,v]=$.split(",").map(Number);if(h[$]!==A.value[E][v])return!1}return!0}async function w(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function _(){if(!c()){F.value=a.value==="ar"?"أكمل كل الخانات أولاً.":"Fill all blanks first.",b&&b.play();return}d()?(N.value=!0,F.value=l[a.value].correct,x&&x.play(),P&&P.play(),await w()):(F.value=l[a.value].wrong,b&&b.play())}function u(){for(const $ in h)delete h[$];N.value=!1,F.value=null,R()}const f=q(()=>{const $=[];for(const[E,v]of Object.entries(T))for(let s=0;s<v;s++)$.push(Number(E));return V($)});return ge(W),me(()=>D.lang,()=>{F.value&&(F.value=null)}),($,E)=>(n(),o("div",{class:"lvl3c1 challenge-surface","data-theme":D.theme},[e("h2",Pr,t(l[a.value].title),1),e("p",Er,t(l[a.value].rule),1),e("p",zr,t(l[a.value].hint),1),e("div",{class:"pyramid",dir:D.lang==="ar"?"rtl":"ltr"},[(n(!0),o(te,null,le(J.value,v=>(n(),o("div",{class:"p-row",key:v.index},[(n(!0),o(te,null,le(v.cells,(s,r)=>(n(),o("div",{class:"brick",key:v.index+"-"+r},[m.value.has(M(v.index,r))?(n(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:Y,onDrop:i=>k(M(v.index,r),i)},[h[M(v.index,r)]!=null?(n(),o("span",{key:0,class:"num",style:de(G.value)},t(h[M(v.index,r)]),5)):(n(),o("span",jr,"؟"))],40,Or),e("button",{class:"clear",onClick:i=>p(M(v.index,r))},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)],8,Ir)],64)):(n(),o("span",{key:0,class:"num",style:de(G.value)},t(s),5))]))),128))]))),128))],8,Rr),e("div",Fr,[e("div",Ur,t(l[a.value].bank),1),e("div",qr,[(n(!0),o(te,null,le(f.value,(v,s)=>(n(),o("button",{key:v+"_"+s,class:"chip",draggable:"true",onDragstart:r=>j(r,v),style:de(G.value)},t(v),45,Qr))),128))])]),e("div",Hr,[e("button",{class:"btn",onClick:u},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn primary",onClick:_},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:W},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),F.value?(n(),o("div",{key:0,class:oe(["toast",{ok:N.value}])},t(F.value),3)):re("",!0)],8,Nr))}},Gr=fe(Wr,[["__scopeId","data-v-e7c52a8a"]]),Vr=["data-theme"],Kr={class:"head"},Yr={class:"title"},Xr={class:"rule"},Jr={class:"board"},Zr={class:"cards"},ei=["onDrop"],ti={key:0,class:"num"},ai={key:1,class:"placeholder"},li=["value","onInput","onChange","onBlur","placeholder"],ni=["onClick"],si={class:"facts"},oi={class:"bank"},ri={class:"bank-title"},ii={class:"bank-items"},ci=["onDragstart"],ui={class:"actions"},di=4,vi={__name:"challenge_level_three_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 2: الأرقام المفقودة على البطاقات",rule:"أمامك بطاقات ملوّنة بأرقام مفقودة. استخدم المعلومات المعطاة (المجموع، المتوسط، الوسيط، المدى) لتحديد الرقم المناسب لكل بطاقة، ثم اسحبه من لوحة الأعداد أو اكتبه يدويًا.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"مسح",check:"تحقّق",correct:"أحسنت! الأرقام صحيحة.",wrong:"تحقّق من القيم مرة أخرى.",clear:"تفريغ البطاقة",hints:{sum:"المجموع",mean:"المتوسط الحسابي",median:"الوسيط",range:"المدى"},manualPlaceholder:"أدخل رقمًا"},en:{title:"Level 3 – Challenge 2: Missing numbers on the cards",rule:"Each coloured card is missing its number. Use the given information (sum, mean, median, range) to deduce the correct value for every card, then drag a number from the bank or type it manually.",bank:"Number bank",newQ:"New puzzle",reset:"Clear",check:"Check",correct:"Great! All numbers are correct.",wrong:"Something is off – recheck the values.",clear:"Clear card",hints:{sum:"Sum",mean:"Mean",median:"Median",range:"Range"},manualPlaceholder:"Type value"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=q(()=>D.lang==="ar"?"ar-EG":"en-US"),P=typeof Audio!="undefined"?new Audio(Le):null,b=typeof Audio!="undefined"?new Audio($e):null,L=typeof Audio!="undefined"?new Audio(Ne):null;P&&(P.preload="auto"),b&&(b.preload="auto"),L&&(L.preload="auto");const V=["green","gold","teal","magenta","sky","orange","crimson"],M=[{numbers:[4,8,12,16,20]},{numbers:[5,9,11,13,22]},{numbers:[7,10,12,18,23]},{numbers:[6,8,15,19,22]},{numbers:[9,11,14,20,26]}];function A(C){const O=C.slice().sort((ie,ue)=>ie-ue),H=O.reduce((ie,ue)=>ie+ue,0),Z=H/O.length,X=O[Math.floor(O.length/2)],se=O[O.length-1]-O[0];return{sum:H,mean:Z,median:X,range:se}}const m=B([]),h=pe({}),S=B(new Set),T=pe({}),F=pe({}),N=pe({}),G=pe({}),J=pe({}),I=pe({}),R=B({sum:0,mean:0,median:0,range:0}),z=B(null),W=B(!1);function Y(C){for(const O of Object.keys(C))delete C[O]}function j(){const O=M[Math.floor(Math.random()*M.length)].numbers.slice(),H=V.slice(0,O.length).sort(()=>Math.random()-.5),Z=O.slice().sort(()=>Math.random()-.5);m.value=[],S.value=new Set,Y(h),Y(G),Y(J),Y(I),Y(T),Y(F),Y(N),Z.forEach((ve,Ce)=>{const Pe=`card-${Ce}`;m.value.push({id:Pe,value:ve,color:H[Ce%H.length]}),h[Pe]=ve,S.value.add(Pe),T[ve]=(T[ve]||0)+1});for(const[ve,Ce]of Object.entries(T))N[ve]=Ce;const X=Math.min(...O),se=Math.max(...O),ie=Math.max(1,X-12),ue=se+12,Te=new Set;for(;Te.size<di;){const ve=Math.floor(Math.random()*(ue-ie+1))+ie;T[ve]||Te.add(ve)}Te.forEach(ve=>{F[ve]=(F[ve]||0)+1,N[ve]=(N[ve]||0)+1}),R.value=A(O),z.value=null,W.value=!1}function k(C,O){C.dataTransfer.setData("text/plain",String(O))}function p(C){C.preventDefault()}function c(C,O,H){if(Number.isNaN(O))return!1;if(G[C]!=null&&J[C]==="bank"){const Z=G[C];N[Z]=(N[Z]||0)+1}if(H==="bank"){if((N[O]||0)<=0)return!1;N[O]=(N[O]||0)-1}return G[C]=O,J[C]=H,I[C]=String(O),z.value=null,W.value=!1,!0}function d(C,O){C.preventDefault();const H=Number(C.dataTransfer.getData("text/plain"));Number.isNaN(H)||c(O,H,"bank")}function w(C){if(G[C]!=null&&J[C]==="bank"){const O=G[C];N[O]=(N[O]||0)+1}delete G[C],delete J[C],I[C]="",z.value=null,W.value=!1}function _(){for(const C of S.value)if(G[C]==null)return!1;return!0}function u(){const C={};for(const O of S.value){const H=G[O];if(H==null)return!1;C[H]=(C[H]||0)+1}for(const[O,H]of Object.entries(T))if((C[O]||0)!==H)return!1;return!0}async function f(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function $(){if(!_()){z.value=a.value==="ar"?"أكمل كل البطاقات أولاً.":"Fill every card first.",L&&L.play();return}u()?(W.value=!0,z.value=l[a.value].correct,P&&P.play(),b&&b.play(),await f()):(z.value=l[a.value].wrong,L&&L.play())}function E(){Y(G),Y(J),Y(I),Y(N);for(const[C,O]of Object.entries(T))N[C]=O;for(const[C,O]of Object.entries(F))N[C]=(N[C]||0)+O;z.value=null,W.value=!1}const v=q(()=>{const C=[];for(const[O,H]of Object.entries(N))for(let Z=0;Z<H;Z++)C.push({value:Number(O),key:`${O}-${Z}`});return C});function s(C,O){I[C]=O}function r(C){var Z;const O=((Z=I[C])!=null?Z:"").trim();if(O===""){w(C);return}const H=Number(O);Number.isFinite(H)&&c(C,H,"manual")}const i=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function y(C){const O=String(C);return D.lang!=="ar"?O:O.replace(/[0-9]/g,H=>i[Number(H)])}function g(C,O={}){return new Intl.NumberFormat(x.value,O).format(C)}return ge(j),me(()=>D.lang,()=>{z.value&&W.value||(z.value=null)}),(C,O)=>(n(),o("div",{class:"lvl3c2 challenge-surface","data-theme":D.theme},[e("header",Kr,[e("h2",Yr,t(l[a.value].title),1),e("p",Xr,t(l[a.value].rule),1)]),e("section",Jr,[e("div",Zr,[(n(!0),o(te,null,le(m.value,H=>{var Z;return n(),o("div",{key:H.id,class:oe(["card","color-"+H.color])},[e("div",{class:"drop",onDragover:p,onDrop:X=>d(X,H.id)},[G[H.id]!=null?(n(),o("span",ti,t(y(G[H.id])),1)):(n(),o("span",ai,"؟"))],40,ei),e("input",{class:"manual-entry",type:"number",inputmode:"numeric",value:(Z=I[H.id])!=null?Z:"",onInput:X=>s(H.id,X.target.value),onChange:X=>r(H.id),onBlur:X=>r(H.id),placeholder:l[a.value].manualPlaceholder},null,40,li),e("button",{class:"clear",onClick:X=>w(H.id)},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)],8,ni)],2)}),128))]),e("aside",si,[e("h3",null,t(D.lang==="ar"?"المعلومات المتاحة":"Given facts"),1),e("ul",null,[e("li",null,[e("strong",null,t(l[a.value].hints.sum)+":",1),K(" "+t(g(R.value.sum)),1)]),e("li",null,[e("strong",null,t(l[a.value].hints.mean)+":",1),K(" "+t(g(R.value.mean,{maximumFractionDigits:2})),1)]),e("li",null,[e("strong",null,t(l[a.value].hints.median)+":",1),K(" "+t(g(R.value.median)),1)]),e("li",null,[e("strong",null,t(l[a.value].hints.range)+":",1),K(" "+t(g(R.value.range)),1)])])])]),e("section",oi,[e("div",ri,t(l[a.value].bank),1),e("div",ii,[(n(!0),o(te,null,le(v.value,H=>(n(),o("button",{key:H.key,class:"chip",draggable:"true",onDragstart:Z=>k(Z,H.value)},t(y(H.value)),41,ci))),128))])]),e("section",ui,[e("button",{class:"btn",onClick:E},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn primary",onClick:$},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:j},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:ye(()=>[z.value?(n(),o("div",{key:0,class:oe(["toast",{ok:W.value}])},t(z.value),3)):re("",!0)]),_:1})],8,Vr))}},hi=fe(vi,[["__scopeId","data-v-70cc11ae"]]),pi=["data-theme"],fi={class:"head"},mi={class:"title"},gi={class:"rule"},_i={class:"status"},yi={class:"chip target"},bi={class:"chip sum"},ki={class:"grid"},wi=["onClick"],$i={class:"actions"},Ci={__name:"challenge_level_three_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 3: خطوط المجموع العشري",rule:"اختر أرقامًا متجاورة على خط مستقيم (أفقي، عمودي أو قطري) بحيث يساوي مجموعها القيمة المطلوبة.",targetLabel:"المجموع المطلوب",selected:"المجموع الحالي",check:"تحقّق",reset:"إعادة اختيار",newQ:"سؤال جديد",needSelection:"اختر خانات أولاً.",wrongLine:"يجب أن تكون الخانات المختارة على خط مستقيم ومتجاورة.",wrongSum:"المجموع لا يساوي القيمة المطلوبة.",correct:"رائع! خط صحيح."},en:{title:"Level 3 – Challenge 3: Decimal Sum Lines",rule:"Pick numbers lying on one straight line (horizontal, vertical, or diagonal) so their sum equals the target.",targetLabel:"Target sum",selected:"Current sum",check:"Check",reset:"Reset selection",newQ:"New puzzle",needSelection:"Select cells first.",wrongLine:"Selections must be contiguous on a straight line.",wrongSum:"The sum does not match the target.",correct:"Great! You found a valid line."}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Le):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(at):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");const L=[{id:"p1",target:10,grid:[[1.2,.8,2.5,1.3,.9],[2.1,3.4,2,.6,1.5],[1.8,2.2,1.5,3,1.1],[.5,1.6,1.7,2,3.5],[1.4,1.3,2.3,1.8,2.7]],solution:[{r:0,c:2},{r:1,c:2},{r:2,c:2},{r:3,c:2},{r:4,c:2}]},{id:"p2",target:10,grid:[[.8,1.7,2.1,.9,1.4],[2.6,1.5,1.9,1.1,2.9],[1.3,2.4,1.2,2.2,1.6],[.7,1.8,2.5,1.7,2.3],[1.9,.6,1.8,2.6,.9]],solution:[{r:1,c:0},{r:1,c:1},{r:1,c:2},{r:1,c:3},{r:1,c:4}]},{id:"p3",target:10,grid:[[2.5,1.1,.8,1.4,1.2],[.9,2,1.3,1.7,1],[1.6,1.2,1.8,1.1,1.3],[1.4,1.9,1.5,1.5,1.8],[1.3,1.4,.9,1.6,2.2]],solution:[{r:0,c:0},{r:1,c:1},{r:2,c:2},{r:3,c:3},{r:4,c:4}]},{id:"p4",target:10,grid:[[1.1,.9,1.7,1.3,2.1],[2,1.4,2,1.1,1.6],[1.5,2.2,1.8,1.4,1.3],[.8,1.9,2.3,1.2,1.1],[1.6,1.5,2.2,1.7,.9]],solution:[{r:0,c:2},{r:1,c:2},{r:2,c:2},{r:3,c:2},{r:4,c:2}]},{id:"p5",target:10.2,grid:[[1,1.3,.9,1.5,1.9],[1.6,1.2,1.4,1.8,1],[1.7,1.1,2.1,1.4,1.2],[2.4,2,1.5,1.3,.8],[2.4,1.5,1.6,1.1,.7]],solution:[{r:0,c:4},{r:1,c:3},{r:2,c:2},{r:3,c:1},{r:4,c:0}]},{id:"p6",target:9,grid:[[1.8,2.2,1.6,1.5,1.9],[1.3,.9,2.1,2.5,1.1],[1.4,1.7,1.2,1.8,1.6],[1,2.3,1.5,1.4,2.2],[1.6,1.1,2,1.7,.8]],solution:[{r:0,c:0},{r:0,c:1},{r:0,c:2},{r:0,c:3},{r:0,c:4}]},{id:"p7",target:9.3,grid:[[1.2,1.5,2.1,1,1.4],[.9,2,1.7,1.9,1.2],[1.3,1.8,2.2,1.6,1.1],[1.5,1.9,1.4,1.7,2.3],[1,2.1,1.5,1.2,1.8]],solution:[{r:0,c:1},{r:1,c:1},{r:2,c:1},{r:3,c:1},{r:4,c:1}]},{id:"p8",target:9,grid:[[1.4,1.2,2,1.6,.9],[1.1,1.8,1.4,2.3,1.5],[2.2,1.3,1.7,1.2,1.1],[1.5,2.4,1.6,1.5,1.9],[2,1.7,1.5,1.4,2.6]],solution:[{r:0,c:0},{r:1,c:1},{r:2,c:2},{r:3,c:3},{r:4,c:4}]},{id:"p9",target:10,grid:[[1.6,1,1.2,1.9,2.1],[1.3,1.5,2.2,1.8,1.1],[2,1.8,1.4,1.5,1.7],[1.2,2.3,1.6,1.7,1],[2.4,1.9,1.5,1.2,.8]],solution:[{r:0,c:4},{r:1,c:3},{r:2,c:2},{r:3,c:1},{r:4,c:0}]},{id:"p10",target:9,grid:[[1,1.7,1.3,2.1,1.6],[1.5,1.1,2.4,1.6,1.8],[1.9,2,1.5,1.2,1.3],[1.4,1.9,1.7,2,1.1],[2.1,2,1.8,1.5,1.6]],solution:[{r:4,c:0},{r:4,c:1},{r:4,c:2},{r:4,c:3},{r:4,c:4}]}],V=B(L[0]),M=B(null),A=B(new Set),m=B(!1),h=B(null);function S(j,k){return`${j},${k}`}function T(){if(L.length===1)return M.value=L[0].id,L[0];let j;do j=L[Math.floor(Math.random()*L.length)];while(j.id===M.value);return M.value=j.id,j}function F(){A.value=new Set,m.value=!1,h.value=null}function N(){const j=T();V.value=j,F()}function G(j,k){const p=S(j,k),c=new Set(A.value);c.has(p)?c.delete(p):c.add(p),A.value=c,m.value=!1,h.value=null}const J=q(()=>Array.from(A.value).map(j=>{const[k,p]=j.split(",").map(Number);return{r:k,c:p}})),I=q(()=>J.value.reduce((j,k)=>j+V.value.grid[k.r][k.c],0));function R(j){if(j.length<2)return!0;const k=j.map(f=>f.r),p=j.map(f=>f.c),c=k.every(f=>f===k[0]),d=p.every(f=>f===p[0]),w=k.every((f,$)=>f-p[$]===k[0]-p[0]),_=k.every((f,$)=>f+p[$]===k[0]+p[0]);if(!c&&!d&&!w&&!_)return!1;const u=[...j];if(c){u.sort((f,$)=>f.c-$.c);for(let f=1;f<u.length;f++)if(u[f].c-u[f-1].c!==1)return!1;return!0}if(d){u.sort((f,$)=>f.r-$.r);for(let f=1;f<u.length;f++)if(u[f].r-u[f-1].r!==1)return!1;return!0}if(w){u.sort((f,$)=>f.r-$.r);for(let f=1;f<u.length;f++)if(u[f].r-u[f-1].r!==1||u[f].c-u[f-1].c!==1)return!1;return!0}u.sort((f,$)=>f.r-$.r);for(let f=1;f<u.length;f++)if(u[f].r-u[f-1].r!==1||u[f-1].c-u[f].c!==1)return!1;return!0}async function z(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function W(){if(!A.value.size){h.value=l[a.value].needSelection,b&&b.play();return}const j=J.value;if(!R(j)){h.value=l[a.value].wrongLine,b&&b.play();return}const k=I.value;if(Math.abs(k-V.value.target)>1e-6){h.value=l[a.value].wrongSum,b&&b.play();return}m.value=!0,h.value=l[a.value].correct,x&&x.play(),P&&P.play(),await z()}function Y(j,k){return V.value.solution.some(p=>p.r===j&&p.c===k)}return ge(()=>{N()}),(j,k)=>(n(),o("div",{class:"lvl3c3 challenge-surface","data-theme":D.theme},[e("header",fi,[e("h2",mi,t(l[a.value].title),1),e("p",gi,t(l[a.value].rule),1)]),e("section",_i,[e("div",yi,[K(t(l[a.value].targetLabel)+": ",1),e("strong",null,t(V.value.target.toFixed(1)),1)]),e("div",bi,[K(t(l[a.value].selected)+": ",1),e("strong",null,t(I.value.toFixed(1)),1)])]),e("section",ki,[(n(!0),o(te,null,le(V.value.grid,(p,c)=>(n(),o("div",{key:c,class:"row"},[(n(!0),o(te,null,le(p,(d,w)=>(n(),o("button",{key:w,class:oe(["cell",{selected:A.value.has(S(c,w)),success:m.value&&Y(c,w)}]),onClick:_=>G(c,w)},t(d.toFixed(1)),11,wi))),128))]))),128))]),e("section",$i,[e("button",{class:"btn",onClick:W},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:F},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:N},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:ye(()=>[h.value?(n(),o("div",{key:0,class:oe(["feedback",{ok:m.value}])},t(h.value),3)):re("",!0)]),_:1})],8,pi))}},xi=fe(Ci,[["__scopeId","data-v-413d5506"]]),Ti=["data-theme"],Ai={class:"head"},Si={class:"title"},Di={class:"equations"},Mi={class:"expression"},Li=["innerHTML"],Bi=["onDrop"],Ni=["innerHTML"],Pi={key:1,class:"placeholder"},Ei=["onClick"],zi={class:"bank"},Ri={class:"bank-title"},Oi={class:"bank-items"},ji=["onDragstart","innerHTML"],Ii={class:"actions"},mt="⁦",gt="⁩",_t=" ",Fi={__name:"challenge_level_three_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 4: أزل النقطة الحمراء",intro:["هذه المعادلات للتفكير في العمليات على الأعداد العشرية.","كل نقطة ● تمثل رقمًا واحدًا. اسحب الرقم الصحيح من لوحة الأرقام إلى مكانه حتى تصبح المعادلات صحيحة."],check:"تحقّق",reset:"مسح الكل",newQ:"سؤال جديد",incomplete:"أكمل كل الخانات أولًا.",wrong:"هناك معادلة غير صحيحة.",correct:"أحسنت! جميع المعادلات صحيحة.",bank:"لوحة الأرقام",clear:"تفريغ"},en:{title:"Level 3 – Challenge 4: Replace the red dot",intro:["These equations practice decimal operations.","Each red dot ● hides a single digit. Drag the correct digit from the number bank to make every equation true."],check:"Check",reset:"Clear all",newQ:"New puzzle",incomplete:"Fill every blank first.",wrong:"One or more equations are incorrect.",correct:"Great! All equations are valid.",bank:"Number bank",clear:"Clear"}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Be):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Ne):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");const L=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function V(v,s){const i=(typeof v=="number"&&s!=null?v.toFixed(s):String(v)).replace(/[0-9]/g,y=>L[+y]).replace(/\./g,`${_t}٫${_t}`);return mt+i+gt}function M(v){const s=String(v);return D.lang==="ar"?mt+s.replace(/[0-9]/g,r=>L[+r])+gt:s}function A({multiplier:v,offset:s,aDigit:r,bDigit:i}){const y=V(v,1),g=v.toFixed(1),O=s.toFixed(2).slice(1),H=V(O);return{id:"eqA",slots:{a:r,b:i},order:["a","b"],template:{ar:["أ. ",{num:!0,text:y}," × ",{num:!0,text:"٠"},"٫",{slot:"a"}," = ",{slot:"b"},{num:!0,text:H}],en:["A. ",{num:!0,text:g}," × 0.",{slot:"a"}," = ",{slot:"b"},O]},evaluate(Z){const X=v*(Z.a/10),se=Z.b+s;return Math.abs(X-se)<1e-6}}}function m({baseLeft:v,baseRight:s,cDigit:r,dDigit:i,result:y,decimals:g=2}){const C=V(v,0),O=V(s,0),H=`${v}`,Z=`${s}`,X=g!=null?y.toFixed(g):String(y),se=V(X);return{id:"eqB",slots:{c:r,d:i},order:["c","d"],template:{ar:["ب. ",{num:!0,text:C},"٫",{slot:"c"}," × ",{num:!0,text:O},"٫",{slot:"d"}," = ",{num:!0,text:se}],en:["B. ",{num:!0,text:H},".",{slot:"c"}," × ",{num:!0,text:Z},".",{slot:"d"}," = ",X]},evaluate(ie){const ue=(v+ie.c/10)*(s+ie.d/10);return Math.abs(ue-y)<1e-6}}}function h({secondBase:v,eDigit:s,fDigit:r,result:i,decimals:y=2}){const g=V(v,0),C=`${v}`,O=y!=null?i.toFixed(y):String(i),H=V(O);return{id:"eqC",slots:{e:s,f:r},order:["e","f"],template:{ar:["ج. ",{slot:"e"},"٫",{num:!0,text:V(9,0)}," × ",{num:!0,text:g},"٫",{slot:"f"}," = ",{num:!0,text:H}],en:["C. ",{slot:"e"},".9 × ",{num:!0,text:C},".",{slot:"f"}," = ",O]},evaluate(Z){const X=(Z.e+.9)*(v+Z.f/10);return Math.abs(X-i)<1e-6}}}function S({gDigit:v,hDigit:s}){return{id:"eqD",slots:{g:v,h:s},order:["g","h"],template:{ar:["د. ",{num:!0,text:"٤"},"٫",{slot:"g"}," + ",{num:!0,text:"١٫٢٥"}," = ",{num:!0,text:"٥"},"٫",{slot:"h"},{num:!0,text:"٥"}],en:["D. 4.",{slot:"g"}," + 1.25 = 5.",{slot:"h"},"5"]},evaluate(r){const i=4+r.g/10+1.25,y=5+r.h/10+.05;return Math.abs(i-y)<1e-6}}}const T=[{id:"p1",equations:[A({multiplier:9.3,offset:.44,aDigit:8,bDigit:7}),m({baseLeft:2,baseRight:2,cDigit:4,dDigit:9,result:6.96,decimals:2}),h({secondBase:3,eDigit:4,fDigit:7,result:18.13,decimals:2}),S({gDigit:7,hDigit:9})]},{id:"p2",equations:[A({multiplier:8.6,offset:.16,aDigit:6,bDigit:5}),m({baseLeft:2,baseRight:2,cDigit:1,dDigit:6,result:5.46,decimals:2}),h({secondBase:3,eDigit:2,fDigit:5,result:10.15,decimals:2}),S({gDigit:3,hDigit:5})]},{id:"p3",equations:[A({multiplier:7.8,offset:.24,aDigit:8,bDigit:6}),m({baseLeft:2,baseRight:2,cDigit:5,dDigit:2,result:5.5,decimals:2}),h({secondBase:3,eDigit:3,fDigit:6,result:14.04,decimals:2}),S({gDigit:2,hDigit:4})]},{id:"p4",equations:[A({multiplier:6.4,offset:.28,aDigit:2,bDigit:1}),m({baseLeft:2,baseRight:2,cDigit:8,dDigit:3,result:6.44,decimals:2}),h({secondBase:3,eDigit:5,fDigit:2,result:18.88,decimals:2}),S({gDigit:4,hDigit:6})]},{id:"p5",equations:[A({multiplier:6.4,offset:.12,aDigit:8,bDigit:5}),m({baseLeft:2,baseRight:2,cDigit:0,dDigit:9,result:5.8,decimals:2}),h({secondBase:3,eDigit:6,fDigit:1,result:21.39,decimals:2}),S({gDigit:1,hDigit:3})]}],F=B(T[0]),N=B(null),G=pe({}),J=pe({}),I=pe({}),R=B([]),z=B(null),W=B(!1);function Y(v){return v.slice().sort(()=>Math.random()-.5)}function j(){if(T.length===1)return N.value=T[0].id,T[0];let v;do v=T[Math.floor(Math.random()*T.length)];while(v.id===N.value);return N.value=v.id,v}function k(){const v=j();F.value=v,z.value=null,W.value=!1,Object.keys(G).forEach(r=>delete G[r]),Object.keys(J).forEach(r=>delete J[r]),Object.keys(I).forEach(r=>delete I[r]);const s=[];v.equations.forEach(r=>{r.order.forEach(i=>{const y=`${r.id}-${i}`;s.push({key:y,eq:r,slotName:i}),G[y]=null;const g=r.slots[i];J[g]=(J[g]||0)+1,I[g]=(I[g]||0)+1})}),R.value=s}function p(v){v.preventDefault()}function c(v,s){v.dataTransfer.setData("text/plain",String(s))}function d(v,s){v.preventDefault();const r=Number(v.dataTransfer.getData("text/plain"));if(!Number.isNaN(r)&&!((I[r]||0)<=0&&G[s]!==r)){if(G[s]!=null){const i=G[s];I[i]=(I[i]||0)+1}G[s]!==r&&(I[r]=(I[r]||0)-1,I[r]<0&&(I[r]=0)),G[s]=r,z.value=null,W.value=!1}}function w(v){if(G[v]!=null){const s=G[v];I[s]=(I[s]||0)+1,G[v]=null,z.value=null,W.value=!1}}const _=q(()=>{const v=[];for(const[s,r]of Object.entries(I))for(let i=0;i<r;i++)v.push({value:Number(s),key:`${s}-${i}`});return Y(v)});function u(){return R.value.every(v=>G[v.key]!=null)}async function f(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function $(){if(!u()){z.value=l[a.value].incomplete,b&&b.play();return}const{equations:v}=F.value;for(const s of v){const r={};for(const i of s.order)r[i]=G[`${s.id}-${i}`];if(!s.evaluate(r)){z.value=l[a.value].wrong,b&&b.play();return}}z.value=l[a.value].correct,W.value=!0,x&&x.play(),P&&P.play(),await f()}function E(){R.value.forEach(v=>{if(G[v.key]!=null){const s=G[v.key];I[s]=(I[s]||0)+1,G[v.key]=null}}),z.value=null,W.value=!1}return ge(k),me(()=>D.lang,()=>{W.value||(z.value=null)}),(v,s)=>(n(),o("div",{class:"lvl3c4 challenge-surface","data-theme":D.theme},[e("header",Ai,[e("h2",Si,t(l[a.value].title),1),(n(!0),o(te,null,le(l[a.value].intro,(r,i)=>(n(),o("p",{key:i,class:"intro"},t(r),1))),128))]),e("section",Di,[(n(!0),o(te,null,le(F.value.equations,r=>(n(),o("div",{key:r.id,class:"card"},[e("div",Mi,[(n(!0),o(te,null,le(D.lang==="ar"?r.template.ar:r.template.en,(i,y)=>(n(),o("span",{key:y},[typeof i=="string"?(n(),o(te,{key:0},[K(t(i),1)],64)):i.num?(n(),o("span",{key:1,class:"num",innerHTML:i.text},null,8,Li)):(n(),o(te,{key:2},[e("span",{class:"slot",onDragover:p,onDrop:g=>d(g,r.id+"-"+i.slot)},[G[r.id+"-"+i.slot]!=null?(n(),o("span",{key:0,class:"digit",innerHTML:M(G[r.id+"-"+i.slot])},null,8,Ni)):(n(),o("span",Pi,"●"))],40,Bi),e("button",{class:"clear",onClick:g=>w(r.id+"-"+i.slot)},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)],8,Ei)],64))]))),128))])]))),128))]),e("section",zi,[e("div",Ri,t(l[a.value].bank),1),e("div",Oi,[(n(!0),o(te,null,le(_.value,r=>(n(),o("button",{key:r.key,class:"chip",draggable:"true",onDragstart:i=>c(i,r.value),innerHTML:M(r.value)},null,40,ji))),128))])]),e("section",Ii,[e("button",{class:"btn",onClick:$},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:E},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:k},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:ye(()=>[z.value?(n(),o("div",{key:0,class:oe(["feedback",{ok:W.value}])},t(z.value),3)):re("",!0)]),_:1})],8,Ti))}},Ui=fe(Fi,[["__scopeId","data-v-be117a7f"]]),qi=["data-theme"],Qi={class:"head"},Hi={class:"title"},Wi={class:"equation"},Gi={class:"fraction"},Vi={class:"row"},Ki=["onDrop"],Yi={key:0,class:"digit"},Xi={key:1,class:"placeholder"},Ji={class:"row"},Zi=["onDrop"],ec={key:0,class:"digit"},tc={key:1,class:"placeholder"},ac={class:"fraction"},lc={class:"row"},nc=["onDrop"],sc={key:0,class:"digit"},oc={key:1,class:"placeholder"},rc={class:"row"},ic=["onDrop"],cc={key:0,class:"digit"},uc={key:1,class:"placeholder"},dc={key:0,class:"digit"},vc={key:1,class:"placeholder"},hc={class:"controls"},pc={class:"bank"},fc={class:"bank-title"},mc={class:"bank-items"},gc=["onDragstart"],_c={__name:"challenge_level_three_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 5: بطاقات الكسر المفقود",intro:["استخدم البطاقات المرقّمة من ١ إلى ٩ مرة واحدة فقط لتكوين الكسرين بحيث يكون الناتج مساويًا للقيمة المطلوبة.","اسحب الرقم المناسب إلى كل خانة للبسط أو المقام، ثم تحقّق من صحة الناتج."],bank:"البطاقات المتاحة",check:"تحقّق",reset:"مسح الاختيار",newQ:"تحدٍ جديد",clear:"تفريغ",needAll:"املأ كل الخانات أولًا.",wrong:"المعادلة غير صحيحة، جرّب ترتيبًا آخر.",correct:"أحسنت! أنتجت الكسور الصحيحة."},en:{title:"Level 3 – Challenge 5: Missing Fraction Cards",intro:["Use the cards labelled 1 through 9 exactly once to build two fractions whose sum matches the target.","Drag each digit into the correct numerator or denominator, then check your result."],bank:"Available cards",check:"Check",reset:"Reset selection",newQ:"New challenge",clear:"Clear",needAll:"Fill every slot first.",wrong:"The equation is not satisfied—try another arrangement.",correct:"Great! The fractions are correct."}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Le):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Oe):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");const L={n1:["n1a","n1b"],d1:["d1a","d1b"],n2:["n2a","n2b"],d2:["d2a","d2b"],res:["res"]},V=[{id:"p1",solution:{n1:["2","9"],d1:["1","6"],n2:["5","7"],d2:["4","8"],res:["3"]}},{id:"p2",solution:{n1:["3","9"],d1:["2","7"],n2:["6","4"],d2:["1","8"],res:["5"]}},{id:"p3",solution:{n1:["5","7"],d1:["1","3"],n2:["9","4"],d2:["2","6"],res:["8"]}}],M=B(V[0]),A=pe({}),m=pe({}),h=pe({}),S=B(null),T=B(!1),F=["1","2","3","4","5","6","7","8","9"],N=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function G(w){if(w==null)return"";const _=String(w);return D.lang==="ar"?_.replace(/[0-9]/g,u=>N[Number(u)]):_}function J(){Object.keys(A).forEach(w=>delete A[w]),Object.keys(m).forEach(w=>delete m[w]),Object.keys(h).forEach(w=>delete h[w])}function I(){const w=V[Math.floor(Math.random()*V.length)];M.value=w,J(),S.value=null,T.value=!1,F.forEach(_=>{h[_]=1});for(const[_,u]of Object.entries(L)){const f=w.solution[_];f&&u.forEach(($,E)=>{A[$]=null,m[$]=f[E]})}}function R(w){w.preventDefault()}function z(w,_){w.dataTransfer.setData("text/plain",_)}function W(w,_){w.preventDefault();const u=w.dataTransfer.getData("text/plain");if(u&&!((h[u]||0)<=0&&A[_]!==u)){if(A[_]!=null){const f=A[_];h[f]=(h[f]||0)+1}A[_]!==u&&(h[u]=(h[u]||0)-1,h[u]<0&&(h[u]=0)),A[_]=u,S.value=null,T.value=!1}}const Y=q(()=>{const w=[];for(const[_,u]of Object.entries(h))for(let f=0;f<u;f++)w.push({digit:_,key:`${_}-${f}`});return w});function j(){return Object.keys(m).every(w=>A[w]!=null)}function k(w){const u=L[w].map(f=>A[f]);return Number(u.join(""))}async function p(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function c(){if(!j()){S.value=l[a.value].needAll,b&&b.play();return}const w=k("n1"),_=k("d1"),u=k("n2"),f=k("d2"),$=Number(A.res);if(!_||!f){S.value=l[a.value].wrong,b&&b.play();return}const E=w/_+u/f;Math.abs(E-$)<1e-6?(S.value=l[a.value].correct,T.value=!0,x&&x.play(),P&&P.play(),await p()):(S.value=l[a.value].wrong,b&&b.play())}function d(){for(const w of Object.keys(A))if(A[w]!=null){const _=A[w];h[_]=(h[_]||0)+1,A[w]=null}S.value=null,T.value=!1}return ge(I),me(()=>D.lang,()=>{T.value||(S.value=null)}),(w,_)=>(n(),o("div",{class:"lvl3c5 challenge-surface","data-theme":D.theme},[e("header",Qi,[e("h2",Hi,t(l[a.value].title),1),(n(!0),o(te,null,le(l[a.value].intro,(u,f)=>(n(),o("p",{key:f,class:"intro"},t(u),1))),128))]),e("section",Wi,[e("div",Gi,[e("div",Vi,[(n(!0),o(te,null,le(L.n1,u=>(n(),o("div",{key:u,class:"slot",onDragover:R,onDrop:f=>W(f,u)},[A[u]?(n(),o("span",Yi,t(G(A[u])),1)):(n(),o("span",Xi,"?"))],40,Ki))),128))]),_[1]||(_[1]=e("div",{class:"bar"},null,-1)),e("div",Ji,[(n(!0),o(te,null,le(L.d1,u=>(n(),o("div",{key:u,class:"slot",onDragover:R,onDrop:f=>W(f,u)},[A[u]?(n(),o("span",ec,t(G(A[u])),1)):(n(),o("span",tc,"?"))],40,Zi))),128))])]),_[3]||(_[3]=e("span",{class:"op"},"+",-1)),e("div",ac,[e("div",lc,[(n(!0),o(te,null,le(L.n2,u=>(n(),o("div",{key:u,class:"slot",onDragover:R,onDrop:f=>W(f,u)},[A[u]?(n(),o("span",sc,t(G(A[u])),1)):(n(),o("span",oc,"?"))],40,nc))),128))]),_[2]||(_[2]=e("div",{class:"bar"},null,-1)),e("div",rc,[(n(!0),o(te,null,le(L.d2,u=>(n(),o("div",{key:u,class:"slot",onDragover:R,onDrop:f=>W(f,u)},[A[u]?(n(),o("span",cc,t(G(A[u])),1)):(n(),o("span",uc,"?"))],40,ic))),128))])]),_[4]||(_[4]=e("span",{class:"op"},"=",-1)),e("div",{class:"target-slot",onDragover:R,onDrop:_[0]||(_[0]=u=>W(u,"res"))},[A.res?(n(),o("span",dc,t(G(A.res)),1)):(n(),o("span",vc,"?"))],32)]),e("section",hc,[e("button",{class:"btn",onClick:c},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:d},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:I},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),e("section",pc,[e("div",fc,t(l[a.value].bank),1),e("div",mc,[(n(!0),o(te,null,le(Y.value,u=>(n(),o("button",{key:u.key,class:"chip",draggable:"true",onDragstart:f=>z(f,u.digit)},t(G(u.digit)),41,gc))),128))])]),U(ke,{name:"fade"},{default:ye(()=>[S.value?(n(),o("div",{key:0,class:oe(["feedback",{ok:T.value}])},t(S.value),3)):re("",!0)]),_:1})],8,qi))}},yc=fe(_c,[["__scopeId","data-v-7304f2b0"]]),bc=["data-theme"],kc={class:"head"},wc={class:"title"},$c={class:"intro"},Cc={class:"problem"},xc={class:"decimal-card"},Tc={class:"label"},Ac={class:"decimal-display"},Sc={class:"slots"},Dc=["onDrop"],Mc={key:0,class:"digit"},Lc={key:1,class:"placeholder"},Bc=["onClick"],Nc={class:"fraction-card"},Pc={class:"label"},Ec={class:"fraction"},zc={class:"row"},Rc=["onDrop"],Oc={key:0,class:"digit"},jc={key:1,class:"placeholder"},Ic=["onClick"],Fc={class:"row"},Uc=["onDrop"],qc={key:0,class:"digit"},Qc={key:1,class:"placeholder"},Hc=["onClick"],Wc={class:"controls"},Gc={class:"bank"},Vc={class:"bank-title"},Kc={class:"bank-items"},Yc=["onDragstart"],Xc={__name:"challenge_level_three_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 6: كسور مكافئة",intro:"اسحب الأرقام المتاحة وضعها في الخانات بحيث يكون الكسر الاعتيادي مساويًا للقيمة العشرية المعطاة.",decimals:"القيمة العشرية",fraction:"الكسر المكافئ",bank:"البطاقات المتاحة",check:"تحقّق",reset:"مسح",newQ:"تحدٍ جديد",clear:"تفريغ",needAll:"املأ كل الخانات أولًا.",wrong:"القيم غير متكافئة، حاول ترتيبًا مختلفًا.",correct:"أحسنت! الكسور مكافئة."},en:{title:"Level 3 – Challenge 6: Equivalent Fractions",intro:"Drag the available digits into the slots so the fraction equals the given decimal value.",decimals:"Decimal value",fraction:"Equivalent fraction",bank:"Available cards",check:"Check",reset:"Clear",newQ:"New challenge",clear:"Clear",needAll:"Fill every slot first.",wrong:"Values are not equivalent. Try another arrangement.",correct:"Great! They are equivalent."}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Be):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Ne):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");const L=[{id:"p1",decimal:{slots:["dec1","dec2"],digits:["2","5"]},fraction:{num:{slots:["num1"],digits:["1"]},den:{slots:["den1"],digits:["4"]}},digits:["1","2","4","5"]},{id:"p2",decimal:{slots:["dec1","dec2"],digits:["7","5"]},fraction:{num:{slots:["num1"],digits:["3"]},den:{slots:["den1"],digits:["4"]}},digits:["3","4","5","7"]},{id:"p3",decimal:{slots:["dec1"],digits:["6"]},fraction:{num:{slots:["num1"],digits:["3"]},den:{slots:["den1"],digits:["5"]}},digits:["3","5","6"]},{id:"p4",decimal:{slots:["dec1","dec2"],digits:["3","3"]},fraction:{num:{slots:["num1"],digits:["1"]},den:{slots:["den1"],digits:["3"]}},digits:["1","3"]}],V=B(L[0]),M=pe({}),A=pe({}),m=pe({}),h=B(null),S=B(!1);function T(){Object.keys(M).forEach(c=>delete M[c]),Object.keys(A).forEach(c=>delete A[c]),Object.keys(m).forEach(c=>delete m[c])}function F(){const c=L[Math.floor(Math.random()*L.length)];V.value=c,T(),h.value=null,S.value=!1;const{decimal:d,fraction:w}=c;d.slots.forEach((_,u)=>{M[_]=null,A[_]=d.digits[u]}),w.num.slots.forEach((_,u)=>{M[_]=null,A[_]=w.num.digits[u]}),w.den.slots.forEach((_,u)=>{M[_]=null,A[_]=w.den.digits[u]}),c.digits.forEach(_=>{m[_]=(m[_]||0)+1})}function N(c){c.preventDefault()}function G(c,d){c.dataTransfer.setData("text/plain",d)}function J(c,d){c.preventDefault();const w=c.dataTransfer.getData("text/plain");if(w&&!((m[w]||0)<=0&&M[d]!==w)){if(M[d]!=null){const _=M[d];m[_]=(m[_]||0)+1}M[d]!==w&&(m[w]=(m[w]||0)-1,m[w]<0&&(m[w]=0)),M[d]=w,S.value=!1,h.value=null}}function I(c){if(M[c]!=null){const d=M[c];m[d]=(m[d]||0)+1,M[c]=null,S.value=!1,h.value=null}}const R=q(()=>{const c=[];for(const[d,w]of Object.entries(m))for(let _=0;_<w;_++)c.push({digit:d,key:`${d}-${_}`});return c});function z(){return Object.keys(A).every(c=>M[c]!=null)}function W(){return+`0.${V.value.decimal.slots.map(w=>M[w]).join("")}`}function Y(){const{fraction:c}=V.value,d=c.num.slots.map(f=>M[f]).join(""),w=c.den.slots.map(f=>M[f]).join(""),_=Number(d),u=Number(w);return u?_/u:null}async function j(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function k(){if(!z()){h.value=l[a.value].needAll,b&&b.play();return}const c=W(),d=Y();if(d==null){h.value=l[a.value].wrong,b&&b.play();return}Math.abs(c-d)<1e-6?(h.value=l[a.value].correct,S.value=!0,x&&x.play(),P&&P.play(),await j()):(h.value=l[a.value].wrong,b&&b.play())}function p(){Object.keys(M).forEach(c=>{if(M[c]!=null){const d=M[c];m[d]=(m[d]||0)+1,M[c]=null}}),S.value=!1,h.value=null}return ge(F),me(()=>D.lang,()=>{S.value||(h.value=null)}),(c,d)=>(n(),o("div",{class:"lvl3c6 challenge-surface","data-theme":D.theme},[e("header",kc,[e("h2",wc,t(l[a.value].title),1),e("p",$c,t(l[a.value].intro),1)]),e("section",Cc,[e("div",xc,[e("div",Tc,t(l[a.value].decimals),1),e("div",Ac,[d[0]||(d[0]=e("span",{class:"fixed"},"0.",-1)),e("div",Sc,[(n(!0),o(te,null,le(V.value.decimal.slots,w=>(n(),o("div",{key:w,class:"slot",onDragover:N,onDrop:_=>J(_,w)},[M[w]?(n(),o("span",Mc,t(M[w]),1)):(n(),o("span",Lc,"?")),e("button",{class:"clear",onClick:_=>I(w)},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)],8,Bc)],40,Dc))),128))])])]),d[2]||(d[2]=e("span",{class:"equals"},"=",-1)),e("div",Nc,[e("div",Pc,t(l[a.value].fraction),1),e("div",Ec,[e("div",zc,[(n(!0),o(te,null,le(V.value.fraction.num.slots,w=>(n(),o("div",{key:w,class:"slot",onDragover:N,onDrop:_=>J(_,w)},[M[w]?(n(),o("span",Oc,t(M[w]),1)):(n(),o("span",jc,"?")),e("button",{class:"clear",onClick:_=>I(w)},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)],8,Ic)],40,Rc))),128))]),d[1]||(d[1]=e("div",{class:"bar"},null,-1)),e("div",Fc,[(n(!0),o(te,null,le(V.value.fraction.den.slots,w=>(n(),o("div",{key:w,class:"slot",onDragover:N,onDrop:_=>J(_,w)},[M[w]?(n(),o("span",qc,t(M[w]),1)):(n(),o("span",Qc,"?")),e("button",{class:"clear",onClick:_=>I(w)},[U(Q(xe),{class:"ic"}),K(" "+t(l[a.value].clear),1)],8,Hc)],40,Uc))),128))])])])]),e("section",Wc,[e("button",{class:"btn",onClick:k},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:p},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:F},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),e("section",Gc,[e("div",Vc,t(l[a.value].bank),1),e("div",Kc,[(n(!0),o(te,null,le(R.value,w=>(n(),o("button",{key:w.key,class:"chip",draggable:"true",onDragstart:_=>G(_,w.digit)},t(w.digit),41,Yc))),128))])]),U(ke,{name:"fade"},{default:ye(()=>[h.value?(n(),o("div",{key:0,class:oe(["feedback",{ok:S.value}])},t(h.value),3)):re("",!0)]),_:1})],8,bc))}},Jc=fe(Xc,[["__scopeId","data-v-46279352"]]),Zc=["data-theme"],eu={class:"head"},tu={class:"title"},au={class:"intro"},lu={class:"status"},nu={class:"chip"},su={class:"chip"},ou={class:"graph"},ru={viewBox:"0 0 500 300"},iu=["x1","y1","x2","y2"],cu=["x","y"],uu=["onClick"],du=["cx","cy","r"],vu=["x","y"],hu={class:"controls"},pu={__name:"challenge_level_three_7",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 7: مسار الضرب",intro:"ابدأ من النقطة أ ثم اختر نقاطًا متصلة للوصول إلى ب بحيث يكون حاصل ضرب الأرقام على الأضلاع مساويًا للقيمة المطلوبة.",target:"القيمة المطلوبة",current:"الحاصل الحالي",check:"تحقّق",reset:"مسح آخر نقطة",newQ:"تحدٍ جديد",clearAll:"إعادة المسار",needStart:"ابدأ من النقطة أ.",invalid:"يجب اختيار نقطة متصلة.",wrong:"المسار لا يعطي القيمة المطلوبة، حاول مرة أخرى.",correct:"أحسنت! المسار يعطي القيمة المطلوبة."},en:{title:"Level 3 – Challenge 7: Multiplication Path",intro:"Start at point A and travel along connected nodes to reach B so the product of edge values equals the required target.",target:"Target product",current:"Current product",check:"Check",reset:"Undo last",newQ:"New challenge",clearAll:"Clear path",needStart:"Start from node A.",invalid:"Pick a connected node.",wrong:"Path does not meet the target—try again.",correct:"Great! The path matches the target."}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Le):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Oe):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");const L=[{id:"p1",target:5,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:90},{id:"RB",x:340,y:210},{id:"CT",x:260,y:70},{id:"C",x:260,y:150},{id:"CB",x:260,y:230},{id:"LT",x:180,y:90},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:.5},{from:"RT",to:"CT",value:1},{from:"CT",to:"C",value:.5},{from:"C",to:"LT",value:2},{from:"LT",to:"B",value:2.5},{from:"A",to:"RB",value:2},{from:"RB",to:"CB",value:1.25},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1},{from:"LB",to:"B",value:2},{from:"CT",to:"CB",value:2},{from:"RT",to:"C",value:1.4},{from:"C",to:"LT",value:1.6}]},{id:"p2",target:6,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:100},{id:"RB",x:340,y:200},{id:"CT",x:260,y:60},{id:"C",x:260,y:150},{id:"CB",x:260,y:240},{id:"LT",x:180,y:100},{id:"LB",x:180,y:200}],edges:[{from:"A",to:"RT",value:1.5},{from:"RT",to:"CT",value:2},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:.5},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:2},{from:"C",to:"LB",value:1},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.2},{from:"C",to:"LT",value:1.5}]},{id:"p3",target:5.4,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:90},{id:"RB",x:340,y:210},{id:"CT",x:260,y:70},{id:"C",x:260,y:150},{id:"CB",x:260,y:230},{id:"LT",x:180,y:90},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:1.2},{from:"RT",to:"CT",value:1.5},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1.5},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:1.4},{from:"RB",to:"CB",value:1.1},{from:"CB",to:"C",value:1.2},{from:"C",to:"LB",value:1.3},{from:"LB",to:"B",value:1.8},{from:"RT",to:"C",value:1.3},{from:"CT",to:"CB",value:1.4}]},{id:"p4",target:4.5,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:110},{id:"RB",x:340,y:210},{id:"CT",x:260,y:90},{id:"C",x:260,y:160},{id:"CB",x:260,y:240},{id:"LT",x:180,y:120},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:1.1},{from:"RT",to:"CT",value:1.3},{from:"CT",to:"C",value:1.2},{from:"C",to:"LT",value:1.25},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:1.5},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1.4},{from:"LB",to:"B",value:1.8},{from:"RT",to:"C",value:1.4},{from:"CT",to:"CB",value:1.1}]},{id:"p5",target:7.2,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:95},{id:"RB",x:340,y:205},{id:"CT",x:260,y:65},{id:"C",x:260,y:150},{id:"CB",x:260,y:235},{id:"LT",x:180,y:105},{id:"LB",x:180,y:205}],edges:[{from:"A",to:"RT",value:1.2},{from:"RT",to:"CT",value:1.5},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1.2},{from:"LT",to:"B",value:1.6},{from:"A",to:"RB",value:.9},{from:"RB",to:"CB",value:1.4},{from:"CB",to:"C",value:1.3},{from:"C",to:"LB",value:2},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.3},{from:"CT",to:"CB",value:1.2}]},{id:"p6",target:4.8,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:105},{id:"RB",x:340,y:215},{id:"CT",x:260,y:75},{id:"C",x:260,y:155},{id:"CB",x:260,y:235},{id:"LT",x:180,y:110},{id:"LB",x:180,y:215}],edges:[{from:"A",to:"RT",value:1.3},{from:"RT",to:"CT",value:1.2},{from:"CT",to:"C",value:1.1},{from:"C",to:"LT",value:1.4},{from:"LT",to:"B",value:1.7},{from:"A",to:"RB",value:1.25},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1.6},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.2},{from:"CT",to:"CB",value:1.3}]}];function V(p,c){const d=c.find(_=>_.id===p.from),w=c.find(_=>_.id===p.to);return{...p,x1:d.x,y1:d.y,x2:w.x,y2:w.y,midX:(d.x+w.x)/2,midY:(d.y+w.y)/2}}const M=B(L[0]),A=B(null),m=B([]),h=B(null),S=B(!1),T=q(()=>M.value.nodes),F=q(()=>M.value.edges.map(p=>V(p,T.value))),N=q(()=>{const p=[];for(let c=0;c<m.value.length-1;c++){const d=m.value[c],w=m.value[c+1],_=F.value.find(u=>u.from===d&&u.to===w||u.from===w&&u.to===d);_&&p.push(_)}return p}),G=q(()=>N.value.reduce((p,c)=>p*c.value,1));function J(p,c){return F.value.some(d=>d.from===p&&d.to===c||d.from===c&&d.to===p)}function I(){if(L.length===1)return A.value=L[0].id,L[0];let p;do p=L[Math.floor(Math.random()*L.length)];while(p.id===A.value);return A.value=p.id,p}function R(){m.value=[],S.value=!1,h.value=null}function z(){m.value.length>0&&(m.value=m.value.slice(0,-1),S.value=!1,h.value=null)}async function W(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}function Y(p){const{start:c,end:d}=M.value;if(!m.value.length){if(p.id!==c){h.value=l[a.value].needStart,b&&b.play();return}m.value=[p.id],h.value=null;return}const w=m.value[m.value.length-1];if(p.id===w)return;if(!J(w,p.id)){h.value=l[a.value].invalid,b&&b.play();return}const _=m.value.slice();_.push(p.id),m.value=_,h.value=null,p.id===d&&j()}async function j(){const{end:p,target:c}=M.value;if(m.value[m.value.length-1]!==p){h.value=l[a.value].wrong,b&&b.play();return}Math.abs(G.value-c)<1e-6?(h.value=l[a.value].correct,S.value=!0,x&&x.play(),P&&P.play(),await W()):(h.value=l[a.value].wrong,S.value=!1,b&&b.play())}function k(){const p=I();M.value=p,R()}return ge(k),me(()=>D.lang,()=>{S.value||(h.value=null)}),(p,c)=>(n(),o("div",{class:"lvl3c8 challenge-surface","data-theme":D.theme},[e("header",eu,[e("h2",tu,t(l[a.value].title),1),e("p",au,t(l[a.value].intro),1)]),e("section",lu,[e("div",nu,[K(t(l[a.value].target)+": ",1),e("strong",null,t(M.value.target),1)]),e("div",su,[K(t(l[a.value].current)+": ",1),e("strong",null,t(G.value.toFixed(3)),1)])]),e("section",ou,[(n(),o("svg",ru,[(n(!0),o(te,null,le(F.value,d=>(n(),o("g",{key:d.from+d.to},[e("line",{x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,class:oe(["edge",{active:N.value.includes(d)}])},null,10,iu),e("text",{x:d.midX,y:d.midY,class:"edge-label"},t(d.value),9,cu)]))),128)),(n(!0),o(te,null,le(T.value,d=>(n(),o("g",{key:d.id,class:"node",onClick:w=>Y(d)},[e("circle",{cx:d.x,cy:d.y,r:d.type?20:12,class:oe(["point",d.type,{selected:m.value.includes(d.id)}])},null,10,du),e("text",{x:d.x,y:d.y+4,class:"node-label"},t(d.label||""),9,vu)],8,uu))),128))]))]),e("section",hu,[e("button",{class:"btn",onClick:j},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:z},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:R},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].clearAll),1)]),e("button",{class:"btn",onClick:k},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:ye(()=>[h.value?(n(),o("div",{key:0,class:oe(["feedback",{ok:S.value}])},t(h.value),3)):re("",!0)]),_:1})],8,Zc))}},fu=fe(pu,[["__scopeId","data-v-db47ac07"]]),mu=["data-theme"],gu={class:"head"},_u={class:"title"},yu={class:"intro"},bu={class:"status"},ku={class:"chip"},wu={class:"chip"},$u={class:"graph"},Cu={viewBox:"0 0 500 300"},xu=["x1","y1","x2","y2"],Tu=["x","y"],Au=["onClick"],Su=["cx","cy","r"],Du=["x","y"],Mu={class:"controls"},Lu={__name:"challenge_level_three_8",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 8: مسار الضرب",intro:"ابدأ من النقطة أ ثم اختر نقاطًا متصلة للوصول إلى ب بحيث يكون حاصل ضرب الأرقام على الأضلاع مساويًا للقيمة المطلوبة.",target:"القيمة المطلوبة",current:"الحاصل الحالي",check:"تحقّق",reset:"مسح آخر نقطة",newQ:"تحدٍ جديد",clearAll:"إعادة المسار",needStart:"ابدأ من النقطة أ.",invalid:"يجب اختيار نقطة متصلة.",wrong:"المسار لا يعطي القيمة المطلوبة، حاول مرة أخرى.",correct:"أحسنت! المسار يعطي القيمة المطلوبة."},en:{title:"Level 3 – Challenge 8: Multiplication Path",intro:"Start at point A and travel along connected nodes to reach B so the product of edge values equals the required target.",target:"Target product",current:"Current product",check:"Check",reset:"Undo last",newQ:"New challenge",clearAll:"Clear path",needStart:"Start from node A.",invalid:"Pick a connected node.",wrong:"Path does not meet the target—try again.",correct:"Great! The path matches the target."}},a=q(()=>l[D.lang]?D.lang:"ar"),x=typeof Audio!="undefined"?new Audio(Le):null,P=typeof Audio!="undefined"?new Audio($e):null,b=typeof Audio!="undefined"?new Audio(Oe):null;x&&(x.preload="auto"),P&&(P.preload="auto"),b&&(b.preload="auto");const L=[{id:"p1",target:5,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:90},{id:"RB",x:340,y:210},{id:"CT",x:260,y:70},{id:"C",x:260,y:150},{id:"CB",x:260,y:230},{id:"LT",x:180,y:90},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:.5},{from:"RT",to:"CT",value:1},{from:"CT",to:"C",value:.5},{from:"C",to:"LT",value:2},{from:"LT",to:"B",value:2.5},{from:"A",to:"RB",value:2},{from:"RB",to:"CB",value:1.25},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1},{from:"LB",to:"B",value:2},{from:"CT",to:"CB",value:2},{from:"RT",to:"C",value:1.4},{from:"C",to:"LT",value:1.6}]},{id:"p2",target:6,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:100},{id:"RB",x:340,y:200},{id:"CT",x:260,y:60},{id:"C",x:260,y:150},{id:"CB",x:260,y:240},{id:"LT",x:180,y:100},{id:"LB",x:180,y:200}],edges:[{from:"A",to:"RT",value:1.5},{from:"RT",to:"CT",value:2},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:.5},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:2},{from:"C",to:"LB",value:1},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.2},{from:"C",to:"LT",value:1.5}]},{id:"p3",target:5.4,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:90},{id:"RB",x:340,y:210},{id:"CT",x:260,y:70},{id:"C",x:260,y:150},{id:"CB",x:260,y:230},{id:"LT",x:180,y:90},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:1.2},{from:"RT",to:"CT",value:1.5},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1.5},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:1.4},{from:"RB",to:"CB",value:1.1},{from:"CB",to:"C",value:1.2},{from:"C",to:"LB",value:1.3},{from:"LB",to:"B",value:1.8},{from:"RT",to:"C",value:1.3},{from:"CT",to:"CB",value:1.4}]},{id:"p4",target:4.5,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:110},{id:"RB",x:340,y:210},{id:"CT",x:260,y:90},{id:"C",x:260,y:160},{id:"CB",x:260,y:240},{id:"LT",x:180,y:120},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:1.1},{from:"RT",to:"CT",value:1.3},{from:"CT",to:"C",value:1.2},{from:"C",to:"LT",value:1.25},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:1.5},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1.4},{from:"LB",to:"B",value:1.8},{from:"RT",to:"C",value:1.4},{from:"CT",to:"CB",value:1.1}]},{id:"p5",target:7.2,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:95},{id:"RB",x:340,y:205},{id:"CT",x:260,y:65},{id:"C",x:260,y:150},{id:"CB",x:260,y:235},{id:"LT",x:180,y:105},{id:"LB",x:180,y:205}],edges:[{from:"A",to:"RT",value:1.2},{from:"RT",to:"CT",value:1.5},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1.2},{from:"LT",to:"B",value:1.6},{from:"A",to:"RB",value:.9},{from:"RB",to:"CB",value:1.4},{from:"CB",to:"C",value:1.3},{from:"C",to:"LB",value:2},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.3},{from:"CT",to:"CB",value:1.2}]},{id:"p6",target:4.8,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:105},{id:"RB",x:340,y:215},{id:"CT",x:260,y:75},{id:"C",x:260,y:155},{id:"CB",x:260,y:235},{id:"LT",x:180,y:110},{id:"LB",x:180,y:215}],edges:[{from:"A",to:"RT",value:1.3},{from:"RT",to:"CT",value:1.2},{from:"CT",to:"C",value:1.1},{from:"C",to:"LT",value:1.4},{from:"LT",to:"B",value:1.7},{from:"A",to:"RB",value:1.25},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1.6},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.2},{from:"CT",to:"CB",value:1.3}]}];function V(p,c){const d=c.find(_=>_.id===p.from),w=c.find(_=>_.id===p.to);return{...p,x1:d.x,y1:d.y,x2:w.x,y2:w.y,midX:(d.x+w.x)/2,midY:(d.y+w.y)/2}}const M=B(L[0]),A=B(null),m=B([]),h=B(null),S=B(!1),T=q(()=>M.value.nodes),F=q(()=>M.value.edges.map(p=>V(p,T.value))),N=q(()=>{const p=[];for(let c=0;c<m.value.length-1;c++){const d=m.value[c],w=m.value[c+1],_=F.value.find(u=>u.from===d&&u.to===w||u.from===w&&u.to===d);_&&p.push(_)}return p}),G=q(()=>N.value.reduce((p,c)=>p*c.value,1));function J(p,c){return F.value.some(d=>d.from===p&&d.to===c||d.from===c&&d.to===p)}function I(){if(L.length===1)return A.value=L[0].id,L[0];let p;do p=L[Math.floor(Math.random()*L.length)];while(p.id===A.value);return A.value=p.id,p}function R(){m.value=[],S.value=!1,h.value=null}function z(){m.value.length>0&&(m.value=m.value.slice(0,-1),S.value=!1,h.value=null)}async function W(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}function Y(p){const{start:c,end:d}=M.value;if(!m.value.length){if(p.id!==c){h.value=l[a.value].needStart,b&&b.play();return}m.value=[p.id],h.value=null;return}const w=m.value[m.value.length-1];if(p.id===w)return;if(!J(w,p.id)){h.value=l[a.value].invalid,b&&b.play();return}const _=m.value.slice();_.push(p.id),m.value=_,h.value=null,p.id===d&&j()}async function j(){const{end:p,target:c}=M.value;if(m.value[m.value.length-1]!==p){h.value=l[a.value].wrong,b&&b.play();return}Math.abs(G.value-c)<1e-6?(h.value=l[a.value].correct,S.value=!0,x&&x.play(),P&&P.play(),await W()):(h.value=l[a.value].wrong,S.value=!1,b&&b.play())}function k(){const p=I();M.value=p,R()}return ge(k),me(()=>D.lang,()=>{S.value||(h.value=null)}),(p,c)=>(n(),o("div",{class:"lvl3c8 challenge-surface","data-theme":D.theme},[e("header",gu,[e("h2",_u,t(l[a.value].title),1),e("p",yu,t(l[a.value].intro),1)]),e("section",bu,[e("div",ku,[K(t(l[a.value].target)+": ",1),e("strong",null,t(M.value.target),1)]),e("div",wu,[K(t(l[a.value].current)+": ",1),e("strong",null,t(G.value.toFixed(3)),1)])]),e("section",$u,[(n(),o("svg",Cu,[(n(!0),o(te,null,le(F.value,d=>(n(),o("g",{key:d.from+d.to},[e("line",{x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,class:oe(["edge",{active:N.value.includes(d)}])},null,10,xu),e("text",{x:d.midX,y:d.midY,class:"edge-label"},t(d.value),9,Tu)]))),128)),(n(!0),o(te,null,le(T.value,d=>(n(),o("g",{key:d.id,class:"node",onClick:w=>Y(d)},[e("circle",{cx:d.x,cy:d.y,r:d.type?20:12,class:oe(["point",d.type,{selected:m.value.includes(d.id)}])},null,10,Su),e("text",{x:d.x,y:d.y+4,class:"node-label"},t(d.label||""),9,Du)],8,Au))),128))]))]),e("section",Mu,[e("button",{class:"btn",onClick:j},[U(Q(be),{class:"ic"}),K(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:z},[U(Q(we),{class:"ic"}),K(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:R},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].clearAll),1)]),e("button",{class:"btn",onClick:k},[U(Q(_e),{class:"ic"}),K(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:ye(()=>[h.value?(n(),o("div",{key:0,class:oe(["feedback",{ok:S.value}])},t(h.value),3)):re("",!0)]),_:1})],8,mu))}},Bu=fe(Lu,[["__scopeId","data-v-583e7892"]]),Je="ml-toast";function Ie({message:ee,type:D="info",duration:l=2600}={}){var a;ee&&window.dispatchEvent(new CustomEvent(Je,{detail:{message:ee,type:D,duration:l,id:((a=crypto.randomUUID)==null?void 0:a.call(crypto))||Math.random().toString(36).slice(2),timestamp:Date.now()}}))}function Nu(ee){return window.addEventListener(Je,ee),()=>window.removeEventListener(Je,ee)}const Ze=B(null),Ct=B(null),xt=B(null),Tt=B(null),Qe=B(!1),He=B(null),et=B(0),At=B(null),St=B(null),Dt=B(null);async function Pu(ee=!1){var l;const D=Date.now();if(!(!ee&&Ze.value!==null&&D-et.value<6e4)&&!Qe.value){Qe.value=!0,He.value=null;try{const a=await fetch("/api/method/mathematics_leaders.api.game_points.get_points",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),x=await a.json();if(!a.ok||!((l=x==null?void 0:x.message)!=null&&l.ok))throw new Error((x==null?void 0:x.message)||"Unable to load score");const P=x.message;Ze.value=Number(P.points||0),Ct.value=P.rank||1,xt.value=P.players||1,Tt.value=Number(P.best||P.points||0),At.value=P.profile_image||null,St.value=P.username||null,Dt.value=P.game_user_name||null,et.value=D}catch(a){He.value=a instanceof Error?a.message:String(a),Ie({message:He.value,type:"danger"})}finally{Qe.value=!1}}}function lt(){return{score:Ze,rank:Ct,totalPlayers:xt,bestScore:Tt,loading:Qe,error:He,lastUpdated:et,profileImage:At,username:St,gameUserName:Dt,refresh:Pu}}const Eu=["dir","data-theme"],zu={class:"overview"},Ru={class:"panel donut-panel"},Ou={class:"panel__header"},ju={class:"tier-chip"},Iu=["disabled"],Fu={class:"donut"},Uu={viewBox:"0 0 160 160","aria-hidden":"true"},qu={class:"donut__label"},Qu={class:"panel__footer"},Hu={class:"progress-caption"},Wu={class:"timestamp"},Gu={class:"panel spark-panel"},Vu={class:"panel__header"},Ku={class:"panel__title"},Yu={class:"spark"},Xu={viewBox:"0 0 180 72","aria-hidden":"true"},Ju=["d"],Zu=["d"],ed={class:"spark__meta"},td={class:"spark__hint"},ad={class:"metrics"},ld={class:"metric__label"},nd={class:"metric__value"},sd={class:"insights"},od={class:"insights__grid"},rd={class:"insight-card__icon"},id={class:"insight-card__body"},cd={key:0,class:"error"},yt=9,Ke=58,ud={__name:"my_scores",setup(ee){const{score:D,rank:l,totalPlayers:a,bestScore:x,loading:P,error:b,lastUpdated:L,refresh:V}=lt(),M=()=>(document.documentElement.lang||"").toLowerCase().startsWith("en")||(localStorage.getItem("ml_lang")||"").toLowerCase().startsWith("en")?"en":"ar",A=()=>localStorage.getItem("ml_theme")||"light",m=B(M()),h=B(A()),S=q(()=>m.value==="ar"),T=q(()=>m.value==="ar"?{totalPoints:"إجمالي النقاط",progressLabel:"التقدم نحو الرتبة التالية",refresh:"تحديث النقاط",lastUpdated:"آخر تحديث",insightHeading:"تحليلات سريعة",scoreTrendTitle:"منحنى الأداء",scoreTrendCopy:"يميل الأداء إلى التحسن خلال آخر المحاولات.",percentRankTitle:"موقعك بين اللاعبين",topTierCopy:"لقد بلغت أعلى رتبة متاحة! استمر في التألق.",nextTierLabel:"المتبقي للوصول للرتبة التالية",recordTitle:"أفضل نتيجة مسجلة",sparkLabel:"تحوّل النقاط (آخر الجلسات)",metricsHeading:"مؤشرات سريعة",playersLabel:"عدد اللاعبين",rankLabel:"ترتيبك",recordLabel:"رقمك القياسي",minutesAgo:"منذ دقائق",justNow:"الآن"}:{totalPoints:"Total points",progressLabel:"Progress to next tier",refresh:"Refresh score",lastUpdated:"Last updated",insightHeading:"Quick insights",scoreTrendTitle:"Performance trend",scoreTrendCopy:"Your recent attempts show an upward trend.",percentRankTitle:"Position among players",topTierCopy:"You already sit at the highest tier—keep shining!",nextTierLabel:"To reach the next tier",recordTitle:"Best recorded score",sparkLabel:"Score changes (recent sessions)",metricsHeading:"Key metrics",playersLabel:"Players",rankLabel:"Your rank",recordLabel:"Personal best",minutesAgo:"minutes ago",justNow:"just now"}),F=[{threshold:0,title:{ar:"مبتدئ الأرقام",en:"Number Novice"}},{threshold:25,title:{ar:"مستكشف الأنماط",en:"Pattern Explorer"}},{threshold:75,title:{ar:"مايسترو الرياضيات",en:"Math Maestro"}},{threshold:150,title:{ar:"أسطورة التحديات",en:"Challenge Legend"}}],N=q(()=>Number(D.value||0)),G=q(()=>Number(x.value||0)),J=q(()=>{let X=0;return F.forEach((se,ie)=>{N.value>=se.threshold&&(X=ie)}),X}),I=q(()=>F[J.value]),R=q(()=>F[J.value+1]||null),z=q(()=>{var X,se,ie,ue;return((se=(X=I.value)==null?void 0:X.title)==null?void 0:se[m.value])||((ue=(ie=I.value)==null?void 0:ie.title)==null?void 0:ue.en)||""}),W=q(()=>{if(!R.value)return 1;const X=R.value.threshold-I.value.threshold;return X<=0?1:Math.min(1,(N.value-I.value.threshold)/X)}),Y=new Intl.NumberFormat("en-US",{maximumFractionDigits:0}),j=q(()=>Y.format(N.value)),k=q(()=>Y.format(G.value)),p=q(()=>l.value!=null?`#${l.value}`:"--"),c=q(()=>a.value!=null?Y.format(a.value):"--"),d=q(()=>{if(!L.value)return"--";const X=Date.now()-L.value;return X<6e4?T.value.justNow:`${Math.round(X/6e4)} ${T.value.minutesAgo}`}),w=q(()=>{const X=Math.max(N.value,G.value,1),se=Math.max(10,X*.45),ie=[];for(let ue=0;ue<yt;ue+=1){const Te=ue/(yt-1),ve=Math.sin((N.value+ue)*.35)*X*.05,Ce=Math.max(0,se+(X-se)*Te+ve);ie.push(Math.round(Ce))}return ie[ie.length-1]=Math.max(N.value,0),ie}),_=q(()=>{const X=w.value;if(!X.length)return[];const se=180,ie=54,ue=Math.max(...X),Te=Math.min(...X),ve=ue-Te||1;return X.map((Ce,Pe)=>{const Fe=X.length===1?se:se/(X.length-1)*Pe,Ue=ie-(Ce-Te)/ve*ie;return{x:Number(Fe.toFixed(2)),y:Number(Ue.toFixed(2)),value:Ce}})}),u=q(()=>{const X=_.value;return X.length?X.map((se,ie)=>`${ie===0?"M":"L"}${se.x},${se.y}`).join(" "):""}),f=q(()=>{const X=_.value;if(!X.length)return"";const se=54,ie=X[0],ue=X[X.length-1],Te=X.map((ve,Ce)=>`L${ve.x},${ve.y}`).join(" ");return`M${ie.x},${se} ${Te} L${ue.x},${se} Z`}),$=q(()=>{const X=w.value;return X.length<2?0:X[X.length-1]-X[0]}),E=2*Math.PI*Ke,v=q(()=>E*(1-W.value)),s=q(()=>Math.round(W.value*100)),r=q(()=>!l.value||!a.value?null:Math.max(0,100-Math.round((l.value-1)/a.value*100))),i={trend:ol,award:Ka,activity:Va,target:bt},y=q(()=>{const X=[];if(R.value){const se=Math.max(0,R.value.threshold-N.value);X.push({icon:"target",title:T.value.nextTierLabel,body:m.value==="ar"?`تبقى ${Y.format(se)} نقطة للوصول إلى «${R.value.title.ar}».`:`${Y.format(se)} pts to unlock “${R.value.title.en}”.`})}else X.push({icon:"target",title:T.value.nextTierLabel,body:(m.value==="ar",T.value.topTierCopy)});return X.push({icon:"trend",title:T.value.scoreTrendTitle,body:m.value==="ar"?`${T.value.scoreTrendCopy} (+${Y.format(Math.max(0,$.value))}).`:`${T.value.scoreTrendCopy} (+${Y.format(Math.max(0,$.value))}).`}),r.value!=null&&X.push({icon:"award",title:T.value.percentRankTitle,body:m.value==="ar"?`أنت ضمن أفضل ${r.value}% من اللاعبين.`:`You currently outperform ${r.value}% of players.`}),X.push({icon:"activity",title:T.value.recordTitle,body:m.value==="ar"?`أفضل نتيجة حققتها هي ${k.value} نقطة.`:`Your personal best sits at ${k.value} pts.`}),X}),g=q(()=>[{label:T.value.rankLabel,value:p.value},{label:T.value.playersLabel,value:c.value},{label:T.value.recordLabel,value:k.value}]);function C(){V(!0)}let O=null,H=null,Z=null;return ge(()=>{V(!0);const X=()=>{m.value=M()},se=()=>{h.value=A()};O=new MutationObserver(X),O.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"]}),H=new MutationObserver(se),H.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),Z=()=>{X(),se()},window.addEventListener("storage",Z)}),tt(()=>{O&&O.disconnect(),H&&H.disconnect(),Z&&window.removeEventListener("storage",Z)}),(X,se)=>(n(),o("div",{class:"scores-page",dir:S.value?"rtl":"ltr","data-theme":h.value},[e("section",zu,[e("article",Ru,[e("header",Ou,[e("span",ju,t(z.value),1),e("button",{class:"refresh","data-ripple":"",disabled:Q(P),onClick:C},[U(Q(_e),{class:oe(["ic",{spin:Q(P)}])},null,8,["class"]),K(" "+t(T.value.refresh),1)],8,Iu)]),e("div",Fu,[(n(),o("svg",Uu,[se[0]||(se[0]=e("defs",null,[e("linearGradient",{id:"donutGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"#c8a03b"}),e("stop",{offset:"100%","stop-color":"#0f8a3e"})])],-1)),e("circle",{class:"track",cx:"80",cy:"80",r:Ke}),e("circle",{class:"progress",cx:"80",cy:"80",r:Ke,style:de({strokeDasharray:`${E}px`,strokeDashoffset:`${v.value}px`})},null,4)])),e("div",qu,[e("strong",null,t(j.value),1),e("span",null,t(T.value.totalPoints),1)])]),e("footer",Qu,[e("div",Hu,[e("span",null,t(T.value.progressLabel),1),e("span",null,t(s.value)+"%",1)]),e("div",Wu,t(T.value.lastUpdated)+" · "+t(d.value),1)])]),e("article",Gu,[e("header",Vu,[e("span",Ku,t(T.value.sparkLabel),1)]),e("div",Yu,[(n(),o("svg",Xu,[se[1]||(se[1]=e("defs",null,[e("linearGradient",{id:"sparkFill",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"rgba(15,138,62,0.35)"}),e("stop",{offset:"100%","stop-color":"rgba(200,160,59,0.05)"})])],-1)),f.value?(n(),o("path",{key:0,class:"spark__area",d:f.value,fill:"url(#sparkFill)"},null,8,Ju)):re("",!0),u.value?(n(),o("path",{key:1,class:"spark__path",d:u.value},null,8,Zu)):re("",!0)])),e("div",ed,[e("span",{class:oe(["spark__delta",{up:$.value>=0}])},t($.value>=0?"+":"")+t(Q(Y).format($.value)),3),e("span",td,t(T.value.scoreTrendCopy),1)])]),e("div",ad,[(n(!0),o(te,null,le(g.value,ie=>(n(),o("div",{key:ie.label,class:"metric"},[e("span",ld,t(ie.label),1),e("strong",nd,t(ie.value),1)]))),128))])])]),e("section",sd,[e("h3",null,t(T.value.insightHeading),1),e("div",od,[(n(!0),o(te,null,le(y.value,(ie,ue)=>(n(),o("article",{key:ue,class:"insight-card"},[e("div",rd,[(n(),Se(Re(i[ie.icon]),{class:"glyph"}))]),e("div",id,[e("h4",null,t(ie.title),1),e("p",null,t(ie.body),1)])]))),128))]),Q(b)?(n(),o("p",cd,t(Q(b)),1)):re("",!0)])],8,Eu))}},dd=fe(ud,[["__scopeId","data-v-d7a1a530"]]),vd=["dir","data-theme"],hd={class:"settings__header"},pd={class:"page-title"},fd={class:"settings__grid"},md={class:"settings-card profile-card"},gd={class:"card-header"},_d={class:"title"},yd={class:"card-body"},bd={class:"avatar-stack"},kd={class:"avatar-orbit"},wd={class:"avatar-ring"},$d=["src"],Cd={key:1},xd={class:"display-name"},Td={class:"controls"},Ad={class:"btn ghost","data-ripple":""},Sd=["disabled"],Dd={key:"avatar-ok",class:"status success"},Md={key:"avatar-err",class:"status error"},Ld={class:"settings-card password-card"},Bd={class:"card-header"},Nd={class:"title"},Pd={class:"verify-block"},Ed=["disabled"],zd={key:"verify-ok",class:"status success"},Rd={key:"verify-err",class:"status error"},Od={key:0,class:"password-fields"},jd={class:"form-actions"},Id=["disabled"],Fd={key:"pass-ok",class:"status success"},Ud={key:"pass-err",class:"status error"},qd={__name:"settings",setup(ee){const D=lt(),l=()=>(document.documentElement.lang||"").toLowerCase().startsWith("en")||(localStorage.getItem("ml_lang")||"").toLowerCase().startsWith("en")?"en":"ar",a=()=>localStorage.getItem("ml_theme")||"light",x=B(l()),P=B(a()),b=q(()=>x.value==="ar"),L=q(()=>x.value==="ar"?{title:"إعدادات الحساب",avatarTitle:"صورة البروفايل",avatarHint:"ارفع صورة مربعة بدقة جيدة (حتى 2 م.ب).",chooseFile:"اختر صورة",cancel:"إزالة التحديد",upload:"حفظ الصورة",loading:"جارٍ الرفع...",changeSuccess:"تم تحديث الصورة بنجاح.",changeError:"تعذر تحديث الصورة، حاول لاحقًا.",passwordTitle:"تغيير كلمة المرور",formHint:"استخدم كلمة مرور قوية تجمع بين الأحرف والأرقام والرموز.",currentPassword:"كلمة المرور الحالية",newPassword:"كلمة المرور الجديدة",confirmPassword:"تأكيد كلمة المرور",verify:"تحقّق",verified:"تم التحقق من كلمة المرور.",verifyError:"تحقق من كلمة المرور الحالية أولًا.",savePassword:"حفظ كلمة المرور",reset:"إعادة التعيين",passwordSuccess:"تم تغيير كلمة المرور بنجاح.",passwordError:"تعذر تغيير كلمة المرور، تحقق من البيانات.",selectImageFirst:"اختر صورة أولًا.",notImage:"الملف ليس صورة.",tooLarge:"حجم الصورة يتجاوز 2 م.ب.",missingPlayer:"تعذر إيجاد ملف اللاعب."}:{title:"Account settings",avatarTitle:"Profile picture",avatarHint:"Upload a crisp square image (up to 2 MB).",chooseFile:"Choose image",cancel:"Remove selection",upload:"Save avatar",loading:"Uploading...",changeSuccess:"Profile picture updated successfully.",changeError:"We could not update your picture. Try again later.",passwordTitle:"Change password",formHint:"Use a strong password that mixes letters, numbers, and symbols.",currentPassword:"Current password",newPassword:"New password",confirmPassword:"Confirm password",verify:"Verify",verified:"Password verified.",verifyError:"Verify your current password first.",savePassword:"Save password",reset:"Reset form",passwordSuccess:"Password updated successfully.",passwordError:"Unable to change password. Check your entries.",selectImageFirst:"Select an image first.",notImage:"The selected file is not an image.",tooLarge:"Image size exceeds 2 MB.",missingPlayer:"Unable to identify player record."}),V=B(null),M=B(""),A=pe({loading:!1,message:"",error:""}),m=pe({current:"",next:"",confirm:""}),h=pe({loading:!1,verified:!1,message:"",error:""}),S=pe({loading:!1,message:"",error:""}),T=q(()=>D.username.value||"Player"),F=q(()=>T.value.trim().charAt(0).toUpperCase()||"P"),N=q(()=>M.value||D.profileImage.value||null);function G(p){var d;A.message="",A.error="";const c=(d=p.target.files)==null?void 0:d[0];if(!c){J();return}if(!c.type.startsWith("image/")){A.error=L.value.notImage;return}if(c.size>2*1024*1024){A.error=L.value.tooLarge;return}M.value&&URL.revokeObjectURL(M.value),V.value=c,M.value=URL.createObjectURL(c)}function J(){M.value&&URL.revokeObjectURL(M.value),V.value=null,M.value="",A.message="",A.error=""}async function I(){var c,d;if(!V.value){A.error=L.value.selectImageFirst;return}D.gameUserName.value||await D.refresh(!0);const p=D.gameUserName.value;if(!p){A.error=L.value.missingPlayer;return}A.loading=!0,A.error="",A.message="";try{const w=new FormData;w.append("file",V.value),w.append("filename",V.value.name),w.append("is_private","0"),w.append("attached_to_doctype","Game Users"),w.append("attached_to_name",p);const _=await fetch("/api/method/upload_file",{method:"POST",credentials:"include",body:w}),u=await _.json();if(!_.ok||!((c=u==null?void 0:u.message)!=null&&c.file_url))throw new Error((u==null?void 0:u._server_messages)||(u==null?void 0:u.message)||"Upload failed");const f=u.message.file_url,$=await fetch("/api/method/mathematics_leaders.api.profile.set_profile_image",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_url:f})}),E=await $.json();if(!$.ok||!((d=E==null?void 0:E.message)!=null&&d.ok))throw new Error((E==null?void 0:E.message)||"Unable to store profile image");A.message=L.value.changeSuccess,Ie({message:L.value.changeSuccess,type:"success"}),await D.refresh(!0),J()}catch(w){A.error=w instanceof Error?w.message:L.value.changeError,Ie({message:A.error,type:"danger"})}finally{A.loading=!1}}async function R(){var p;h.loading=!0,h.error="",h.message="";try{if(!m.current)throw new Error(L.value.verifyError);const c=await fetch("/api/method/mathematics_leaders.api.profile.verify_current_password",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:m.current})}),d=await c.json();if(!c.ok||!((p=d==null?void 0:d.message)!=null&&p.ok))throw new Error((d==null?void 0:d.message)||L.value.verifyError);h.verified=!0,h.message=L.value.verified,S.error=""}catch(c){h.verified=!1,h.error=c instanceof Error?c.message:L.value.verifyError}finally{h.loading=!1}}async function z(){var w;if(!h.verified){h.error=L.value.verifyError;return}S.loading=!0,S.message="",S.error="";const{current:p,next:c,confirm:d}=m;try{if(!p||!c||!d)throw new Error(x.value==="ar"?"املأ كل الحقول.":"Fill in every field.");if(c!==d)throw new Error(x.value==="ar"?"كلمتا المرور غير متطابقتين.":"Passwords do not match.");if(c.length<8)throw new Error(x.value==="ar"?"كلمة المرور يجب أن تكون 8 أحرف على الأقل.":"Password must be at least 8 characters.");const _=await fetch("/api/method/mathematics_leaders.api.profile.change_password",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:p,new_password:c})}),u=await _.json();if(!_.ok||!((w=u==null?void 0:u.message)!=null&&w.ok))throw new Error((u==null?void 0:u.message)||L.value.passwordError);S.message=L.value.passwordSuccess,Ie({message:L.value.passwordSuccess,type:"success"}),m.current="",m.next="",m.confirm="",h.verified=!1,h.message=""}catch(_){S.error=_ instanceof Error?_.message:L.value.passwordError,Ie({message:S.error,type:"danger"})}finally{S.loading=!1}}function W(){m.current="",m.next="",m.confirm="",h.loading=!1,h.verified=!1,h.message="",h.error="",S.loading=!1,S.message="",S.error=""}let Y=null,j=null,k=null;return ge(()=>{D.score.value==null&&D.refresh(!0);const p=()=>{x.value=l()},c=()=>{P.value=a()};Y=new MutationObserver(p),Y.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"]}),j=new MutationObserver(c),j.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),k=()=>{p(),c()},window.addEventListener("storage",k)}),tt(()=>{M.value&&URL.revokeObjectURL(M.value),Y&&Y.disconnect(),j&&j.disconnect(),k&&window.removeEventListener("storage",k)}),(p,c)=>(n(),o("div",{class:"settings",dir:b.value?"rtl":"ltr","data-theme":P.value},[e("header",hd,[U(Q(ll),{class:"heading-icon"}),e("h1",pd,t(L.value.title),1)]),e("div",fd,[e("section",md,[e("header",gd,[e("div",_d,[U(Q(pt),{class:"icon"}),e("div",null,[e("h2",null,t(L.value.avatarTitle),1),e("p",null,t(L.value.avatarHint),1)])])]),e("div",yd,[e("div",bd,[e("div",kd,[e("div",wd,[N.value?(n(),o("img",{key:0,src:N.value,alt:"avatar preview"},null,8,$d)):(n(),o("span",Cd,t(F.value),1))])]),e("span",xd,t(T.value),1)]),e("div",Td,[e("label",Ad,[U(Q(il),{class:"icon"}),e("span",null,t(L.value.chooseFile),1),e("input",{type:"file",accept:"image/*",onChange:G,hidden:""},null,32)]),V.value?(n(),o("button",{key:0,type:"button",class:"btn subtle","data-ripple":"",onClick:J},t(L.value.cancel),1)):re("",!0),e("button",{type:"button",class:"btn solid","data-ripple":"",disabled:A.loading,onClick:I},[A.loading?(n(),Se(Q(qe),{key:0,class:"icon spinner"})):(n(),Se(Q(pt),{key:1,class:"icon"})),e("span",null,t(A.loading?L.value.loading:L.value.upload),1)],8,Sd)]),U(ke,{name:"fade-slide",mode:"out-in"},{default:ye(()=>[A.message?(n(),o("p",Dd,[U(Q(Ve),{class:"icon"}),e("span",null,t(A.message),1)])):re("",!0)]),_:1}),U(ke,{name:"fade-slide",mode:"out-in"},{default:ye(()=>[A.error?(n(),o("p",Md,t(A.error),1)):re("",!0)]),_:1})])]),e("section",Ld,[e("header",Bd,[e("div",Nd,[U(Q(Za),{class:"icon"}),e("div",null,[e("h2",null,t(L.value.passwordTitle),1),e("p",null,t(L.value.formHint),1)])])]),e("form",{class:"card-body password-form",onSubmit:We(z,["prevent"])},[e("div",Pd,[e("label",null,[e("span",null,t(L.value.currentPassword),1),De(e("input",{type:"password","onUpdate:modelValue":c[0]||(c[0]=d=>m.current=d),autocomplete:"current-password"},null,512),[[Me,m.current]])]),e("button",{type:"button",class:"btn solid","data-ripple":"",disabled:h.loading,onClick:R},[h.loading?(n(),Se(Q(qe),{key:0,class:"icon spinner"})):(n(),Se(Q(be),{key:1,class:"icon"})),e("span",null,t(h.loading?L.value.loading:L.value.verify),1)],8,Ed),U(ke,{name:"fade-slide",mode:"out-in"},{default:ye(()=>[h.message?(n(),o("p",zd,[U(Q(Ve),{class:"icon"}),e("span",null,t(h.message),1)])):re("",!0)]),_:1}),U(ke,{name:"fade-slide",mode:"out-in"},{default:ye(()=>[h.error?(n(),o("p",Rd,t(h.error),1)):re("",!0)]),_:1})]),U(ke,{name:"panel-grow"},{default:ye(()=>[h.verified?(n(),o("div",Od,[e("label",null,[e("span",null,t(L.value.newPassword),1),De(e("input",{type:"password","onUpdate:modelValue":c[1]||(c[1]=d=>m.next=d),autocomplete:"new-password",required:""},null,512),[[Me,m.next]])]),e("label",null,[e("span",null,t(L.value.confirmPassword),1),De(e("input",{type:"password","onUpdate:modelValue":c[2]||(c[2]=d=>m.confirm=d),autocomplete:"new-password",required:""},null,512),[[Me,m.confirm]])]),e("div",jd,[e("button",{class:"btn success","data-ripple":"",type:"submit",disabled:S.loading},[S.loading?(n(),Se(Q(qe),{key:0,class:"icon spinner"})):(n(),Se(Q(be),{key:1,class:"icon"})),e("span",null,t(S.loading?L.value.loading:L.value.savePassword),1)],8,Id),e("button",{type:"button",class:"btn subtle","data-ripple":"",onClick:W},[U(Q(_e),{class:"icon"}),e("span",null,t(L.value.reset),1)])]),U(ke,{name:"fade-slide",mode:"out-in"},{default:ye(()=>[S.message?(n(),o("p",Fd,[U(Q(Ve),{class:"icon"}),e("span",null,t(S.message),1)])):re("",!0)]),_:1}),U(ke,{name:"fade-slide",mode:"out-in"},{default:ye(()=>[S.error?(n(),o("p",Ud,t(S.error),1)):re("",!0)]),_:1})])):re("",!0)]),_:1})],32)])])],8,vd))}},Qd=fe(qd,[["__scopeId","data-v-29b78927"]]),Hd=["dir"],Wd=["onClick"],Gd={class:"dashboard__topbar"},Vd={class:"topbar__left"},Kd=["aria-expanded","aria-label"],Yd={class:"brand-chip"},Xd={class:"brand-chip__logo"},Jd=["src"],Zd={class:"brand-chip__text"},ev={class:"brand-chip__title"},tv={class:"brand-chip__subtitle"},av={class:"topbar__center"},lv={class:"greet"},nv={class:"topbar__actions"},sv=["aria-label"],ov=["aria-label"],rv={class:"avatar"},iv={key:1,class:"avatar__initial"},cv={class:"profile__text"},uv={class:"profile__name"},dv={class:"profile__meta"},vv={key:0,class:"profile__menu"},hv={class:"dashboard__main"},pv={class:"overview-grid"},fv={class:"welcome-card"},mv={class:"welcome-card__icon"},gv={class:"welcome-card__copy"},_v={class:"welcome-card__metrics"},yv={class:"metric"},bv={class:"metric__label"},kv={class:"metric"},wv={class:"metric__label"},$v=["aria-busy"],Cv={key:0,class:"score-card__overlay","aria-hidden":"true"},xv={class:"score-card__ring"},Tv={viewBox:"0 0 120 120",role:"presentation"},Av={class:"score-card__center"},Sv={class:"score-card__details"},Dv={class:"score-card__tier"},Mv={class:"score-card__subtitle"},Lv=["aria-valuenow"],Bv={class:"progress__track"},Nv={class:"progress__meta"},Pv={class:"mentor-card"},Ev={class:"mentor-card__badge"},zv={class:"challenge-section"},Rv={class:"challenge-list__header"},Ov={class:"levels"},jv=["onClick"],Iv={class:"level-head__info"},Fv={class:"level-head__title"},Uv={class:"level-head__count"},qv={key:0,class:"challenge-cards"},Qv=["onClick"],Hv={class:"challenge-card__symbol"},Wv={class:"challenge-card__body"},Gv={class:"challenge-card__title"},Vv={class:"challenge-card__summary"},Kv={class:"challenge-card__cta"},Yv={class:"logout-block"},Xv={class:"challenge-preview"},Jv={class:"preview-header"},Zv={key:0,class:"preview-pill"},e1={class:"preview-text"},t1={key:0},a1={key:1},l1={key:2},n1={key:3},s1={key:4},o1={key:5},r1={key:6},i1={key:7},c1={class:"preview-surface"},u1={class:"preview-placeholder",key:"placeholder"},d1={__name:"Dashboard",props:{view:{type:String,default:""}},setup(ee){var ot;const D=Rt(),l=ee,a=[{id:"level1",label:{ar:"المستوى الأول",en:"Level One"},challenges:[{id:"challenge_1",component:Bl,symbol:"∑",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"إكمال عملية جمع عمودية بأرقام مخفية.",en:"Complete a column addition puzzle with hidden digits."}},{id:"challenge_2",component:Xl,symbol:"√",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"شبكة أعداد تتزايد بمقدار ثابت، أعد القيم المفقودة.",en:"Fill a number grid that increases by a fixed step."}},{id:"challenge_3",component:hn,symbol:"π",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"اختر زوج الأعداد الصحيح حسب المجموع والفرق.",en:"Pick the number pair that matches the given sum and difference."}},{id:"challenge_4",component:Bn,symbol:"×",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"استكمل جدول ضرب مصغر.",en:"Complete the mini multiplication table."}},{id:"challenge_5",component:ls,symbol:"Δ",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"املأ مثلث الضرب على الأضلاع.",en:"Fill in the edge products of the triangle."}},{id:"challenge_6",component:ds,symbol:"≡",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"اختر ثلاث خلايا مختلفة الصف والعمود لتحقيق مجموع محدد.",en:"Pick three distinct-row/column cells to reach the target sum."}},{id:"challenge_7",component:As,symbol:"∴",label:{ar:"التحدي 7",en:"Challenge 7"},summary:{ar:"أكمل هرم الجمع بإسقاط القيم الصحيحة.",en:"Complete the sum pyramid with the correct values."}}]},{id:"level2",label:{ar:"المستوى الثاني",en:"Level Two"},challenges:[{id:"challenge_level_two_1",component:qs,symbol:"∫",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"كوّن تعبيرًا يستخدم الأرقام 1 إلى 5 مرة واحدة.",en:"Build an expression that uses digits 1–5 exactly once."}},{id:"challenge_level_two_2",component:lo,symbol:"≠",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"أكمل مربّعًا سحريًا بمجاميع متساوية.",en:"Complete a magic square with equal sums."}},{id:"challenge_level_two_3",component:Bo,symbol:"≈",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"طابق أعدادًا سداسية مع خواص القسمة.",en:"Match six-digit numbers to divisibility rules."}},{id:"challenge_level_two_4",component:Fo,symbol:"∞",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"اختر الزوج الذي يطابق المجموع والفرق.",en:"Choose the pair that matches the required sum and difference."}},{id:"challenge_level_two_5",component:wr,symbol:"∂",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"اكمل طرح الكسور بوضع الأعداد الصحيحة.",en:"Complete the fraction subtraction by placing the right integers."}},{id:"challenge_level_two_6",component:Br,symbol:"⊗",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"رتّب خطوات حل معادلة الموازين.",en:"Order the solution steps for the balance puzzle."}}]},{id:"level3",label:{ar:"المستوى الثالث",en:"Level Three"},challenges:[{id:"challenge_level_three_1",component:Gr,symbol:"Φ",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"ابن هرم الضرب من أرقام مبعثرة.",en:"Rebuild the multiplication pyramid from scattered numbers."}},{id:"challenge_level_three_2",component:hi,symbol:"Ψ",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"لغز تفكير متقدم في الأعداد.",en:"An advanced numerical reasoning puzzle."}},{id:"challenge_level_three_3",component:xi,symbol:"Λ",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"لغز منطق متقدم لاختبار السرعة.",en:"Advanced logic to test your speed."}},{id:"challenge_level_three_4",component:Ui,symbol:"Ξ",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"تحدٍ عالي المستوى لربط الأنماط.",en:"High-level challenge for spotting patterns."}},{id:"challenge_level_three_5",component:yc,symbol:"Θ",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"مسألة حسابية تحتاج إلى خطوات دقيقة.",en:"A numeric problem that needs careful steps."}},{id:"challenge_level_three_6",component:Jc,symbol:"β",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"إستراتيجية جديدة لبناء الحل خطوة بخطوة.",en:"Strategic puzzle solved step by step."}},{id:"challenge_level_three_7",component:fu,symbol:"η",label:{ar:"التحدي 7",en:"Challenge 7"},summary:{ar:"اختبار المنطق السريع بالأرقام.",en:"Fast-paced numeric logic test."}},{id:"challenge_level_three_8",component:Bu,symbol:"ζ",label:{ar:"التحدي 8",en:"Challenge 8"},summary:{ar:"لغز أخير يجمع بين التفكير والسرعة.",en:"A final puzzle mixing reasoning with speed."}}]}],x=lt(),P=[{threshold:0,title:{ar:"مبتدئ",en:"Novice"}},{threshold:25,title:{ar:"متقدم",en:"Skilled"}},{threshold:80,title:{ar:"قائد",en:"Leader"}},{threshold:160,title:{ar:"أسطورة",en:"Legend"}}],b=q(()=>Number(x.score.value||0)),L=q(()=>{let ae=0;return P.forEach((ne,ce)=>{b.value>=ne.threshold&&(ae=ce)}),ae}),V=q(()=>P[L.value]),M=q(()=>P[L.value+1]||null),A=q(()=>{var ae,ne,ce,Ae;return((ne=(ae=V.value)==null?void 0:ae.title)==null?void 0:ne[k.value])||((Ae=(ce=V.value)==null?void 0:ce.title)==null?void 0:Ae.en)||""}),m=q(()=>{if(!M.value)return 1;const ae=M.value.threshold-V.value.threshold;return ae<=0?1:Math.min(1,(b.value-V.value.threshold)/ae)}),h=new Intl.NumberFormat("en-US",{maximumFractionDigits:0}),S=q(()=>h.format(b.value));q(()=>{const ae=x.rank.value;return ae?`#${ae}`:"--"});const T=q(()=>{const ae=x.totalPlayers.value;return ae?h.format(ae):"--"}),F=q(()=>x.loading.value),N=q(()=>Math.round(m.value*100)),G=q(()=>x.profileImage.value||null),J=q(()=>(Z.value||x.username.value||H.value||"P").trim().charAt(0).toUpperCase()||"P"),I=q(()=>F.value?"loading":`score-${b.value}`),R=B(0),z=B(!1);me(m,ae=>{R.value=ae},{immediate:!0}),me(()=>x.score.value,(ae,ne)=>{ne==null||Number(ae)===Number(ne)||(z.value=!1,requestAnimationFrame(()=>{z.value=!0,setTimeout(()=>{z.value=!1},720)}))});function W(){Fe("/scores")}const Y={};a.forEach(ae=>{ae.challenges.forEach(ne=>{Y[ne.id]=ne.component})});const j={scores:dd,settings:Qd},k=B(localStorage.getItem("ml_lang")||"ar"),p=q(()=>k.value==="ar"?"rtl":"ltr"),c={ar:{challenges:"المستوى الأول",challenges2:"المستوى الثاني",myScores:"درجاتي",settings:"الإعدادات",logout:"خروج",hello:"مرحبًا",sub:"اختر تحديًا وابدأ اللعب!",challenge:"التحدي",brand:"زعماء الرياضيات",tagline:"رحلة إنجاز رقمية",pickPrompt:"اختر تحديًا من البطاقات أدناه للبدء.",cardCTA:"ابدأ التحدي",scoreWidgetTitle:"نقاطي",scoreWidgetSubtitle:"نظرة سريعة على تقدّمك",scoreWidgetRank:"الترتيب",scoreWidgetPlayers:"عدد اللاعبين",scoreWidgetProgress:"نحو الرتبة التالية",scoreWidgetView:"عرض التفاصيل",scoreWidgetLoading:"جار تحديث النقاط...",teacherTitle:"الشريك التربوي",teacherSubtitle:"ميعاد سفر المالكي",teacherMessage:"✨ “من هنا بدأت الرحلة… رحلة شغف صاغتها الأستاذة ميعاد سفر المالكي لتلهم طلابها نحو الإبداع والتفكير."},en:{challenges:"Level One",challenges2:"Level Two",myScores:"My Scores",settings:"Settings",logout:"Log out",hello:"Hello",sub:"Pick a challenge and start!",challenge:"Challenge",brand:"Math Leaders",tagline:"Interactive mastery journey",pickPrompt:"Select a challenge from the cards below to get started.",cardCTA:"Start challenge",scoreWidgetTitle:"My points",scoreWidgetSubtitle:"Quick glance at your progress",scoreWidgetRank:"Rank",scoreWidgetPlayers:"Players",scoreWidgetProgress:"To next tier",scoreWidgetView:"View details",scoreWidgetLoading:"Refreshing score...",teacherTitle:"Presented by",teacherSubtitle:"Miyaad Safar Al-Malki",teacherMessage:"A heartfelt thanks to Ms. Miyaad Safar Al-Malki for curating these inspiring challenges."}},d=ae=>c[k.value][ae],w=q(()=>l.view||"");me(k,ae=>{localStorage.setItem("ml_lang",ae),document.documentElement.dir=p.value,document.documentElement.lang=ae});const _=B(localStorage.getItem("ml_theme")||"light"),u=B(!1),f=B(!1),$=B([]);function E(ae){document.documentElement.setAttribute("data-ml-theme",ae)}let v=null;function s(){u.value=!0,window.clearTimeout(s.timer),s.timer=window.setTimeout(()=>{u.value=!1},360)}function r(ae){$.value=$.value.filter(ne=>ne.id!==ae)}function i(){s(),k.value=k.value==="ar"?"en":"ar"}function y(){s(),_.value=_.value==="light"?"dark":"light"}me(_,ae=>{localStorage.setItem("ml_theme",ae),E(ae)});function g(){if(typeof window=="undefined")return;const ae=window.matchMedia("(max-width: 1024px)").matches;f.value=ae,ae||(ue.value=!1)}function C(ae){ie.value&&(ie.value.contains(ae.target)||(se.value=!1))}async function O(ae,ne={}){const ce=new URLSearchParams(ne).toString(),Ae=await fetch(ae+(ce?`?${ce}`:""),{method:"GET",credentials:"include"}),Ge=await Ae.json().catch(()=>({}));if(!Ae.ok)throw Ge;return Ge}const H=B("player"),Z=B("");async function X(){try{const ae=await O("/api/method/mathematics_leaders.api.get_my_details.get_me"),ne=ae==null?void 0:ae.message;if(!(ne!=null&&ne.ok)){D.replace("/");return}const ce=ne.profile||{};H.value=ce.username||"player",Z.value=ce.full_name||"",ce.language&&!localStorage.getItem("ml_lang")&&(k.value=ce.language)}catch{D.replace("/")}}const se=B(!1),ie=B(null),ue=B(!1),Te=pe(Object.fromEntries(a.map(ae=>[ae.id,!1]))),ve=B(((ot=a[0])==null?void 0:ot.id)||"level1"),Ce=B(null);function Pe(){ue.value=!ue.value}function Fe(ae){D.push(ae)}async function Ue(){await O("/api/method/logout"),D.replace("/")}function Mt(ae){Te[ae]=!Te[ae]}function nt(ae){return!!Te[ae]}function Lt(ae,ne){Te[ae]=!0,ve.value=ae,Ce.value=ne,f.value&&(ue.value=!0),D.currentRoute.value.path!=="/home"&&D.push("/home")}function Bt(ae,ne){return ve.value===ae&&Ce.value===ne}const Ee=q(()=>{if(l.view&&j[l.view])return{level:null,challenge:null};if(!Ce.value)return{level:a.find(ne=>ne.id===ve.value)||null,challenge:null};for(const ae of a){const ne=ae.challenges.find(ce=>ce.id===Ce.value);if(ne)return{level:ae,challenge:ne}}return{level:a.find(ae=>ae.id===ve.value)||null,challenge:null}}),st=q(()=>{if(l.view&&j[l.view])return j[l.view];const ae=Ce.value;return ae?Y[ae]:null});ge(()=>{document.documentElement.dir=p.value,document.documentElement.lang=k.value,E(_.value),X(),x.refresh(),g(),f.value&&(ue.value=!0),typeof window!="undefined"&&window.addEventListener("resize",g),document.addEventListener("click",C),v=Nu(ae=>{const ne=ae.detail||{};if(!ne.message)return;const ce={id:ne.id||Math.random().toString(36).slice(2),message:ne.message,type:ne.type||"info"};$.value.push(ce),$.value.length>4&&$.value.shift();const Ae=Math.max(1500,ne.duration||2600);window.setTimeout(()=>r(ce.id),Ae)})}),tt(()=>{v&&v(),window.clearTimeout(s.timer),typeof window!="undefined"&&window.removeEventListener("resize",g),document.removeEventListener("click",C)});const Nt=new URL("/assets/mathematics_leaders/frontend/assets/logo3.jpeg",import.meta.url).href;return(ae,ne)=>(n(),o("div",{class:oe(["dashboard",_.value,{transitioning:u.value}]),dir:p.value},[ne[7]||(ne[7]=Ye('<div class="dashboard__background" aria-hidden="true" data-v-7999c0c0><span class="glow glow-one" data-v-7999c0c0></span><span class="glow glow-two" data-v-7999c0c0></span><span class="glow glow-three" data-v-7999c0c0></span><span class="mesh" data-v-7999c0c0></span></div>',1)),U(zt,{name:"toast-fade",tag:"div",class:"toasts","aria-live":"polite"},{default:ye(()=>[(n(!0),o(te,null,le($.value,ce=>(n(),o("div",{key:ce.id,class:oe(["toast",ce.type])},[ne[2]||(ne[2]=e("span",{class:"toast__dot"},null,-1)),e("p",null,t(ce.message),1),e("button",{type:"button",class:"toast__close",onClick:Ae=>r(ce.id)},"×",8,Wd)],2))),128))]),_:1}),e("header",Gd,[e("div",Vd,[f.value?(n(),o("button",{key:0,class:"topbar__menu",type:"button",onClick:Pe,"aria-expanded":!ue.value,"aria-label":ue.value?k.value==="ar"?"فتح قائمة التحديات":"Open challenges":k.value==="ar"?"إخفاء قائمة التحديات":"Hide challenges"},[ue.value?(n(),Se(Q(el),{key:0})):(n(),Se(Q(Ya),{key:1,style:de({transform:p.value==="rtl"?"scaleX(-1)":""})},null,8,["style"]))],8,Kd)):re("",!0),e("div",Yd,[e("div",Xd,[e("img",{src:Q(Nt),alt:"logo"},null,8,Jd)]),e("div",Zd,[e("span",ev,t(c[k.value].brand),1),e("span",tv,t(c[k.value].tagline),1)])])]),e("div",av,[U(Q(Ja),{class:"wave"}),e("div",lv,[e("h1",null,t(c[k.value].hello)+" "+t(Z.value||H.value),1),e("p",null,t(d("sub")),1)])]),e("div",nv,[e("button",{class:"action-btn",type:"button","aria-label":_.value==="dark"?k.value==="ar"?"التبديل إلى الوضع الفاتح":"Switch to light theme":k.value==="ar"?"التبديل إلى الوضع الداكن":"Switch to dark theme",onClick:y},[_.value==="light"?(n(),Se(Q(sl),{key:0})):(n(),Se(Q(tl),{key:1}))],8,sv),e("button",{class:"action-btn",type:"button","aria-label":k.value==="ar"?"Switch to English":"التبديل إلى العربية",onClick:i},t(k.value==="ar"?"EN":"ع"),9,ov),e("div",{class:"profile",ref_key:"profileRef",ref:ie,onClick:ne[1]||(ne[1]=We(ce=>se.value=!se.value,["stop"]))},[e("div",rv,[G.value?(n(),o("span",{key:0,class:"avatar__image",style:de({backgroundImage:`url(${G.value})`})},null,4)):(n(),o("span",iv,t(J.value),1))]),e("div",cv,[e("span",uv,t(Z.value||H.value),1),e("span",dv,t(c[k.value].brand),1)]),U(Q(dt),{class:oe(["profile__chevron",{open:se.value}])},null,8,["class"]),U(ke,{name:"fade"},{default:ye(()=>[se.value?(n(),o("ul",vv,[e("li",null,[e("button",{type:"button",onClick:ne[0]||(ne[0]=ce=>Fe("/settings"))},[U(Q(al)),ne[3]||(ne[3]=K()),e("span",null,t(c[k.value].settings),1)])]),e("li",null,[e("button",{type:"button",class:"danger",onClick:Ue},[U(Q(ft)),ne[4]||(ne[4]=K()),e("span",null,t(c[k.value].logout),1)])])])):re("",!0)]),_:1})],512)])]),e("main",hv,[e("section",pv,[e("article",fv,[e("div",mv,[U(Q(ht))]),e("div",gv,[e("h2",null,t(c[k.value].brand),1),e("p",null,t(c[k.value].pickPrompt),1)]),e("div",_v,[e("div",yv,[e("span",bv,t(c[k.value].scoreWidgetRank),1),e("strong",null,t(ae.scoreRankDisplay),1)]),e("div",kv,[e("span",wv,t(c[k.value].scoreWidgetPlayers),1),e("strong",null,t(T.value),1)])])]),e("article",{class:oe(["score-card",{loading:F.value,pulse:z.value}]),"aria-busy":F.value},[F.value?(n(),o("div",Cv,[U(Q(qe),{class:"overlay-spinner"})])):re("",!0),e("div",xv,[(n(),o("svg",Tv,[ne[5]||(ne[5]=e("defs",null,[e("linearGradient",{id:"dashboardScoreGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"#c6a034"}),e("stop",{offset:"100%","stop-color":"#0f8a3e"})])],-1)),ne[6]||(ne[6]=e("circle",{class:"ring-bg",cx:"60",cy:"60",r:"52"},null,-1)),e("circle",{class:"ring-fg",cx:"60",cy:"60",r:"52",stroke:"url(#dashboardScoreGradient)",style:de({"--progress":R.value})},null,4)])),e("div",Av,[U(ke,{name:"score-flip",mode:"out-in"},{default:ye(()=>[(n(),o("span",{class:"score-card__points",key:I.value},t(F.value?"...":S.value),1))]),_:1}),e("small",null,t(c[k.value].scoreWidgetTitle),1)])]),e("div",Sv,[e("span",Dv,t(A.value),1),e("p",Mv,t(F.value?c[k.value].scoreWidgetLoading:c[k.value].scoreWidgetSubtitle),1),e("div",{class:"progress",role:"progressbar","aria-valuenow":N.value,"aria-valuemin":"0","aria-valuemax":"100"},[e("div",Bv,[e("div",{class:"progress__fill",style:de({"--progress":R.value})},null,4)]),e("div",Nv,[e("span",null,t(N.value)+"%",1),e("button",{type:"button",class:"progress__link",onClick:W},t(c[k.value].scoreWidgetView),1)])],8,Lv)])],10,$v),e("article",Pv,[e("div",Ev,t(c[k.value].teacherTitle),1),e("h3",null,t(c[k.value].teacherSubtitle),1),e("p",null,t(c[k.value].teacherMessage),1)])]),e("section",zv,[e("aside",{class:oe(["challenge-list",{collapsed:ue.value&&f.value}])},[e("header",Rv,[e("h2",null,t(c[k.value].challenge),1),e("p",null,t(c[k.value].pickPrompt),1)]),e("div",Ov,[(n(),o(te,null,le(a,ce=>e("div",{class:"level-block",key:ce.id},[e("button",{type:"button",class:"level-head",onClick:Ae=>Mt(ce.id)},[e("div",Iv,[U(Q(bt),{class:"level-head__icon"}),e("span",Fv,t(ce.label[k.value]),1)]),e("span",Uv,t(ce.challenges.length),1),U(Q(dt),{class:oe(["level-head__chevron",{open:nt(ce.id)}])},null,8,["class"])],8,jv),U(ke,{name:"fade"},{default:ye(()=>[nt(ce.id)?(n(),o("div",qv,[(n(!0),o(te,null,le(ce.challenges,Ae=>(n(),o("button",{key:Ae.id,type:"button",class:oe(["challenge-card",{active:Bt(ce.id,Ae.id)}]),onClick:Ge=>Lt(ce.id,Ae.id)},[e("span",Hv,t(Ae.symbol),1),e("div",Wv,[e("span",Gv,t(Ae.label[k.value]),1),e("p",Vv,t(Ae.summary[k.value]),1)]),e("span",Kv,t(c[k.value].cardCTA),1)],10,Qv))),128))])):re("",!0)]),_:2},1024)])),64))]),e("div",Yv,[e("button",{type:"button",class:"logout-btn",onClick:Ue},[U(Q(ft)),e("span",null,t(c[k.value].logout),1)])])],2),e("div",Xv,[e("div",Jv,[Ee.value.level?(n(),o("span",Zv,t(Ee.value.level.label[k.value]),1)):re("",!0),e("div",e1,[w.value==="scores"?(n(),o("h3",t1,t(c[k.value].myScores),1)):w.value==="settings"?(n(),o("h3",a1,t(c[k.value].settings),1)):Ee.value.challenge?(n(),o("h3",l1,t(Ee.value.challenge.label[k.value]),1)):(n(),o("h3",n1,t(c[k.value].brand),1)),Ee.value.challenge?(n(),o("p",s1,t(Ee.value.challenge.summary[k.value]),1)):w.value==="scores"?(n(),o("p",o1,t(c[k.value].scoreWidgetSubtitle),1)):w.value==="settings"?(n(),o("p",r1,t(c[k.value].settings),1)):(n(),o("p",i1,t(c[k.value].pickPrompt),1))])]),e("div",c1,[U(ke,{name:"preview-fade",mode:"out-in"},{default:ye(()=>{var ce;return[st.value?(n(),Se(Re(st.value),Ot({key:w.value||((ce=Ee.value.challenge)==null?void 0:ce.id)||"welcome",class:"preview-component"},{lang:k.value,theme:_.value}),null,16)):(n(),o("div",u1,[U(Q(ht)),e("p",null,t(c[k.value].pickPrompt),1)]))]}),_:1})])])])])],10,Hd))}},v1=fe(d1,[["__scopeId","data-v-7999c0c0"]]),h1=jt({history:It("/math-leaders-games/"),routes:[{path:"/",redirect:"/login"},{path:"/login",component:qa},{path:"/home",component:v1},{path:"/scores",component:()=>it(()=>import("./ScoresView.js"),__vite__mapDeps([0,1]))},{path:"/settings",component:()=>it(()=>import("./SettingsView.js"),__vite__mapDeps([2,1]))}]});Ft(Ht).use(h1).mount("#app");export{v1 as D};
//# sourceMappingURL=platform.js.map
