const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/ScoresView.js","js/vue.js","js/SettingsView.js"])))=>i.map(i=>d[i]);
import{r as Lt,c as r,o as n,a as U,b as E,d as Q,w as me,e as ge,f as Ye,g as e,t,u as V,F as te,h as le,i as ie,n as oe,j as be,T as ke,k as We,l as Te,v as Me,m as Z,p as Ze,q as he,s as De,x as Re,y as de,z as Nt,A as tt,B as Et,C as Pt,D as zt,E as Bt,G as Rt,H as Ot}from"./vue.js";(function(){const D=document.createElement("link").relList;if(D&&D.supports&&D.supports("modulepreload"))return;for(const w of document.querySelectorAll('link[rel="modulepreload"]'))a(w);new MutationObserver(w=>{for(const B of w)if(B.type==="childList")for(const k of B.addedNodes)k.tagName==="LINK"&&k.rel==="modulepreload"&&a(k)}).observe(document,{childList:!0,subtree:!0});function l(w){const B={};return w.integrity&&(B.integrity=w.integrity),w.referrerPolicy&&(B.referrerPolicy=w.referrerPolicy),w.crossOrigin==="use-credentials"?B.credentials="include":w.crossOrigin==="anonymous"?B.credentials="omit":B.credentials="same-origin",B}function a(w){if(w.ep)return;w.ep=!0;const B=l(w);fetch(w.href,B)}})();const fe=(ee,D)=>{const l=ee.__vccOpts||ee;for(const[a,w]of D)l[a]=w;return l},jt={},It={class:"p-6"};function Ft(ee,D){const l=Lt("RouterView");return n(),r("main",It,[U(l)])}const qt=fe(jt,[["render",Ft]]),Ut="modulepreload",Qt=function(ee){return"/assets/mathematics_leaders/frontend/"+ee},rt={},it=function(D,l,a){let w=Promise.resolve();if(l&&l.length>0){let G=function(T){return Promise.all(T.map(A=>Promise.resolve(A).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const k=document.querySelector("meta[property=csp-nonce]"),L=(k==null?void 0:k.nonce)||(k==null?void 0:k.getAttribute("nonce"));w=G(l.map(T=>{if(T=Qt(T),T in rt)return;rt[T]=!0;const A=T.endsWith(".css"),f=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${T}"]${f}`))return;const d=document.createElement("link");if(d.rel=A?"stylesheet":Ut,A||(d.as="script"),d.crossOrigin="",d.href=T,L&&d.setAttribute("nonce",L),document.head.appendChild(d),A)return new Promise((S,M)=>{d.addEventListener("load",S),d.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${T}`)))})}))}function B(k){const L=new Event("vite:preloadError",{cancelable:!0});if(L.payload=k,window.dispatchEvent(L),!L.defaultPrevented)throw k}return w.then(k=>{for(const L of k||[])L.status==="rejected"&&B(L.reason);return D().catch(B)})},Vt=["dir"],Wt={class:"floating-controls"},Gt=["aria-label"],Ht={class:"control-icon","aria-hidden":"true"},Kt={key:0,viewBox:"0 0 24 24",focusable:"false"},Yt={key:1,viewBox:"0 0 24 24",focusable:"false"},Zt={class:"control-text"},Jt=["aria-label"],Xt={class:"landing__wrapper"},ea={class:"landing__intro"},ta={class:"logo-card"},aa=["src"],la={class:"intro__title"},na={class:"intro__subtitle"},sa={class:"feature-grid"},oa={class:"feature-index"},ra={class:"feature-text"},ia={class:"stats-row"},ca={class:"stat-value"},ua={class:"stat-label"},da={class:"landing__auth"},va={class:"auth-card"},ha={class:"auth-tabs",role:"tablist"},pa=["aria-selected"],fa=["aria-selected"],ma={class:"input-field"},ga=["for"],_a=["id","placeholder"],ba={class:"input-field"},ya=["for"],ka=["id","placeholder"],wa={class:"form-meta"},$a={href:"#"},Ca=["disabled"],xa={class:"switch-text"},Sa={class:"input-field"},Aa=["for"],Da=["id","placeholder"],Ta={class:"input-field"},Ma=["for"],La=["id","placeholder"],Na={class:"input-field"},Ea=["for"],Pa=["id","placeholder"],za=["disabled"],Ba={class:"switch-text"},Ra={key:0,class:"auth-notice"},Oa="",ja={__name:"Index",setup(ee){const D=E(localStorage.getItem("ml_lang")||"ar"),l=Q(()=>D.value==="ar"?"rtl":"ltr"),a=m=>({en:{signin:"Sign In",signup:"Create Account",username:"Username",password:"Password",confirm:"Confirm Password",login:"Login",register:"Signup",toSignup:"Create account",toSignin:"Back to login",forgot:"Forgot password?"},ar:{signin:"تسجيل الدخول",signup:"إنشاء حساب",username:"اسم المستخدم",password:"كلمة المرور",confirm:"تأكيد كلمة المرور",login:"دخول",register:"تسجيل",toSignup:"إنشاء حساب",toSignin:"العودة لتسجيل الدخول",forgot:"نسيت كلمة المرور؟"}})[D.value][m],w=Q(()=>D.value==="ar");function B(){D.value=w.value?"en":"ar"}const k=E(localStorage.getItem("ml_theme")||"light"),L=Q(()=>k.value==="dark"),G=Q(()=>w.value?L.value?"فاتح":"داكن":L.value?"Light":"Dark"),T=Q(()=>w.value?L.value?"التبديل إلى الوضع الفاتح":"التبديل إلى الوضع الداكن":L.value?"Switch to light theme":"Switch to dark theme");function A(){k.value=L.value?"light":"dark"}function f(m){document.documentElement.setAttribute("data-ml-theme",m)}me(D,m=>{localStorage.setItem("ml_lang",m),document.documentElement.dir=l.value,document.documentElement.lang=m}),me(k,m=>{localStorage.setItem("ml_theme",m),f(m)}),ge(()=>{document.documentElement.dir=l.value,document.documentElement.lang=D.value,f(k.value)});const d=E(!1),S=E({username:"",password:""}),M=E({username:"",password:"",confirm:""}),I=E(!1),N=E(null);me(d,()=>{N.value=null});const H=new URL("/assets/mathematics_leaders/frontend/assets/logo3.jpeg",import.meta.url).href,X=Q(()=>w.value?"منصة زعماء الرياضيات":"Mathematics Leaders Platform"),R=Q(()=>w.value?"تعلم الرياضيات بأسلوب ممتع وتفاعلي مصمم للقادة الصغار.":"Master mathematics with playful, interactive journeys built for young leaders."),j=Q(()=>w.value?["برامج تفاعلية مدعومة بالذكاء الاصطناعي","تتبع تقدّم ذكي ومباشر","مجتمع محفّز من المعلمين والطلاب"]:["Interactive, AI-guided programmes","Real-time progress insights","A supportive teacher & student community"]),O=Q(()=>w.value?[{value:"12+",label:"وحدة تعليمية متدرجة"},{value:"4K",label:"طالب نشط"},{value:"92%",label:"نسبة إكمال المهام"}]:[{value:"12+",label:"Adaptive learning tracks"},{value:"4K",label:"Active learners"},{value:"92%",label:"Task completion rate"}]);async function W(m,c={}){const g=new URLSearchParams(c).toString(),$=await fetch(Oa+m+(g?`?${g}`:""),{method:"GET",credentials:"include"}),y=await $.json().catch(()=>({}));if(!$.ok)throw y;return y}function J(m){if(typeof m=="string")return m;if(m!=null&&m._server_messages)try{const c=JSON.parse(m._server_messages),g=(c==null?void 0:c[0])&&JSON.parse(c[0]);return(g==null?void 0:g.message)||(g==null?void 0:g._error_message)||"Invalid Request"}catch{}return(m==null?void 0:m.message)||(m==null?void 0:m.exc)||"Invalid Request"}function P(m){const c=m||{username:S.value.username};localStorage.setItem("ml_profile",JSON.stringify({...c,language:D.value})),window.location.href="/math-leaders-games/#/home"}async function h(){var m,c;I.value=!0,N.value=null;try{if(d.value){if(!M.value.username||!M.value.password||!M.value.confirm)throw{message:w.value?"الرجاء ملء كل الحقول.":"Please fill all fields."};if(M.value.password!==M.value.confirm)throw{message:w.value?"كلمتا المرور غير متطابقتين.":"Passwords do not match."};await W("/api/method/mathematics_leaders.api.signup_and_login.signup_user",{username:M.value.username,password:M.value.password,language:D.value});const g=await W("/api/method/mathematics_leaders.api.signup_and_login.verify_login",{usr:M.value.username,pwd:M.value.password});P(((m=g==null?void 0:g.message)==null?void 0:m.profile)||{username:M.value.username})}else{const g=await W("/api/method/mathematics_leaders.api.signup_and_login.verify_login",{usr:S.value.username,pwd:S.value.password});P(((c=g==null?void 0:g.message)==null?void 0:c.profile)||{username:S.value.username})}}catch(g){N.value=J(g)}finally{I.value=!1}}return(m,c)=>(n(),r("section",{class:oe(["landing",k.value]),dir:l.value},[c[11]||(c[11]=Ye('<div class="background" aria-hidden="true" data-v-9ae221db><span class="glow glow-one" data-v-9ae221db></span><span class="glow glow-two" data-v-9ae221db></span><span class="glow glow-three" data-v-9ae221db></span><span class="grid" data-v-9ae221db></span></div>',1)),e("div",Wt,[e("button",{type:"button",class:"control-btn theme-toggle","aria-label":T.value,onClick:A},[e("span",Ht,[L.value?(n(),r("svg",Kt,[...c[9]||(c[9]=[Ye('<circle cx="12" cy="12" r="4.2" fill="none" stroke="currentColor" stroke-width="1.6" data-v-9ae221db></circle><line x1="12" y1="2.4" x2="12" y2="5.4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="12" y1="18.6" x2="12" y2="21.6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="2.4" y1="12" x2="5.4" y2="12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="18.6" y1="12" x2="21.6" y2="12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="5.4" y1="5.4" x2="7.7" y2="7.7" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="16.3" y1="16.3" x2="18.6" y2="18.6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="5.4" y1="18.6" x2="7.7" y2="16.3" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="16.3" y1="7.7" x2="18.6" y2="5.4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line>',9)])])):(n(),r("svg",Yt,[...c[10]||(c[10]=[e("path",{d:"M15.8 21.2a7.6 7.6 0 0 1-6.9-10.6 6.9 6.9 0 0 0 8.5 8.5 7.6 7.6 0 0 1-1.6 2.1Z",fill:"none",stroke:"currentColor","stroke-width":"1.6","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))]),e("span",Zt,t(G.value),1)],8,Gt),e("button",{type:"button",class:"control-btn lang-toggle","aria-label":w.value?"Switch to English":"التبديل إلى العربية",onClick:B},[e("span",null,t(w.value?"EN":"ع"),1)],8,Jt)]),e("div",Xt,[e("div",ea,[e("div",ta,[e("img",{src:V(H),alt:"شعار زعماء الرياضيات"},null,8,aa)]),e("h1",la,t(X.value),1),e("p",na,t(R.value),1),e("ul",sa,[(n(!0),r(te,null,le(j.value,(g,$)=>(n(),r("li",{key:$,class:"feature-item"},[e("span",oa,"0"+t($+1),1),e("span",ra,t(g),1)]))),128))]),e("div",ia,[(n(!0),r(te,null,le(O.value,(g,$)=>(n(),r("div",{key:$,class:"stat-card"},[e("span",ca,t(g.value),1),e("span",ua,t(g.label),1)]))),128))])]),e("div",da,[e("div",va,[e("div",ha,[e("button",{type:"button",class:oe(["tab-btn",{active:!d.value}]),role:"tab","aria-selected":!d.value,onClick:c[0]||(c[0]=g=>d.value=!1)},t(a("signin")),11,pa),e("button",{type:"button",class:oe(["tab-btn",{active:d.value}]),role:"tab","aria-selected":d.value,onClick:c[1]||(c[1]=g=>d.value=!0)},t(a("signup")),11,fa)]),U(ke,{name:"slide-fade",mode:"out-in"},{default:be(()=>[d.value?(n(),r("form",{key:"signup",class:"auth-form",onSubmit:We(h,["prevent"])},[e("div",Sa,[e("label",{for:w.value?"signup-username-ar":"signup-username-en"},t(a("username")),9,Aa),Te(e("input",{id:w.value?"signup-username-ar":"signup-username-en","onUpdate:modelValue":c[5]||(c[5]=g=>M.value.username=g),type:"text",placeholder:a("username"),autocomplete:"username",required:""},null,8,Da),[[Me,M.value.username]])]),e("div",Ta,[e("label",{for:w.value?"signup-password-ar":"signup-password-en"},t(a("password")),9,Ma),Te(e("input",{id:w.value?"signup-password-ar":"signup-password-en","onUpdate:modelValue":c[6]||(c[6]=g=>M.value.password=g),type:"password",placeholder:a("password"),autocomplete:"new-password",required:""},null,8,La),[[Me,M.value.password]])]),e("div",Na,[e("label",{for:w.value?"signup-confirm-ar":"signup-confirm-en"},t(a("confirm")),9,Ea),Te(e("input",{id:w.value?"signup-confirm-ar":"signup-confirm-en","onUpdate:modelValue":c[7]||(c[7]=g=>M.value.confirm=g),type:"password",placeholder:a("confirm"),autocomplete:"new-password",required:""},null,8,Pa),[[Me,M.value.confirm]])]),e("button",{class:"primary-btn",type:"submit",disabled:I.value},[e("span",null,t(a("register")),1)],8,za),e("p",Ba,[Z(t(w.value?"لديك حساب بالفعل؟":"Already have an account?")+" ",1),e("button",{type:"button",onClick:c[8]||(c[8]=g=>d.value=!1)},t(a("toSignin")),1)])],32)):(n(),r("form",{key:"signin",class:"auth-form",onSubmit:We(h,["prevent"])},[e("div",ma,[e("label",{for:w.value?"signin-username-ar":"signin-username-en"},t(a("username")),9,ga),Te(e("input",{id:w.value?"signin-username-ar":"signin-username-en","onUpdate:modelValue":c[2]||(c[2]=g=>S.value.username=g),type:"text",placeholder:a("username"),autocomplete:"username",required:""},null,8,_a),[[Me,S.value.username]])]),e("div",ba,[e("label",{for:w.value?"signin-password-ar":"signin-password-en"},t(a("password")),9,ya),Te(e("input",{id:w.value?"signin-password-ar":"signin-password-en","onUpdate:modelValue":c[3]||(c[3]=g=>S.value.password=g),type:"password",placeholder:a("password"),autocomplete:"current-password",required:""},null,8,ka),[[Me,S.value.password]])]),e("div",wa,[e("a",$a,t(a("forgot")),1)]),e("button",{class:"primary-btn",type:"submit",disabled:I.value},[e("span",null,t(a("login")),1)],8,Ca),e("p",xa,[Z(t(w.value?"لا تملك حساباً؟":"Don't have an account?")+" ",1),e("button",{type:"button",onClick:c[4]||(c[4]=g=>d.value=!0)},t(a("toSignup")),1)])],32))]),_:1}),N.value?(n(),r("p",Ra,t(N.value),1)):ie("",!0)])])])],10,Vt))}},Ia=fe(ja,[["__scopeId","data-v-9ae221db"]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=ee=>ee.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Fa=ee=>ee.replace(/^([A-Z])|[\s-_]+(\w)/g,(D,l,a)=>a?a.toUpperCase():l.toLowerCase()),qa=ee=>{const D=Fa(ee);return D.charAt(0).toUpperCase()+D.slice(1)},Ua=(...ee)=>ee.filter((D,l,a)=>!!D&&D.trim()!==""&&a.indexOf(D)===l).join(" ").trim(),ut=ee=>ee==="";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var je={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=({name:ee,iconNode:D,absoluteStrokeWidth:l,"absolute-stroke-width":a,strokeWidth:w,"stroke-width":B,size:k=je.width,color:L=je.stroke,...G},{slots:T})=>Ze("svg",{...je,...G,width:k,height:k,stroke:L,"stroke-width":ut(l)||ut(a)||l===!0||a===!0?Number(w||B||je["stroke-width"])*24/Number(k):w||B||je["stroke-width"],class:Ua("lucide",G.class,...ee?[`lucide-${ct(qa(ee))}-icon`,`lucide-${ct(ee)}`]:["lucide-icon"])},[...D.map(A=>Ze(...A)),...T.default?[T.default()]:[]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=(ee,D)=>(l,{slots:a,attrs:w})=>Ze(Qa,{...w,...l,iconNode:D,name:ee},a);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=pe("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=pe("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=pe("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=pe("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=pe("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=pe("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=pe("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=pe("diamond",[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=pe("eraser",[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=pe("hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=pe("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=pe("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=pe("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=pe("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=pe("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=pe("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=pe("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=pe("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=pe("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=pe("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=pe("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=pe("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=pe("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=pe("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ll=pe("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=pe("triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=pe("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),_t="/assets/mathematics_leaders/frontend/assets/success.mp3",$e="/assets/mathematics_leaders/frontend/assets/clap.mp3",at="/assets/mathematics_leaders/frontend/assets/wrong.mp3",ol=["dir","data-theme"],rl={class:"hdr"},il={class:"sub"},cl={class:"board"},ul={class:"assign",dir:"ltr"},dl=["onDrop"],vl={class:"actions"},hl=["disabled"],pl={class:"col-sum",dir:"ltr"},fl={class:"row"},ml={key:0},gl={class:"row"},_l={key:0},bl={class:"row"},yl={key:0},kl={class:"digits",dir:"ltr"},wl={class:"tiles"},$l=["onDragstart"],Cl={key:0,class:"overlay"},xl={class:"sheet"},Sl={class:"big"},Al={class:"toasts"},Dl={__name:"challenge_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l=E(D.lang),a=E(D.theme);me(()=>D.lang,b=>l.value=b),me(()=>D.theme,b=>a.value=b);async function w(b,z={}){const v=new URLSearchParams(z).toString(),s=await fetch(b+(v?`?${v}`:""),{method:"GET",credentials:"include"}),o=await s.json().catch(()=>({}));if(!s.ok)throw o;return o}const B=Q(()=>l.value==="ar"?"rtl":"ltr"),k={ar:{title:"التحدي 1: عملية جمع عمودية بأرقام مفقودة (رموز)",subtitle:"اسحب الأرقام وضعها مكان الرموز حتى تكتمل العملية.",digits:"الأرقام",check:"تحقق",reset:"إعادة ضبط",newQ:"سؤال جديد",correctBig:"أحسنت!",correctSub:"حل صحيح 👏 لقد كسبت نقطة.",wrong:"حاول مرة أخرى 🤔"},en:{title:"Challenge 1: Column addition with missing (symbol) digits",subtitle:"Drag digits onto symbols until the addition becomes correct.",digits:"Digits",check:"Check",reset:"Reset",newQ:"New Question",correctBig:"Great!",correctSub:"Correct 👏 You earned a point.",wrong:"Try again 🤔"}},L=b=>k[l.value][b],G=new Audio(_t),T=new Audio($e),A=new Audio(at);G.preload="auto",T.preload="auto",A.preload="auto";const f={circle:vt,square:tl,triangle:nl,diamond:Ha},d=["circle","square","triangle","diamond"],S=b=>f[b]||vt;function M(b,z){return b+Math.floor(Math.random()*(z-b+1))}function I(b){return b.slice().sort(()=>Math.random()-.5)}const N=he({aStr:"",bStr:"",sStr:"",hiddenMap:{},assignMap:{},usedShapes:[]}),H=E([]),X=E([]),R=E([]);function j(){const b=M(2,3),z=M(2,3),v=M(10**(b-1),10**b-1),s=M(10**(z-1),10**z-1),o=v+s;N.aStr=String(v),N.bStr=String(s),N.sStr=String(o);const i=Array.from(new Set((N.aStr+N.bStr+N.sStr).split("").map(K=>+K))),_=Math.min(M(2,3),i.length),q=I(i).slice(0,_),x=I(d).slice(0,_);N.hiddenMap={},q.forEach((K,Y)=>{N.hiddenMap[x[Y]]=K});const C=new Set;function F(K){return K.split("").map(Y=>{var ue;const ne=+Y,re=(ue=Object.entries(N.hiddenMap).find(([Se,ve])=>ve===ne))==null?void 0:ue[0];return re?(C.add(re),{t:"shape",v:re}):{t:"digit",v:Y}})}H.value=F(N.aStr),X.value=F(N.bStr),R.value=F(N.sStr),N.usedShapes=Array.from(C),N.assignMap=Object.fromEntries(N.usedShapes.map(K=>[K,null])),N.usedShapes.length===0&&j()}function O(b,z){b.dataTransfer.setData("text/plain",String(z))}function W(b,z){const v=Number(b.dataTransfer.getData("text/plain"));Number.isNaN(v)||Object.values(N.assignMap).includes(v)&&N.assignMap[z]!==v||(N.assignMap[z]=v,$())}function J(b){b.preventDefault()}function P(){Object.keys(N.assignMap).forEach(b=>N.assignMap[b]=null)}const h=Q(()=>N.usedShapes.every(b=>Number.isInteger(N.assignMap[b])));function m(b){return Number(b.map(z=>{var v;return z.t==="digit"?z.v:(v=N.assignMap[z.v])!=null?v:"?"}).join(""))}function c(){if(!h.value)return!1;const b=m(H.value),z=m(X.value),v=m(R.value);return![b,z,v].some(s=>String(s).includes("?"))&&b+z===v}const g=he({open:!1,good:!0});async function $(){if(h.value)if(c()){try{G.currentTime=0,G.play().catch(()=>{})}catch{}try{T.currentTime=0,T.play().catch(()=>{})}catch{}g.open=!0,g.good=!0,w("/api/method/mathematics_leaders.api.game_points.add_point",{amount:1}).catch(()=>{})}else{try{A.currentTime=0,A.play().catch(()=>{})}catch{}p(L("wrong"),"warn")}}function y(){g.open=!1,j()}const u=E([]);function p(b,z="ok"){const v=Math.random().toString(36).slice(2);u.value.push({id:v,msg:b,type:z}),setTimeout(()=>u.value=u.value.filter(s=>s.id!==v),1800)}return ge(()=>j()),(b,z)=>(n(),r("section",{class:"wrap challenge-surface",dir:B.value,"data-theme":a.value},[e("header",rl,[e("h2",null,t(L("title")),1),e("p",il,t(L("subtitle")),1)]),e("div",cl,[e("div",ul,[(n(!0),r(te,null,le(N.usedShapes,v=>(n(),r("div",{key:v,class:"slot",onDrop:s=>W(s,v),onDragover:J},[(n(),De(Re(S(v)),{class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}})),e("div",{class:oe(["val",{empty:N.assignMap[v]==null}])},t(N.assignMap[v]==null?"…":N.assignMap[v]),3)],40,dl))),128)),e("div",vl,[e("button",{class:"ghost",onClick:P},t(L("reset")),1),e("button",{class:"primary",disabled:!h.value,onClick:$},t(L("check")),9,hl),e("button",{class:"ghost",onClick:j},t(L("newQ")),1)])]),e("div",pl,[e("div",fl,[(n(!0),r(te,null,le(H.value,(v,s)=>(n(),r("span",{key:"a"+s,class:oe(["cell",v.t])},[v.t==="digit"?(n(),r("span",ml,t(v.v),1)):(n(),De(Re(S(v.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))]),z[0]||(z[0]=e("div",{class:"row plus"},[e("span",null,"+")],-1)),e("div",gl,[(n(!0),r(te,null,le(X.value,(v,s)=>(n(),r("span",{key:"b"+s,class:oe(["cell",v.t])},[v.t==="digit"?(n(),r("span",_l,t(v.v),1)):(n(),De(Re(S(v.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))]),z[1]||(z[1]=e("div",{class:"line"},null,-1)),e("div",bl,[(n(!0),r(te,null,le(R.value,(v,s)=>(n(),r("span",{key:"s"+s,class:oe(["cell",v.t])},[v.t==="digit"?(n(),r("span",yl,t(v.v),1)):(n(),De(Re(S(v.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))])]),e("div",kl,[e("h4",null,t(L("digits")),1),e("div",wl,[(n(),r(te,null,le(10,v=>e("button",{key:v-1,class:"tile",draggable:"true",onDragstart:s=>O(s,v-1)},t(v-1),41,$l)),64))])])]),U(ke,{name:"fade"},{default:be(()=>[g.open?(n(),r("div",Cl,[e("div",xl,[e("div",Sl,t(L("correctBig")),1),e("p",null,t(L("correctSub")),1),e("button",{class:"primary",onClick:y},t(L("newQ")),1)])])):ie("",!0)]),_:1}),e("div",Al,[(n(!0),r(te,null,le(u.value,v=>(n(),r("div",{key:v.id,class:oe(["toast",v.type])},t(v.msg),3))),128))])],8,ol))}},Tl=fe(Dl,[["__scopeId","data-v-9c65b80b"]]),Ne="/assets/mathematics_leaders/frontend/assets/success2.mp3",Ee="/assets/mathematics_leaders/frontend/assets/wrong2.mp3",Ml=["data-theme"],Ll={class:"title"},Nl={class:"rule"},El={class:"layout"},Pl={class:"grid"},zl=["onDrop"],Bl={key:1,class:"placeholder"},Rl=["value","onInput","onChange","onBlur","placeholder"],Ol=["onClick"],jl={class:"bank"},Il={class:"bank-title"},Fl={class:"bank-items"},ql=["onDragstart"],Ul={class:"actions"},Ql={key:0,class:"overlay"},Vl={class:"card"},Wl={class:"big"},Gl={__name:"challenge_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 2: شبكة أعداد تزيد بمقدار {STEP}",rule:"كل خانة تزيد {STEP} عن اليسار وعن الأعلى. اسحب الأعداد المفقودة إلى أماكنها.",newQ:"سؤال جديد",check:"تحقّق",reset:"إعادة تعيين",correct:"إجابة صحيحة",wrong:"تحقق من القيم",bank:"لوحة الأعداد",clear:"تفريغ الخلية"},en:{title:"Challenge 2: Number grid with step {STEP}",rule:"Each cell increases by {STEP} from its left and its top. Drag the missing numbers into place.",newQ:"New puzzle",check:"Check",reset:"Reset",correct:"Correct answer",wrong:"Check your values",bank:"Number bank",clear:"Clear cell"}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Ne):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Ee):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");const L=[100,200,500,1e3,2e3];function G(x,C){return Math.floor(Math.random()*(C-x+1))+x}function T(x){const C=x.slice();for(let F=C.length-1;F>0;F--){const K=Math.floor(Math.random()*(F+1));[C[F],C[K]]=[C[K],C[F]]}return C}const A=E(3),f=E(1e3),d=E(0),S=E([]),M=E(new Set),I=E({}),N=E({}),H=E({}),X=E(!1),R=E(null),j=Q(()=>l[a.value].title.replaceAll("{STEP}",f.value)),O=Q(()=>l[a.value].rule.replaceAll("{STEP}",f.value)),W=(x,C)=>`${x},${C}`;function J(x,C,F){const K=[];for(let Y=0;Y<x;Y++){const ne=[];for(let re=0;re<x;re++)ne.push(C+F*(Y+re));K.push(ne)}return K}function P(x){const C=[];for(let Y=0;Y<x;Y++)for(let ne=0;ne<x;ne++)C.push([Y,ne]);const F=C.filter(([Y,ne])=>!(Y===0&&ne===0)),K=G(3,5);return new Set(T(F).slice(0,K).map(([Y,ne])=>W(Y,ne)))}function h(){const x={};M.value.forEach(C=>{const[F,K]=C.split(",").map(Number),Y=S.value[F][K];x[Y]=(x[Y]||0)+1}),H.value=x}const m=Q(()=>{const x=[];for(const[C,F]of Object.entries(H.value))for(let K=0;K<F;K++)x.push(Number(C));return T(x)});function c(){X.value=!1,R.value=null,I.value={},N.value={},f.value=L[G(0,L.length-1)];const x=G(5,19)*100;d.value=x;const C=A.value;S.value=J(C,d.value,f.value),M.value=P(C),h()}function g(){for(const x of M.value)if(I.value[x]==null)return!1;return!0}function $(){if(!g())return!1;for(const x of M.value){const[C,F]=x.split(",").map(Number);if(I.value[x]!==S.value[C][F])return!1}return!0}async function y(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function u(){if(!g()){R.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",k&&k.play();return}$()?(X.value=!0,R.value=l[a.value].correct,w&&w.play(),B&&B.play(),await y()):(R.value=l[a.value].wrong,k&&k.play())}function p(){I.value={},N.value={},h(),R.value=null,X.value=!1}function b(x,C,{fromManual:F=!1}={}){if(!Number.isNaN(C)){if(I.value[x]!=null){const K=I.value[x];H.value[K]=(H.value[K]||0)+1}if(F)(H.value[C]||0)>0&&(H.value[C]-=1);else{if((H.value[C]||0)===0)return;H.value[C]-=1}I.value[x]=C,N.value={...N.value,[x]:String(C)},R.value=null}}function z(x,C){x.dataTransfer.setData("text/plain",String(C))}function v(x){x.preventDefault()}function s(x,C){x.preventDefault();const F=Number(x.dataTransfer.getData("text/plain"));b(C,F)}function o(x){if(I.value[x]!=null){const C=I.value[x];H.value[C]=(H.value[C]||0)+1,delete I.value[x]}N.value={...N.value,[x]:""}}function i(x,C){N.value={...N.value,[x]:C}}function _(x){var K;const C=((K=N.value[x])!=null?K:"").trim();if(C===""){o(x);return}const F=Number(C);Number.isFinite(F)&&b(x,F,{fromManual:!0})}const q=Q(()=>({direction:"ltr",unicodeBidi:"isolate"}));return ge(c),me(()=>D.lang,()=>R.value=null),(x,C)=>(n(),r("div",{class:"challenge2 challenge-surface","data-theme":D.theme},[e("h2",Ll,t(j.value),1),e("p",Nl,t(O.value),1),e("div",El,[e("div",Pl,[(n(!0),r(te,null,le(A.value,F=>(n(),r("div",{key:"r"+F,class:"row"},[(n(!0),r(te,null,le(A.value,K=>{var Y;return n(),r("div",{key:"c"+F+"-"+K,class:"cell"},[M.value.has(`${F-1},${K-1}`)?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:v,onDrop:ne=>s(ne,`${F-1},${K-1}`)},[I.value[`${F-1},${K-1}`]!=null?(n(),r("span",{key:0,class:"num",style:de(q.value)},t(I.value[`${F-1},${K-1}`]),5)):(n(),r("span",Bl,"؟"))],40,zl),e("input",{class:"manual-entry",type:"number",value:(Y=N.value[`${F-1},${K-1}`])!=null?Y:"",onInput:ne=>i(`${F-1},${K-1}`,ne.target.value),onChange:ne=>_(`${F-1},${K-1}`),onBlur:ne=>_(`${F-1},${K-1}`),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,Rl),e("button",{class:"clear",onClick:ne=>o(`${F-1},${K-1}`)},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)],8,Ol)],64)):(n(),r("span",{key:0,class:"num",style:de(q.value)},t(S.value[F-1][K-1]),5))])}),128))]))),128))]),e("div",jl,[e("div",Il,t(l[a.value].bank),1),e("div",Fl,[(n(!0),r(te,null,le(m.value,F=>(n(),r("button",{key:F+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:K=>z(K,F),style:de(q.value)},t(F),45,ql))),128))]),e("div",Ul,[e("button",{class:"btn",onClick:p},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:u},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:c},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),R.value?(n(),r("div",{key:0,class:oe(["toast",{ok:X.value}])},t(R.value),3)):ie("",!0)])]),X.value?(n(),r("div",Ql,[e("div",Vl,[e("div",Wl,t(l[a.value].correct),1),e("button",{class:"btn",onClick:c},t(l[a.value].newQ),1)])])):ie("",!0)],8,Ml))}},Hl=fe(Gl,[["__scopeId","data-v-f172099e"]]),Le="/assets/mathematics_leaders/frontend/assets/success3.mp3",Oe="/assets/mathematics_leaders/frontend/assets/wrong3.mp3",Kl=["data-theme"],Yl={class:"title"},Zl={class:"rule"},Jl={class:"qs"},Xl={class:"qtext"},en={class:"opts"},tn=["onClick"],an=["onClick"],ln={class:"toolbar"},nn={class:"status"},sn={key:0,class:"done"},on={class:"actions"},rn=4,cn={__name:"challenge_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 3: إيجاد عددين من المجموع والفرق",rule:"اختر الزوج الصحيح (أكبر، أصغر) بحيث يكون مجموعهما S والفرق بينهما D.",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"إجابة غير صحيحة",done:"أكملت هذه الجولة",q:(R,j,O)=>`(${R}) جد عددين ناتج جمعهما ${j} والفرق بينهما ${O}`},en:{title:"Challenge 3: Find two numbers from sum and difference",rule:"Pick the correct pair (greater, smaller) with sum S and difference D.",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Incorrect",done:"Round completed",q:(R,j,O)=>`(${R}) Find two numbers with sum ${j} and difference ${O}`}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Le):null,B=typeof Audio!="undefined"?new Audio(Oe):null;w&&(w.preload="auto"),B&&(B.preload="auto");function k(R,j){return Math.floor(Math.random()*(j-R+1))+R}function L(R){const j=R.slice();for(let O=j.length-1;O>0;O--){const W=Math.floor(Math.random()*(O+1));[j[O],j[W]]=[j[W],j[O]]}return j}const G=E([]),T=Q(()=>G.value.filter(R=>{var j;return R.judged&&((j=R.options[R.pickedIndex])==null?void 0:j.isAns)}).length),A=Q(()=>G.value.length>0&&G.value.every(R=>R.judged));function f(R,j){return[(R+j)/2,(R-j)/2]}function d(R){return Number.isInteger(R)&&R>=0}function S(){let R,j,O,W;for(;R=k(10,60),j=k(0,20),!((R&1)===(j&1)&&!(R<j)&&([O,W]=f(R,j),d(O)&&d(W))););const J=new Set,P=(m,c)=>{const g=`${m},${c}`;m>=0&&c>=0&&Number.isInteger(m)&&Number.isInteger(c)&&g!==`${O},${W}`&&J.add(g)};P(O+1,W-1),P(O-1,W+1),P(O+2,W-2),P(O-2,W+2),P(O+1,W),P(O,W+1);const h=[{a:O,b:W,isAns:!0}];for(const m of Array.from(J).slice(0,3)){const[c,g]=m.split(",").map($=>Number($));if(h.push({a:c,b:g,isAns:!1}),h.length===4)break}for(;h.length<4;){const m=k(-3,3),c=k(-3,3),g=Math.max(0,O+m),$=Math.max(0,W+c);g===O&&$===W||h.push({a:g,b:$,isAns:!1})}return{S:R,D:j,ans:[O,W],options:L(h),pickedIndex:null,judged:!1,firstTry:!0}}function M(){G.value=Array.from({length:rn},()=>S())}function I(){for(const R of G.value)R.pickedIndex=null,R.judged=!1,R.firstTry=!0}async function N(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function H(R,j){if(R.judged)return;R.pickedIndex=j,R.judged=!0,R.options[j].isAns?(w&&w.play(),A.value&&w&&w.play(),R.firstTry&&await N()):B&&B.play()}function X(R){R.judged=!1,R.firstTry=!1,R.pickedIndex=null}return ge(M),me(()=>D.lang,()=>{}),(R,j)=>(n(),r("div",{class:"challenge3 challenge-surface","data-theme":D.theme},[e("h2",Yl,t(l[a.value].title),1),e("p",Zl,t(l[a.value].rule),1),e("div",Jl,[(n(!0),r(te,null,le(G.value,(O,W)=>(n(),r("div",{key:W,class:"qcard"},[e("div",Xl,t(l[a.value].q(W+1,O.S,O.D)),1),e("div",en,[(n(!0),r(te,null,le(O.options,(J,P)=>(n(),r("button",{key:P,class:oe(["opt",{chosen:O.pickedIndex===P,ok:O.judged&&O.options[P].isAns,bad:O.judged&&O.pickedIndex===P&&!O.options[P].isAns}]),onClick:h=>H(O,P)}," ( "+t(J.a)+" ، "+t(J.b)+" ) ",11,tn))),128))]),O.judged?(n(),r("div",{key:0,class:oe(["feedback",{ok:O.options[O.pickedIndex].isAns}])},[Z(t(O.options[O.pickedIndex].isAns?l[a.value].correct:l[a.value].wrong)+" ",1),O.options[O.pickedIndex].isAns?ie("",!0):(n(),r("button",{key:0,class:"retry",onClick:J=>X(O)},"↺",8,an))],2)):ie("",!0)]))),128))]),e("div",ln,[e("div",nn,[U(V(ye),{class:"ic"}),Z(" "+t(T.value)+" / "+t(G.value.length)+" ",1),A.value&&T.value===G.value.length?(n(),r("span",sn," · "+t(l[a.value].done),1)):ie("",!0)]),e("div",on,[e("button",{class:"btn",onClick:I},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:M},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])])])],8,Kl))}},un=fe(cn,[["__scopeId","data-v-d29bc703"]]),bt="/assets/mathematics_leaders/frontend/assets/success4.mp3",yt="/assets/mathematics_leaders/frontend/assets/wrong4.mp3",dn=["data-theme"],vn={class:"title"},hn={class:"rule"},pn={class:"table"},fn=["onDrop"],mn={key:1,class:"placeholder"},gn=["value","onInput","onChange","onBlur","placeholder"],_n=["onClick"],bn={class:"side"},yn={class:"bank-title"},kn={class:"bank-items"},wn=["onDragstart"],$n={class:"actions"},Cn={key:0,class:"overlay"},xn={class:"card"},Sn={class:"big"},Be=3,An={__name:"challenge_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 4: أكمل جدول الضرب",rule:"جدول ضرب بعناوين صفوف وأعمدة. اسحب القيم الصحيحة من الأسفل إلى الخانات الفارغة.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 4: Complete the multiplication table",rule:"A multiplication table with row/column headers. Drag correct values into the blanks.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check your values",clear:"Clear cell"}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(bt):null,B=typeof Audio!="undefined"?new Audio(yt):null;w&&(w.preload="auto"),B&&(B.preload="auto");function k(s,o){return Math.floor(Math.random()*(o-s+1))+s}function L(s){const o=s.slice();for(let i=o.length-1;i>0;i--){const _=Math.floor(Math.random()*(i+1));[o[i],o[_]]=[o[_],o[i]]}return o}const G=E([]),T=E([]),A=E(new Set),f=E({}),d=E({}),S=E({}),M=E(!1),I=E(null);function N(s,o){return s===0&&o===0?"×":s===0?T.value[o-1]:o===0?G.value[s-1]:G.value[s-1]*T.value[o-1]}const H=(s,o)=>s===0||o===0?`h:${s},${o}`:`c:${s},${o}`;function X(s){return L([1,2,3,4,5,6,7,8,9]).slice(0,s).sort((o,i)=>o-i)}function R(){const s=[];for(let C=0;C<=Be;C++)for(let F=0;F<=Be;F++)C===0&&F===0||s.push([C,F]);const o=s.filter(([C,F])=>C>0&&F>0),i=L(o)[0],_=s.filter(([C,F])=>!(C===i[0]&&F===i[1])),q=k(5,8),x=L(_).slice(0,q);return new Set(x.map(([C,F])=>H(C,F)))}function j(){const s={};A.value.forEach(o=>{const[i,_]=o.split(":"),[q,x]=_.split(",").map(Number),C=N(q,x);s[C]=(s[C]||0)+1});for(const[o,i]of Object.entries(f.value))s[i]=(s[i]||0)-1;for(const[o,i]of Object.entries(s))i<=0&&delete s[o];S.value=s}const O=Q(()=>{const s=[];for(const[o,i]of Object.entries(S.value))for(let _=0;_<i;_++)s.push(Number(o));return L(s)});function W(){M.value=!1,I.value=null,f.value={},d.value={},G.value=X(Be),T.value=X(Be),A.value=R(),j()}function J(){for(const s of A.value)if(f.value[s]==null)return!1;return!0}function P(){if(!J())return!1;for(const s of A.value){const[o,i]=s.split(":"),[_,q]=i.split(",").map(Number);if(f.value[s]!==N(_,q))return!1}return!0}async function h(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function m(){if(!J()){I.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",B&&B.play();return}P()?(M.value=!0,I.value=l[a.value].correct,w&&w.play(),await h()):(I.value=l[a.value].wrong,B&&B.play())}function c(){f.value={},d.value={},j(),I.value=null,M.value=!1}function g(s,o,{fromManual:i=!1}={}){if(!Number.isNaN(o)){if(f.value[s]!=null){const _=f.value[s];S.value[_]=(S.value[_]||0)+1}if(i)(S.value[o]||0)>0&&(S.value[o]-=1);else{if((S.value[o]||0)===0)return;S.value[o]-=1}f.value[s]=o,d.value={...d.value,[s]:String(o)},I.value=null}}function $(s,o){s.dataTransfer.setData("text/plain",String(o))}function y(s){s.preventDefault()}function u(s,o){s.preventDefault();const i=Number(s.dataTransfer.getData("text/plain"));g(o,i)}function p(s){if(f.value[s]!=null){const o=f.value[s];S.value[o]=(S.value[o]||0)+1,delete f.value[s]}d.value={...d.value,[s]:""}}function b(s,o){d.value={...d.value,[s]:o}}function z(s){var _;const o=((_=d.value[s])!=null?_:"").trim();if(o===""){p(s);return}const i=Number(o);Number.isFinite(i)&&g(s,i,{fromManual:!0})}const v=Q(()=>({direction:"ltr",unicodeBidi:"isolate"}));return ge(W),me(()=>D.lang,()=>{}),(s,o)=>(n(),r("div",{class:"challenge4 challenge-surface","data-theme":D.theme},[e("h2",vn,t(l[a.value].title),1),e("p",hn,t(l[a.value].rule),1),e("div",pn,[(n(!0),r(te,null,le(Be+1,i=>(n(),r("div",{class:"row",key:"r"+i},[(n(!0),r(te,null,le(Be+1,_=>{var q;return n(),r("div",{class:oe(["cell header",{th:i===1||_===1,corner:i===1&&_===1}]),key:"c"+i+"-"+_},[i===1&&_===1?(n(),r(te,{key:0},[Z(" × ")],64)):A.value.has(i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`)?(n(),r(te,{key:2},[e("div",{class:"dropzone",onDragover:y,onDrop:x=>u(x,i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`)},[f.value[i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`]!=null?(n(),r("span",{key:0,class:"num",style:de(v.value)},t(f.value[i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`]),5)):(n(),r("span",mn,"؟"))],40,fn),e("input",{class:"manual-entry",type:"number",value:(q=d.value[i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`])!=null?q:"",onInput:x=>b(i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`,x.target.value),onChange:x=>z(i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`),onBlur:x=>z(i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,gn),e("button",{class:"clear",onClick:x=>p(i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`)},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)],8,_n)],64)):(n(),r("span",{key:1,class:"num",style:de(v.value)},t(N(i-1,_-1)),5))],2)}),128))]))),128))]),e("div",bn,[e("div",yn,t(l[a.value].bank),1),e("div",kn,[(n(!0),r(te,null,le(O.value,i=>(n(),r("button",{key:i+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:_=>$(_,i),style:de(v.value)},t(i),45,wn))),128))]),e("div",$n,[e("button",{class:"btn",onClick:c},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:m},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:W},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),I.value?(n(),r("div",{key:0,class:oe(["toast",{ok:M.value}])},t(I.value),3)):ie("",!0)]),M.value?(n(),r("div",Cn,[e("div",xn,[e("div",Sn,t(l[a.value].correct),1),e("button",{class:"btn",onClick:W},t(l[a.value].newQ),1)])])):ie("",!0)],8,dn))}},Dn=fe(An,[["__scopeId","data-v-f63f0f22"]]),Tn="/assets/mathematics_leaders/frontend/assets/wrong5.mp3",Mn=["data-theme"],Ln={class:"title"},Nn={class:"rule"},En={class:"tri-wrap"},Pn={class:"square left-sq"},zn={key:1,class:"placeholder"},Bn=["value","placeholder"],Rn={class:"square right-sq"},On={key:1,class:"placeholder"},jn=["value","placeholder"],In={class:"square base-sq"},Fn={key:1,class:"placeholder"},qn=["value","placeholder"],Un={class:"side"},Qn={class:"bank-title"},Vn={class:"bank-items"},Wn=["onDragstart"],Gn={class:"actions"},Hn={key:0,class:"overlay"},Kn={class:"card"},Yn={class:"big"},Zn=4,Jn={__name:"challenge_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 5: مخطط مثلث (ضرب)",rule:"كل مربع على الضلع يساوي حاصل ضرب العدديْن في الدائرتيْن المجاورتين له. اسحب القيم المفقودة إلى المربعات.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 5: Triangle product",rule:"Each edge-square equals the product of the two adjacent circles. Drag missing values into the squares.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check your values",clear:"Clear cell"}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Ne):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Tn):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");function L(v,s){return Math.floor(Math.random()*(s-v+1))+v}function G(v){const s=v.slice();for(let o=s.length-1;o>0;o--){const i=Math.floor(Math.random()*(o+1));[s[o],s[i]]=[s[i],s[o]]}return s}const T=E([2,3,4]),A=E({t:0,l:0,r:0}),f=E(new Set),d=E({}),S=E({}),M=E({}),I=E(!1),N=E(null);function H(){const v=G([2,3,4,5,6,7,8,9]).slice(0,3);T.value=[v[0],v[1],v[2]];const[s,o,i]=T.value;A.value={l:s*o,r:s*i,t:o*i}}function X(){const v=["l","r","t"],s=L(2,3);f.value=new Set(G(v).slice(0,s))}function R(){const v={};f.value.forEach(o=>{const i=A.value[o];v[i]=(v[i]||0)+1});for(const[o,i]of Object.entries(d.value))v[i]=(v[i]||0)-1;for(const[o,i]of Object.entries(v))i<=0&&delete v[o];const s=Zn;{const o=new Set(Object.keys(v).map(Number)),i=new Set(Object.values(A.value)),_=[];for(let q=4;q<=81;q++)!o.has(q)&&!i.has(q)&&_.push(q);for(let q=0;q<s&&_.length;q++){const x=Math.floor(Math.random()*_.length),C=_.splice(x,1)[0];v[C]=(v[C]||0)+1}}M.value=v}const j=Q(()=>{const v=[];for(const[s,o]of Object.entries(M.value))for(let i=0;i<o;i++)v.push(Number(s));return G(v)});function O(){I.value=!1,N.value=null,d.value={},S.value={},H(),X(),R()}function W(){for(const v of f.value)if(d.value[v]==null)return!1;return!0}function J(){if(!W())return!1;for(const v of f.value)if(d.value[v]!==A.value[v])return!1;return!0}async function P(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function h(){if(!W()){N.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",k&&k.play();return}J()?(I.value=!0,N.value=l[a.value].correct,w&&w.play(),B&&B.play(),await P()):(N.value=l[a.value].wrong,k&&k.play())}function m(){d.value={},R(),N.value=null,I.value=!1}function c(v,s){v.dataTransfer.setData("text/plain",String(s))}function g(v){v.preventDefault()}function $(v,s,{fromManual:o=!1}={}){if(!Number.isNaN(s)){if(d.value[v]!=null){const i=d.value[v];M.value[i]=(M.value[i]||0)+1}if(o)(M.value[s]||0)>0&&(M.value[s]-=1);else{if((M.value[s]||0)===0)return;M.value[s]-=1}d.value[v]=s,S.value={...S.value,[v]:String(s)},N.value=null}}function y(v,s){v.preventDefault();const o=Number(v.dataTransfer.getData("text/plain"));$(s,o)}function u(v){if(d.value[v]!=null){const s=d.value[v];M.value[s]=(M.value[s]||0)+1,delete d.value[v]}S.value={...S.value,[v]:""}}function p(v,s){S.value={...S.value,[v]:s}}function b(v){var i;const s=((i=S.value[v])!=null?i:"").trim();if(s===""){u(v);return}const o=Number(s);Number.isFinite(o)&&$(v,o,{fromManual:!0})}const z=Q(()=>({direction:"ltr",unicodeBidi:"isolate"}));return ge(O),me(()=>D.lang,()=>{}),(v,s)=>{var o,i,_;return n(),r("div",{class:"challenge5 challenge-surface","data-theme":D.theme},[e("h2",Ln,t(l[a.value].title),1),e("p",Nn,t(l[a.value].rule),1),e("div",En,[s[15]||(s[15]=e("svg",{class:"links",viewBox:"0 0 300 260",preserveAspectRatio:"none"},[e("line",{x1:"150",y1:"40",x2:"60",y2:"140"}),e("line",{x1:"150",y1:"40",x2:"240",y2:"140"}),e("line",{x1:"60",y1:"140",x2:"240",y2:"140"})],-1)),e("div",{class:"circle top",style:de(z.value)},t(T.value[0]),5),e("div",{class:"circle left",style:de(z.value)},t(T.value[1]),5),e("div",{class:"circle right",style:de(z.value)},t(T.value[2]),5),e("div",Pn,[f.value.has("l")?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:g,onDrop:s[0]||(s[0]=q=>y(q,"l"))},[d.value.l!=null?(n(),r("span",{key:0,class:"num",style:de(z.value)},t(d.value.l),5)):(n(),r("span",zn,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(o=S.value.l)!=null?o:"",onInput:s[1]||(s[1]=q=>p("l",q.target.value)),onChange:s[2]||(s[2]=q=>b("l")),onBlur:s[3]||(s[3]=q=>b("l")),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,Bn),e("button",{class:"clear",onClick:s[4]||(s[4]=q=>u("l"))},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)])],64)):(n(),r("span",{key:0,class:"num",style:de(z.value)},t(A.value.l),5))]),e("div",Rn,[f.value.has("r")?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:g,onDrop:s[5]||(s[5]=q=>y(q,"r"))},[d.value.r!=null?(n(),r("span",{key:0,class:"num",style:de(z.value)},t(d.value.r),5)):(n(),r("span",On,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(i=S.value.r)!=null?i:"",onInput:s[6]||(s[6]=q=>p("r",q.target.value)),onChange:s[7]||(s[7]=q=>b("r")),onBlur:s[8]||(s[8]=q=>b("r")),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,jn),e("button",{class:"clear",onClick:s[9]||(s[9]=q=>u("r"))},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)])],64)):(n(),r("span",{key:0,class:"num",style:de(z.value)},t(A.value.r),5))]),e("div",In,[f.value.has("t")?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:g,onDrop:s[10]||(s[10]=q=>y(q,"t"))},[d.value.t!=null?(n(),r("span",{key:0,class:"num",style:de(z.value)},t(d.value.t),5)):(n(),r("span",Fn,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(_=S.value.t)!=null?_:"",onInput:s[11]||(s[11]=q=>p("t",q.target.value)),onChange:s[12]||(s[12]=q=>b("t")),onBlur:s[13]||(s[13]=q=>b("t")),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,qn),e("button",{class:"clear",onClick:s[14]||(s[14]=q=>u("t"))},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)])],64)):(n(),r("span",{key:0,class:"num",style:de(z.value)},t(A.value.t),5))])]),e("div",Un,[e("div",Qn,t(l[a.value].bank),1),e("div",Vn,[(n(!0),r(te,null,le(j.value,q=>(n(),r("button",{key:q+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:x=>c(x,q),style:de(z.value)},t(q),45,Wn))),128))]),e("div",Gn,[e("button",{class:"btn",onClick:m},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:h},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:O},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),N.value?(n(),r("div",{key:0,class:oe(["toast",{ok:I.value}])},t(N.value),3)):ie("",!0)]),I.value?(n(),r("div",Hn,[e("div",Kn,[e("div",Yn,t(l[a.value].correct),1),e("button",{class:"btn",onClick:O},t(l[a.value].newQ),1)])])):ie("",!0)],8,Mn)}}},Xn=fe(Jn,[["__scopeId","data-v-d3434538"]]),es=["data-theme"],ts={class:"title"},as={class:"rule"},ls=["onClick"],ns={class:"panel"},ss={class:"status"},os={class:"actions"},rs={__name:"challenge_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 6: اختر ثلاث خلايا من شبكة بحيث لا تكون في الصف أو العمود نفسه ويكون مجموعها الهدف",rule:(P,h)=>`شبكة ${P}×${P}. اختر ثلاث خلايا كلٌّ منها في صف وعمود مختلفين بحيث يساوي مجموعها ${h}.`,newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيود أو من المجموع",picked:"المختار: "},en:{title:"Challenge 6: Pick 3 cells in different rows and columns to reach the target sum",rule:(P,h)=>`A ${P}×${P} grid. Pick three cells, one per distinct row and column, whose sum equals ${h}.`,newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check the constraints or the sum",picked:"Picked: "}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(_t):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Oe):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");function L(P,h){return Math.floor(Math.random()*(h-P+1))+P}function G(P){const h=P.slice();for(let m=h.length-1;m>0;m--){const c=Math.floor(Math.random()*(m+1));[h[m],h[c]]=[h[c],h[m]]}return h}const T=E(3),A=E([]),f=E(0),d=E([]),S=E(!1),M=E(null),I=Q(()=>({direction:"ltr",unicodeBidi:"isolate"})),N=Q(()=>d.value.reduce((P,h)=>P+A.value[h.r][h.c],0));function H(){S.value=!1,M.value=null,d.value=[],T.value=[3,4][L(0,1)],A.value=Array.from({length:T.value},()=>Array.from({length:T.value},()=>L(1,9)));const P=G([...Array(T.value).keys()]).slice(0,3),h=G([...Array(T.value).keys()]).slice(0,3),m=G(h.slice()),c=P.map((g,$)=>({r:g,c:m[$]}));f.value=c.reduce((g,$)=>g+A.value[$.r][$.c],0)}function X(){d.value=[],M.value=null,S.value=!1}function R(P,h){if(S.value)return;const m=d.value.findIndex(c=>c.r===P&&c.c===h);if(m>=0){d.value.splice(m,1);return}d.value.length!==3&&d.value.push({r:P,c:h})}function j(){const P=d.value.map(h=>h.r);return new Set(P).size===d.value.length}function O(){const P=d.value.map(h=>h.c);return new Set(P).size===d.value.length}async function W(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function J(){if(d.value.length!==3){M.value=a.value==="ar"?"اختر ثلاث خلايا":"Pick three cells",k&&k.play();return}if(!j()||!O()){M.value=l[a.value].wrong,k&&k.play();return}N.value===f.value?(S.value=!0,M.value=l[a.value].correct,w&&w.play(),B&&B.play(),await W()):(M.value=l[a.value].wrong,k&&k.play())}return ge(H),(P,h)=>(n(),r("div",{class:"challenge6 challenge-surface","data-theme":D.theme},[e("h2",ts,t(l[a.value].title),1),e("p",as,t(l[a.value].rule(T.value,f.value)),1),(n(!0),r(te,null,le(A.value,(m,c)=>(n(),r("div",{class:"grid",key:"r"+c,style:de({"--n":T.value})},[(n(!0),r(te,null,le(m,(g,$)=>(n(),r("button",{key:c+"-"+$,class:oe(["cell",{picked:d.value.some(y=>y.r===c&&y.c===$)}]),onClick:y=>R(c,$),style:de(I.value)},t(g),15,ls))),128))],4))),128)),e("div",ns,[e("div",ss,t(l[a.value].picked)+" "+t(d.value.length)+" · "+t(N.value),1),e("div",os,[e("button",{class:"btn",onClick:X},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:J},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:H},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),M.value?(n(),r("div",{key:0,class:oe(["toast",{ok:S.value}])},t(M.value),3)):ie("",!0)])],8,es))}},is=fe(rs,[["__scopeId","data-v-69ee6918"]]),cs=["data-theme"],us={class:"title"},ds={class:"rule"},vs={class:"pyramid"},hs=["onDrop"],ps={key:1,class:"placeholder"},fs=["value","onInput","onChange","onBlur","placeholder"],ms=["onClick"],gs={class:"side"},_s={class:"bank-title"},bs={class:"bank-items"},ys=["onDragstart"],ks={class:"actions"},ws=6,$s={__name:"challenge_7",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 7: جدار أعداد (هرم جمع)",rule:"كل خانة تساوي مجموع الخليتين اللتين تحتها مباشرة. اسحب القيم المفقودة لإكمال الهرم.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 7: Sum Pyramid",rule:"Each cell equals the sum of the two cells directly below. Drag missing values to complete the pyramid.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check your values",clear:"Clear cell"}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Le):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(at):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");function L(s,o){return Math.floor(Math.random()*(o-s+1))+s}function G(s){const o=s.slice();for(let i=o.length-1;i>0;i--){const _=Math.floor(Math.random()*(i+1));[o[i],o[_]]=[o[_]]=[o[_],o[i]]}return o}const T=E(4),A=E([]),f=E(new Set),d=E({}),S=E({}),M=E({}),I=E(!1),N=E(null),H=Q(()=>({direction:"ltr",unicodeBidi:"isolate"}));function X(s){const o=[];o[0]=Array.from({length:s},()=>L(1,9));for(let i=1;i<s;i++)o[i]=Array.from({length:s-i},(_,q)=>o[i-1][q]+o[i-1][q+1]);return o}function R(s,o){return`${s},${o}`}function j(s){const o=[];for(let C=0;C<s;C++)for(let F=0;F<A.value[C].length;F++)o.push([C,F]);const i=new Set;for(let C=1;C<s;C++){const F=L(0,A.value[C].length-1);i.add(R(C,F))}const _=o.filter(([C,F])=>C>0&&!i.has(R(C,F))),q=L(4,6),x=G(_).slice(0,q);return new Set(x.map(([C,F])=>R(C,F)))}function O(){const s={};f.value.forEach(o=>{const[i,_]=o.split(",").map(Number),q=A.value[i][_];s[q]=(s[q]||0)+1});for(const[o,i]of Object.entries(d.value))s[i]=(s[i]||0)-1;for(const[o,i]of Object.entries(s))i<=0&&delete s[o];{const o=new Set(Object.keys(s).map(Number)),i=new Set;A.value.forEach(C=>C.forEach(F=>i.add(F)));const _=[],q=2,x=120;for(let C=q;C<=x;C++)!o.has(C)&&!i.has(C)&&_.push(C);for(let C=0;C<ws&&_.length;C++){const F=Math.floor(Math.random()*_.length),K=_.splice(F,1)[0];s[K]=(s[K]||0)+1}}M.value=s}const W=Q(()=>{const s=[];for(const[o,i]of Object.entries(M.value))for(let _=0;_<i;_++)s.push(Number(o));return G(s)});function J(){I.value=!1,N.value=null,d.value={},S.value={},A.value=X(T.value),f.value=j(T.value),O()}function P(){for(const s of f.value)if(d.value[s]==null)return!1;return!0}function h(){if(!P())return!1;for(const s of f.value){const[o,i]=s.split(",").map(Number);if(d.value[s]!==A.value[o][i])return!1}return!0}async function m(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function c(){if(!P()){N.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",k&&k.play();return}h()?(I.value=!0,N.value=l[a.value].correct,w&&w.play(),B&&B.play(),await m()):(N.value=l[a.value].wrong,k&&k.play())}function g(){d.value={},S.value={},O(),N.value=null,I.value=!1}function $(s,o,{fromManual:i=!1}={}){if(!Number.isNaN(o)){if(d.value[s]!=null){const _=d.value[s];M.value[_]=(M.value[_]||0)+1}if(i)(M.value[o]||0)>0&&(M.value[o]-=1);else{if((M.value[o]||0)===0)return;M.value[o]-=1}d.value[s]=o,S.value={...S.value,[s]:String(o)},N.value=null}}function y(s,o){s.dataTransfer.setData("text/plain",String(o))}function u(s){s.preventDefault()}function p(s,o){s.preventDefault();const i=Number(s.dataTransfer.getData("text/plain"));$(o,i)}function b(s){if(d.value[s]!=null){const o=d.value[s];M.value[o]=(M.value[o]||0)+1,delete d.value[s]}S.value={...S.value,[s]:""}}ge(J),me(()=>D.lang,()=>{});function z(s,o){S.value={...S.value,[s]:o}}function v(s){var _;const o=((_=S.value[s])!=null?_:"").trim();if(o===""){b(s);return}const i=Number(o);Number.isFinite(i)&&$(s,i,{fromManual:!0})}return(s,o)=>(n(),r("div",{class:"challenge7 challenge-surface","data-theme":D.theme},[e("h2",us,t(l[a.value].title),1),e("p",ds,t(l[a.value].rule),1),e("div",vs,[(n(!0),r(te,null,le(A.value,(i,_)=>(n(),r("div",{class:"prow",key:"r"+_,style:de({"--cols":i.length})},[(n(!0),r(te,null,le(i,(q,x)=>{var C;return n(),r("div",{class:"cell",key:_+"-"+x},[f.value.has(`${_},${x}`)?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:u,onDrop:F=>p(F,`${_},${x}`)},[d.value[`${_},${x}`]!=null?(n(),r("span",{key:0,class:"num",style:de(H.value)},t(d.value[`${_},${x}`]),5)):(n(),r("span",ps,"؟"))],40,hs),e("input",{class:"manual-entry",type:"number",value:(C=S.value[`${_},${x}`])!=null?C:"",onInput:F=>z(`${_},${x}`,F.target.value),onChange:F=>v(`${_},${x}`),onBlur:F=>v(`${_},${x}`),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,fs),e("button",{class:"clear",onClick:F=>b(`${_},${x}`)},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)],8,ms)],64)):(n(),r("span",{key:0,class:"num",style:de(H.value)},t(q),5))])}),128))],4))),128))]),e("div",gs,[e("div",_s,t(l[a.value].bank),1),e("div",bs,[(n(!0),r(te,null,le(W.value,i=>(n(),r("button",{key:i+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:_=>y(_,i),style:de(H.value)},t(i),45,ys))),128))]),e("div",ks,[e("button",{class:"btn",onClick:g},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:c},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:J},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),N.value?(n(),r("div",{key:0,class:oe(["toast",{ok:I.value}])},t(N.value),3)):ie("",!0)])],8,cs))}},Cs=fe($s,[["__scopeId","data-v-48f5f33c"]]),xs="/assets/mathematics_leaders/frontend/assets/oh_no.mp3",Ss=["data-theme"],As={class:"title"},Ds={class:"rule"},Ts={class:"panel"},Ms=["placeholder"],Ls={class:"usage"},Ns={class:"keypad"},Es={class:"label"},Ps={class:"row"},zs=["onClick"],Bs=["onClick"],Rs={class:"actions"},Os={class:"hint"},js={__name:"challenge_level_two_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"التحدي 1 (المستوى الثاني): كوّن جملة عددية تستعمل 1،2،3،4،5 دون تكرار",rule:P=>`اكتب تعبيراً حسابياً يستخدم الأرقام ١،٢،٣،٤،٥ كلٌّ مرة واحدة فقط ويكون ناتجه ${P}. يمكن استعمال + - × ÷ والأقواس، ولا يُسمح بأي أرقام أخرى أو تكرار.`,inputPH:"اكتب التعبير هنا… مثل: (5*4)*(3+2)*1",keys:"لوحة المفاتيح",newQ:"سؤال جديد",reset:"مسح",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من الشروط أو من النتيجة",used:"استخدام الأرقام:",note:"تلميح: يمكنك دائماً استعمال ×1 دون تغيير النتيجة."},en:{title:"Level 2 – Challenge 1: Build an expression with 1..5 once each",rule:P=>`Write an expression that uses digits 1,2,3,4,5 exactly once and evaluates to ${P}. Allowed: + - * / and parentheses. No other digits or repeats.`,inputPH:"Type expression… e.g., (5*4)*(3+2)*1",keys:"Keypad",newQ:"New puzzle",reset:"Clear",check:"Check",correct:"Correct",wrong:"Check constraints or value",used:"Digits usage:",note:"Hint: multiplying by 1 keeps the value unchanged."}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Ne):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(xs):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");function L(P,h){return Math.floor(Math.random()*(h-P+1))+P}function G(P){const h=P.slice();for(let m=h.length-1;m>0;m--){const c=Math.floor(Math.random()*(m+1));[h[m],h[c]]=[h[c],h[m]]}return h}const T=E(""),A=E(0),f=E(null),d=E(!1),S=[1,2,3,4,5],M=["+","-","*","/","(",")"];function I(){const P=G([2,3,4,5]),[h,m,c,g]=P,$=o=>o[L(0,o.length-1)],y=$(["+","-","*","/"]),u=$(["+","-","*","/"]),p=$(["+","-","*","/"]),b=o=>{try{return Function(`return (${o});`)()}catch{return null}};let z=`( ${h} ${y} ${m} ) ${u} ( ${c} ${p} ${g} )`,v=b(z),s=0;for(;(v==null||!isFinite(v))&&s<20;)return I();Math.random()<.7?(z=`(${z}) * 1`,v=b(z)):(z=`((${z}) + 1) - 1`,v=b(z)),A.value=v,T.value="",f.value=null,d.value=!1}function N(P){T.value+=P}function H(){T.value=T.value.slice(0,-1)}function X(){T.value="",f.value=null,d.value=!1}const R=Q(()=>{const P={1:0,2:0,3:0,4:0,5:0};for(const h of T.value)"12345".includes(h)&&P[h]++;return P});function j(P){return/^[\d\+\-\*\/\(\)\s]*$/.test(P)}function O(){if(/[06789]/.test(T.value))return!1;const P=R.value;return S.every(h=>P[h]===1)}function W(P){try{return!j(P)||(P=P.replace(/×/g,"*").replace(/÷/g,"/"),/\b(?![1-5]\b)\d+\b/.test(P))?null:Function(`"use strict"; return (${P});`)()}catch{return null}}async function J(){const P=W(T.value);if(P==null||!isFinite(P)||!O()){f.value=l[a.value].wrong,k&&k.play();return}if(Math.abs(P-A.value)<1e-9){d.value=!0,f.value=l[a.value].correct,w&&w.play(),B&&B.play();try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}else f.value=l[a.value].wrong,k&&k.play()}return ge(I),(P,h)=>(n(),r("div",{class:"lvl2c1 challenge-surface","data-theme":D.theme},[e("h2",As,t(l[a.value].title),1),e("p",Ds,t(l[a.value].rule(A.value)),1),e("div",Ts,[Te(e("input",{class:"expr",placeholder:l[a.value].inputPH,"onUpdate:modelValue":h[0]||(h[0]=m=>T.value=m),dir:"ltr",inputmode:"numeric",autocomplete:"off",spellcheck:"false"},null,8,Ms),[[Me,T.value]]),e("div",Ls,[Z(t(l[a.value].used)+" ",1),(n(),r(te,null,le(S,m=>e("span",{key:m,class:oe(["u",{ok:R.value[m]===1,bad:R.value[m]>1}])},t(m)+": "+t(R.value[m]),3)),64))]),e("div",Ns,[e("div",Es,t(l[a.value].keys),1),e("div",Ps,[(n(),r(te,null,le(S,m=>e("button",{class:"k",key:"d"+m,onClick:c=>N(String(m))},t(m),9,zs)),64)),(n(),r(te,null,le(M,m=>e("button",{class:"k",key:"o"+m,onClick:c=>N(m)},t(m),9,Bs)),64)),e("button",{class:"k wide",onClick:H},"⌫")])]),e("div",Rs,[e("button",{class:"btn",onClick:X},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:J},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:I},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),e("div",Os,t(l[a.value].note),1),f.value?(n(),r("div",{key:0,class:oe(["toast",{ok:d.value}])},t(f.value),3)):ie("",!0)])],8,Ss))}},Is=fe(js,[["__scopeId","data-v-ac84a4b0"]]),Fs=["data-theme"],qs={class:"title"},Us={class:"rule"},Qs={class:"board"},Vs=["onDrop"],Ws={key:1,class:"placeholder"},Gs=["onClick"],Hs={class:"side"},Ks={class:"bank-title"},Ys={class:"bank-items"},Zs=["onDragstart"],Js={class:"actions"},Xs={__name:"challenge_level_two_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثاني – التحدي 2: أكمل مربعاً سحرياً",rule:o=>`ضع الأعداد بحيث يكون مجموع كل صف وعمود وقطر مساوياً ${o}. اسحب القيم المفقودة إلى أماكنها. الأعداد جميعها مختلفة.`,bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من المجاميع أو التكرار",clear:"تفريغ الخلية"},en:{title:"Level 2 – Challenge 2: Complete a magic square",rule:o=>`Place numbers so each row, column, and diagonal sums to ${o}. Drag the missing values into place. All numbers are distinct.`,bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check sums or duplicates",clear:"Clear cell"}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Ne):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Ee):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");function L(o,i){return Math.floor(Math.random()*(i-o+1))+o}function G(o){const i=o.slice();for(let _=i.length-1;_>0;_--){const q=Math.floor(Math.random()*(_+1));[i[_],i[q]]=[i[q],i[_]]}return i}const T=[[8,1,6],[3,5,7],[4,9,2]];function A(o){const i=K=>[[K[2][0],K[1][0],K[0][0]],[K[2][1],K[1][1],K[0][1]],[K[2][2],K[1][2],K[0][2]]],_=K=>K.map(Y=>Y.slice().reverse()),q=[];let x=o;for(let K=0;K<4;K++)q.push(x),q.push(_(x)),x=i(x);const C=[],F=new Set;for(const K of q){const Y=JSON.stringify(K);F.has(Y)||(C.push(K),F.add(Y))}return C}const f=A(T),d=E([[0,0,0],[0,0,0],[0,0,0]]),S=E(0),M=E(new Set),I=E({}),N=E({}),H=E(!1),X=E(null),R=Q(()=>({direction:"ltr",unicodeBidi:"isolate"})),j=(o,i)=>`${o},${i}`;function O(){const o=f[L(0,f.length-1)],i=[1,2,3,4,5][L(0,4)],_=L(0,6),q=Array.from({length:3},()=>Array(3).fill(0));for(let x=0;x<3;x++)for(let C=0;C<3;C++)q[x][C]=_+i*o[x][C];d.value=q,S.value=i*15+3*_}function W(){const o=[];for(let x=0;x<3;x++)for(let C=0;C<3;C++)o.push([x,C]);const i=G(o).slice(0,L(3,4)),_=new Set(i.map(([x,C])=>j(x,C))),q=o.filter(([x,C])=>!_.has(j(x,C)));M.value=new Set(q.map(([x,C])=>j(x,C)))}function J(){const o={};M.value.forEach(i=>{const[_,q]=i.split(",").map(Number),x=d.value[_][q];o[x]=(o[x]||0)+1});for(const[i,_]of Object.entries(I.value))o[_]=(o[_]||0)-1;for(const[i,_]of Object.entries(o))_<=0&&delete o[i];N.value=o}const P=Q(()=>{const o=[];for(const[i,_]of Object.entries(N.value))for(let q=0;q<_;q++)o.push(Number(i));return G(o)});function h(){H.value=!1,X.value=null,I.value={},O(),W(),J()}function m(){for(const o of M.value)if(I.value[o]==null)return!1;return!0}function c(){const o=d.value.map(i=>i.slice());for(const i of M.value){const[_,q]=i.split(",").map(Number);o[_][q]=I.value[i]}return o}function g(o){const i=new Set;for(const _ of o)for(const q of _){if(i.has(q))return!1;i.add(q)}return!0}function $(o){const i=(_,q,x)=>_+q+x;for(let _=0;_<3;_++)if(i(o[_][0],o[_][1],o[_][2])!==S.value||i(o[0][_],o[1][_],o[2][_])!==S.value)return!1;return!(i(o[0][0],o[1][1],o[2][2])!==S.value||i(o[0][2],o[1][1],o[2][0])!==S.value)}async function y(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function u(){if(!m()){X.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",k&&k.play();return}const o=c();g(o)&&$(o)?(H.value=!0,X.value=l[a.value].correct,w&&w.play(),B&&B.play(),await y()):(X.value=l[a.value].wrong,k&&k.play())}function p(){I.value={},J(),X.value=null,H.value=!1}function b(o,i){o.dataTransfer.setData("text/plain",String(i))}function z(o){o.preventDefault()}function v(o,i){o.preventDefault();const _=Number(o.dataTransfer.getData("text/plain"));if(I.value[i]!=null){const q=I.value[i];N.value[q]=(N.value[q]||0)+1}(N.value[_]||0)!==0&&(N.value[_]-=1,I.value[i]=_,X.value=null)}function s(o){if(I.value[o]!=null){const i=I.value[o];N.value[i]=(N.value[i]||0)+1,delete I.value[o]}}return ge(h),me(()=>D.lang,()=>{}),(o,i)=>(n(),r("div",{class:"lvl2c2 challenge-surface","data-theme":D.theme},[e("h2",qs,t(l[a.value].title),1),e("p",Us,t(l[a.value].rule(S.value)),1),e("div",Qs,[(n(),r(te,null,le(3,_=>e("div",{class:"row",key:"r"+_},[(n(),r(te,null,le(3,q=>e("div",{class:"cell",key:"c"+_+"-"+q},[M.value.has(`${_-1},${q-1}`)?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:z,onDrop:x=>v(x,`${_-1},${q-1}`)},[I.value[`${_-1},${q-1}`]!=null?(n(),r("span",{key:0,class:"num",style:de(R.value)},t(I.value[`${_-1},${q-1}`]),5)):(n(),r("span",Ws,"؟"))],40,Vs),e("button",{class:"clear",onClick:x=>s(`${_-1},${q-1}`)},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)],8,Gs)],64)):(n(),r("span",{key:0,class:"num",style:de(R.value)},t(d.value[_-1][q-1]),5))])),64))])),64))]),e("div",Hs,[e("div",Ks,t(l[a.value].bank),1),e("div",Ys,[(n(!0),r(te,null,le(P.value,_=>(n(),r("button",{key:_+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:q=>b(q,_),style:de(R.value)},t(_),45,Zs))),128))]),e("div",Js,[e("button",{class:"btn",onClick:p},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:u},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:h},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),X.value?(n(),r("div",{key:0,class:oe(["toast",{ok:H.value}])},t(X.value),3)):ie("",!0)])],8,Fs))}},eo=fe(Xs,[["__scopeId","data-v-741125f1"]]),to=["data-theme"],ao={class:"title"},lo={class:"rule"},no={class:"cards"},so={class:"card"},oo={class:"label"},ro={key:0,class:"num"},io={key:1,class:"placeholder"},co={class:"card"},uo={class:"label"},vo={key:0,class:"num"},ho={key:1,class:"placeholder"},po={class:"card"},fo={class:"label"},mo={key:0,class:"num"},go={key:1,class:"placeholder"},_o={class:"card"},bo={class:"label"},yo={key:0,class:"num"},ko={key:1,class:"placeholder"},wo={class:"bank"},$o={class:"bank-title"},Co={class:"bank-items"},xo=["disabled","onDragstart"],So={key:0},Ao={class:"actions"},Do={__name:"challenge_level_two_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثاني – التحدي 3: أوصل المسألة بالنتيجة الصحيحة",rule:"اسحب عدداً من ستة أرقام إلى كل خانة بحسب الخاصية المطلوبة: مضاعف 2، 3، 4، 5. كل عدد يُستخدم مرة واحدة.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من الخواص",clear:"تفريغ الخلية",lab2:"مضاعفًا للعدد 2",lab3:"مضاعفًا للعدد 3",lab4:"مضاعفًا للعدد 4",lab5:"مضاعفًا للعدد 5"},en:{title:"Level 2 – Challenge 3: Match each rule to a six-digit number",rule:"Drag one six-digit number to each rule: multiple of 2, 3, 4, 5. Each number can be used once.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check the properties",clear:"Clear cell",lab2:"Multiple of 2",lab3:"Multiple of 3",lab4:"Multiple of 4",lab5:"Multiple of 5"}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Le):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Ee):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");function L(y,u){return Math.floor(Math.random()*(u-y+1))+y}function G(y){const u=y.slice();for(let p=u.length-1;p>0;p--){const b=Math.floor(Math.random()*(p+1));[u[p],u[b]]=[u[b],u[p]]}return u}const T=E([]),A=E({}),f=E({m2:null,m3:null,m4:null,m5:null}),d=E(null),S=E(!1),M=y=>y%2===0,I=y=>String(y).split("").reduce((u,p)=>u+ +p,0)%3===0,N=y=>y%100%4===0,H=y=>y%10===0||y%10===5;function X(y=u=>!0){for(;;){const u=L(1,9);let p=String(u);for(let z=0;z<5;z++)p+=String(L(0,9));const b=Number(p);if(y(b))return b}}function R(y,u=()=>!0){for(;;){const p=L(1,9);let b=String(p);for(let v=0;v<4;v++)b+=String(L(0,9));b+=String(y);const z=Number(b);if(u(z))return z}}function j(){S.value=!1,d.value=null,f.value={m2:null,m3:null,m4:null,m5:null};const y=new Set,u=i=>{const _=String(i);return y.has(_)?!1:(y.add(_),!0)};let p=R(5,i=>!I(i)||L(0,1));for(;!u(p);)p=R(5);let b=R([0,2,4,6,8][L(0,4)],i=>!H(i)&&!N(i));for(;!u(b);)b=R([0,2,4,6,8][L(0,4)],i=>!H(i)&&!N(i));let z=X(i=>N(i));for(;!u(z);)z=X(i=>N(i));let v=X(i=>I(i)&&!H(i));for(;!u(v);)v=X(i=>I(i)&&!H(i));const s=[b,v,z,p],o=[];for(;o.length<4;){let i=X(_=>_%2!==0&&!I(_)&&!H(_)&&!N(_));u(i)&&o.push(i)}T.value=G(s.concat(o)),A.value=Object.fromEntries(T.value.map(i=>[i,1]))}function O(y,u){y.dataTransfer.setData("text/plain",String(u))}function W(y){y.preventDefault()}function J(y,u){u.preventDefault();const p=Number(u.dataTransfer.getData("text/plain"));(A.value[p]||0)!==0&&(f.value[y]!=null&&(A.value[f.value[y]]=(A.value[f.value[y]]||0)+1),f.value[y]=p,A.value[p]-=1,d.value=null)}function P(y){f.value[y]!=null&&(A.value[f.value[y]]=(A.value[f.value[y]]||0)+1,f.value[y]=null)}function h(){return["m2","m3","m4","m5"].every(y=>f.value[y]!=null)}function m(){return M(f.value.m2)&&I(f.value.m3)&&N(f.value.m4)&&H(f.value.m5)}async function c(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function g(){if(!h()){d.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",k&&k.play();return}m()?(S.value=!0,d.value=l[a.value].correct,w&&w.play(),B&&B.play(),await c()):(d.value=l[a.value].wrong,k&&k.play())}function $(){f.value={m2:null,m3:null,m4:null,m5:null},A.value=Object.fromEntries(T.value.map(y=>[y,1])),d.value=null,S.value=!1}return ge(j),me(()=>D.lang,()=>{}),(y,u)=>(n(),r("div",{class:"lvl2c3 challenge-surface","data-theme":D.theme},[e("h2",ao,t(l[a.value].title),1),e("p",lo,t(l[a.value].rule),1),e("div",no,[e("div",so,[e("div",oo,t(l[a.value].lab2),1),e("div",{class:"drop",onDragover:W,onDrop:u[0]||(u[0]=p=>J("m2",p))},[f.value.m2!=null?(n(),r("span",ro,t(f.value.m2),1)):(n(),r("span",io,"؟"))],32),e("button",{class:"clear",onClick:u[1]||(u[1]=p=>P("m2"))},[U(V(Ce),{class:"ic"}),Z(t(l[a.value].clear),1)])]),e("div",co,[e("div",uo,t(l[a.value].lab3),1),e("div",{class:"drop",onDragover:W,onDrop:u[2]||(u[2]=p=>J("m3",p))},[f.value.m3!=null?(n(),r("span",vo,t(f.value.m3),1)):(n(),r("span",ho,"؟"))],32),e("button",{class:"clear",onClick:u[3]||(u[3]=p=>P("m3"))},[U(V(Ce),{class:"ic"}),Z(t(l[a.value].clear),1)])]),e("div",po,[e("div",fo,t(l[a.value].lab4),1),e("div",{class:"drop",onDragover:W,onDrop:u[4]||(u[4]=p=>J("m4",p))},[f.value.m4!=null?(n(),r("span",mo,t(f.value.m4),1)):(n(),r("span",go,"؟"))],32),e("button",{class:"clear",onClick:u[5]||(u[5]=p=>P("m4"))},[U(V(Ce),{class:"ic"}),Z(t(l[a.value].clear),1)])]),e("div",_o,[e("div",bo,t(l[a.value].lab5),1),e("div",{class:"drop",onDragover:W,onDrop:u[6]||(u[6]=p=>J("m5",p))},[f.value.m5!=null?(n(),r("span",yo,t(f.value.m5),1)):(n(),r("span",ko,"؟"))],32),e("button",{class:"clear",onClick:u[7]||(u[7]=p=>P("m5"))},[U(V(Ce),{class:"ic"}),Z(t(l[a.value].clear),1)])])]),e("div",wo,[e("div",$o,t(l[a.value].bank),1),e("div",Co,[(n(!0),r(te,null,le(T.value,p=>(n(),r("button",{key:p,class:"chip",disabled:(A.value[p]||0)===0,draggable:"true",onDragstart:b=>O(b,p)},[Z(t(p)+" ",1),(A.value[p]||0)===0?(n(),r("small",So,"✓")):ie("",!0)],40,xo))),128))])]),e("div",Ao,[e("button",{class:"btn",onClick:$},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:g},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:j},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),d.value?(n(),r("div",{key:0,class:oe(["toast",{ok:S.value}])},t(d.value),3)):ie("",!0)],8,to))}},To=fe(Do,[["__scopeId","data-v-a01ad243"]]),Mo=["data-theme"],Lo={class:"title"},No={class:"rule"},Eo={class:"choices"},Po=["onClick"],zo=["checked"],Bo={class:"pair"},Ro={class:"hint"},Oo={class:"actions"},jo={__name:"challenge_level_two_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثاني – التحدي 4: اختر الإجابة الصحيحة",rule:(j,O)=>`ما العددان اللذان حاصل جمعهما ${j} والفرق بينهما ${O}؟ اختر الزوج الصحيح.`,choices:"الخيارات",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"إجابة غير صحيحة"},en:{title:"Level 2 – Challenge 4: Pick the correct pair",rule:(j,O)=>`Which two numbers have sum ${j} and difference ${O}? Pick the correct pair.`,choices:"Choices",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Incorrect"}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(bt):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(yt):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");function L(j,O){return Math.floor(Math.random()*(O-j+1))+j}function G(j){const O=j.slice();for(let W=O.length-1;W>0;W--){const J=Math.floor(Math.random()*(W+1));[O[W],O[J]]=[O[J],O[W]]}return O}const T=E(0),A=E(0),f=E([0,0]),d=E([]),S=E(null),M=E(null),I=E(!1);function N(){I.value=!1,M.value=null,S.value=null;let j,O;j=L(6,60),O=L(1,j-1);const W=Math.max(j,O),J=Math.min(j,O);T.value=W+J,A.value=W-J,f.value=[W,J];const P=[[W,J]],h=()=>{let m=L(1,65),c=L(1,65);return m<c&&([m,c]=[c,m]),[m,c]};for(;P.length<6;){let m=h();if(!(m[0]+m[1]===T.value&&m[0]-m[1]===A.value)){if(L(0,1)===0){const c=T.value,g=L(1,c-1),$=c-g,y=[Math.max(g,$),Math.min(g,$)];y[0]-y[1]!==A.value&&(m=y)}else{const c=A.value,g=L(1,50),y=[g+c,g];y[0]+y[1]!==T.value&&(m=y)}P.some(c=>c[0]===m[0]&&c[1]===m[1])||P.push(m)}}d.value=G(P)}async function H(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function X(){if(S.value==null){M.value=a.value==="ar"?"اختر إجابة":"Pick an answer",k&&k.play();return}const j=d.value[S.value];j[0]+j[1]===T.value&&j[0]-j[1]===A.value?(I.value=!0,M.value=l[a.value].correct,w&&w.play(),B&&B.play(),await H()):(M.value=l[a.value].wrong,k&&k.play())}function R(){S.value=null,M.value=null,I.value=!1}return ge(N),me(()=>D.lang,()=>{}),(j,O)=>(n(),r("div",{class:"lvl2c4 challenge-surface","data-theme":D.theme},[e("h2",Lo,t(l[a.value].title),1),e("p",No,t(l[a.value].rule(T.value,A.value)),1),e("div",Eo,[(n(!0),r(te,null,le(d.value,(W,J)=>(n(),r("div",{class:oe(["choice",{sel:S.value===J}]),key:J,onClick:P=>S.value=J},[e("input",{type:"radio",checked:S.value===J},null,8,zo),e("span",Bo,t(W[0])+" ، "+t(W[1]),1),e("small",Ro,"("+t(W[0]+W[1])+" ، "+t(W[0]-W[1])+")",1)],10,Po))),128))]),e("div",Oo,[e("button",{class:"btn",onClick:R},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:X},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:N},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),M.value?(n(),r("div",{key:0,class:oe(["toast",{ok:I.value}])},t(M.value),3)):ie("",!0)],8,Mo))}},Io=fe(jo,[["__scopeId","data-v-3bc97670"]]),Fo=["data-theme"],qo={class:"title"},Uo={class:"rule"},Qo={class:"equation",dir:"ltr"},Vo={class:"frac"},Wo={class:"top"},Go={class:"bot"},Ho={class:"frac"},Ko={class:"bot"},Yo={key:0,class:"num"},Zo={key:1,class:"placeholder"},Jo={class:"frac"},Xo={class:"top"},er={key:0,class:"num"},tr={key:1,class:"placeholder"},ar={class:"bot"},lr={class:"bank"},nr={class:"bank-title"},sr={class:"bank-items"},or=["onDragstart"],rr={class:"actions"},ir={__name:"challenge_level_two_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثاني – التحدي 5: أكمل طرح الكسور",rule:u=>`ضع عددًا كليًا في كل مربع لتصبح المعادلة صحيحة:  ${u.num}/${u.den} =  ١/□  −  □/${u.d2}.  اسحب الرقمين من لوحة الأعداد.`,bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Level 2 – Challenge 5: Complete the fraction subtraction",rule:u=>`Place integers to make the equation true:  ${u.num}/${u.den} =  1/□  −  □/${u.d2}.  Drag the two numbers from the bank.`,bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check values",clear:"Clear"}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Ne):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Ee):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");function L(u,p){return Math.floor(Math.random()*(p-u+1))+u}function G(u){const p=u.slice();for(let b=p.length-1;b>0;b--){const z=Math.floor(Math.random()*(b+1));[p[b],p[z]]=[p[z],p[b]]}return p}const T=E({num:1,den:6,d2:6}),A=E([]),f=E({A:null,N:null}),d=E(null),S=E(!1),M=[{id:"p1",target:{num:1,den:6},d2:6,solution:{A:2,N:2},extras:[1,3,4,5,7,8]},{id:"p2",target:{num:1,den:6},d2:9,solution:{A:2,N:3},extras:[1,4,5,6,7,8]},{id:"p3",target:{num:1,den:6},d2:12,solution:{A:2,N:4},extras:[1,3,5,6,7,9]},{id:"p4",target:{num:1,den:6},d2:6,solution:{A:3,N:1},extras:[2,4,5,7,8,9]},{id:"p5",target:{num:2,den:6},d2:6,solution:{A:2,N:1},extras:[3,4,5,7,8,9]},{id:"p6",target:{num:1,den:8},d2:8,solution:{A:2,N:3},extras:[1,2,4,5,6,7]},{id:"p7",target:{num:3,den:8},d2:8,solution:{A:2,N:1},extras:[2,4,5,6,7,9]},{id:"p8",target:{num:1,den:9},d2:9,solution:{A:3,N:2},extras:[1,3,4,5,6,7]},{id:"p9",target:{num:3,den:9},d2:6,solution:{A:2,N:1},extras:[2,4,5,7,8,9]},{id:"p10",target:{num:1,den:10},d2:5,solution:{A:2,N:2},extras:[1,3,4,6,7,8]},{id:"p11",target:{num:2,den:10},d2:10,solution:{A:2,N:3},extras:[1,4,5,6,7,9]},{id:"p12",target:{num:1,den:12},d2:4,solution:{A:3,N:1},extras:[2,5,6,7,8,9]}],I=E(M[0]),N=E(null);function H(){if(M.length===1)return N.value=M[0].id,M[0];let u;do u=M[Math.floor(Math.random()*M.length)];while(u.id===N.value);return N.value=u.id,u}function X(u){const p=new Set([u.solution.A,u.solution.N]);for((u.extras||[]).forEach(z=>p.add(z));p.size<8;)p.add(L(1,15));return G([...p])}const R=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function j(u){const p=String(u);return D.lang==="ar"?p.replace(/[0-9]/g,b=>R[Number(b)]):p}const O=Q(()=>a.value==="ar"?`ضع عددًا كليًا في كل مربع لتصبح المعادلة صحيحة:  ${j(T.value.num)}/${j(T.value.den)} =  ١/□  −  □/${j(T.value.d2)}.`:`Place integers to make the equation true:  ${T.value.num}/${T.value.den} =  1/□  −  □/${T.value.d2}.`);function W(){S.value=!1,d.value=null,f.value={A:null,N:null};const u=H();I.value=u,T.value={num:u.target.num,den:u.target.den,d2:u.d2},A.value=X(u)}function J(u,p){u.dataTransfer.setData("text/plain",String(p))}function P(u){u.preventDefault()}function h(u,p){p.preventDefault();const b=Number(p.dataTransfer.getData("text/plain"));f.value[u]=b,d.value=null}function m(){return f.value.A!=null&&f.value.N!=null}function c(){if(!m())return!1;const u=f.value.A,p=f.value.N;if(!u||!p)return!1;const b=1/u-p/T.value.d2,z=T.value.num/T.value.den;return Math.abs(b-z)<1e-9}async function g(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function $(){if(!m()){d.value=a.value==="ar"?"أكمل الخانتين":"Fill both blanks",k&&k.play();return}c()?(S.value=!0,d.value=l[a.value].correct,w&&w.play(),B&&B.play(),await g()):(d.value=l[a.value].wrong,k&&k.play())}function y(){f.value={A:null,N:null},d.value=null,S.value=!1}return ge(W),(u,p)=>(n(),r("div",{class:"lvl2c5 challenge-surface","data-theme":D.theme},[e("h2",qo,t(l[a.value].title),1),e("p",Uo,t(O.value),1),e("div",Qo,[e("div",Vo,[e("div",Wo,t(j(T.value.num)),1),p[2]||(p[2]=e("div",{class:"bar"},null,-1)),e("div",Go,t(j(T.value.den)),1)]),p[6]||(p[6]=e("span",{class:"eq"},"=",-1)),e("div",Ho,[p[3]||(p[3]=e("div",{class:"top"},"1",-1)),p[4]||(p[4]=e("div",{class:"bar"},null,-1)),e("div",Ko,[e("div",{class:"drop",onDragover:P,onDrop:p[0]||(p[0]=b=>h("A",b))},[f.value.A!=null?(n(),r("span",Yo,t(j(f.value.A)),1)):(n(),r("span",Zo,"□"))],32)])]),p[7]||(p[7]=e("span",{class:"minus"},"−",-1)),e("div",Jo,[e("div",Xo,[e("div",{class:"drop",onDragover:P,onDrop:p[1]||(p[1]=b=>h("N",b))},[f.value.N!=null?(n(),r("span",er,t(j(f.value.N)),1)):(n(),r("span",tr,"□"))],32)]),p[5]||(p[5]=e("div",{class:"bar"},null,-1)),e("div",ar,t(j(T.value.d2)),1)])]),e("div",lr,[e("div",nr,t(l[a.value].bank),1),e("div",sr,[(n(!0),r(te,null,le(A.value,b=>(n(),r("button",{key:b,class:"chip",draggable:"true",onDragstart:z=>J(z,b)},t(j(b)),41,or))),128))])]),e("div",rr,[e("button",{class:"btn",onClick:y},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:$},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:W},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),d.value?(n(),r("div",{key:0,class:oe(["toast",{ok:S.value}])},t(d.value),3)):ie("",!0)],8,Fo))}},cr=fe(ir,[["__scopeId","data-v-a6287a4b"]]),ur=["data-theme"],dr={class:"head"},vr={class:"title"},hr={class:"question"},pr={class:"options"},fr=["value"],mr={class:"text"},gr={class:"actions"},_r={__name:"challenge_level_two_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثاني – التحدي 6: مقارنة الأوزان",question:"ما وزن المربع الواحد مقارنة بالمثلث؟",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة! أحسنت في مقارنة الأوزان.",wrong:"إجابة غير صحيحة. أعد التفكير في المعادلات.",pick:"اختر إجابة أولاً."},en:{title:"Level 2 – Challenge 6: Comparing weights",question:"How does the weight of the square compare to the triangle?",newQ:"New question",reset:"Reset",check:"Check",correct:"Correct! Great job comparing the weights.",wrong:"That is incorrect. Revisit the equations.",pick:"Select an option first."}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Ne):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Ee):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");const L=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function G(u){return String(u).replace(/[0-9]/g,p=>L[Number(p)])}function T(u,p){return p==="ar"?G(u):String(u)}function A(u,p){return p==="ar"?u<=2?"وحدة":"وحدات":u===1?"unit":"units"}const f={ar:{double:"ضعف وزن المثلث",equal:"يساوي وزن المثلث",half:"نصف وزن المثلث",less:u=>`أقل بـ${G(u)} ${A(u,"ar")} من وزن المثلث`,more:u=>`أكثر بـ${G(u)} ${A(u,"ar")} من وزن المثلث`},en:{double:"Twice the triangle",equal:"Equal to the triangle",half:"Half the triangle",less:u=>`${u} ${A(u,"en")} less than the triangle`,more:u=>`${u} ${A(u,"en")} more than the triangle`}};function d(u,p){const b=Math.abs(u.difference),z=f[p];return[{id:"a",text:z.double},{id:"b",text:z.equal},{id:"c",text:z.half},{id:"d",text:z.less(b)},{id:"e",text:z.more(b)}]}function S(u,p){const b=T(u.totals.square,p),z=T(u.totals.triangle,p);return p==="ar"?[`وزن كرتان ومربع واحد يساويان ${b} وحدات.`,`وزن كرتان ومثلث واحد يساويان ${z} وحدات.`]:[`Two balls and one square weigh ${b} units.`,`Two balls and one triangle weigh ${z} units.`]}const M=[{id:"p1",totals:{square:8,triangle:6},difference:2,correctId:"e"},{id:"p2",totals:{square:10,triangle:7},difference:3,correctId:"e"},{id:"p3",totals:{square:9,triangle:11},difference:-2,correctId:"d"},{id:"p4",totals:{square:12,triangle:8},difference:4,correctId:"e"},{id:"p5",totals:{square:7,triangle:10},difference:-3,correctId:"d"}],I=E(M[0]),N=E(null),H=Q(()=>I.value.correctId);function X(){if(M.length===1)return N.value=M[0].id,M[0];let u;do u=M[Math.floor(Math.random()*M.length)];while(u.id===N.value);return N.value=u.id,u}function R(u){return u.slice().sort(()=>Math.random()-.5)}const j=E(null),O=E(null),W=E(!1),J=E(null);function P(){J.value=R(d(I.value,a.value))}function h(){j.value=null,O.value=null,W.value=!1}async function m(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function c(){if(!j.value){O.value=l[a.value].pick,k&&k.play();return}if(j.value===H.value){const u=W.value;W.value=!0,O.value=l[a.value].correct,w&&w.play(),B&&B.play(),u||await m()}else W.value=!1,O.value=l[a.value].wrong,k&&k.play()}function g(){const u=X();I.value=u,h(),P()}me(()=>D.lang,()=>{h(),P()});const $=Q(()=>J.value||d(I.value,a.value)),y=Q(()=>S(I.value,a.value));return ge(()=>{g()}),(u,p)=>(n(),r("div",{class:"lvl2c6 challenge-surface","data-theme":D.theme},[e("header",dr,[e("h2",vr,t(l[a.value].title),1),(n(!0),r(te,null,le(y.value,(b,z)=>(n(),r("p",{key:z,class:"premise"},t(b),1))),128)),e("p",hr,t(l[a.value].question),1)]),e("section",pr,[(n(!0),r(te,null,le($.value,b=>(n(),r("label",{key:b.id,class:oe(["option",{selected:j.value===b.id}])},[Te(e("input",{type:"radio",name:"weight-comparison",value:b.id,"onUpdate:modelValue":p[0]||(p[0]=z=>j.value=z)},null,8,fr),[[Nt,j.value]]),p[1]||(p[1]=e("span",{class:"mark"},null,-1)),e("span",mr,t(b.text),1)],2))),128))]),e("section",gr,[e("button",{class:"btn",onClick:c},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:h},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:g},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:be(()=>[O.value?(n(),r("div",{key:0,class:oe(["feedback",{ok:W.value}])},t(O.value),3)):ie("",!0)]),_:1})],8,ur))}},br=fe(_r,[["__scopeId","data-v-15b62468"]]),yr=["data-theme"],kr={class:"title"},wr={class:"rule"},$r={class:"hint"},Cr=["dir"],xr=["onDrop"],Sr={key:1,class:"placeholder"},Ar=["onClick"],Dr={class:"bank"},Tr={class:"bank-title"},Mr={class:"bank-items"},Lr=["onDragstart"],Nr={class:"actions"},Er={__name:"challenge_level_three_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 1: هرم الضرب",rule:"املأ مربعات الهرم بحيث يساوي كل مربع أعلى حاصل ضرب الخليتين تحته. اسحب الأرقام الصحيحة من اللوحة حتى يكتمل الهرم.",hint:"تذكّر أن كل خطوة نحو الأعلى هي نتيجة ضرب الخليتين في الأسفل مباشرة.",bank:"لوحة الأرقام",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"أحسنت! اكتمل الهرم.",wrong:"تحقّق مرة أخرى، هناك قيمة في غير مكانها.",clear:"تفريغ الخلية"},en:{title:"Level 3 – Challenge 1: Multiplication Pyramid",rule:"Fill the pyramid so that every cell above equals the product of the two cells directly beneath it. Drag the correct numbers from the bank.",hint:"Remember: each step upward is the product of the two numbers underneath.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Great! The pyramid is complete.",wrong:"Something is off. Recheck the placements.",clear:"Clear cell"}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Le):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Oe):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");function L(b,z){return Math.floor(Math.random()*(z-b+1))+b}function G(b){const z=b.slice();for(let v=z.length-1;v>0;v--){const s=Math.floor(Math.random()*(v+1));[z[v],z[s]]=[z[s],z[v]]}return z}function T(b,z){return`${b},${z}`}const A=E([]),f=E(new Set),d=he({}),S=he({}),M=he({}),I=E(null),N=E(!1),H=Q(()=>({direction:"ltr",unicodeBidi:"isolate"})),X=Q(()=>A.value.map((b,z)=>({cells:b,index:z})).slice().reverse());function R(b){let z=0;for(const v in d)d[v]===b&&z++;return z}function j(){const b={};for(const[z,v]of Object.entries(S)){const s=Number(z),o=v-R(s);o>0&&(b[s]=o)}for(const z in M)delete M[z];for(const[z,v]of Object.entries(b))M[z]=v}function O(){for(;;){const z=[Array.from({length:4},()=>L(2,6))];for(let s=1;s<4;s++){const o=z[s-1],i=[];for(let _=0;_<o.length-1;_++)i.push(o[_]*o[_+1]);z.push(i)}if(z[3][0]<=5e4)return z}}function W(){N.value=!1,I.value=null;const b=O();A.value=b,f.value=new Set;for(const v in d)delete d[v];for(let v=1;v<A.value.length;v++)for(let s=0;s<A.value[v].length;s++)f.value.add(T(v,s));const z={};f.value.forEach(v=>{const[s,o]=v.split(",").map(Number),i=A.value[s][o];z[i]=(z[i]||0)+1});for(const v in S)delete S[v];for(const[v,s]of Object.entries(z))S[v]=s;j()}function J(b){b.preventDefault()}function P(b,z){b.dataTransfer.setData("text/plain",String(z))}function h(b,z){if(z.preventDefault(),!f.value.has(b))return;const v=z.dataTransfer.getData("text/plain"),s=Number(v);if(Number.isNaN(s)||!S[s])return;const o=d[b];o===s||R(s)>=S[s]||(o!=null&&delete d[b],d[b]=s,j(),I.value=null)}function m(b){d[b]!=null&&(delete d[b],j())}function c(){for(const b of f.value)if(d[b]==null)return!1;return!0}function g(){for(const b of f.value){const[z,v]=b.split(",").map(Number);if(d[b]!==A.value[z][v])return!1}return!0}async function $(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function y(){if(!c()){I.value=a.value==="ar"?"أكمل كل الخانات أولاً.":"Fill all blanks first.",k&&k.play();return}g()?(N.value=!0,I.value=l[a.value].correct,w&&w.play(),B&&B.play(),await $()):(I.value=l[a.value].wrong,k&&k.play())}function u(){for(const b in d)delete d[b];N.value=!1,I.value=null,j()}const p=Q(()=>{const b=[];for(const[z,v]of Object.entries(M))for(let s=0;s<v;s++)b.push(Number(z));return G(b)});return ge(W),me(()=>D.lang,()=>{I.value&&(I.value=null)}),(b,z)=>(n(),r("div",{class:"lvl3c1 challenge-surface","data-theme":D.theme},[e("h2",kr,t(l[a.value].title),1),e("p",wr,t(l[a.value].rule),1),e("p",$r,t(l[a.value].hint),1),e("div",{class:"pyramid",dir:D.lang==="ar"?"rtl":"ltr"},[(n(!0),r(te,null,le(X.value,v=>(n(),r("div",{class:"p-row",key:v.index},[(n(!0),r(te,null,le(v.cells,(s,o)=>(n(),r("div",{class:"brick",key:v.index+"-"+o},[f.value.has(T(v.index,o))?(n(),r(te,{key:1},[e("div",{class:"dropzone",onDragover:J,onDrop:i=>h(T(v.index,o),i)},[d[T(v.index,o)]!=null?(n(),r("span",{key:0,class:"num",style:de(H.value)},t(d[T(v.index,o)]),5)):(n(),r("span",Sr,"؟"))],40,xr),e("button",{class:"clear",onClick:i=>m(T(v.index,o))},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)],8,Ar)],64)):(n(),r("span",{key:0,class:"num",style:de(H.value)},t(s),5))]))),128))]))),128))],8,Cr),e("div",Dr,[e("div",Tr,t(l[a.value].bank),1),e("div",Mr,[(n(!0),r(te,null,le(p.value,(v,s)=>(n(),r("button",{key:v+"_"+s,class:"chip",draggable:"true",onDragstart:o=>P(o,v),style:de(H.value)},t(v),45,Lr))),128))])]),e("div",Nr,[e("button",{class:"btn",onClick:u},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:y},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:W},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),I.value?(n(),r("div",{key:0,class:oe(["toast",{ok:N.value}])},t(I.value),3)):ie("",!0)],8,yr))}},Pr=fe(Er,[["__scopeId","data-v-cecd74e3"]]),zr=["data-theme"],Br={class:"head"},Rr={class:"title"},Or={class:"rule"},jr={class:"board"},Ir={class:"cards"},Fr=["onDrop"],qr={key:0,class:"num"},Ur={key:1,class:"placeholder"},Qr=["value","onInput","onChange","onBlur","placeholder"],Vr=["onClick"],Wr={class:"facts"},Gr={class:"bank"},Hr={class:"bank-title"},Kr={class:"bank-items"},Yr=["onDragstart"],Zr={class:"actions"},Jr=4,Xr={__name:"challenge_level_three_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 2: الأرقام المفقودة على البطاقات",rule:"أمامك بطاقات ملوّنة بأرقام مفقودة. استخدم المعلومات المعطاة (المجموع، المتوسط، الوسيط، المدى) لتحديد الرقم المناسب لكل بطاقة، ثم اسحبه من لوحة الأعداد أو اكتبه يدويًا.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"مسح",check:"تحقّق",correct:"أحسنت! الأرقام صحيحة.",wrong:"تحقّق من القيم مرة أخرى.",clear:"تفريغ البطاقة",hints:{sum:"المجموع",mean:"المتوسط الحسابي",median:"الوسيط",range:"المدى"},manualPlaceholder:"أدخل رقمًا"},en:{title:"Level 3 – Challenge 2: Missing numbers on the cards",rule:"Each coloured card is missing its number. Use the given information (sum, mean, median, range) to deduce the correct value for every card, then drag a number from the bank or type it manually.",bank:"Number bank",newQ:"New puzzle",reset:"Clear",check:"Check",correct:"Great! All numbers are correct.",wrong:"Something is off – recheck the values.",clear:"Clear card",hints:{sum:"Sum",mean:"Mean",median:"Median",range:"Range"},manualPlaceholder:"Type value"}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=Q(()=>D.lang==="ar"?"ar-EG":"en-US"),B=typeof Audio!="undefined"?new Audio(Le):null,k=typeof Audio!="undefined"?new Audio($e):null,L=typeof Audio!="undefined"?new Audio(Ee):null;B&&(B.preload="auto"),k&&(k.preload="auto"),L&&(L.preload="auto");const G=["green","gold","teal","magenta","sky","orange","crimson"],T=[{numbers:[4,8,12,16,20]},{numbers:[5,9,11,13,22]},{numbers:[7,10,12,18,23]},{numbers:[6,8,15,19,22]},{numbers:[9,11,14,20,26]}];function A(x){const C=x.slice().sort((re,ue)=>re-ue),F=C.reduce((re,ue)=>re+ue,0),K=F/C.length,Y=C[Math.floor(C.length/2)],ne=C[C.length-1]-C[0];return{sum:F,mean:K,median:Y,range:ne}}const f=E([]),d=he({}),S=E(new Set),M=he({}),I=he({}),N=he({}),H=he({}),X=he({}),R=he({}),j=E({sum:0,mean:0,median:0,range:0}),O=E(null),W=E(!1);function J(x){for(const C of Object.keys(x))delete x[C]}function P(){const C=T[Math.floor(Math.random()*T.length)].numbers.slice(),F=G.slice(0,C.length);F.sort(()=>Math.random()-.5);const K=C.slice().sort(()=>Math.random()-.5);f.value=[],S.value=new Set,J(d),J(H),J(X),J(R),J(M),J(I),J(N),K.forEach((ve,xe)=>{const Pe=`card-${xe}`;f.value.push({id:Pe,value:ve,color:F[xe%F.length]}),d[Pe]=ve,S.value.add(Pe),M[ve]=(M[ve]||0)+1});for(const[ve,xe]of Object.entries(M))N[ve]=xe;const Y=Math.min(...C),ne=Math.max(...C),re=Math.max(1,Y-12),ue=ne+12,Se=new Set;for(;Se.size<Jr;){const ve=Math.floor(Math.random()*(ue-re+1))+re;M[ve]||Se.add(ve)}Se.forEach(ve=>{I[ve]=(I[ve]||0)+1,N[ve]=(N[ve]||0)+1}),j.value=A(C),O.value=null,W.value=!1}function h(x,C){x.dataTransfer.setData("text/plain",String(C))}function m(x){x.preventDefault()}function c(x,C,F){if(Number.isNaN(C))return!1;if(H[x]!=null&&X[x]==="bank"){const K=H[x];N[K]=(N[K]||0)+1}if(F==="bank"){if((N[C]||0)<=0)return!1;N[C]=(N[C]||0)-1}return H[x]=C,X[x]=F,R[x]=String(C),O.value=null,W.value=!1,!0}function g(x,C){x.preventDefault();const F=x.dataTransfer.getData("text/plain"),K=Number(F);Number.isNaN(K)||c(C,K,"bank")}function $(x){if(H[x]!=null&&X[x]==="bank"){const C=H[x];N[C]=(N[C]||0)+1}delete H[x],delete X[x],R[x]="",O.value=null,W.value=!1}function y(){for(const x of S.value)if(H[x]==null)return!1;return!0}function u(){for(const x of S.value)if(H[x]!==d[x])return!1;return!0}async function p(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function b(){if(!y()){O.value=a.value==="ar"?"أكمل كل البطاقات أولاً.":"Fill every card first.",L&&L.play();return}u()?(W.value=!0,O.value=l[a.value].correct,B&&B.play(),k&&k.play(),await p()):(O.value=l[a.value].wrong,L&&L.play())}function z(){J(H),J(X),J(R),J(N);for(const[x,C]of Object.entries(M))N[x]=C;for(const[x,C]of Object.entries(I))N[x]=(N[x]||0)+C;O.value=null,W.value=!1}const v=Q(()=>{const x=[];for(const[C,F]of Object.entries(N))for(let K=0;K<F;K++)x.push({value:Number(C),key:`${C}-${K}`});return x});function s(x,C){R[x]=C}function o(x){var K;const C=((K=R[x])!=null?K:"").trim();if(C===""){$(x);return}const F=Number(C);Number.isFinite(F)&&c(x,F,"manual")}const i=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function _(x){const C=String(x);return D.lang!=="ar"?C:C.replace(/[0-9]/g,F=>i[Number(F)])}function q(x,C={}){return new Intl.NumberFormat(w.value,C).format(x)}return ge(P),me(()=>D.lang,()=>{O.value&&W.value||(O.value=null)}),(x,C)=>(n(),r("div",{class:"lvl3c2 challenge-surface","data-theme":D.theme},[e("header",Br,[e("h2",Rr,t(l[a.value].title),1),e("p",Or,t(l[a.value].rule),1)]),e("section",jr,[e("div",Ir,[(n(!0),r(te,null,le(f.value,F=>{var K;return n(),r("div",{key:F.id,class:oe(["card","color-"+F.color])},[e("div",{class:"drop",onDragover:m,onDrop:Y=>g(Y,F.id)},[H[F.id]!=null?(n(),r("span",qr,t(_(H[F.id])),1)):(n(),r("span",Ur,"؟"))],40,Fr),e("input",{class:"manual-entry",type:"number",inputmode:"numeric",value:(K=R[F.id])!=null?K:"",onInput:Y=>s(F.id,Y.target.value),onChange:Y=>o(F.id),onBlur:Y=>o(F.id),placeholder:l[a.value].manualPlaceholder},null,40,Qr),e("button",{class:"clear",onClick:Y=>$(F.id)},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)],8,Vr)],2)}),128))]),e("aside",Wr,[e("h3",null,t(D.lang==="ar"?"المعلومات المتاحة":"Given facts"),1),e("ul",null,[e("li",null,[e("strong",null,t(l[a.value].hints.sum)+":",1),Z(" "+t(q(j.value.sum)),1)]),e("li",null,[e("strong",null,t(l[a.value].hints.mean)+":",1),Z(" "+t(q(j.value.mean,{maximumFractionDigits:2})),1)]),e("li",null,[e("strong",null,t(l[a.value].hints.median)+":",1),Z(" "+t(q(j.value.median)),1)]),e("li",null,[e("strong",null,t(l[a.value].hints.range)+":",1),Z(" "+t(q(j.value.range)),1)])])])]),e("section",Gr,[e("div",Hr,t(l[a.value].bank),1),e("div",Kr,[(n(!0),r(te,null,le(v.value,F=>(n(),r("button",{key:F.key,class:"chip",draggable:"true",onDragstart:K=>h(K,F.value)},t(_(F.value)),41,Yr))),128))])]),e("section",Zr,[e("button",{class:"btn",onClick:z},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:b},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:P},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:be(()=>[O.value?(n(),r("div",{key:0,class:oe(["toast",{ok:W.value}])},t(O.value),3)):ie("",!0)]),_:1})],8,zr))}},ei=fe(Xr,[["__scopeId","data-v-9b49ee36"]]),ti=["data-theme"],ai={class:"head"},li={class:"title"},ni={class:"rule"},si={class:"status"},oi={class:"chip target"},ri={class:"chip sum"},ii={class:"grid"},ci=["onClick"],ui={class:"actions"},di={__name:"challenge_level_three_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 3: خطوط المجموع العشري",rule:"اختر أرقامًا متجاورة على خط مستقيم (أفقي، عمودي أو قطري) بحيث يساوي مجموعها القيمة المطلوبة.",targetLabel:"المجموع المطلوب",selected:"المجموع الحالي",check:"تحقّق",reset:"إعادة اختيار",newQ:"سؤال جديد",needSelection:"اختر خانات أولاً.",wrongLine:"يجب أن تكون الخانات المختارة على خط مستقيم ومتجاورة.",wrongSum:"المجموع لا يساوي القيمة المطلوبة.",correct:"رائع! خط صحيح."},en:{title:"Level 3 – Challenge 3: Decimal Sum Lines",rule:"Pick numbers lying on one straight line (horizontal, vertical, or diagonal) so their sum equals the target.",targetLabel:"Target sum",selected:"Current sum",check:"Check",reset:"Reset selection",newQ:"New puzzle",needSelection:"Select cells first.",wrongLine:"Selections must be contiguous on a straight line.",wrongSum:"The sum does not match the target.",correct:"Great! You found a valid line."}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Le):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(at):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");const L=[{id:"p1",target:10,grid:[[1.2,.8,2.5,1.3,.9],[2.1,3.4,2,.6,1.5],[1.8,2.2,1.5,3,1.1],[.5,1.6,1.7,2,3.5],[1.4,1.3,2.3,1.8,2.7]],solution:[{r:0,c:2},{r:1,c:2},{r:2,c:2},{r:3,c:2},{r:4,c:2}]},{id:"p2",target:10,grid:[[.8,1.7,2.1,.9,1.4],[2.6,1.5,1.9,1.1,2.9],[1.3,2.4,1.2,2.2,1.6],[.7,1.8,2.5,1.7,2.3],[1.9,.6,1.8,2.6,.9]],solution:[{r:1,c:0},{r:1,c:1},{r:1,c:2},{r:1,c:3},{r:1,c:4}]},{id:"p3",target:10,grid:[[2.5,1.1,.8,1.4,1.2],[.9,2,1.3,1.7,1],[1.6,1.2,1.8,1.1,1.3],[1.4,1.9,1.5,1.5,1.8],[1.3,1.4,.9,1.6,2.2]],solution:[{r:0,c:0},{r:1,c:1},{r:2,c:2},{r:3,c:3},{r:4,c:4}]},{id:"p4",target:10,grid:[[1.1,.9,1.7,1.3,2.1],[2,1.4,2,1.1,1.6],[1.5,2.2,1.8,1.4,1.3],[.8,1.9,2.3,1.2,1.1],[1.6,1.5,2.2,1.7,.9]],solution:[{r:0,c:2},{r:1,c:2},{r:2,c:2},{r:3,c:2},{r:4,c:2}]},{id:"p5",target:10.2,grid:[[1,1.3,.9,1.5,1.9],[1.6,1.2,1.4,1.8,1],[1.7,1.1,2.1,1.4,1.2],[2.4,2,1.5,1.3,.8],[2.4,1.5,1.6,1.1,.7]],solution:[{r:0,c:4},{r:1,c:3},{r:2,c:2},{r:3,c:1},{r:4,c:0}]},{id:"p6",target:9,grid:[[1.8,2.2,1.6,1.5,1.9],[1.3,.9,2.1,2.5,1.1],[1.4,1.7,1.2,1.8,1.6],[1,2.3,1.5,1.4,2.2],[1.6,1.1,2,1.7,.8]],solution:[{r:0,c:0},{r:0,c:1},{r:0,c:2},{r:0,c:3},{r:0,c:4}]},{id:"p7",target:9.3,grid:[[1.2,1.5,2.1,1,1.4],[.9,2,1.7,1.9,1.2],[1.3,1.8,2.2,1.6,1.1],[1.5,1.9,1.4,1.7,2.3],[1,2.1,1.5,1.2,1.8]],solution:[{r:0,c:1},{r:1,c:1},{r:2,c:1},{r:3,c:1},{r:4,c:1}]},{id:"p8",target:9,grid:[[1.4,1.2,2,1.6,.9],[1.1,1.8,1.4,2.3,1.5],[2.2,1.3,1.7,1.2,1.1],[1.5,2.4,1.6,1.5,1.9],[2,1.7,1.5,1.4,2.6]],solution:[{r:0,c:0},{r:1,c:1},{r:2,c:2},{r:3,c:3},{r:4,c:4}]},{id:"p9",target:10,grid:[[1.6,1,1.2,1.9,2.1],[1.3,1.5,2.2,1.8,1.1],[2,1.8,1.4,1.5,1.7],[1.2,2.3,1.6,1.7,1],[2.4,1.9,1.5,1.2,.8]],solution:[{r:0,c:4},{r:1,c:3},{r:2,c:2},{r:3,c:1},{r:4,c:0}]},{id:"p10",target:9,grid:[[1,1.7,1.3,2.1,1.6],[1.5,1.1,2.4,1.6,1.8],[1.9,2,1.5,1.2,1.3],[1.4,1.9,1.7,2,1.1],[2.1,2,1.8,1.5,1.6]],solution:[{r:4,c:0},{r:4,c:1},{r:4,c:2},{r:4,c:3},{r:4,c:4}]}],G=E(L[0]),T=E(null),A=E(new Set),f=E(!1),d=E(null);function S(P,h){return`${P},${h}`}function M(){if(L.length===1)return T.value=L[0].id,L[0];let P;do P=L[Math.floor(Math.random()*L.length)];while(P.id===T.value);return T.value=P.id,P}function I(){A.value=new Set,f.value=!1,d.value=null}function N(){const P=M();G.value=P,I()}function H(P,h){const m=S(P,h),c=new Set(A.value);c.has(m)?c.delete(m):c.add(m),A.value=c,f.value=!1,d.value=null}const X=Q(()=>Array.from(A.value).map(P=>{const[h,m]=P.split(",").map(Number);return{r:h,c:m}})),R=Q(()=>X.value.reduce((P,h)=>P+G.value.grid[h.r][h.c],0));function j(P){if(P.length<2)return!0;const h=P.map(p=>p.r),m=P.map(p=>p.c),c=h.every(p=>p===h[0]),g=m.every(p=>p===m[0]),$=h.every((p,b)=>p-m[b]===h[0]-m[0]),y=h.every((p,b)=>p+m[b]===h[0]+m[0]);if(!c&&!g&&!$&&!y)return!1;const u=[...P];if(c){u.sort((p,b)=>p.c-b.c);for(let p=1;p<u.length;p++)if(u[p].c-u[p-1].c!==1)return!1;return!0}if(g){u.sort((p,b)=>p.r-b.r);for(let p=1;p<u.length;p++)if(u[p].r-u[p-1].r!==1)return!1;return!0}if($){u.sort((p,b)=>p.r-b.r);for(let p=1;p<u.length;p++)if(u[p].r-u[p-1].r!==1||u[p].c-u[p-1].c!==1)return!1;return!0}u.sort((p,b)=>p.r-b.r);for(let p=1;p<u.length;p++)if(u[p].r-u[p-1].r!==1||u[p-1].c-u[p].c!==1)return!1;return!0}async function O(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function W(){if(!A.value.size){d.value=l[a.value].needSelection,k&&k.play();return}const P=X.value;if(!j(P)){d.value=l[a.value].wrongLine,k&&k.play();return}const h=R.value;if(Math.abs(h-G.value.target)>1e-6){d.value=l[a.value].wrongSum,k&&k.play();return}f.value=!0,d.value=l[a.value].correct,w&&w.play(),B&&B.play(),await O()}function J(P,h){return G.value.solution.some(m=>m.r===P&&m.c===h)}return ge(()=>{N()}),(P,h)=>(n(),r("div",{class:"lvl3c3 challenge-surface","data-theme":D.theme},[e("header",ai,[e("h2",li,t(l[a.value].title),1),e("p",ni,t(l[a.value].rule),1)]),e("section",si,[e("div",oi,[Z(t(l[a.value].targetLabel)+": ",1),e("strong",null,t(G.value.target.toFixed(1)),1)]),e("div",ri,[Z(t(l[a.value].selected)+": ",1),e("strong",null,t(R.value.toFixed(1)),1)])]),e("section",ii,[(n(!0),r(te,null,le(G.value.grid,(m,c)=>(n(),r("div",{key:c,class:"row"},[(n(!0),r(te,null,le(m,(g,$)=>(n(),r("button",{key:$,class:oe(["cell",{selected:A.value.has(S(c,$)),success:f.value&&J(c,$)}]),onClick:y=>H(c,$)},t(g.toFixed(1)),11,ci))),128))]))),128))]),e("section",ui,[e("button",{class:"btn",onClick:W},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:I},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:N},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:be(()=>[d.value?(n(),r("div",{key:0,class:oe(["feedback",{ok:f.value}])},t(d.value),3)):ie("",!0)]),_:1})],8,ti))}},vi=fe(di,[["__scopeId","data-v-413d5506"]]),hi=["data-theme"],pi={class:"head"},fi={class:"title"},mi={class:"equations"},gi={class:"expression"},_i=["onDrop"],bi={key:0,class:"digit"},yi={key:1,class:"placeholder"},ki=["onClick"],wi={class:"bank"},$i={class:"bank-title"},Ci={class:"bank-items"},xi=["onDragstart"],Si={class:"actions"},Ai={__name:"challenge_level_three_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 4: أزل النقطة الحمراء",intro:["هذه المعادلات فرصة للتفكير في العمليات على الأعداد العشرية.","كل نقطة حمراء ● تمثّل رقمًا ناقصًا. اسحب الرقم الملائم من لوحة الأرقام وضعه مكان النقطة حتى تصبح المعادلة صحيحة."],check:"تحقّق",reset:"مسح الكل",newQ:"سؤال جديد",incomplete:"أكمل كل الفراغات أولاً.",wrong:"هناك معادلة غير صحيحة، راجع الأرقام.",correct:"أحسنت! جميع المعادلات صحيحة.",bank:"لوحة الأرقام",clear:"تفريغ"},en:{title:"Level 3 – Challenge 4: Replace the red dot",intro:["These equations focus on decimal operations.","Each red dot ● hides a single digit. Drag the correct digit from the number bank to make every equation true."],check:"Check",reset:"Clear all",newQ:"New puzzle",incomplete:"Fill every blank first.",wrong:"One or more equations are incorrect. Try again.",correct:"Great! All equations are valid.",bank:"Number bank",clear:"Clear"}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Ne):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Ee):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");const L=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function G(v,s){let o;return typeof v=="number"?o=s!=null?v.toFixed(s):String(v):o=String(v),o.replace(/[0-9]/g,i=>L[Number(i)]).replace(/\./g,"٫")}function T({multiplier:v,offset:s,aDigit:o,bDigit:i}){const _=G(v,1),q=v.toFixed(1),x=s.toFixed(2),C=x.slice(1),F=G(x).slice(1);return{id:"eqA",slots:{a:o,b:i},order:["a","b"],template:{ar:["أ. ",_," × ٠٫",{slot:"a"}," = ",{slot:"b"},F],en:["A. ",q," × 0.",{slot:"a"}," = ",{slot:"b"},C]},evaluate(K){const Y=v*(K.a/10),ne=K.b+s;return Math.abs(Y-ne)<1e-6}}}function A({baseLeft:v,baseRight:s,cDigit:o,dDigit:i,result:_,decimals:q=2}){const x=G(v,0)+"٫",C=G(s,0)+"٫",F=`${v}.`,K=`${s}.`,Y=q!=null?_.toFixed(q):String(_),ne=G(Y);return{id:"eqB",slots:{c:o,d:i},order:["c","d"],template:{ar:["ب. ",x,{slot:"c"}," × ",C,{slot:"d"}," = ",ne],en:["B. ",F,{slot:"c"}," × ",K,{slot:"d"}," = ",Y]},evaluate(re){const ue=(v+re.c/10)*(s+re.d/10);return Math.abs(ue-_)<1e-6}}}function f({secondBase:v,eDigit:s,fDigit:o,result:i,decimals:_=2}){const q=G(v,0)+"٫",x=`${v}.`,C=_!=null?i.toFixed(_):String(i),F=G(C);return{id:"eqC",slots:{e:s,f:o},order:["e","f"],template:{ar:["ج. ",{slot:"e"},"٫٩ × ",q,{slot:"f"}," = ",F],en:["C. ",{slot:"e"},".9 × ",x,{slot:"f"}," = ",C]},evaluate(K){const Y=(K.e+.9)*(v+K.f/10);return Math.abs(Y-i)<1e-6}}}function d({gDigit:v,hDigit:s}){return{id:"eqD",slots:{g:v,h:s},order:["g","h"],template:{ar:["د. ٤٫",{slot:"g"}," + ١٫٢٥ = ٥٫",{slot:"h"},"٥"],en:["D. 4.",{slot:"g"}," + 1.25 = 5.",{slot:"h"},"5"]},evaluate(o){const i=4+o.g/10+1.25,_=5+o.h/10+.05;return Math.abs(i-_)<1e-6}}}const S=[{id:"p1",equations:[T({multiplier:9.3,offset:.44,aDigit:8,bDigit:7}),A({baseLeft:2,baseRight:2,cDigit:4,dDigit:9,result:6.96,decimals:2}),f({secondBase:3,eDigit:4,fDigit:7,result:18.13,decimals:2}),d({gDigit:7,hDigit:9})]},{id:"p2",equations:[T({multiplier:8.6,offset:.16,aDigit:6,bDigit:5}),A({baseLeft:2,baseRight:2,cDigit:1,dDigit:6,result:5.46,decimals:2}),f({secondBase:3,eDigit:2,fDigit:5,result:10.15,decimals:2}),d({gDigit:3,hDigit:5})]},{id:"p3",equations:[T({multiplier:7.8,offset:.24,aDigit:8,bDigit:6}),A({baseLeft:2,baseRight:2,cDigit:5,dDigit:2,result:5.5,decimals:2}),f({secondBase:3,eDigit:3,fDigit:6,result:14.04,decimals:2}),d({gDigit:2,hDigit:4})]},{id:"p4",equations:[T({multiplier:6.4,offset:.28,aDigit:2,bDigit:1}),A({baseLeft:2,baseRight:2,cDigit:8,dDigit:3,result:6.44,decimals:2}),f({secondBase:3,eDigit:5,fDigit:2,result:18.88,decimals:2}),d({gDigit:4,hDigit:6})]},{id:"p5",equations:[T({multiplier:6.4,offset:.12,aDigit:8,bDigit:5}),A({baseLeft:2,baseRight:2,cDigit:0,dDigit:9,result:5.8,decimals:2}),f({secondBase:3,eDigit:6,fDigit:1,result:21.39,decimals:2}),d({gDigit:1,hDigit:3})]}],M=E(S[0]),I=E(null);function N(){if(S.length===1)return I.value=S[0].id,S[0];let v;do v=S[Math.floor(Math.random()*S.length)];while(v.id===I.value);return I.value=v.id,v}const H=he({}),X=he({}),R=he({}),j=E([]),O=E(null),W=E(!1);function J(v){if(v==null)return"";const s=String(v);return D.lang==="ar"?s.replace(/[0-9]/g,o=>L[Number(o)]):s}function P(v){return v.slice().sort(()=>Math.random()-.5)}function h(){const v=N();M.value=v,O.value=null,W.value=!1,Object.keys(H).forEach(o=>delete H[o]),Object.keys(X).forEach(o=>delete X[o]),Object.keys(R).forEach(o=>delete R[o]);const s=[];v.equations.forEach(o=>{o.order.forEach(i=>{const _=`${o.id}-${i}`;s.push({key:_,eq:o,slotName:i}),H[_]=null;const q=o.slots[i];X[q]=(X[q]||0)+1,R[q]=(R[q]||0)+1})}),j.value=s}function m(v){v.preventDefault()}function c(v,s){v.dataTransfer.setData("text/plain",String(s))}function g(v,s){v.preventDefault();const o=v.dataTransfer.getData("text/plain"),i=Number(o);if(!Number.isNaN(i)&&!((R[i]||0)<=0&&H[s]!==i)){if(H[s]!=null){const _=H[s];R[_]=(R[_]||0)+1}H[s]!==i&&(R[i]=(R[i]||0)-1,R[i]<0&&(R[i]=0)),H[s]=i,O.value=null,W.value=!1}}function $(v){if(H[v]!=null){const s=H[v];R[s]=(R[s]||0)+1,H[v]=null,O.value=null,W.value=!1}}const y=Q(()=>{const v=[];for(const[s,o]of Object.entries(R))for(let i=0;i<o;i++)v.push({value:Number(s),key:`${s}-${i}`});return P(v)});function u(){return j.value.every(v=>H[v.key]!=null)}async function p(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function b(){if(!u()){O.value=l[a.value].incomplete,k&&k.play();return}const{equations:v}=M.value;for(const s of v){const o={};let i=!0;for(const _ of s.order){const q=`${s.id}-${_}`;if(o[_]=H[q],o[_]==null){i=!1;break}}if(!i||!s.evaluate(o)){O.value=l[a.value].wrong,k&&k.play();return}}O.value=l[a.value].correct,W.value=!0,w&&w.play(),B&&B.play(),await p()}function z(){j.value.forEach(v=>{if(H[v.key]!=null){const s=H[v.key];R[s]=(R[s]||0)+1,H[v.key]=null}}),O.value=null,W.value=!1}return ge(h),me(()=>D.lang,()=>{W.value||(O.value=null)}),(v,s)=>(n(),r("div",{class:"lvl3c4 challenge-surface","data-theme":D.theme},[e("header",pi,[e("h2",fi,t(l[a.value].title),1),(n(!0),r(te,null,le(l[a.value].intro,(o,i)=>(n(),r("p",{key:i,class:"intro"},t(o),1))),128))]),e("section",mi,[(n(!0),r(te,null,le(M.value.equations,o=>(n(),r("div",{key:o.id,class:"card"},[e("div",gi,[(n(!0),r(te,null,le(D.lang==="ar"?o.template.ar:o.template.en,(i,_)=>(n(),r("span",{key:_},[typeof i=="string"?(n(),r(te,{key:0},[Z(t(i),1)],64)):(n(),r(te,{key:1},[e("span",{class:"slot",onDragover:m,onDrop:q=>g(q,o.id+"-"+i.slot)},[H[o.id+"-"+i.slot]!=null?(n(),r("span",bi,t(J(H[o.id+"-"+i.slot])),1)):(n(),r("span",yi,"●"))],40,_i),e("button",{class:"clear",onClick:q=>$(o.id+"-"+i.slot)},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)],8,ki)],64))]))),128))])]))),128))]),e("section",wi,[e("div",$i,t(l[a.value].bank),1),e("div",Ci,[(n(!0),r(te,null,le(y.value,o=>(n(),r("button",{key:o.key,class:"chip",draggable:"true",onDragstart:i=>c(i,o.value)},t(J(o.value)),41,xi))),128))])]),e("section",Si,[e("button",{class:"btn",onClick:b},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:z},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:h},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:be(()=>[O.value?(n(),r("div",{key:0,class:oe(["feedback",{ok:W.value}])},t(O.value),3)):ie("",!0)]),_:1})],8,hi))}},Di=fe(Ai,[["__scopeId","data-v-ad7bbf94"]]),Ti=["data-theme"],Mi={class:"head"},Li={class:"title"},Ni={class:"equation"},Ei={class:"fraction"},Pi={class:"row"},zi=["onDrop"],Bi={key:0,class:"digit"},Ri={key:1,class:"placeholder"},Oi={class:"row"},ji=["onDrop"],Ii={key:0,class:"digit"},Fi={key:1,class:"placeholder"},qi={class:"fraction"},Ui={class:"row"},Qi=["onDrop"],Vi={key:0,class:"digit"},Wi={key:1,class:"placeholder"},Gi={class:"row"},Hi=["onDrop"],Ki={key:0,class:"digit"},Yi={key:1,class:"placeholder"},Zi={key:0,class:"digit"},Ji={key:1,class:"placeholder"},Xi={class:"controls"},ec={class:"bank"},tc={class:"bank-title"},ac={class:"bank-items"},lc=["onDragstart"],nc={__name:"challenge_level_three_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 5: بطاقات الكسر المفقود",intro:["استخدم البطاقات المرقّمة من ١ إلى ٩ مرة واحدة فقط لتكوين الكسرين بحيث يكون الناتج مساويًا للقيمة المطلوبة.","اسحب الرقم المناسب إلى كل خانة للبسط أو المقام، ثم تحقّق من صحة الناتج."],bank:"البطاقات المتاحة",check:"تحقّق",reset:"مسح الاختيار",newQ:"تحدٍ جديد",clear:"تفريغ",needAll:"املأ كل الخانات أولًا.",wrong:"المعادلة غير صحيحة، جرّب ترتيبًا آخر.",correct:"أحسنت! أنتجت الكسور الصحيحة."},en:{title:"Level 3 – Challenge 5: Missing Fraction Cards",intro:["Use the cards labelled 1 through 9 exactly once to build two fractions whose sum matches the target.","Drag each digit into the correct numerator or denominator, then check your result."],bank:"Available cards",check:"Check",reset:"Reset selection",newQ:"New challenge",clear:"Clear",needAll:"Fill every slot first.",wrong:"The equation is not satisfied—try another arrangement.",correct:"Great! The fractions are correct."}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Le):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Oe):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");const L={n1:["n1a","n1b"],d1:["d1a","d1b"],n2:["n2a","n2b"],d2:["d2a","d2b"],res:["res"]},G=[{id:"p1",solution:{n1:["2","9"],d1:["1","6"],n2:["5","7"],d2:["4","8"],res:["3"]}},{id:"p2",solution:{n1:["3","9"],d1:["2","7"],n2:["6","4"],d2:["1","8"],res:["5"]}},{id:"p3",solution:{n1:["5","7"],d1:["1","3"],n2:["9","4"],d2:["2","6"],res:["8"]}}],T=E(G[0]),A=he({}),f=he({}),d=he({}),S=E(null),M=E(!1),I=["1","2","3","4","5","6","7","8","9"],N=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function H($){if($==null)return"";const y=String($);return D.lang==="ar"?y.replace(/[0-9]/g,u=>N[Number(u)]):y}function X(){Object.keys(A).forEach($=>delete A[$]),Object.keys(f).forEach($=>delete f[$]),Object.keys(d).forEach($=>delete d[$])}function R(){const $=G[Math.floor(Math.random()*G.length)];T.value=$,X(),S.value=null,M.value=!1,I.forEach(y=>{d[y]=1});for(const[y,u]of Object.entries(L)){const p=$.solution[y];p&&u.forEach((b,z)=>{A[b]=null,f[b]=p[z]})}}function j($){$.preventDefault()}function O($,y){$.dataTransfer.setData("text/plain",y)}function W($,y){$.preventDefault();const u=$.dataTransfer.getData("text/plain");if(u&&!((d[u]||0)<=0&&A[y]!==u)){if(A[y]!=null){const p=A[y];d[p]=(d[p]||0)+1}A[y]!==u&&(d[u]=(d[u]||0)-1,d[u]<0&&(d[u]=0)),A[y]=u,S.value=null,M.value=!1}}const J=Q(()=>{const $=[];for(const[y,u]of Object.entries(d))for(let p=0;p<u;p++)$.push({digit:y,key:`${y}-${p}`});return $});function P(){return Object.keys(f).every($=>A[$]!=null)}function h($){const u=L[$].map(p=>A[p]);return Number(u.join(""))}async function m(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function c(){if(!P()){S.value=l[a.value].needAll,k&&k.play();return}const $=h("n1"),y=h("d1"),u=h("n2"),p=h("d2"),b=Number(A.res);if(!y||!p){S.value=l[a.value].wrong,k&&k.play();return}const z=$/y+u/p;Math.abs(z-b)<1e-6?(S.value=l[a.value].correct,M.value=!0,w&&w.play(),B&&B.play(),await m()):(S.value=l[a.value].wrong,k&&k.play())}function g(){for(const $ of Object.keys(A))if(A[$]!=null){const y=A[$];d[y]=(d[y]||0)+1,A[$]=null}S.value=null,M.value=!1}return ge(R),me(()=>D.lang,()=>{M.value||(S.value=null)}),($,y)=>(n(),r("div",{class:"lvl3c5 challenge-surface","data-theme":D.theme},[e("header",Mi,[e("h2",Li,t(l[a.value].title),1),(n(!0),r(te,null,le(l[a.value].intro,(u,p)=>(n(),r("p",{key:p,class:"intro"},t(u),1))),128))]),e("section",Ni,[e("div",Ei,[e("div",Pi,[(n(!0),r(te,null,le(L.n1,u=>(n(),r("div",{key:u,class:"slot",onDragover:j,onDrop:p=>W(p,u)},[A[u]?(n(),r("span",Bi,t(H(A[u])),1)):(n(),r("span",Ri,"?"))],40,zi))),128))]),y[1]||(y[1]=e("div",{class:"bar"},null,-1)),e("div",Oi,[(n(!0),r(te,null,le(L.d1,u=>(n(),r("div",{key:u,class:"slot",onDragover:j,onDrop:p=>W(p,u)},[A[u]?(n(),r("span",Ii,t(H(A[u])),1)):(n(),r("span",Fi,"?"))],40,ji))),128))])]),y[3]||(y[3]=e("span",{class:"op"},"+",-1)),e("div",qi,[e("div",Ui,[(n(!0),r(te,null,le(L.n2,u=>(n(),r("div",{key:u,class:"slot",onDragover:j,onDrop:p=>W(p,u)},[A[u]?(n(),r("span",Vi,t(H(A[u])),1)):(n(),r("span",Wi,"?"))],40,Qi))),128))]),y[2]||(y[2]=e("div",{class:"bar"},null,-1)),e("div",Gi,[(n(!0),r(te,null,le(L.d2,u=>(n(),r("div",{key:u,class:"slot",onDragover:j,onDrop:p=>W(p,u)},[A[u]?(n(),r("span",Ki,t(H(A[u])),1)):(n(),r("span",Yi,"?"))],40,Hi))),128))])]),y[4]||(y[4]=e("span",{class:"op"},"=",-1)),e("div",{class:"target-slot",onDragover:j,onDrop:y[0]||(y[0]=u=>W(u,"res"))},[A.res?(n(),r("span",Zi,t(H(A.res)),1)):(n(),r("span",Ji,"?"))],32)]),e("section",Xi,[e("button",{class:"btn",onClick:c},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:g},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:R},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),e("section",ec,[e("div",tc,t(l[a.value].bank),1),e("div",ac,[(n(!0),r(te,null,le(J.value,u=>(n(),r("button",{key:u.key,class:"chip",draggable:"true",onDragstart:p=>O(p,u.digit)},t(H(u.digit)),41,lc))),128))])]),U(ke,{name:"fade"},{default:be(()=>[S.value?(n(),r("div",{key:0,class:oe(["feedback",{ok:M.value}])},t(S.value),3)):ie("",!0)]),_:1})],8,Ti))}},sc=fe(nc,[["__scopeId","data-v-7304f2b0"]]),oc=["data-theme"],rc={class:"head"},ic={class:"title"},cc={class:"intro"},uc={class:"problem"},dc={class:"decimal-card"},vc={class:"label"},hc={class:"decimal-display"},pc={class:"slots"},fc=["onDrop"],mc={key:0,class:"digit"},gc={key:1,class:"placeholder"},_c=["onClick"],bc={class:"fraction-card"},yc={class:"label"},kc={class:"fraction"},wc={class:"row"},$c=["onDrop"],Cc={key:0,class:"digit"},xc={key:1,class:"placeholder"},Sc=["onClick"],Ac={class:"row"},Dc=["onDrop"],Tc={key:0,class:"digit"},Mc={key:1,class:"placeholder"},Lc=["onClick"],Nc={class:"controls"},Ec={class:"bank"},Pc={class:"bank-title"},zc={class:"bank-items"},Bc=["onDragstart"],Rc={__name:"challenge_level_three_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 6: كسور مكافئة",intro:"اسحب الأرقام المتاحة وضعها في الخانات بحيث يكون الكسر الاعتيادي مساويًا للقيمة العشرية المعطاة.",decimals:"القيمة العشرية",fraction:"الكسر المكافئ",bank:"البطاقات المتاحة",check:"تحقّق",reset:"مسح",newQ:"تحدٍ جديد",clear:"تفريغ",needAll:"املأ كل الخانات أولًا.",wrong:"القيم غير متكافئة، حاول ترتيبًا مختلفًا.",correct:"أحسنت! الكسور مكافئة."},en:{title:"Level 3 – Challenge 6: Equivalent Fractions",intro:"Drag the available digits into the slots so the fraction equals the given decimal value.",decimals:"Decimal value",fraction:"Equivalent fraction",bank:"Available cards",check:"Check",reset:"Clear",newQ:"New challenge",clear:"Clear",needAll:"Fill every slot first.",wrong:"Values are not equivalent. Try another arrangement.",correct:"Great! They are equivalent."}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Ne):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Ee):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");const L=[{id:"p1",decimal:{slots:["dec1","dec2"],digits:["2","5"]},fraction:{num:{slots:["num1"],digits:["1"]},den:{slots:["den1"],digits:["4"]}},digits:["1","2","4","5"]},{id:"p2",decimal:{slots:["dec1","dec2"],digits:["7","5"]},fraction:{num:{slots:["num1"],digits:["3"]},den:{slots:["den1"],digits:["4"]}},digits:["3","4","5","7"]},{id:"p3",decimal:{slots:["dec1"],digits:["6"]},fraction:{num:{slots:["num1"],digits:["3"]},den:{slots:["den1"],digits:["5"]}},digits:["3","5","6"]},{id:"p4",decimal:{slots:["dec1","dec2"],digits:["3","3"]},fraction:{num:{slots:["num1"],digits:["1"]},den:{slots:["den1"],digits:["3"]}},digits:["1","3"]}],G=E(L[0]),T=he({}),A=he({}),f=he({}),d=E(null),S=E(!1);function M(){Object.keys(T).forEach(c=>delete T[c]),Object.keys(A).forEach(c=>delete A[c]),Object.keys(f).forEach(c=>delete f[c])}function I(){const c=L[Math.floor(Math.random()*L.length)];G.value=c,M(),d.value=null,S.value=!1;const{decimal:g,fraction:$}=c;g.slots.forEach((y,u)=>{T[y]=null,A[y]=g.digits[u]}),$.num.slots.forEach((y,u)=>{T[y]=null,A[y]=$.num.digits[u]}),$.den.slots.forEach((y,u)=>{T[y]=null,A[y]=$.den.digits[u]}),c.digits.forEach(y=>{f[y]=(f[y]||0)+1})}function N(c){c.preventDefault()}function H(c,g){c.dataTransfer.setData("text/plain",g)}function X(c,g){c.preventDefault();const $=c.dataTransfer.getData("text/plain");if($&&!((f[$]||0)<=0&&T[g]!==$)){if(T[g]!=null){const y=T[g];f[y]=(f[y]||0)+1}T[g]!==$&&(f[$]=(f[$]||0)-1,f[$]<0&&(f[$]=0)),T[g]=$,S.value=!1,d.value=null}}function R(c){if(T[c]!=null){const g=T[c];f[g]=(f[g]||0)+1,T[c]=null,S.value=!1,d.value=null}}const j=Q(()=>{const c=[];for(const[g,$]of Object.entries(f))for(let y=0;y<$;y++)c.push({digit:g,key:`${g}-${y}`});return c});function O(){return Object.keys(A).every(c=>T[c]!=null)}function W(){return+`0.${G.value.decimal.slots.map($=>T[$]).join("")}`}function J(){const{fraction:c}=G.value,g=c.num.slots.map(p=>T[p]).join(""),$=c.den.slots.map(p=>T[p]).join(""),y=Number(g),u=Number($);return u?y/u:null}async function P(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function h(){if(!O()){d.value=l[a.value].needAll,k&&k.play();return}const c=W(),g=J();if(g==null){d.value=l[a.value].wrong,k&&k.play();return}Math.abs(c-g)<1e-6?(d.value=l[a.value].correct,S.value=!0,w&&w.play(),B&&B.play(),await P()):(d.value=l[a.value].wrong,k&&k.play())}function m(){Object.keys(T).forEach(c=>{if(T[c]!=null){const g=T[c];f[g]=(f[g]||0)+1,T[c]=null}}),S.value=!1,d.value=null}return ge(I),me(()=>D.lang,()=>{S.value||(d.value=null)}),(c,g)=>(n(),r("div",{class:"lvl3c6 challenge-surface","data-theme":D.theme},[e("header",rc,[e("h2",ic,t(l[a.value].title),1),e("p",cc,t(l[a.value].intro),1)]),e("section",uc,[e("div",dc,[e("div",vc,t(l[a.value].decimals),1),e("div",hc,[g[0]||(g[0]=e("span",{class:"fixed"},"0.",-1)),e("div",pc,[(n(!0),r(te,null,le(G.value.decimal.slots,$=>(n(),r("div",{key:$,class:"slot",onDragover:N,onDrop:y=>X(y,$)},[T[$]?(n(),r("span",mc,t(T[$]),1)):(n(),r("span",gc,"?")),e("button",{class:"clear",onClick:y=>R($)},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)],8,_c)],40,fc))),128))])])]),g[2]||(g[2]=e("span",{class:"equals"},"=",-1)),e("div",bc,[e("div",yc,t(l[a.value].fraction),1),e("div",kc,[e("div",wc,[(n(!0),r(te,null,le(G.value.fraction.num.slots,$=>(n(),r("div",{key:$,class:"slot",onDragover:N,onDrop:y=>X(y,$)},[T[$]?(n(),r("span",Cc,t(T[$]),1)):(n(),r("span",xc,"?")),e("button",{class:"clear",onClick:y=>R($)},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)],8,Sc)],40,$c))),128))]),g[1]||(g[1]=e("div",{class:"bar"},null,-1)),e("div",Ac,[(n(!0),r(te,null,le(G.value.fraction.den.slots,$=>(n(),r("div",{key:$,class:"slot",onDragover:N,onDrop:y=>X(y,$)},[T[$]?(n(),r("span",Tc,t(T[$]),1)):(n(),r("span",Mc,"?")),e("button",{class:"clear",onClick:y=>R($)},[U(V(Ce),{class:"ic"}),Z(" "+t(l[a.value].clear),1)],8,Lc)],40,Dc))),128))])])])]),e("section",Nc,[e("button",{class:"btn",onClick:h},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:m},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:I},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),e("section",Ec,[e("div",Pc,t(l[a.value].bank),1),e("div",zc,[(n(!0),r(te,null,le(j.value,$=>(n(),r("button",{key:$.key,class:"chip",draggable:"true",onDragstart:y=>H(y,$.digit)},t($.digit),41,Bc))),128))])]),U(ke,{name:"fade"},{default:be(()=>[d.value?(n(),r("div",{key:0,class:oe(["feedback",{ok:S.value}])},t(d.value),3)):ie("",!0)]),_:1})],8,oc))}},Oc=fe(Rc,[["__scopeId","data-v-46279352"]]),jc=["data-theme"],Ic={class:"head"},Fc={class:"title"},qc={class:"intro"},Uc={class:"status"},Qc={class:"chip"},Vc={class:"chip"},Wc={class:"graph"},Gc={viewBox:"0 0 500 300"},Hc=["x1","y1","x2","y2"],Kc=["x","y"],Yc=["onClick"],Zc=["cx","cy","r"],Jc=["x","y"],Xc={class:"controls"},eu={__name:"challenge_level_three_8",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 8: مسار الضرب",intro:"ابدأ من النقطة أ ثم اختر نقاطًا متصلة للوصول إلى ب بحيث يكون حاصل ضرب الأرقام على الأضلاع مساويًا للقيمة المطلوبة.",target:"القيمة المطلوبة",current:"الحاصل الحالي",check:"تحقّق",reset:"مسح آخر نقطة",newQ:"تحدٍ جديد",clearAll:"إعادة المسار",needStart:"ابدأ من النقطة أ.",invalid:"يجب اختيار نقطة متصلة.",wrong:"المسار لا يعطي القيمة المطلوبة، حاول مرة أخرى.",correct:"أحسنت! المسار يعطي القيمة المطلوبة."},en:{title:"Level 3 – Challenge 8: Multiplication Path",intro:"Start at point A and travel along connected nodes to reach B so the product of edge values equals the required target.",target:"Target product",current:"Current product",check:"Check",reset:"Undo last",newQ:"New challenge",clearAll:"Clear path",needStart:"Start from node A.",invalid:"Pick a connected node.",wrong:"Path does not meet the target—try again.",correct:"Great! The path matches the target."}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Le):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Oe):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");const L=[{id:"p1",target:5,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:90},{id:"RB",x:340,y:210},{id:"CT",x:260,y:70},{id:"C",x:260,y:150},{id:"CB",x:260,y:230},{id:"LT",x:180,y:90},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:.5},{from:"RT",to:"CT",value:1},{from:"CT",to:"C",value:.5},{from:"C",to:"LT",value:2},{from:"LT",to:"B",value:2.5},{from:"A",to:"RB",value:2},{from:"RB",to:"CB",value:1.25},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1},{from:"LB",to:"B",value:2},{from:"CT",to:"CB",value:2},{from:"RT",to:"C",value:1.4},{from:"C",to:"LT",value:1.6}]},{id:"p2",target:6,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:100},{id:"RB",x:340,y:200},{id:"CT",x:260,y:60},{id:"C",x:260,y:150},{id:"CB",x:260,y:240},{id:"LT",x:180,y:100},{id:"LB",x:180,y:200}],edges:[{from:"A",to:"RT",value:1.5},{from:"RT",to:"CT",value:2},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:.5},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:2},{from:"C",to:"LB",value:1},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.2},{from:"C",to:"LT",value:1.5}]},{id:"p3",target:5.4,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:90},{id:"RB",x:340,y:210},{id:"CT",x:260,y:70},{id:"C",x:260,y:150},{id:"CB",x:260,y:230},{id:"LT",x:180,y:90},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:1.2},{from:"RT",to:"CT",value:1.5},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1.5},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:1.4},{from:"RB",to:"CB",value:1.1},{from:"CB",to:"C",value:1.2},{from:"C",to:"LB",value:1.3},{from:"LB",to:"B",value:1.8},{from:"RT",to:"C",value:1.3},{from:"CT",to:"CB",value:1.4}]},{id:"p4",target:4.5,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:110},{id:"RB",x:340,y:210},{id:"CT",x:260,y:90},{id:"C",x:260,y:160},{id:"CB",x:260,y:240},{id:"LT",x:180,y:120},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:1.1},{from:"RT",to:"CT",value:1.3},{from:"CT",to:"C",value:1.2},{from:"C",to:"LT",value:1.25},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:1.5},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1.4},{from:"LB",to:"B",value:1.8},{from:"RT",to:"C",value:1.4},{from:"CT",to:"CB",value:1.1}]},{id:"p5",target:7.2,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:95},{id:"RB",x:340,y:205},{id:"CT",x:260,y:65},{id:"C",x:260,y:150},{id:"CB",x:260,y:235},{id:"LT",x:180,y:105},{id:"LB",x:180,y:205}],edges:[{from:"A",to:"RT",value:1.2},{from:"RT",to:"CT",value:1.5},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1.2},{from:"LT",to:"B",value:1.6},{from:"A",to:"RB",value:.9},{from:"RB",to:"CB",value:1.4},{from:"CB",to:"C",value:1.3},{from:"C",to:"LB",value:2},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.3},{from:"CT",to:"CB",value:1.2}]},{id:"p6",target:4.8,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:105},{id:"RB",x:340,y:215},{id:"CT",x:260,y:75},{id:"C",x:260,y:155},{id:"CB",x:260,y:235},{id:"LT",x:180,y:110},{id:"LB",x:180,y:215}],edges:[{from:"A",to:"RT",value:1.3},{from:"RT",to:"CT",value:1.2},{from:"CT",to:"C",value:1.1},{from:"C",to:"LT",value:1.4},{from:"LT",to:"B",value:1.7},{from:"A",to:"RB",value:1.25},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1.6},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.2},{from:"CT",to:"CB",value:1.3}]}];function G(m,c){const g=c.find(y=>y.id===m.from),$=c.find(y=>y.id===m.to);return{...m,x1:g.x,y1:g.y,x2:$.x,y2:$.y,midX:(g.x+$.x)/2,midY:(g.y+$.y)/2}}const T=E(L[0]),A=E(null),f=E([]),d=E(null),S=E(!1),M=Q(()=>T.value.nodes),I=Q(()=>T.value.edges.map(m=>G(m,M.value))),N=Q(()=>{const m=[];for(let c=0;c<f.value.length-1;c++){const g=f.value[c],$=f.value[c+1],y=I.value.find(u=>u.from===g&&u.to===$||u.from===$&&u.to===g);y&&m.push(y)}return m}),H=Q(()=>N.value.reduce((m,c)=>m*c.value,1));function X(m,c){return I.value.some(g=>g.from===m&&g.to===c||g.from===c&&g.to===m)}function R(){if(L.length===1)return A.value=L[0].id,L[0];let m;do m=L[Math.floor(Math.random()*L.length)];while(m.id===A.value);return A.value=m.id,m}function j(){f.value=[],S.value=!1,d.value=null}function O(){f.value.length>0&&(f.value=f.value.slice(0,-1),S.value=!1,d.value=null)}async function W(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}function J(m){const{start:c,end:g}=T.value;if(!f.value.length){if(m.id!==c){d.value=l[a.value].needStart,k&&k.play();return}f.value=[m.id],d.value=null;return}const $=f.value[f.value.length-1];if(m.id===$)return;if(!X($,m.id)){d.value=l[a.value].invalid,k&&k.play();return}const y=f.value.slice();y.push(m.id),f.value=y,d.value=null,m.id===g&&P()}async function P(){const{end:m,target:c}=T.value;if(f.value[f.value.length-1]!==m){d.value=l[a.value].wrong,k&&k.play();return}Math.abs(H.value-c)<1e-6?(d.value=l[a.value].correct,S.value=!0,w&&w.play(),B&&B.play(),await W()):(d.value=l[a.value].wrong,S.value=!1,k&&k.play())}function h(){const m=R();T.value=m,j()}return ge(h),me(()=>D.lang,()=>{S.value||(d.value=null)}),(m,c)=>(n(),r("div",{class:"lvl3c8 challenge-surface","data-theme":D.theme},[e("header",Ic,[e("h2",Fc,t(l[a.value].title),1),e("p",qc,t(l[a.value].intro),1)]),e("section",Uc,[e("div",Qc,[Z(t(l[a.value].target)+": ",1),e("strong",null,t(T.value.target),1)]),e("div",Vc,[Z(t(l[a.value].current)+": ",1),e("strong",null,t(H.value.toFixed(3)),1)])]),e("section",Wc,[(n(),r("svg",Gc,[(n(!0),r(te,null,le(I.value,g=>(n(),r("g",{key:g.from+g.to},[e("line",{x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2,class:oe(["edge",{active:N.value.includes(g)}])},null,10,Hc),e("text",{x:g.midX,y:g.midY,class:"edge-label"},t(g.value),9,Kc)]))),128)),(n(!0),r(te,null,le(M.value,g=>(n(),r("g",{key:g.id,class:"node",onClick:$=>J(g)},[e("circle",{cx:g.x,cy:g.y,r:g.type?20:12,class:oe(["point",g.type,{selected:f.value.includes(g.id)}])},null,10,Zc),e("text",{x:g.x,y:g.y+4,class:"node-label"},t(g.label||""),9,Jc)],8,Yc))),128))]))]),e("section",Xc,[e("button",{class:"btn",onClick:P},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:O},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:j},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].clearAll),1)]),e("button",{class:"btn",onClick:h},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:be(()=>[d.value?(n(),r("div",{key:0,class:oe(["feedback",{ok:S.value}])},t(d.value),3)):ie("",!0)]),_:1})],8,jc))}},tu=fe(eu,[["__scopeId","data-v-788ee3c8"]]),au=["data-theme"],lu={class:"head"},nu={class:"title"},su={class:"intro"},ou={class:"table"},ru={class:"table-title"},iu={class:"grid"},cu={class:"cell letter"},uu=["onDrop"],du={key:0,class:"value"},vu={key:1,class:"placeholder"},hu=["onClick"],pu={class:"equations"},fu={class:"bank"},mu={class:"bank-title"},gu={class:"bank-items"},_u=["onDragstart"],bu={class:"message"},yu={class:"encoded"},ku={class:"decoded"},wu={class:"controls"},$u={__name:"challenge_level_three_9",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,l={ar:{title:"المستوى الثالث – التحدي 9: شيفرة الرموز",intro:"حلّ المعادلات لتحديد قيمة كل رمز، ثم اسحب الحروف/الأرقام إلى مواقعها لفك الشيفرة.",letters:"التحويل الحرفي",equations:"المعادلات",message:"الرسالة المشفّرة",bank:"بنك القيم",decoded:"الرسالة بعد الفَك",check:"تحقّق",reset:"مسح التعيينات",newQ:"تحدٍ جديد",needAll:"أكمل كل الحروف أولاً.",wrong:"التعيينات غير صحيحة، راجع الحلول.",correct:"رائع! قمت بفك الشيفرة بنجاح."},en:{title:"Level 3 – Challenge 9: Cipher Grid",intro:"Solve each expression to find the value of every symbol, then drag letters/numbers into place to decode the message.",letters:"Letter mapping",equations:"Expressions",message:"Encoded message",bank:"Value bank",decoded:"Decoded message",check:"Check",reset:"Reset assignments",newQ:"New challenge",needAll:"Assign all letters first.",wrong:"Some assignments are incorrect. Try again.",correct:"Great job! You decoded the cipher."}},a=Q(()=>l[D.lang]?D.lang:"ar"),w=typeof Audio!="undefined"?new Audio(Le):null,B=typeof Audio!="undefined"?new Audio($e):null,k=typeof Audio!="undefined"?new Audio(Oe):null;w&&(w.preload="auto"),B&&(B.preload="auto"),k&&(k.preload="auto");const L=[{id:"p1",equations:[{id:"M",expr:"M + 7 = 16",value:9},{id:"A",expr:"A / 2 = 7",value:14},{id:"T",expr:"T - 5 = 16",value:21},{id:"H",expr:"3 * H = 36",value:12},{id:"W",expr:"W - 4 = 14",value:18},{id:"I",expr:"I + 2 = 8",value:6},{id:"Z",expr:"Z / 2 = 13",value:26},{id:"L",expr:"L / 4 = 5",value:20},{id:"E",expr:"2 * E - 4 = 22",value:13},{id:"D",expr:"D + 9 = 25",value:16}],mappingTable:[{letter:"M",value:9},{letter:"A",value:14},{letter:"T",value:21},{letter:"H",value:12},{letter:"W",value:18},{letter:"I",value:6},{letter:"Z",value:26},{letter:"L",value:20},{letter:"E",value:13},{letter:"D",value:16}],message:[9,14,21,12,18,6,26]},{id:"p2",equations:[{id:"V",expr:"V / 3 = 8",value:24},{id:"I",expr:"I + 2 = 7",value:5},{id:"C",expr:"3 * C = 54",value:18},{id:"T",expr:"T + 4 = 16",value:12},{id:"O",expr:"O - 5 = 15",value:20},{id:"R",expr:"R / 3 = 9",value:27},{id:"Y",expr:"2 * Y = 20",value:10},{id:"E",expr:"2 * E + 6 = 34",value:14},{id:"L",expr:"L * 2 = 16",value:8},{id:"S",expr:"S / 4 + 3 = 7",value:16}],mappingTable:[{letter:"V",value:24},{letter:"I",value:5},{letter:"C",value:18},{letter:"T",value:12},{letter:"O",value:20},{letter:"R",value:27},{letter:"Y",value:10},{letter:"E",value:14},{letter:"L",value:8},{letter:"S",value:16}],message:[24,5,18,12,20,27,10]},{id:"p3",equations:[{id:"P",expr:"P + 5 = 16",value:11},{id:"U",expr:"U / 4 = 7",value:28},{id:"Z",expr:"3 * Z = 27",value:9},{id:"L",expr:"L - 6 = 12",value:18},{id:"E",expr:"E + 6 = 21",value:15},{id:"S",expr:"2 * S = 24",value:12},{id:"A",expr:"A / 2 = 11",value:22},{id:"R",expr:"R + 5 = 19",value:14},{id:"T",expr:"T / 5 = 6",value:30},{id:"M",expr:"2 * M = 32",value:16}],mappingTable:[{letter:"P",value:11},{letter:"U",value:28},{letter:"Z",value:9},{letter:"L",value:18},{letter:"E",value:15},{letter:"S",value:12},{letter:"A",value:22},{letter:"R",value:14},{letter:"T",value:30},{letter:"M",value:16}],message:[11,28,9,9,18,15,12]}],G=E(L[0]),T=E(null);function A(){if(L.length===1)return T.value=L[0].id,L[0];let h;do h=L[Math.floor(Math.random()*L.length)];while(h.id===T.value);return T.value=h.id,h}const f=he({}),d=E(null),S=E(!1);function M(){const h=A();G.value=h,Object.keys(f).forEach(m=>delete f[m]),d.value=null,S.value=!1}const I=Q(()=>G.value.mappingTable.map(h=>h.value));Q(()=>G.value.mappingTable.map(h=>h.letter));function N(h){h.preventDefault()}function H(h,m){h.dataTransfer.setData("text/plain",String(m))}function X(h,m){h.preventDefault();const c=h.dataTransfer.getData("text/plain");c&&(f[m]=Number(c),S.value=!1,d.value=null)}function R(h){f[h]!=null&&(f[h]=null,S.value=!1,d.value=null)}const j=Q(()=>G.value.message.map(h=>{const m=G.value.mappingTable.find(c=>f[c.letter]===h);return m?m.letter:"?"}).join(""));function O(){return G.value.mappingTable.every(h=>f[h.letter]!=null)}async function W(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function J(){if(!O()){d.value=l[a.value].needAll,k&&k.play();return}for(const h of G.value.mappingTable)if(f[h.letter]!==h.value){d.value=l[a.value].wrong,k&&k.play();return}d.value=l[a.value].correct,S.value=!0,w&&w.play(),B&&B.play(),await W()}function P(){G.value.mappingTable.forEach(h=>{f[h.letter]=null}),d.value=null,S.value=!1}return ge(M),me(()=>D.lang,()=>{S.value||(d.value=null)}),(h,m)=>(n(),r("div",{class:"lvl3c9 challenge-surface","data-theme":D.theme},[e("header",lu,[e("h2",nu,t(l[a.value].title),1),e("p",su,t(l[a.value].intro),1)]),e("section",ou,[e("div",ru,t(l[a.value].letters),1),e("div",iu,[(n(!0),r(te,null,le(G.value.mappingTable,c=>(n(),r(te,{key:c.letter},[e("div",cu,t(c.letter),1),e("div",{class:"cell slot",onDragover:N,onDrop:g=>X(g,c.letter)},[f[c.letter]!=null?(n(),r("span",du,t(f[c.letter]),1)):(n(),r("span",vu,"?")),e("button",{class:"clear",onClick:g=>R(c.letter)},[U(V(Ce),{class:"ic"})],8,hu)],40,uu)],64))),128))])]),e("section",pu,[e("h3",null,t(l[a.value].equations),1),e("ul",null,[(n(!0),r(te,null,le(G.value.equations,c=>(n(),r("li",{key:c.id},t(c.expr),1))),128))])]),e("section",fu,[e("div",mu,t(l[a.value].bank),1),e("div",gu,[(n(!0),r(te,null,le(I.value,c=>(n(),r("button",{key:c,class:"chip",draggable:"true",onDragstart:g=>H(g,c)},t(c),41,_u))),128))])]),e("section",bu,[e("h3",null,t(l[a.value].message),1),e("div",yu,[(n(!0),r(te,null,le(G.value.message,(c,g)=>(n(),r("span",{key:g},t(c),1))),128))]),e("h4",null,t(l[a.value].decoded),1),e("div",ku,t(j.value),1)]),e("section",wu,[e("button",{class:"btn",onClick:J},[U(V(ye),{class:"ic"}),Z(" "+t(l[a.value].check),1)]),e("button",{class:"btn",onClick:P},[U(V(we),{class:"ic"}),Z(" "+t(l[a.value].reset),1)]),e("button",{class:"btn",onClick:M},[U(V(_e),{class:"ic"}),Z(" "+t(l[a.value].newQ),1)])]),U(ke,{name:"fade"},{default:be(()=>[d.value?(n(),r("div",{key:0,class:oe(["feedback",{ok:S.value}])},t(d.value),3)):ie("",!0)]),_:1})],8,au))}},Cu=fe($u,[["__scopeId","data-v-6f07a60a"]]),Je="ml-toast";function Ie({message:ee,type:D="info",duration:l=2600}={}){var a;ee&&window.dispatchEvent(new CustomEvent(Je,{detail:{message:ee,type:D,duration:l,id:((a=crypto.randomUUID)==null?void 0:a.call(crypto))||Math.random().toString(36).slice(2),timestamp:Date.now()}}))}function xu(ee){return window.addEventListener(Je,ee),()=>window.removeEventListener(Je,ee)}const Xe=E(null),kt=E(null),wt=E(null),$t=E(null),Qe=E(!1),Ve=E(null),et=E(0),Ct=E(null),xt=E(null),St=E(null);async function Su(ee=!1){var l;const D=Date.now();if(!(!ee&&Xe.value!==null&&D-et.value<6e4)&&!Qe.value){Qe.value=!0,Ve.value=null;try{const a=await fetch("/api/method/mathematics_leaders.api.game_points.get_points",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),w=await a.json();if(!a.ok||!((l=w==null?void 0:w.message)!=null&&l.ok))throw new Error((w==null?void 0:w.message)||"Unable to load score");const B=w.message;Xe.value=Number(B.points||0),kt.value=B.rank||1,wt.value=B.players||1,$t.value=Number(B.best||B.points||0),Ct.value=B.profile_image||null,xt.value=B.username||null,St.value=B.game_user_name||null,et.value=D}catch(a){Ve.value=a instanceof Error?a.message:String(a),Ie({message:Ve.value,type:"danger"})}finally{Qe.value=!1}}}function lt(){return{score:Xe,rank:kt,totalPlayers:wt,bestScore:$t,loading:Qe,error:Ve,lastUpdated:et,profileImage:Ct,username:xt,gameUserName:St,refresh:Su}}const Au=["dir","data-theme"],Du={class:"overview"},Tu={class:"panel donut-panel"},Mu={class:"panel__header"},Lu={class:"tier-chip"},Nu=["disabled"],Eu={class:"donut"},Pu={viewBox:"0 0 160 160","aria-hidden":"true"},zu={class:"donut__label"},Bu={class:"panel__footer"},Ru={class:"progress-caption"},Ou={class:"timestamp"},ju={class:"panel spark-panel"},Iu={class:"panel__header"},Fu={class:"panel__title"},qu={class:"spark"},Uu={viewBox:"0 0 180 72","aria-hidden":"true"},Qu=["d"],Vu=["d"],Wu={class:"spark__meta"},Gu={class:"spark__hint"},Hu={class:"metrics"},Ku={class:"metric__label"},Yu={class:"metric__value"},Zu={class:"insights"},Ju={class:"insights__grid"},Xu={class:"insight-card__icon"},ed={class:"insight-card__body"},td={key:0,class:"error"},mt=9,Ke=58,ad={__name:"my_scores",setup(ee){const{score:D,rank:l,totalPlayers:a,bestScore:w,loading:B,error:k,lastUpdated:L,refresh:G}=lt(),T=()=>(document.documentElement.lang||"").toLowerCase().startsWith("en")||(localStorage.getItem("ml_lang")||"").toLowerCase().startsWith("en")?"en":"ar",A=()=>localStorage.getItem("ml_theme")||"light",f=E(T()),d=E(A()),S=Q(()=>f.value==="ar"),M=Q(()=>f.value==="ar"?{totalPoints:"إجمالي النقاط",progressLabel:"التقدم نحو الرتبة التالية",refresh:"تحديث النقاط",lastUpdated:"آخر تحديث",insightHeading:"تحليلات سريعة",scoreTrendTitle:"منحنى الأداء",scoreTrendCopy:"يميل الأداء إلى التحسن خلال آخر المحاولات.",percentRankTitle:"موقعك بين اللاعبين",topTierCopy:"لقد بلغت أعلى رتبة متاحة! استمر في التألق.",nextTierLabel:"المتبقي للوصول للرتبة التالية",recordTitle:"أفضل نتيجة مسجلة",sparkLabel:"تحوّل النقاط (آخر الجلسات)",metricsHeading:"مؤشرات سريعة",playersLabel:"عدد اللاعبين",rankLabel:"ترتيبك",recordLabel:"رقمك القياسي",minutesAgo:"منذ دقائق",justNow:"الآن"}:{totalPoints:"Total points",progressLabel:"Progress to next tier",refresh:"Refresh score",lastUpdated:"Last updated",insightHeading:"Quick insights",scoreTrendTitle:"Performance trend",scoreTrendCopy:"Your recent attempts show an upward trend.",percentRankTitle:"Position among players",topTierCopy:"You already sit at the highest tier—keep shining!",nextTierLabel:"To reach the next tier",recordTitle:"Best recorded score",sparkLabel:"Score changes (recent sessions)",metricsHeading:"Key metrics",playersLabel:"Players",rankLabel:"Your rank",recordLabel:"Personal best",minutesAgo:"minutes ago",justNow:"just now"}),I=[{threshold:0,title:{ar:"مبتدئ الأرقام",en:"Number Novice"}},{threshold:25,title:{ar:"مستكشف الأنماط",en:"Pattern Explorer"}},{threshold:75,title:{ar:"مايسترو الرياضيات",en:"Math Maestro"}},{threshold:150,title:{ar:"أسطورة التحديات",en:"Challenge Legend"}}],N=Q(()=>Number(D.value||0)),H=Q(()=>Number(w.value||0)),X=Q(()=>{let Y=0;return I.forEach((ne,re)=>{N.value>=ne.threshold&&(Y=re)}),Y}),R=Q(()=>I[X.value]),j=Q(()=>I[X.value+1]||null),O=Q(()=>{var Y,ne,re,ue;return((ne=(Y=R.value)==null?void 0:Y.title)==null?void 0:ne[f.value])||((ue=(re=R.value)==null?void 0:re.title)==null?void 0:ue.en)||""}),W=Q(()=>{if(!j.value)return 1;const Y=j.value.threshold-R.value.threshold;return Y<=0?1:Math.min(1,(N.value-R.value.threshold)/Y)}),J=new Intl.NumberFormat("en-US",{maximumFractionDigits:0}),P=Q(()=>J.format(N.value)),h=Q(()=>J.format(H.value)),m=Q(()=>l.value!=null?`#${l.value}`:"--"),c=Q(()=>a.value!=null?J.format(a.value):"--"),g=Q(()=>{if(!L.value)return"--";const Y=Date.now()-L.value;return Y<6e4?M.value.justNow:`${Math.round(Y/6e4)} ${M.value.minutesAgo}`}),$=Q(()=>{const Y=Math.max(N.value,H.value,1),ne=Math.max(10,Y*.45),re=[];for(let ue=0;ue<mt;ue+=1){const Se=ue/(mt-1),ve=Math.sin((N.value+ue)*.35)*Y*.05,xe=Math.max(0,ne+(Y-ne)*Se+ve);re.push(Math.round(xe))}return re[re.length-1]=Math.max(N.value,0),re}),y=Q(()=>{const Y=$.value;if(!Y.length)return[];const ne=180,re=54,ue=Math.max(...Y),Se=Math.min(...Y),ve=ue-Se||1;return Y.map((xe,Pe)=>{const Fe=Y.length===1?ne:ne/(Y.length-1)*Pe,qe=re-(xe-Se)/ve*re;return{x:Number(Fe.toFixed(2)),y:Number(qe.toFixed(2)),value:xe}})}),u=Q(()=>{const Y=y.value;return Y.length?Y.map((ne,re)=>`${re===0?"M":"L"}${ne.x},${ne.y}`).join(" "):""}),p=Q(()=>{const Y=y.value;if(!Y.length)return"";const ne=54,re=Y[0],ue=Y[Y.length-1],Se=Y.map((ve,xe)=>`L${ve.x},${ve.y}`).join(" ");return`M${re.x},${ne} ${Se} L${ue.x},${ne} Z`}),b=Q(()=>{const Y=$.value;return Y.length<2?0:Y[Y.length-1]-Y[0]}),z=2*Math.PI*Ke,v=Q(()=>z*(1-W.value)),s=Q(()=>Math.round(W.value*100)),o=Q(()=>!l.value||!a.value?null:Math.max(0,100-Math.round((l.value-1)/a.value*100))),i={trend:ll,award:Wa,activity:Va,target:gt},_=Q(()=>{const Y=[];if(j.value){const ne=Math.max(0,j.value.threshold-N.value);Y.push({icon:"target",title:M.value.nextTierLabel,body:f.value==="ar"?`تبقى ${J.format(ne)} نقطة للوصول إلى «${j.value.title.ar}».`:`${J.format(ne)} pts to unlock “${j.value.title.en}”.`})}else Y.push({icon:"target",title:M.value.nextTierLabel,body:(f.value==="ar",M.value.topTierCopy)});return Y.push({icon:"trend",title:M.value.scoreTrendTitle,body:f.value==="ar"?`${M.value.scoreTrendCopy} (+${J.format(Math.max(0,b.value))}).`:`${M.value.scoreTrendCopy} (+${J.format(Math.max(0,b.value))}).`}),o.value!=null&&Y.push({icon:"award",title:M.value.percentRankTitle,body:f.value==="ar"?`أنت ضمن أفضل ${o.value}% من اللاعبين.`:`You currently outperform ${o.value}% of players.`}),Y.push({icon:"activity",title:M.value.recordTitle,body:f.value==="ar"?`أفضل نتيجة حققتها هي ${h.value} نقطة.`:`Your personal best sits at ${h.value} pts.`}),Y}),q=Q(()=>[{label:M.value.rankLabel,value:m.value},{label:M.value.playersLabel,value:c.value},{label:M.value.recordLabel,value:h.value}]);function x(){G(!0)}let C=null,F=null,K=null;return ge(()=>{G(!0);const Y=()=>{f.value=T()},ne=()=>{d.value=A()};C=new MutationObserver(Y),C.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"]}),F=new MutationObserver(ne),F.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),K=()=>{Y(),ne()},window.addEventListener("storage",K)}),tt(()=>{C&&C.disconnect(),F&&F.disconnect(),K&&window.removeEventListener("storage",K)}),(Y,ne)=>(n(),r("div",{class:"scores-page",dir:S.value?"rtl":"ltr","data-theme":d.value},[e("section",Du,[e("article",Tu,[e("header",Mu,[e("span",Lu,t(O.value),1),e("button",{class:"refresh","data-ripple":"",disabled:V(B),onClick:x},[U(V(_e),{class:oe(["ic",{spin:V(B)}])},null,8,["class"]),Z(" "+t(M.value.refresh),1)],8,Nu)]),e("div",Eu,[(n(),r("svg",Pu,[ne[0]||(ne[0]=e("defs",null,[e("linearGradient",{id:"donutGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"#c8a03b"}),e("stop",{offset:"100%","stop-color":"#0f8a3e"})])],-1)),e("circle",{class:"track",cx:"80",cy:"80",r:Ke}),e("circle",{class:"progress",cx:"80",cy:"80",r:Ke,style:de({strokeDasharray:`${z}px`,strokeDashoffset:`${v.value}px`})},null,4)])),e("div",zu,[e("strong",null,t(P.value),1),e("span",null,t(M.value.totalPoints),1)])]),e("footer",Bu,[e("div",Ru,[e("span",null,t(M.value.progressLabel),1),e("span",null,t(s.value)+"%",1)]),e("div",Ou,t(M.value.lastUpdated)+" · "+t(g.value),1)])]),e("article",ju,[e("header",Iu,[e("span",Fu,t(M.value.sparkLabel),1)]),e("div",qu,[(n(),r("svg",Uu,[ne[1]||(ne[1]=e("defs",null,[e("linearGradient",{id:"sparkFill",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"rgba(15,138,62,0.35)"}),e("stop",{offset:"100%","stop-color":"rgba(200,160,59,0.05)"})])],-1)),p.value?(n(),r("path",{key:0,class:"spark__area",d:p.value,fill:"url(#sparkFill)"},null,8,Qu)):ie("",!0),u.value?(n(),r("path",{key:1,class:"spark__path",d:u.value},null,8,Vu)):ie("",!0)])),e("div",Wu,[e("span",{class:oe(["spark__delta",{up:b.value>=0}])},t(b.value>=0?"+":"")+t(V(J).format(b.value)),3),e("span",Gu,t(M.value.scoreTrendCopy),1)])]),e("div",Hu,[(n(!0),r(te,null,le(q.value,re=>(n(),r("div",{key:re.label,class:"metric"},[e("span",Ku,t(re.label),1),e("strong",Yu,t(re.value),1)]))),128))])])]),e("section",Zu,[e("h3",null,t(M.value.insightHeading),1),e("div",Ju,[(n(!0),r(te,null,le(_.value,(re,ue)=>(n(),r("article",{key:ue,class:"insight-card"},[e("div",Xu,[(n(),De(Re(i[re.icon]),{class:"glyph"}))]),e("div",ed,[e("h4",null,t(re.title),1),e("p",null,t(re.body),1)])]))),128))]),V(k)?(n(),r("p",td,t(V(k)),1)):ie("",!0)])],8,Au))}},ld=fe(ad,[["__scopeId","data-v-d7a1a530"]]),nd=["dir","data-theme"],sd={class:"settings__header"},od={class:"page-title"},rd={class:"settings__grid"},id={class:"settings-card profile-card"},cd={class:"card-header"},ud={class:"title"},dd={class:"card-body"},vd={class:"avatar-stack"},hd={class:"avatar-orbit"},pd={class:"avatar-ring"},fd=["src"],md={key:1},gd={class:"display-name"},_d={class:"controls"},bd={class:"btn ghost","data-ripple":""},yd=["disabled"],kd={key:"avatar-ok",class:"status success"},wd={key:"avatar-err",class:"status error"},$d={class:"settings-card password-card"},Cd={class:"card-header"},xd={class:"title"},Sd={class:"verify-block"},Ad=["disabled"],Dd={key:"verify-ok",class:"status success"},Td={key:"verify-err",class:"status error"},Md={key:0,class:"password-fields"},Ld={class:"form-actions"},Nd=["disabled"],Ed={key:"pass-ok",class:"status success"},Pd={key:"pass-err",class:"status error"},zd={__name:"settings",setup(ee){const D=lt(),l=()=>(document.documentElement.lang||"").toLowerCase().startsWith("en")||(localStorage.getItem("ml_lang")||"").toLowerCase().startsWith("en")?"en":"ar",a=()=>localStorage.getItem("ml_theme")||"light",w=E(l()),B=E(a()),k=Q(()=>w.value==="ar"),L=Q(()=>w.value==="ar"?{title:"إعدادات الحساب",avatarTitle:"صورة البروفايل",avatarHint:"ارفع صورة مربعة بدقة جيدة (حتى 2 م.ب).",chooseFile:"اختر صورة",cancel:"إزالة التحديد",upload:"حفظ الصورة",loading:"جارٍ الرفع...",changeSuccess:"تم تحديث الصورة بنجاح.",changeError:"تعذر تحديث الصورة، حاول لاحقًا.",passwordTitle:"تغيير كلمة المرور",formHint:"استخدم كلمة مرور قوية تجمع بين الأحرف والأرقام والرموز.",currentPassword:"كلمة المرور الحالية",newPassword:"كلمة المرور الجديدة",confirmPassword:"تأكيد كلمة المرور",verify:"تحقّق",verified:"تم التحقق من كلمة المرور.",verifyError:"تحقق من كلمة المرور الحالية أولًا.",savePassword:"حفظ كلمة المرور",reset:"إعادة التعيين",passwordSuccess:"تم تغيير كلمة المرور بنجاح.",passwordError:"تعذر تغيير كلمة المرور، تحقق من البيانات.",selectImageFirst:"اختر صورة أولًا.",notImage:"الملف ليس صورة.",tooLarge:"حجم الصورة يتجاوز 2 م.ب.",missingPlayer:"تعذر إيجاد ملف اللاعب."}:{title:"Account settings",avatarTitle:"Profile picture",avatarHint:"Upload a crisp square image (up to 2 MB).",chooseFile:"Choose image",cancel:"Remove selection",upload:"Save avatar",loading:"Uploading...",changeSuccess:"Profile picture updated successfully.",changeError:"We could not update your picture. Try again later.",passwordTitle:"Change password",formHint:"Use a strong password that mixes letters, numbers, and symbols.",currentPassword:"Current password",newPassword:"New password",confirmPassword:"Confirm password",verify:"Verify",verified:"Password verified.",verifyError:"Verify your current password first.",savePassword:"Save password",reset:"Reset form",passwordSuccess:"Password updated successfully.",passwordError:"Unable to change password. Check your entries.",selectImageFirst:"Select an image first.",notImage:"The selected file is not an image.",tooLarge:"Image size exceeds 2 MB.",missingPlayer:"Unable to identify player record."}),G=E(null),T=E(""),A=he({loading:!1,message:"",error:""}),f=he({current:"",next:"",confirm:""}),d=he({loading:!1,verified:!1,message:"",error:""}),S=he({loading:!1,message:"",error:""}),M=Q(()=>D.username.value||"Player"),I=Q(()=>M.value.trim().charAt(0).toUpperCase()||"P"),N=Q(()=>T.value||D.profileImage.value||null);function H(m){var g;A.message="",A.error="";const c=(g=m.target.files)==null?void 0:g[0];if(!c){X();return}if(!c.type.startsWith("image/")){A.error=L.value.notImage;return}if(c.size>2*1024*1024){A.error=L.value.tooLarge;return}T.value&&URL.revokeObjectURL(T.value),G.value=c,T.value=URL.createObjectURL(c)}function X(){T.value&&URL.revokeObjectURL(T.value),G.value=null,T.value="",A.message="",A.error=""}async function R(){var c,g;if(!G.value){A.error=L.value.selectImageFirst;return}D.gameUserName.value||await D.refresh(!0);const m=D.gameUserName.value;if(!m){A.error=L.value.missingPlayer;return}A.loading=!0,A.error="",A.message="";try{const $=new FormData;$.append("file",G.value),$.append("filename",G.value.name),$.append("is_private","0"),$.append("attached_to_doctype","Game Users"),$.append("attached_to_name",m);const y=await fetch("/api/method/upload_file",{method:"POST",credentials:"include",body:$}),u=await y.json();if(!y.ok||!((c=u==null?void 0:u.message)!=null&&c.file_url))throw new Error((u==null?void 0:u._server_messages)||(u==null?void 0:u.message)||"Upload failed");const p=u.message.file_url,b=await fetch("/api/method/mathematics_leaders.api.profile.set_profile_image",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_url:p})}),z=await b.json();if(!b.ok||!((g=z==null?void 0:z.message)!=null&&g.ok))throw new Error((z==null?void 0:z.message)||"Unable to store profile image");A.message=L.value.changeSuccess,Ie({message:L.value.changeSuccess,type:"success"}),await D.refresh(!0),X()}catch($){A.error=$ instanceof Error?$.message:L.value.changeError,Ie({message:A.error,type:"danger"})}finally{A.loading=!1}}async function j(){var m;d.loading=!0,d.error="",d.message="";try{if(!f.current)throw new Error(L.value.verifyError);const c=await fetch("/api/method/mathematics_leaders.api.profile.verify_current_password",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:f.current})}),g=await c.json();if(!c.ok||!((m=g==null?void 0:g.message)!=null&&m.ok))throw new Error((g==null?void 0:g.message)||L.value.verifyError);d.verified=!0,d.message=L.value.verified,S.error=""}catch(c){d.verified=!1,d.error=c instanceof Error?c.message:L.value.verifyError}finally{d.loading=!1}}async function O(){var $;if(!d.verified){d.error=L.value.verifyError;return}S.loading=!0,S.message="",S.error="";const{current:m,next:c,confirm:g}=f;try{if(!m||!c||!g)throw new Error(w.value==="ar"?"املأ كل الحقول.":"Fill in every field.");if(c!==g)throw new Error(w.value==="ar"?"كلمتا المرور غير متطابقتين.":"Passwords do not match.");if(c.length<8)throw new Error(w.value==="ar"?"كلمة المرور يجب أن تكون 8 أحرف على الأقل.":"Password must be at least 8 characters.");const y=await fetch("/api/method/mathematics_leaders.api.profile.change_password",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:m,new_password:c})}),u=await y.json();if(!y.ok||!(($=u==null?void 0:u.message)!=null&&$.ok))throw new Error((u==null?void 0:u.message)||L.value.passwordError);S.message=L.value.passwordSuccess,Ie({message:L.value.passwordSuccess,type:"success"}),f.current="",f.next="",f.confirm="",d.verified=!1,d.message=""}catch(y){S.error=y instanceof Error?y.message:L.value.passwordError,Ie({message:S.error,type:"danger"})}finally{S.loading=!1}}function W(){f.current="",f.next="",f.confirm="",d.loading=!1,d.verified=!1,d.message="",d.error="",S.loading=!1,S.message="",S.error=""}let J=null,P=null,h=null;return ge(()=>{D.score.value==null&&D.refresh(!0);const m=()=>{w.value=l()},c=()=>{B.value=a()};J=new MutationObserver(m),J.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"]}),P=new MutationObserver(c),P.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),h=()=>{m(),c()},window.addEventListener("storage",h)}),tt(()=>{T.value&&URL.revokeObjectURL(T.value),J&&J.disconnect(),P&&P.disconnect(),h&&window.removeEventListener("storage",h)}),(m,c)=>(n(),r("div",{class:"settings",dir:k.value?"rtl":"ltr","data-theme":B.value},[e("header",sd,[U(V(el),{class:"heading-icon"}),e("h1",od,t(L.value.title),1)]),e("div",rd,[e("section",id,[e("header",cd,[e("div",ud,[U(V(pt),{class:"icon"}),e("div",null,[e("h2",null,t(L.value.avatarTitle),1),e("p",null,t(L.value.avatarHint),1)])])]),e("div",dd,[e("div",vd,[e("div",hd,[e("div",pd,[N.value?(n(),r("img",{key:0,src:N.value,alt:"avatar preview"},null,8,fd)):(n(),r("span",md,t(I.value),1))])]),e("span",gd,t(M.value),1)]),e("div",_d,[e("label",bd,[U(V(sl),{class:"icon"}),e("span",null,t(L.value.chooseFile),1),e("input",{type:"file",accept:"image/*",onChange:H,hidden:""},null,32)]),G.value?(n(),r("button",{key:0,type:"button",class:"btn subtle","data-ripple":"",onClick:X},t(L.value.cancel),1)):ie("",!0),e("button",{type:"button",class:"btn solid","data-ripple":"",disabled:A.loading,onClick:R},[A.loading?(n(),De(V(Ue),{key:0,class:"icon spinner"})):(n(),De(V(pt),{key:1,class:"icon"})),e("span",null,t(A.loading?L.value.loading:L.value.upload),1)],8,yd)]),U(ke,{name:"fade-slide",mode:"out-in"},{default:be(()=>[A.message?(n(),r("p",kd,[U(V(He),{class:"icon"}),e("span",null,t(A.message),1)])):ie("",!0)]),_:1}),U(ke,{name:"fade-slide",mode:"out-in"},{default:be(()=>[A.error?(n(),r("p",wd,t(A.error),1)):ie("",!0)]),_:1})])]),e("section",$d,[e("header",Cd,[e("div",xd,[U(V(Ya),{class:"icon"}),e("div",null,[e("h2",null,t(L.value.passwordTitle),1),e("p",null,t(L.value.formHint),1)])])]),e("form",{class:"card-body password-form",onSubmit:We(O,["prevent"])},[e("div",Sd,[e("label",null,[e("span",null,t(L.value.currentPassword),1),Te(e("input",{type:"password","onUpdate:modelValue":c[0]||(c[0]=g=>f.current=g),autocomplete:"current-password"},null,512),[[Me,f.current]])]),e("button",{type:"button",class:"btn solid","data-ripple":"",disabled:d.loading,onClick:j},[d.loading?(n(),De(V(Ue),{key:0,class:"icon spinner"})):(n(),De(V(ye),{key:1,class:"icon"})),e("span",null,t(d.loading?L.value.loading:L.value.verify),1)],8,Ad),U(ke,{name:"fade-slide",mode:"out-in"},{default:be(()=>[d.message?(n(),r("p",Dd,[U(V(He),{class:"icon"}),e("span",null,t(d.message),1)])):ie("",!0)]),_:1}),U(ke,{name:"fade-slide",mode:"out-in"},{default:be(()=>[d.error?(n(),r("p",Td,t(d.error),1)):ie("",!0)]),_:1})]),U(ke,{name:"panel-grow"},{default:be(()=>[d.verified?(n(),r("div",Md,[e("label",null,[e("span",null,t(L.value.newPassword),1),Te(e("input",{type:"password","onUpdate:modelValue":c[1]||(c[1]=g=>f.next=g),autocomplete:"new-password",required:""},null,512),[[Me,f.next]])]),e("label",null,[e("span",null,t(L.value.confirmPassword),1),Te(e("input",{type:"password","onUpdate:modelValue":c[2]||(c[2]=g=>f.confirm=g),autocomplete:"new-password",required:""},null,512),[[Me,f.confirm]])]),e("div",Ld,[e("button",{class:"btn success","data-ripple":"",type:"submit",disabled:S.loading},[S.loading?(n(),De(V(Ue),{key:0,class:"icon spinner"})):(n(),De(V(ye),{key:1,class:"icon"})),e("span",null,t(S.loading?L.value.loading:L.value.savePassword),1)],8,Nd),e("button",{type:"button",class:"btn subtle","data-ripple":"",onClick:W},[U(V(_e),{class:"icon"}),e("span",null,t(L.value.reset),1)])]),U(ke,{name:"fade-slide",mode:"out-in"},{default:be(()=>[S.message?(n(),r("p",Ed,[U(V(He),{class:"icon"}),e("span",null,t(S.message),1)])):ie("",!0)]),_:1}),U(ke,{name:"fade-slide",mode:"out-in"},{default:be(()=>[S.error?(n(),r("p",Pd,t(S.error),1)):ie("",!0)]),_:1})])):ie("",!0)]),_:1})],32)])])],8,nd))}},Bd=fe(zd,[["__scopeId","data-v-29b78927"]]),Rd=["dir"],Od=["onClick"],jd={class:"dashboard__topbar"},Id={class:"topbar__left"},Fd=["aria-expanded","aria-label"],qd={class:"brand-chip"},Ud={class:"brand-chip__logo"},Qd=["src"],Vd={class:"brand-chip__text"},Wd={class:"brand-chip__title"},Gd={class:"brand-chip__subtitle"},Hd={class:"topbar__center"},Kd={class:"greet"},Yd={class:"topbar__actions"},Zd=["aria-label"],Jd=["aria-label"],Xd={class:"avatar"},ev={key:1,class:"avatar__initial"},tv={class:"profile__text"},av={class:"profile__name"},lv={class:"profile__meta"},nv={key:0,class:"profile__menu"},sv={class:"dashboard__main"},ov={class:"overview-grid"},rv={class:"welcome-card"},iv={class:"welcome-card__icon"},cv={class:"welcome-card__copy"},uv={class:"welcome-card__metrics"},dv={class:"metric"},vv={class:"metric__label"},hv={class:"metric"},pv={class:"metric__label"},fv=["aria-busy"],mv={key:0,class:"score-card__overlay","aria-hidden":"true"},gv={class:"score-card__ring"},_v={viewBox:"0 0 120 120",role:"presentation"},bv={class:"score-card__center"},yv={class:"score-card__details"},kv={class:"score-card__tier"},wv={class:"score-card__subtitle"},$v=["aria-valuenow"],Cv={class:"progress__track"},xv={class:"progress__meta"},Sv={class:"mentor-card"},Av={class:"mentor-card__badge"},Dv={class:"challenge-section"},Tv={class:"challenge-list__header"},Mv={class:"levels"},Lv=["onClick"],Nv={class:"level-head__info"},Ev={class:"level-head__title"},Pv={class:"level-head__count"},zv={key:0,class:"challenge-cards"},Bv=["onClick"],Rv={class:"challenge-card__symbol"},Ov={class:"challenge-card__body"},jv={class:"challenge-card__title"},Iv={class:"challenge-card__summary"},Fv={class:"challenge-card__cta"},qv={class:"logout-block"},Uv={class:"challenge-preview"},Qv={class:"preview-header"},Vv={key:0,class:"preview-pill"},Wv={class:"preview-text"},Gv={key:0},Hv={key:1},Kv={key:2},Yv={key:3},Zv={key:4},Jv={key:5},Xv={key:6},e1={key:7},t1={class:"preview-surface"},a1={class:"preview-placeholder",key:"placeholder"},l1={__name:"Dashboard",props:{view:{type:String,default:""}},setup(ee){var ot;const D=Pt(),l=ee,a=[{id:"level1",label:{ar:"المستوى الأول",en:"Level One"},challenges:[{id:"challenge_1",component:Tl,symbol:"∑",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"إكمال عملية جمع عمودية بأرقام مخفية.",en:"Complete a column addition puzzle with hidden digits."}},{id:"challenge_2",component:Hl,symbol:"√",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"شبكة أعداد تتزايد بمقدار ثابت، أعد القيم المفقودة.",en:"Fill a number grid that increases by a fixed step."}},{id:"challenge_3",component:un,symbol:"π",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"اختر زوج الأعداد الصحيح حسب المجموع والفرق.",en:"Pick the number pair that matches the given sum and difference."}},{id:"challenge_4",component:Dn,symbol:"×",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"استكمل جدول ضرب مصغر.",en:"Complete the mini multiplication table."}},{id:"challenge_5",component:Xn,symbol:"Δ",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"املأ مثلث الضرب على الأضلاع.",en:"Fill in the edge products of the triangle."}},{id:"challenge_6",component:is,symbol:"≡",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"اختر ثلاث خلايا مختلفة الصف والعمود لتحقيق مجموع محدد.",en:"Pick three distinct-row/column cells to reach the target sum."}},{id:"challenge_7",component:Cs,symbol:"∴",label:{ar:"التحدي 7",en:"Challenge 7"},summary:{ar:"أكمل هرم الجمع بإسقاط القيم الصحيحة.",en:"Complete the sum pyramid with the correct values."}}]},{id:"level2",label:{ar:"المستوى الثاني",en:"Level Two"},challenges:[{id:"challenge_level_two_1",component:Is,symbol:"∫",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"كوّن تعبيرًا يستخدم الأرقام 1 إلى 5 مرة واحدة.",en:"Build an expression that uses digits 1–5 exactly once."}},{id:"challenge_level_two_2",component:eo,symbol:"≠",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"أكمل مربّعًا سحريًا بمجاميع متساوية.",en:"Complete a magic square with equal sums."}},{id:"challenge_level_two_3",component:To,symbol:"≈",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"طابق أعدادًا سداسية مع خواص القسمة.",en:"Match six-digit numbers to divisibility rules."}},{id:"challenge_level_two_4",component:Io,symbol:"∞",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"اختر الزوج الذي يطابق المجموع والفرق.",en:"Choose the pair that matches the required sum and difference."}},{id:"challenge_level_two_5",component:cr,symbol:"∂",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"اكمل طرح الكسور بوضع الأعداد الصحيحة.",en:"Complete the fraction subtraction by placing the right integers."}},{id:"challenge_level_two_6",component:br,symbol:"⊗",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"رتّب خطوات حل معادلة الموازين.",en:"Order the solution steps for the balance puzzle."}}]},{id:"level3",label:{ar:"المستوى الثالث",en:"Level Three"},challenges:[{id:"challenge_level_three_1",component:Pr,symbol:"Φ",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"ابن هرم الضرب من أرقام مبعثرة.",en:"Rebuild the multiplication pyramid from scattered numbers."}},{id:"challenge_level_three_2",component:ei,symbol:"Ψ",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"لغز تفكير متقدم في الأعداد.",en:"An advanced numerical reasoning puzzle."}},{id:"challenge_level_three_3",component:vi,symbol:"Λ",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"لغز منطق متقدم لاختبار السرعة.",en:"Advanced logic to test your speed."}},{id:"challenge_level_three_4",component:Di,symbol:"Ξ",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"تحدٍ عالي المستوى لربط الأنماط.",en:"High-level challenge for spotting patterns."}},{id:"challenge_level_three_5",component:sc,symbol:"Θ",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"مسألة حسابية تحتاج إلى خطوات دقيقة.",en:"A numeric problem that needs careful steps."}},{id:"challenge_level_three_6",component:Oc,symbol:"β",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"إستراتيجية جديدة لبناء الحل خطوة بخطوة.",en:"Strategic puzzle solved step by step."}},{id:"challenge_level_three_8",component:tu,symbol:"η",label:{ar:"التحدي 7",en:"Challenge 7"},summary:{ar:"اختبار المنطق السريع بالأرقام.",en:"Fast-paced numeric logic test."}},{id:"challenge_level_three_9",component:Cu,symbol:"ζ",label:{ar:"التحدي 8",en:"Challenge 8"},summary:{ar:"لغز أخير يجمع بين التفكير والسرعة.",en:"A final puzzle mixing reasoning with speed."}}]}],w=lt(),B=[{threshold:0,title:{ar:"مبتدئ",en:"Novice"}},{threshold:25,title:{ar:"متقدم",en:"Skilled"}},{threshold:80,title:{ar:"قائد",en:"Leader"}},{threshold:160,title:{ar:"أسطورة",en:"Legend"}}],k=Q(()=>Number(w.score.value||0)),L=Q(()=>{let ae=0;return B.forEach((se,ce)=>{k.value>=se.threshold&&(ae=ce)}),ae}),G=Q(()=>B[L.value]),T=Q(()=>B[L.value+1]||null),A=Q(()=>{var ae,se,ce,Ae;return((se=(ae=G.value)==null?void 0:ae.title)==null?void 0:se[h.value])||((Ae=(ce=G.value)==null?void 0:ce.title)==null?void 0:Ae.en)||""}),f=Q(()=>{if(!T.value)return 1;const ae=T.value.threshold-G.value.threshold;return ae<=0?1:Math.min(1,(k.value-G.value.threshold)/ae)}),d=new Intl.NumberFormat("en-US",{maximumFractionDigits:0}),S=Q(()=>d.format(k.value));Q(()=>{const ae=w.rank.value;return ae?`#${ae}`:"--"});const M=Q(()=>{const ae=w.totalPlayers.value;return ae?d.format(ae):"--"}),I=Q(()=>w.loading.value),N=Q(()=>Math.round(f.value*100)),H=Q(()=>w.profileImage.value||null),X=Q(()=>(K.value||w.username.value||F.value||"P").trim().charAt(0).toUpperCase()||"P"),R=Q(()=>I.value?"loading":`score-${k.value}`),j=E(0),O=E(!1);me(f,ae=>{j.value=ae},{immediate:!0}),me(()=>w.score.value,(ae,se)=>{se==null||Number(ae)===Number(se)||(O.value=!1,requestAnimationFrame(()=>{O.value=!0,setTimeout(()=>{O.value=!1},720)}))});function W(){Fe("/scores")}const J={};a.forEach(ae=>{ae.challenges.forEach(se=>{J[se.id]=se.component})});const P={scores:ld,settings:Bd},h=E(localStorage.getItem("ml_lang")||"ar"),m=Q(()=>h.value==="ar"?"rtl":"ltr"),c={ar:{challenges:"المستوى الأول",challenges2:"المستوى الثاني",myScores:"درجاتي",settings:"الإعدادات",logout:"خروج",hello:"مرحبًا",sub:"اختر تحديًا وابدأ اللعب!",challenge:"التحدي",brand:"زعماء الرياضيات",tagline:"رحلة إنجاز رقمية",pickPrompt:"اختر تحديًا من البطاقات أدناه للبدء.",cardCTA:"ابدأ التحدي",scoreWidgetTitle:"نقاطي",scoreWidgetSubtitle:"نظرة سريعة على تقدّمك",scoreWidgetRank:"الترتيب",scoreWidgetPlayers:"عدد اللاعبين",scoreWidgetProgress:"نحو الرتبة التالية",scoreWidgetView:"عرض التفاصيل",scoreWidgetLoading:"جار تحديث النقاط...",teacherTitle:"الشريك التربوي",teacherSubtitle:"ميعاد سفر المالكي",teacherMessage:"✨ “من هنا بدأت الرحلة… رحلة شغف صاغتها الأستاذة ميعاد سفر المالكي لتلهم طلابها نحو الإبداع والتفكير."},en:{challenges:"Level One",challenges2:"Level Two",myScores:"My Scores",settings:"Settings",logout:"Log out",hello:"Hello",sub:"Pick a challenge and start!",challenge:"Challenge",brand:"Math Leaders",tagline:"Interactive mastery journey",pickPrompt:"Select a challenge from the cards below to get started.",cardCTA:"Start challenge",scoreWidgetTitle:"My points",scoreWidgetSubtitle:"Quick glance at your progress",scoreWidgetRank:"Rank",scoreWidgetPlayers:"Players",scoreWidgetProgress:"To next tier",scoreWidgetView:"View details",scoreWidgetLoading:"Refreshing score...",teacherTitle:"Presented by",teacherSubtitle:"Miyaad Safar Al-Malki",teacherMessage:"A heartfelt thanks to Ms. Miyaad Safar Al-Malki for curating these inspiring challenges."}},g=ae=>c[h.value][ae],$=Q(()=>l.view||"");me(h,ae=>{localStorage.setItem("ml_lang",ae),document.documentElement.dir=m.value,document.documentElement.lang=ae});const y=E(localStorage.getItem("ml_theme")||"light"),u=E(!1),p=E(!1),b=E([]);function z(ae){document.documentElement.setAttribute("data-ml-theme",ae)}let v=null;function s(){u.value=!0,window.clearTimeout(s.timer),s.timer=window.setTimeout(()=>{u.value=!1},360)}function o(ae){b.value=b.value.filter(se=>se.id!==ae)}function i(){s(),h.value=h.value==="ar"?"en":"ar"}function _(){s(),y.value=y.value==="light"?"dark":"light"}me(y,ae=>{localStorage.setItem("ml_theme",ae),z(ae)});function q(){if(typeof window=="undefined")return;const ae=window.matchMedia("(max-width: 1024px)").matches;p.value=ae,ae||(ue.value=!1)}function x(ae){re.value&&(re.value.contains(ae.target)||(ne.value=!1))}async function C(ae,se={}){const ce=new URLSearchParams(se).toString(),Ae=await fetch(ae+(ce?`?${ce}`:""),{method:"GET",credentials:"include"}),Ge=await Ae.json().catch(()=>({}));if(!Ae.ok)throw Ge;return Ge}const F=E("player"),K=E("");async function Y(){try{const ae=await C("/api/method/mathematics_leaders.api.get_my_details.get_me"),se=ae==null?void 0:ae.message;if(!(se!=null&&se.ok)){D.replace("/");return}const ce=se.profile||{};F.value=ce.username||"player",K.value=ce.full_name||"",ce.language&&!localStorage.getItem("ml_lang")&&(h.value=ce.language)}catch{D.replace("/")}}const ne=E(!1),re=E(null),ue=E(!1),Se=he(Object.fromEntries(a.map(ae=>[ae.id,!1]))),ve=E(((ot=a[0])==null?void 0:ot.id)||"level1"),xe=E(null);function Pe(){ue.value=!ue.value}function Fe(ae){D.push(ae)}async function qe(){await C("/api/method/logout"),D.replace("/")}function At(ae){Se[ae]=!Se[ae]}function nt(ae){return!!Se[ae]}function Dt(ae,se){Se[ae]=!0,ve.value=ae,xe.value=se,p.value&&(ue.value=!0),D.currentRoute.value.path!=="/home"&&D.push("/home")}function Tt(ae,se){return ve.value===ae&&xe.value===se}const ze=Q(()=>{if(l.view&&P[l.view])return{level:null,challenge:null};if(!xe.value)return{level:a.find(se=>se.id===ve.value)||null,challenge:null};for(const ae of a){const se=ae.challenges.find(ce=>ce.id===xe.value);if(se)return{level:ae,challenge:se}}return{level:a.find(ae=>ae.id===ve.value)||null,challenge:null}}),st=Q(()=>{if(l.view&&P[l.view])return P[l.view];const ae=xe.value;return ae?J[ae]:null});ge(()=>{document.documentElement.dir=m.value,document.documentElement.lang=h.value,z(y.value),Y(),w.refresh(),q(),p.value&&(ue.value=!0),typeof window!="undefined"&&window.addEventListener("resize",q),document.addEventListener("click",x),v=xu(ae=>{const se=ae.detail||{};if(!se.message)return;const ce={id:se.id||Math.random().toString(36).slice(2),message:se.message,type:se.type||"info"};b.value.push(ce),b.value.length>4&&b.value.shift();const Ae=Math.max(1500,se.duration||2600);window.setTimeout(()=>o(ce.id),Ae)})}),tt(()=>{v&&v(),window.clearTimeout(s.timer),typeof window!="undefined"&&window.removeEventListener("resize",q),document.removeEventListener("click",x)});const Mt=new URL("/assets/mathematics_leaders/frontend/assets/logo3.jpeg",import.meta.url).href;return(ae,se)=>(n(),r("div",{class:oe(["dashboard",y.value,{transitioning:u.value}]),dir:m.value},[se[7]||(se[7]=Ye('<div class="dashboard__background" aria-hidden="true" data-v-8874b839><span class="glow glow-one" data-v-8874b839></span><span class="glow glow-two" data-v-8874b839></span><span class="glow glow-three" data-v-8874b839></span><span class="mesh" data-v-8874b839></span></div>',1)),U(Et,{name:"toast-fade",tag:"div",class:"toasts","aria-live":"polite"},{default:be(()=>[(n(!0),r(te,null,le(b.value,ce=>(n(),r("div",{key:ce.id,class:oe(["toast",ce.type])},[se[2]||(se[2]=e("span",{class:"toast__dot"},null,-1)),e("p",null,t(ce.message),1),e("button",{type:"button",class:"toast__close",onClick:Ae=>o(ce.id)},"×",8,Od)],2))),128))]),_:1}),e("header",jd,[e("div",Id,[p.value?(n(),r("button",{key:0,class:"topbar__menu",type:"button",onClick:Pe,"aria-expanded":!ue.value,"aria-label":ue.value?h.value==="ar"?"فتح قائمة التحديات":"Open challenges":h.value==="ar"?"إخفاء قائمة التحديات":"Hide challenges"},[ue.value?(n(),De(V(Za),{key:0})):(n(),De(V(Ga),{key:1,style:de({transform:m.value==="rtl"?"scaleX(-1)":""})},null,8,["style"]))],8,Fd)):ie("",!0),e("div",qd,[e("div",Ud,[e("img",{src:V(Mt),alt:"logo"},null,8,Qd)]),e("div",Vd,[e("span",Wd,t(c[h.value].brand),1),e("span",Gd,t(c[h.value].tagline),1)])])]),e("div",Hd,[U(V(Ka),{class:"wave"}),e("div",Kd,[e("h1",null,t(c[h.value].hello)+" "+t(K.value||F.value),1),e("p",null,t(g("sub")),1)])]),e("div",Yd,[e("button",{class:"action-btn",type:"button","aria-label":y.value==="dark"?h.value==="ar"?"التبديل إلى الوضع الفاتح":"Switch to light theme":h.value==="ar"?"التبديل إلى الوضع الداكن":"Switch to dark theme",onClick:_},[y.value==="light"?(n(),De(V(al),{key:0})):(n(),De(V(Ja),{key:1}))],8,Zd),e("button",{class:"action-btn",type:"button","aria-label":h.value==="ar"?"Switch to English":"التبديل إلى العربية",onClick:i},t(h.value==="ar"?"EN":"ع"),9,Jd),e("div",{class:"profile",ref_key:"profileRef",ref:re,onClick:se[1]||(se[1]=We(ce=>ne.value=!ne.value,["stop"]))},[e("div",Xd,[H.value?(n(),r("span",{key:0,class:"avatar__image",style:de({backgroundImage:`url(${H.value})`})},null,4)):(n(),r("span",ev,t(X.value),1))]),e("div",tv,[e("span",av,t(K.value||F.value),1),e("span",lv,t(c[h.value].brand),1)]),U(V(dt),{class:oe(["profile__chevron",{open:ne.value}])},null,8,["class"]),U(ke,{name:"fade"},{default:be(()=>[ne.value?(n(),r("ul",nv,[e("li",null,[e("button",{type:"button",onClick:se[0]||(se[0]=ce=>Fe("/settings"))},[U(V(Xa)),se[3]||(se[3]=Z()),e("span",null,t(c[h.value].settings),1)])]),e("li",null,[e("button",{type:"button",class:"danger",onClick:qe},[U(V(ft)),se[4]||(se[4]=Z()),e("span",null,t(c[h.value].logout),1)])])])):ie("",!0)]),_:1})],512)])]),e("main",sv,[e("section",ov,[e("article",rv,[e("div",iv,[U(V(ht))]),e("div",cv,[e("h2",null,t(c[h.value].brand),1),e("p",null,t(c[h.value].pickPrompt),1)]),e("div",uv,[e("div",dv,[e("span",vv,t(c[h.value].scoreWidgetRank),1),e("strong",null,t(ae.scoreRankDisplay),1)]),e("div",hv,[e("span",pv,t(c[h.value].scoreWidgetPlayers),1),e("strong",null,t(M.value),1)])])]),e("article",{class:oe(["score-card",{loading:I.value,pulse:O.value}]),"aria-busy":I.value},[I.value?(n(),r("div",mv,[U(V(Ue),{class:"overlay-spinner"})])):ie("",!0),e("div",gv,[(n(),r("svg",_v,[se[5]||(se[5]=e("defs",null,[e("linearGradient",{id:"dashboardScoreGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"#c6a034"}),e("stop",{offset:"100%","stop-color":"#0f8a3e"})])],-1)),se[6]||(se[6]=e("circle",{class:"ring-bg",cx:"60",cy:"60",r:"52"},null,-1)),e("circle",{class:"ring-fg",cx:"60",cy:"60",r:"52",stroke:"url(#dashboardScoreGradient)",style:de({"--progress":j.value})},null,4)])),e("div",bv,[U(ke,{name:"score-flip",mode:"out-in"},{default:be(()=>[(n(),r("span",{class:"score-card__points",key:R.value},t(I.value?"...":S.value),1))]),_:1}),e("small",null,t(c[h.value].scoreWidgetTitle),1)])]),e("div",yv,[e("span",kv,t(A.value),1),e("p",wv,t(I.value?c[h.value].scoreWidgetLoading:c[h.value].scoreWidgetSubtitle),1),e("div",{class:"progress",role:"progressbar","aria-valuenow":N.value,"aria-valuemin":"0","aria-valuemax":"100"},[e("div",Cv,[e("div",{class:"progress__fill",style:de({"--progress":j.value})},null,4)]),e("div",xv,[e("span",null,t(N.value)+"%",1),e("button",{type:"button",class:"progress__link",onClick:W},t(c[h.value].scoreWidgetView),1)])],8,$v)])],10,fv),e("article",Sv,[e("div",Av,t(c[h.value].teacherTitle),1),e("h3",null,t(c[h.value].teacherSubtitle),1),e("p",null,t(c[h.value].teacherMessage),1)])]),e("section",Dv,[e("aside",{class:oe(["challenge-list",{collapsed:ue.value&&p.value}])},[e("header",Tv,[e("h2",null,t(c[h.value].challenge),1),e("p",null,t(c[h.value].pickPrompt),1)]),e("div",Mv,[(n(),r(te,null,le(a,ce=>e("div",{class:"level-block",key:ce.id},[e("button",{type:"button",class:"level-head",onClick:Ae=>At(ce.id)},[e("div",Nv,[U(V(gt),{class:"level-head__icon"}),e("span",Ev,t(ce.label[h.value]),1)]),e("span",Pv,t(ce.challenges.length),1),U(V(dt),{class:oe(["level-head__chevron",{open:nt(ce.id)}])},null,8,["class"])],8,Lv),U(ke,{name:"fade"},{default:be(()=>[nt(ce.id)?(n(),r("div",zv,[(n(!0),r(te,null,le(ce.challenges,Ae=>(n(),r("button",{key:Ae.id,type:"button",class:oe(["challenge-card",{active:Tt(ce.id,Ae.id)}]),onClick:Ge=>Dt(ce.id,Ae.id)},[e("span",Rv,t(Ae.symbol),1),e("div",Ov,[e("span",jv,t(Ae.label[h.value]),1),e("p",Iv,t(Ae.summary[h.value]),1)]),e("span",Fv,t(c[h.value].cardCTA),1)],10,Bv))),128))])):ie("",!0)]),_:2},1024)])),64))]),e("div",qv,[e("button",{type:"button",class:"logout-btn",onClick:qe},[U(V(ft)),e("span",null,t(c[h.value].logout),1)])])],2),e("div",Uv,[e("div",Qv,[ze.value.level?(n(),r("span",Vv,t(ze.value.level.label[h.value]),1)):ie("",!0),e("div",Wv,[$.value==="scores"?(n(),r("h3",Gv,t(c[h.value].myScores),1)):$.value==="settings"?(n(),r("h3",Hv,t(c[h.value].settings),1)):ze.value.challenge?(n(),r("h3",Kv,t(ze.value.challenge.label[h.value]),1)):(n(),r("h3",Yv,t(c[h.value].brand),1)),ze.value.challenge?(n(),r("p",Zv,t(ze.value.challenge.summary[h.value]),1)):$.value==="scores"?(n(),r("p",Jv,t(c[h.value].scoreWidgetSubtitle),1)):$.value==="settings"?(n(),r("p",Xv,t(c[h.value].settings),1)):(n(),r("p",e1,t(c[h.value].pickPrompt),1))])]),e("div",t1,[U(ke,{name:"preview-fade",mode:"out-in"},{default:be(()=>{var ce;return[st.value?(n(),De(Re(st.value),zt({key:$.value||((ce=ze.value.challenge)==null?void 0:ce.id)||"welcome",class:"preview-component"},{lang:h.value,theme:y.value}),null,16)):(n(),r("div",a1,[U(V(ht)),e("p",null,t(c[h.value].pickPrompt),1)]))]}),_:1})])])])])],10,Rd))}},n1=fe(l1,[["__scopeId","data-v-8874b839"]]),s1=Bt({history:Rt("/math-leaders-games/"),routes:[{path:"/",redirect:"/login"},{path:"/login",component:Ia},{path:"/home",component:n1},{path:"/scores",component:()=>it(()=>import("./ScoresView.js"),__vite__mapDeps([0,1]))},{path:"/settings",component:()=>it(()=>import("./SettingsView.js"),__vite__mapDeps([2,1]))}]});Ot(qt).use(s1).mount("#app");export{n1 as D};
//# sourceMappingURL=platform.js.map
