const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/ScoresView.js","js/vue.js","js/SettingsView.js"])))=>i.map(i=>d[i]);
import{r as Et,c as o,o as l,a as Q,b as z,d as W,w as ge,e as _e,f as Ye,g as e,t,u as V,F as te,h as ne,i as ie,n as oe,j as ke,T as $e,k as Ge,l as Me,v as Le,m as J,p as Je,q as ve,s as De,x as je,y as ue,z as zt,A as tt,B as Bt,C as Ot,D as jt,E as Rt,G as It,H as Ft}from"./vue.js";(function(){const D=document.createElement("link").relList;if(D&&D.supports&&D.supports("modulepreload"))return;for(const A of document.querySelectorAll('link[rel="modulepreload"]'))a(A);new MutationObserver(A=>{for(const B of A)if(B.type==="childList")for(const C of B.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&a(C)}).observe(document,{childList:!0,subtree:!0});function n(A){const B={};return A.integrity&&(B.integrity=A.integrity),A.referrerPolicy&&(B.referrerPolicy=A.referrerPolicy),A.crossOrigin==="use-credentials"?B.credentials="include":A.crossOrigin==="anonymous"?B.credentials="omit":B.credentials="same-origin",B}function a(A){if(A.ep)return;A.ep=!0;const B=n(A);fetch(A.href,B)}})();const me=(ee,D)=>{const n=ee.__vccOpts||ee;for(const[a,A]of D)n[a]=A;return n},Ut={},qt={class:"p-6"};function Qt(ee,D){const n=Et("RouterView");return l(),o("main",qt,[Q(n)])}const Ht=me(Ut,[["render",Qt]]),Gt="modulepreload",Wt=function(ee){return"/assets/mathematics_leaders/frontend/"+ee},rt={},it=function(D,n,a){let A=Promise.resolve();if(n&&n.length>0){let Y=function(N){return Promise.all(N.map(T=>Promise.resolve(T).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const C=document.querySelector("meta[property=csp-nonce]"),E=(C==null?void 0:C.nonce)||(C==null?void 0:C.getAttribute("nonce"));A=Y(n.map(N=>{if(N=Wt(N),N in rt)return;rt[N]=!0;const T=N.endsWith(".css"),m=T?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${N}"]${m}`))return;const v=document.createElement("link");if(v.rel=T?"stylesheet":Gt,T||(v.as="script"),v.crossOrigin="",v.href=N,E&&v.setAttribute("nonce",E),document.head.appendChild(v),T)return new Promise((L,x)=>{v.addEventListener("load",L),v.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${N}`)))})}))}function B(C){const E=new Event("vite:preloadError",{cancelable:!0});if(E.payload=C,window.dispatchEvent(E),!E.defaultPrevented)throw C}return A.then(C=>{for(const E of C||[])E.status==="rejected"&&B(E.reason);return D().catch(B)})},Vt=["dir"],Kt={class:"floating-controls"},Yt=["aria-label"],Jt={class:"control-icon","aria-hidden":"true"},Xt={key:0,viewBox:"0 0 24 24",focusable:"false"},Zt={key:1,viewBox:"0 0 24 24",focusable:"false"},ea={class:"control-text"},ta=["aria-label"],aa={class:"landing__wrapper"},na={class:"landing__intro"},la={class:"logo-card"},sa=["src"],oa={class:"intro__title"},ra={class:"intro__subtitle"},ia={class:"feature-grid"},ca={class:"feature-index"},ua={class:"feature-text"},da={class:"stats-row"},va={class:"stat-value"},ha={class:"stat-label"},pa={class:"landing__auth"},fa={class:"auth-card"},ma={class:"auth-tabs",role:"tablist"},ga=["aria-selected"],_a=["aria-selected"],ya={class:"input-field"},ba=["for"],ka=["id","placeholder"],wa={class:"input-field"},$a=["for"],Ca=["id","placeholder"],xa={class:"form-meta"},Sa={href:"#"},Aa=["disabled"],Da={class:"switch-text"},Ta={class:"input-field"},Ma=["for"],La=["id","placeholder"],Na={class:"input-field"},Pa=["for"],Ea=["id","placeholder"],za={class:"input-field"},Ba=["for"],Oa=["id","placeholder"],ja=["disabled"],Ra={class:"switch-text"},Ia={key:0,class:"auth-notice"},Fa="",Ua={__name:"Index",setup(ee){const D=z(localStorage.getItem("ml_lang")||"ar"),n=W(()=>D.value==="ar"?"rtl":"ltr"),a=g=>({en:{signin:"Sign In",signup:"Create Account",username:"Username",password:"Password",confirm:"Confirm Password",login:"Login",register:"Signup",toSignup:"Create account",toSignin:"Back to login",forgot:"Forgot password?"},ar:{signin:"تسجيل الدخول",signup:"إنشاء حساب",username:"اسم المستخدم",password:"كلمة المرور",confirm:"تأكيد كلمة المرور",login:"دخول",register:"تسجيل",toSignup:"إنشاء حساب",toSignin:"العودة لتسجيل الدخول",forgot:"نسيت كلمة المرور؟"}})[D.value][g],A=W(()=>D.value==="ar");function B(){D.value=A.value?"en":"ar"}const C=z(localStorage.getItem("ml_theme")||"light"),E=W(()=>C.value==="dark"),Y=W(()=>A.value?E.value?"فاتح":"داكن":E.value?"Light":"Dark"),N=W(()=>A.value?E.value?"التبديل إلى الوضع الفاتح":"التبديل إلى الوضع الداكن":E.value?"Switch to light theme":"Switch to dark theme");function T(){C.value=E.value?"light":"dark"}function m(g){document.documentElement.setAttribute("data-ml-theme",g)}ge(D,g=>{localStorage.setItem("ml_lang",g),document.documentElement.dir=n.value,document.documentElement.lang=g}),ge(C,g=>{localStorage.setItem("ml_theme",g),m(g)}),_e(()=>{document.documentElement.dir=n.value,document.documentElement.lang=D.value,m(C.value)});const v=z(!1),L=z({username:"",password:""}),x=z({username:"",password:"",confirm:""}),U=z(!1),P=z(null);ge(v,()=>{P.value=null});const q=new URL("/assets/mathematics_leaders/frontend/assets/logo3.jpeg",import.meta.url).href,Z=W(()=>A.value?"منصة زعماء الرياضيات":"Mathematics Leaders Platform"),F=W(()=>A.value?"تعلم الرياضيات بأسلوب ممتع وتفاعلي مصمم للقادة الصغار.":"Master mathematics with playful, interactive journeys built for young leaders."),I=W(()=>A.value?["برامج تفاعلية مدعومة بالذكاء الاصطناعي","تتبع تقدّم ذكي ومباشر","مجتمع محفّز من المعلمين والطلاب"]:["Interactive, AI-guided programmes","Real-time progress insights","A supportive teacher & student community"]),O=W(()=>A.value?[{value:"12+",label:"وحدة تعليمية متدرجة"},{value:"4K",label:"طالب نشط"},{value:"92%",label:"نسبة إكمال المهام"}]:[{value:"12+",label:"Adaptive learning tracks"},{value:"4K",label:"Active learners"},{value:"92%",label:"Task completion rate"}]);async function H(g,u={}){const p=new URLSearchParams(u).toString(),S=await fetch(Fa+g+(p?`?${p}`:""),{method:"GET",credentials:"include"}),b=await S.json().catch(()=>({}));if(!S.ok)throw b;return b}function X(g){if(typeof g=="string")return g;if(g!=null&&g._server_messages)try{const u=JSON.parse(g._server_messages),p=(u==null?void 0:u[0])&&JSON.parse(u[0]);return(p==null?void 0:p.message)||(p==null?void 0:p._error_message)||"Invalid Request"}catch{}return(g==null?void 0:g.message)||(g==null?void 0:g.exc)||"Invalid Request"}function j(g){const u=g||{username:L.value.username};localStorage.setItem("ml_profile",JSON.stringify({...u,language:D.value})),window.location.href="/math-leaders-games/#/home"}async function w(){var g,u;U.value=!0,P.value=null;try{if(v.value){if(!x.value.username||!x.value.password||!x.value.confirm)throw{message:A.value?"الرجاء ملء كل الحقول.":"Please fill all fields."};if(x.value.password!==x.value.confirm)throw{message:A.value?"كلمتا المرور غير متطابقتين.":"Passwords do not match."};await H("/api/method/mathematics_leaders.api.signup_and_login.signup_user",{username:x.value.username,password:x.value.password,language:D.value});const p=await H("/api/method/mathematics_leaders.api.signup_and_login.verify_login",{usr:x.value.username,pwd:x.value.password});j(((g=p==null?void 0:p.message)==null?void 0:g.profile)||{username:x.value.username})}else{const p=await H("/api/method/mathematics_leaders.api.signup_and_login.verify_login",{usr:L.value.username,pwd:L.value.password});j(((u=p==null?void 0:p.message)==null?void 0:u.profile)||{username:L.value.username})}}catch(p){P.value=X(p)}finally{U.value=!1}}return(g,u)=>(l(),o("section",{class:oe(["landing",C.value]),dir:n.value},[u[11]||(u[11]=Ye('<div class="background" aria-hidden="true" data-v-9ae221db><span class="glow glow-one" data-v-9ae221db></span><span class="glow glow-two" data-v-9ae221db></span><span class="glow glow-three" data-v-9ae221db></span><span class="grid" data-v-9ae221db></span></div>',1)),e("div",Kt,[e("button",{type:"button",class:"control-btn theme-toggle","aria-label":N.value,onClick:T},[e("span",Jt,[E.value?(l(),o("svg",Xt,[...u[9]||(u[9]=[Ye('<circle cx="12" cy="12" r="4.2" fill="none" stroke="currentColor" stroke-width="1.6" data-v-9ae221db></circle><line x1="12" y1="2.4" x2="12" y2="5.4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="12" y1="18.6" x2="12" y2="21.6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="2.4" y1="12" x2="5.4" y2="12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="18.6" y1="12" x2="21.6" y2="12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="5.4" y1="5.4" x2="7.7" y2="7.7" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="16.3" y1="16.3" x2="18.6" y2="18.6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="5.4" y1="18.6" x2="7.7" y2="16.3" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line><line x1="16.3" y1="7.7" x2="18.6" y2="5.4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" data-v-9ae221db></line>',9)])])):(l(),o("svg",Zt,[...u[10]||(u[10]=[e("path",{d:"M15.8 21.2a7.6 7.6 0 0 1-6.9-10.6 6.9 6.9 0 0 0 8.5 8.5 7.6 7.6 0 0 1-1.6 2.1Z",fill:"none",stroke:"currentColor","stroke-width":"1.6","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))]),e("span",ea,t(Y.value),1)],8,Yt),e("button",{type:"button",class:"control-btn lang-toggle","aria-label":A.value?"Switch to English":"التبديل إلى العربية",onClick:B},[e("span",null,t(A.value?"EN":"ع"),1)],8,ta)]),e("div",aa,[e("div",na,[e("div",la,[e("img",{src:V(q),alt:"شعار زعماء الرياضيات"},null,8,sa)]),e("h1",oa,t(Z.value),1),e("p",ra,t(F.value),1),e("ul",ia,[(l(!0),o(te,null,ne(I.value,(p,S)=>(l(),o("li",{key:S,class:"feature-item"},[e("span",ca,"0"+t(S+1),1),e("span",ua,t(p),1)]))),128))]),e("div",da,[(l(!0),o(te,null,ne(O.value,(p,S)=>(l(),o("div",{key:S,class:"stat-card"},[e("span",va,t(p.value),1),e("span",ha,t(p.label),1)]))),128))])]),e("div",pa,[e("div",fa,[e("div",ma,[e("button",{type:"button",class:oe(["tab-btn",{active:!v.value}]),role:"tab","aria-selected":!v.value,onClick:u[0]||(u[0]=p=>v.value=!1)},t(a("signin")),11,ga),e("button",{type:"button",class:oe(["tab-btn",{active:v.value}]),role:"tab","aria-selected":v.value,onClick:u[1]||(u[1]=p=>v.value=!0)},t(a("signup")),11,_a)]),Q($e,{name:"slide-fade",mode:"out-in"},{default:ke(()=>[v.value?(l(),o("form",{key:"signup",class:"auth-form",onSubmit:Ge(w,["prevent"])},[e("div",Ta,[e("label",{for:A.value?"signup-username-ar":"signup-username-en"},t(a("username")),9,Ma),Me(e("input",{id:A.value?"signup-username-ar":"signup-username-en","onUpdate:modelValue":u[5]||(u[5]=p=>x.value.username=p),type:"text",placeholder:a("username"),autocomplete:"username",required:""},null,8,La),[[Le,x.value.username]])]),e("div",Na,[e("label",{for:A.value?"signup-password-ar":"signup-password-en"},t(a("password")),9,Pa),Me(e("input",{id:A.value?"signup-password-ar":"signup-password-en","onUpdate:modelValue":u[6]||(u[6]=p=>x.value.password=p),type:"password",placeholder:a("password"),autocomplete:"new-password",required:""},null,8,Ea),[[Le,x.value.password]])]),e("div",za,[e("label",{for:A.value?"signup-confirm-ar":"signup-confirm-en"},t(a("confirm")),9,Ba),Me(e("input",{id:A.value?"signup-confirm-ar":"signup-confirm-en","onUpdate:modelValue":u[7]||(u[7]=p=>x.value.confirm=p),type:"password",placeholder:a("confirm"),autocomplete:"new-password",required:""},null,8,Oa),[[Le,x.value.confirm]])]),e("button",{class:"primary-btn",type:"submit",disabled:U.value},[e("span",null,t(a("register")),1)],8,ja),e("p",Ra,[J(t(A.value?"لديك حساب بالفعل؟":"Already have an account?")+" ",1),e("button",{type:"button",onClick:u[8]||(u[8]=p=>v.value=!1)},t(a("toSignin")),1)])],32)):(l(),o("form",{key:"signin",class:"auth-form",onSubmit:Ge(w,["prevent"])},[e("div",ya,[e("label",{for:A.value?"signin-username-ar":"signin-username-en"},t(a("username")),9,ba),Me(e("input",{id:A.value?"signin-username-ar":"signin-username-en","onUpdate:modelValue":u[2]||(u[2]=p=>L.value.username=p),type:"text",placeholder:a("username"),autocomplete:"username",required:""},null,8,ka),[[Le,L.value.username]])]),e("div",wa,[e("label",{for:A.value?"signin-password-ar":"signin-password-en"},t(a("password")),9,$a),Me(e("input",{id:A.value?"signin-password-ar":"signin-password-en","onUpdate:modelValue":u[3]||(u[3]=p=>L.value.password=p),type:"password",placeholder:a("password"),autocomplete:"current-password",required:""},null,8,Ca),[[Le,L.value.password]])]),e("div",xa,[e("a",Sa,t(a("forgot")),1)]),e("button",{class:"primary-btn",type:"submit",disabled:U.value},[e("span",null,t(a("login")),1)],8,Aa),e("p",Da,[J(t(A.value?"لا تملك حساباً؟":"Don't have an account?")+" ",1),e("button",{type:"button",onClick:u[4]||(u[4]=p=>v.value=!0)},t(a("toSignup")),1)])],32))]),_:1}),P.value?(l(),o("p",Ia,t(P.value),1)):ie("",!0)])])])],10,Vt))}},qa=me(Ua,[["__scopeId","data-v-9ae221db"]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=ee=>ee.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Qa=ee=>ee.replace(/^([A-Z])|[\s-_]+(\w)/g,(D,n,a)=>a?a.toUpperCase():n.toLowerCase()),Ha=ee=>{const D=Qa(ee);return D.charAt(0).toUpperCase()+D.slice(1)},Ga=(...ee)=>ee.filter((D,n,a)=>!!D&&D.trim()!==""&&a.indexOf(D)===n).join(" ").trim(),ut=ee=>ee==="";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Re={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=({name:ee,iconNode:D,absoluteStrokeWidth:n,"absolute-stroke-width":a,strokeWidth:A,"stroke-width":B,size:C=Re.width,color:E=Re.stroke,...Y},{slots:N})=>Je("svg",{...Re,...Y,width:C,height:C,stroke:E,"stroke-width":ut(n)||ut(a)||n===!0||a===!0?Number(A||B||Re["stroke-width"])*24/Number(C):A||B||Re["stroke-width"],class:Ga("lucide",Y.class,...ee?[`lucide-${ct(Ha(ee))}-icon`,`lucide-${ct(ee)}`]:["lucide-icon"])},[...D.map(T=>Je(...T)),...N.default?[N.default()]:[]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=(ee,D)=>(n,{slots:a,attrs:A})=>Je(Wa,{...A,...n,iconNode:D,name:ee},a);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=fe("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=fe("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=fe("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=fe("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=fe("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=fe("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=fe("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=fe("diamond",[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=fe("eraser",[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=fe("hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=fe("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=fe("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=fe("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=fe("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=fe("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=fe("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=fe("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=fe("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=fe("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=fe("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=fe("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=fe("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=fe("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=fe("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=fe("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=fe("triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=fe("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),kt="/assets/mathematics_leaders/frontend/assets/success.mp3",xe="/assets/mathematics_leaders/frontend/assets/clap.mp3",at="/assets/mathematics_leaders/frontend/assets/wrong.mp3",un=["dir","data-theme"],dn={class:"hdr"},vn={class:"sub"},hn={class:"board"},pn={class:"assign",dir:"ltr"},fn=["onDrop"],mn={class:"actions"},gn=["disabled"],_n={class:"col-sum",dir:"ltr"},yn={class:"row"},bn={key:0},kn={class:"row"},wn={key:0},$n={class:"row"},Cn={key:0},xn={class:"digits",dir:"ltr"},Sn={class:"tiles"},An=["onDragstart"],Dn={key:0,class:"overlay"},Tn={class:"sheet"},Mn={class:"big"},Ln={class:"toasts"},Nn={__name:"challenge_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n=z(D.lang),a=z(D.theme);ge(()=>D.lang,$=>n.value=$),ge(()=>D.theme,$=>a.value=$);async function A($,R={}){const d=new URLSearchParams(R).toString(),s=await fetch($+(d?`?${d}`:""),{method:"GET",credentials:"include"}),r=await s.json().catch(()=>({}));if(!s.ok)throw r;return r}const B=W(()=>n.value==="ar"?"rtl":"ltr"),C={ar:{title:"التحدي 1: عملية جمع عمودية بأرقام مفقودة (رموز)",subtitle:"اسحب الأرقام وضعها مكان الرموز حتى تكتمل العملية.",digits:"الأرقام",check:"تحقق",reset:"إعادة ضبط",newQ:"سؤال جديد",correctBig:"أحسنت!",correctSub:"حل صحيح 👏 لقد كسبت نقطة.",wrong:"حاول مرة أخرى 🤔"},en:{title:"Challenge 1: Column addition with missing (symbol) digits",subtitle:"Drag digits onto symbols until the addition becomes correct.",digits:"Digits",check:"Check",reset:"Reset",newQ:"New Question",correctBig:"Great!",correctSub:"Correct 👏 You earned a point.",wrong:"Try again 🤔"}},E=$=>C[n.value][$],Y=new Audio(kt),N=new Audio(xe),T=new Audio(at);Y.preload="auto",N.preload="auto",T.preload="auto";const m={circle:vt,square:ln,triangle:rn,diamond:Ja},v=["circle","square","triangle","diamond"],L=$=>m[$]||vt;function x($,R){return $+Math.floor(Math.random()*(R-$+1))}function U($){return $.slice().sort(()=>Math.random()-.5)}const P=ve({aStr:"",bStr:"",sStr:"",hiddenMap:{},assignMap:{},usedShapes:[]}),q=z([]),Z=z([]),F=z([]);function I(){const $=x(2,3),R=x(2,3),d=x(10**($-1),10**$-1),s=x(10**(R-1),10**R-1),r=d+s;P.aStr=String(d),P.bStr=String(s),P.sStr=String(r);const i=Array.from(new Set((P.aStr+P.bStr+P.sStr).split("").map(G=>+G))),_=Math.min(x(2,3),i.length),f=U(i).slice(0,_),k=U(v).slice(0,_);P.hiddenMap={},f.forEach((G,K)=>{P.hiddenMap[k[K]]=G});const y=new Set;function M(G){return G.split("").map(K=>{var ce;const le=+K,re=(ce=Object.entries(P.hiddenMap).find(([be,he])=>he===le))==null?void 0:ce[0];return re?(y.add(re),{t:"shape",v:re}):{t:"digit",v:K}})}q.value=M(P.aStr),Z.value=M(P.bStr),F.value=M(P.sStr),P.usedShapes=Array.from(y),P.assignMap=Object.fromEntries(P.usedShapes.map(G=>[G,null])),P.usedShapes.length===0&&I()}function O($,R){$.dataTransfer.setData("text/plain",String(R))}function H($,R){const d=Number($.dataTransfer.getData("text/plain"));Number.isNaN(d)||Object.values(P.assignMap).includes(d)&&P.assignMap[R]!==d||(P.assignMap[R]=d,S())}function X($){$.preventDefault()}function j(){Object.keys(P.assignMap).forEach($=>P.assignMap[$]=null)}const w=W(()=>P.usedShapes.every($=>Number.isInteger(P.assignMap[$])));function g($){return Number($.map(R=>{var d;return R.t==="digit"?R.v:(d=P.assignMap[R.v])!=null?d:"?"}).join(""))}function u(){if(!w.value)return!1;const $=g(q.value),R=g(Z.value),d=g(F.value);return![$,R,d].some(s=>String(s).includes("?"))&&$+R===d}const p=ve({open:!1,good:!0});async function S(){if(w.value)if(u()){try{Y.currentTime=0,Y.play().catch(()=>{})}catch{}try{N.currentTime=0,N.play().catch(()=>{})}catch{}p.open=!0,p.good=!0,A("/api/method/mathematics_leaders.api.game_points.add_point",{amount:1}).catch(()=>{})}else{try{T.currentTime=0,T.play().catch(()=>{})}catch{}h(E("wrong"),"warn")}}function b(){p.open=!1,I()}const c=z([]);function h($,R="ok"){const d=Math.random().toString(36).slice(2);c.value.push({id:d,msg:$,type:R}),setTimeout(()=>c.value=c.value.filter(s=>s.id!==d),1800)}return _e(()=>I()),($,R)=>(l(),o("section",{class:"wrap challenge-surface",dir:B.value,"data-theme":a.value},[e("header",dn,[e("h2",null,t(E("title")),1),e("p",vn,t(E("subtitle")),1)]),e("div",hn,[e("div",pn,[(l(!0),o(te,null,ne(P.usedShapes,d=>(l(),o("div",{key:d,class:"slot",onDrop:s=>H(s,d),onDragover:X},[(l(),De(je(L(d)),{class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}})),e("div",{class:oe(["val",{empty:P.assignMap[d]==null}])},t(P.assignMap[d]==null?"…":P.assignMap[d]),3)],40,fn))),128)),e("div",mn,[e("button",{class:"ghost",onClick:j},t(E("reset")),1),e("button",{class:"primary",disabled:!w.value,onClick:S},t(E("check")),9,gn),e("button",{class:"ghost",onClick:I},t(E("newQ")),1)])]),e("div",_n,[e("div",yn,[(l(!0),o(te,null,ne(q.value,(d,s)=>(l(),o("span",{key:"a"+s,class:oe(["cell",d.t])},[d.t==="digit"?(l(),o("span",bn,t(d.v),1)):(l(),De(je(L(d.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))]),R[0]||(R[0]=e("div",{class:"row plus"},[e("span",null,"+")],-1)),e("div",kn,[(l(!0),o(te,null,ne(Z.value,(d,s)=>(l(),o("span",{key:"b"+s,class:oe(["cell",d.t])},[d.t==="digit"?(l(),o("span",wn,t(d.v),1)):(l(),De(je(L(d.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))]),R[1]||(R[1]=e("div",{class:"line"},null,-1)),e("div",$n,[(l(!0),o(te,null,ne(F.value,(d,s)=>(l(),o("span",{key:"s"+s,class:oe(["cell",d.t])},[d.t==="digit"?(l(),o("span",Cn,t(d.v),1)):(l(),De(je(L(d.v)),{key:1,class:"shape-ico",size:26,stroke:"var(--shape-stroke)","stroke-width":2,style:{fill:"var(--shape-fill)"}}))],2))),128))])]),e("div",xn,[e("h4",null,t(E("digits")),1),e("div",Sn,[(l(),o(te,null,ne(10,d=>e("button",{key:d-1,class:"tile",draggable:"true",onDragstart:s=>O(s,d-1)},t(d-1),41,An)),64))])])]),Q($e,{name:"fade"},{default:ke(()=>[p.open?(l(),o("div",Dn,[e("div",Tn,[e("div",Mn,t(E("correctBig")),1),e("p",null,t(E("correctSub")),1),e("button",{class:"primary",onClick:b},t(E("newQ")),1)])])):ie("",!0)]),_:1}),e("div",Ln,[(l(!0),o(te,null,ne(c.value,d=>(l(),o("div",{key:d.id,class:oe(["toast",d.type])},t(d.msg),3))),128))])],8,un))}},Pn=me(Nn,[["__scopeId","data-v-9c65b80b"]]),ze="/assets/mathematics_leaders/frontend/assets/success2.mp3",Ne="/assets/mathematics_leaders/frontend/assets/wrong2.mp3",En=["data-theme"],zn={class:"title"},Bn={class:"rule"},On={class:"layout"},jn={class:"grid"},Rn=["onDrop"],In={key:1,class:"placeholder"},Fn=["value","onInput","onChange","onBlur","placeholder"],Un=["onClick"],qn={class:"bank"},Qn={class:"bank-title"},Hn={class:"bank-items"},Gn=["onDragstart"],Wn={class:"actions"},Vn={key:0,class:"overlay"},Kn={class:"card"},Yn={class:"big"},Jn={__name:"challenge_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"التحدي 2: شبكة أعداد تزيد بمقدار {STEP}",rule:"كل خانة تزيد {STEP} عن اليسار وعن الأعلى. اسحب الأعداد المفقودة إلى أماكنها.",newQ:"سؤال جديد",check:"تحقّق",reset:"إعادة تعيين",correct:"إجابة صحيحة",wrong:"تحقق من القيم",bank:"لوحة الأعداد",clear:"تفريغ الخلية"},en:{title:"Challenge 2: Number grid with step {STEP}",rule:"Each cell increases by {STEP} from its left and from the top. Drag the missing numbers into place.",newQ:"New puzzle",check:"Check",reset:"Reset",correct:"Correct answer",wrong:"Check your values",bank:"Number bank",clear:"Clear cell"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(ze):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Ne):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");function E(f,k){return Math.floor(Math.random()*(k-f+1))+f}function Y(f){const k=f.slice();for(let y=k.length-1;y>0;y--){const M=Math.floor(Math.random()*(y+1));[k[y],k[M]]=[k[M],k[y]]}return k}const N=z(3),T=z(1e3),m=z(0),v=z([]),L=z(new Set),x=z({}),U=z({}),P=z({}),q=z(!1),Z=z(null),F=W(()=>n[a.value].title.replaceAll("{STEP}",T.value)),I=W(()=>n[a.value].rule.replaceAll("{STEP}",T.value));function O(f,k,y){const M=[];for(let G=0;G<f;G++){const K=[];for(let le=0;le<f;le++)K.push(k+y*(G+le));M.push(K)}return M}function H(f){const k=[];for(let M=0;M<f;M++)for(let G=0;G<f;G++)M===0&&G===0||k.push([M,G]);const y=E(3,5);return new Set(Y(k).slice(0,y).map(([M,G])=>`${M},${G}`))}function X(){const f={};L.value.forEach(k=>{const[y,M]=k.split(",").map(Number),G=v.value[y][M];f[G]=(f[G]||0)+1}),P.value=f}const j=[100,200,500,1e3,2e3];function w(){q.value=!1,Z.value=null,x.value={},U.value={},T.value=j[E(0,j.length-1)],m.value=E(5,19)*100;const f=N.value;v.value=O(f,m.value,T.value),L.value=H(f),X()}const g=W(()=>{const f=[];for(const[k,y]of Object.entries(P.value))for(let M=0;M<y;M++)f.push(Number(k));return Y(f)});function u(f,k,{fromManual:y=!1}={}){if(!Number.isNaN(k)){if(x.value[f]!=null){const M=x.value[f];P.value[M]=(P.value[M]||0)+1}(P.value[k]||0)<=0||(P.value[k]-=1,x.value[f]=k,U.value={...U.value,[f]:String(k)},Z.value=null,q.value=!1)}}function p(f,k){f.dataTransfer.setData("text/plain",String(k))}function S(f){f.preventDefault()}function b(f,k){f.preventDefault();const y=Number(f.dataTransfer.getData("text/plain"));u(k,y)}function c(f){if(x.value[f]!=null){const k=x.value[f];P.value[k]=(P.value[k]||0)+1,delete x.value[f]}U.value={...U.value,[f]:""},Z.value=null,q.value=!1}function h(f,k){U.value={...U.value,[f]:k}}function $(f){var M;const k=((M=U.value[f])!=null?M:"").trim();if(k===""){c(f);return}const y=Number(k);Number.isFinite(y)&&u(f,y,{fromManual:!0})}function R(){for(const f of L.value)if(x.value[f]==null)return!1;return!0}function d(){if(!R())return!1;for(const f of L.value){const[k,y]=f.split(",").map(Number);if(x.value[f]!==v.value[k][y])return!1}return!0}async function s(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function r(){if(!R()){Z.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",C&&C.play();return}d()?(q.value=!0,Z.value=n[a.value].correct,A&&A.play(),B&&B.play(),await s()):(Z.value=n[a.value].wrong,C&&C.play())}function i(){x.value={},U.value={},X(),Z.value=null,q.value=!1}const _=W(()=>({direction:"ltr",unicodeBidi:"isolate"}));return _e(w),ge(()=>D.lang,()=>{q.value||(Z.value=null)}),(f,k)=>(l(),o("div",{class:"challenge2 challenge-surface","data-theme":D.theme},[e("h2",zn,t(F.value),1),e("p",Bn,t(I.value),1),e("div",On,[e("div",jn,[(l(!0),o(te,null,ne(N.value,y=>(l(),o("div",{key:"r"+y,class:"row"},[(l(!0),o(te,null,ne(N.value,M=>{var G;return l(),o("div",{key:"c"+y+"-"+M,class:"cell"},[L.value.has(`${y-1},${M-1}`)?(l(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:S,onDrop:K=>b(K,`${y-1},${M-1}`)},[x.value[`${y-1},${M-1}`]!=null?(l(),o("span",{key:0,class:"num filled",style:ue(_.value)},t(x.value[`${y-1},${M-1}`]),5)):(l(),o("span",In,"؟"))],40,Rn),e("input",{class:"manual-entry",type:"number",value:(G=U.value[`${y-1},${M-1}`])!=null?G:"",onInput:K=>h(`${y-1},${M-1}`,K.target.value),onChange:K=>$(`${y-1},${M-1}`),onBlur:K=>$(`${y-1},${M-1}`),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,Fn),e("button",{class:"clear",onClick:K=>c(`${y-1},${M-1}`)},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)],8,Un)],64)):(l(),o("span",{key:0,class:"num",style:ue(_.value)},t(v.value[y-1][M-1]),5))])}),128))]))),128))]),e("div",qn,[e("div",Qn,t(n[a.value].bank),1),e("div",Hn,[(l(!0),o(te,null,ne(g.value,y=>(l(),o("button",{key:y+"_"+Math.random(),class:"chip",style:ue(_.value),draggable:"true",onDragstart:M=>p(M,y)},t(y),45,Gn))),128))]),e("div",Wn,[e("button",{class:"btn",onClick:i},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn primary",onClick:r},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:w},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),Z.value?(l(),o("div",{key:0,class:oe(["toast",{ok:q.value}])},t(Z.value),3)):ie("",!0)])]),q.value?(l(),o("div",Vn,[e("div",Kn,[e("div",Yn,t(n[a.value].correct),1),e("button",{class:"btn primary",onClick:w},t(n[a.value].newQ),1)])])):ie("",!0)],8,En))}},Xn=me(Jn,[["__scopeId","data-v-540279f2"]]),Pe="/assets/mathematics_leaders/frontend/assets/success3.mp3",Fe="/assets/mathematics_leaders/frontend/assets/wrong3.mp3",Zn=["data-theme"],el={class:"title"},tl={class:"rule"},al={class:"qs"},nl={class:"qtext"},ll={class:"opts"},sl=["onClick"],ol=["onClick"],rl={class:"toolbar"},il={class:"status"},cl={key:0,class:"done"},ul={class:"actions"},dl=4,vl={__name:"challenge_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"التحدي 3: إيجاد عددين من المجموع والفرق",rule:"اختر الزوج الصحيح (أكبر، أصغر) بحيث يكون مجموعهما S والفرق بينهما D.",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"إجابة غير صحيحة",done:"أكملت هذه الجولة",q:(F,I,O)=>`(${F}) جد عددين ناتج جمعهما ${I} والفرق بينهما ${O}`},en:{title:"Challenge 3: Find two numbers from sum and difference",rule:"Pick the correct pair (greater, smaller) with sum S and difference D.",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Incorrect",done:"Round completed",q:(F,I,O)=>`(${F}) Find two numbers with sum ${I} and difference ${O}`}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(Pe):null,B=typeof Audio!="undefined"?new Audio(Fe):null;A&&(A.preload="auto"),B&&(B.preload="auto");function C(F,I){return Math.floor(Math.random()*(I-F+1))+F}function E(F){const I=F.slice();for(let O=I.length-1;O>0;O--){const H=Math.floor(Math.random()*(O+1));[I[O],I[H]]=[I[H],I[O]]}return I}const Y=z([]),N=W(()=>Y.value.filter(F=>{var I;return F.judged&&((I=F.options[F.pickedIndex])==null?void 0:I.isAns)}).length),T=W(()=>Y.value.length>0&&Y.value.every(F=>F.judged));function m(F,I){return[(F+I)/2,(F-I)/2]}function v(F){return Number.isInteger(F)&&F>=0}function L(){let F,I,O,H;for(;F=C(10,60),I=C(0,20),!((F&1)===(I&1)&&!(F<I)&&([O,H]=m(F,I),v(O)&&v(H))););const X=new Set,j=(g,u)=>{const p=`${g},${u}`;g>=0&&u>=0&&Number.isInteger(g)&&Number.isInteger(u)&&p!==`${O},${H}`&&X.add(p)};j(O+1,H-1),j(O-1,H+1),j(O+2,H-2),j(O-2,H+2),j(O+1,H),j(O,H+1);const w=[{a:O,b:H,isAns:!0}];for(const g of Array.from(X).slice(0,3)){const[u,p]=g.split(",").map(S=>Number(S));if(w.push({a:u,b:p,isAns:!1}),w.length===4)break}for(;w.length<4;){const g=C(-3,3),u=C(-3,3),p=Math.max(0,O+g),S=Math.max(0,H+u);p===O&&S===H||w.push({a:p,b:S,isAns:!1})}return{S:F,D:I,ans:[O,H],options:E(w),pickedIndex:null,judged:!1,firstTry:!0}}function x(){Y.value=Array.from({length:dl},()=>L())}function U(){for(const F of Y.value)F.pickedIndex=null,F.judged=!1,F.firstTry=!0}async function P(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function q(F,I){if(F.judged)return;F.pickedIndex=I,F.judged=!0,F.options[I].isAns?(A&&A.play(),T.value&&A&&A.play(),F.firstTry&&await P()):B&&B.play()}function Z(F){F.judged=!1,F.firstTry=!1,F.pickedIndex=null}return _e(x),ge(()=>D.lang,()=>{}),(F,I)=>(l(),o("div",{class:"challenge3 challenge-surface","data-theme":D.theme},[e("h2",el,t(n[a.value].title),1),e("p",tl,t(n[a.value].rule),1),e("div",al,[(l(!0),o(te,null,ne(Y.value,(O,H)=>(l(),o("div",{key:H,class:"qcard"},[e("div",nl,t(n[a.value].q(H+1,O.S,O.D)),1),e("div",ll,[(l(!0),o(te,null,ne(O.options,(X,j)=>(l(),o("button",{key:j,class:oe(["opt",{chosen:O.pickedIndex===j,ok:O.judged&&O.options[j].isAns,bad:O.judged&&O.pickedIndex===j&&!O.options[j].isAns}]),onClick:w=>q(O,j)}," ( "+t(X.a)+" ، "+t(X.b)+" ) ",11,sl))),128))]),O.judged?(l(),o("div",{key:0,class:oe(["feedback",{ok:O.options[O.pickedIndex].isAns}])},[J(t(O.options[O.pickedIndex].isAns?n[a.value].correct:n[a.value].wrong)+" ",1),O.options[O.pickedIndex].isAns?ie("",!0):(l(),o("button",{key:0,class:"retry",onClick:X=>Z(O)},"↺",8,ol))],2)):ie("",!0)]))),128))]),e("div",rl,[e("div",il,[Q(V(we),{class:"ic"}),J(" "+t(N.value)+" / "+t(Y.value.length)+" ",1),T.value&&N.value===Y.value.length?(l(),o("span",cl," · "+t(n[a.value].done),1)):ie("",!0)]),e("div",ul,[e("button",{class:"btn",onClick:U},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn",onClick:x},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])])])],8,Zn))}},hl=me(vl,[["__scopeId","data-v-fd4f6cf1"]]),wt="/assets/mathematics_leaders/frontend/assets/success4.mp3",$t="/assets/mathematics_leaders/frontend/assets/wrong4.mp3",pl=["data-theme"],fl={class:"title"},ml={class:"rule"},gl={class:"wrap"},_l={class:"table"},yl=["onDrop"],bl={key:1,class:"placeholder"},kl=["value","onInput","onChange","onBlur","placeholder"],wl=["onClick"],$l={class:"side"},Cl={class:"bank-title"},xl={class:"bank-items"},Sl=["onDragstart"],Al={class:"actions"},Dl={key:0,class:"overlay"},Tl={class:"card"},Ml={class:"big"},Oe=3,Ll={__name:"challenge_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"التحدي 4: أكمل جدول الضرب",rule:"جدول ضرب بعناوين صفوف وأعمدة. اسحب القيم الصحيحة من الأسفل إلى الخانات الفارغة.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 4: Complete the multiplication table",rule:"A multiplication table with row/column headers. Drag correct values into the blanks.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check your values",clear:"Clear cell"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(wt):null,B=typeof Audio!="undefined"?new Audio($t):null;A&&(A.preload="auto"),B&&(B.preload="auto");function C(s,r){return Math.floor(Math.random()*(r-s+1))+s}function E(s){const r=s.slice();for(let i=r.length-1;i>0;i--){const _=Math.floor(Math.random()*(i+1));[r[i],r[_]]=[r[_],r[i]]}return r}const Y=z([]),N=z([]),T=z(new Set),m=z({}),v=z({}),L=z({}),x=z(!1),U=z(null);function P(s,r){return s===0&&r===0?"×":s===0?N.value[r-1]:r===0?Y.value[s-1]:Y.value[s-1]*N.value[r-1]}const q=(s,r)=>s===0||r===0?`h:${s},${r}`:`c:${s},${r}`;function Z(s){return E([1,2,3,4,5,6,7,8,9]).slice(0,s).sort((r,i)=>r-i)}function F(){const s=[];for(let k=0;k<=Oe;k++)for(let y=0;y<=Oe;y++)k===0&&y===0||s.push([k,y]);const r=s.filter(([k,y])=>k>0&&y>0),i=E(r)[0],_=s.filter(([k,y])=>!(k===i[0]&&y===i[1])),f=C(6,8);return new Set(E(_).slice(0,f).map(([k,y])=>q(k,y)))}function I(){const s={};T.value.forEach(r=>{const[,i]=r.split(":"),[_,f]=i.split(",").map(Number),k=P(_,f);s[k]=(s[k]||0)+1});for(const[r,i]of Object.entries(m.value))s[i]=(s[i]||0)-1;for(const[r,i]of Object.entries(s))i<=0&&delete s[r];L.value=s}const O=W(()=>{const s=[];for(const[r,i]of Object.entries(L.value))for(let _=0;_<i;_++)s.push(Number(r));return E(s)});function H(){x.value=!1,U.value=null,m.value={},v.value={},Y.value=Z(Oe),N.value=Z(Oe),T.value=F(),I()}function X(){for(const s of T.value)if(m.value[s]==null)return!1;return!0}function j(){if(!X())return!1;for(const s of T.value){const[,r]=s.split(":"),[i,_]=r.split(",").map(Number);if(m.value[s]!==P(i,_))return!1}return!0}async function w(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function g(){if(!X()){U.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",B&&B.play();return}j()?(x.value=!0,U.value=n[a.value].correct,A&&A.play(),await w()):(U.value=n[a.value].wrong,B&&B.play())}function u(){m.value={},v.value={},I(),U.value=null,x.value=!1}function p(s,r,{fromManual:i=!1}={}){if(!Number.isNaN(r)){if(m.value[s]!=null){const _=m.value[s];L.value[_]=(L.value[_]||0)+1}(L.value[r]||0)!==0&&(L.value[r]-=1,m.value[s]=r,v.value={...v.value,[s]:String(r)},U.value=null,x.value=!1)}}function S(s,r){s.dataTransfer.setData("text/plain",String(r))}function b(s){s.preventDefault()}function c(s,r){s.preventDefault();const i=Number(s.dataTransfer.getData("text/plain"));p(r,i)}function h(s){if(m.value[s]!=null){const r=m.value[s];L.value[r]=(L.value[r]||0)+1,delete m.value[s]}v.value={...v.value,[s]:""},U.value=null,x.value=!1}function $(s,r){v.value={...v.value,[s]:r}}function R(s){var _;const r=((_=v.value[s])!=null?_:"").trim();if(r===""){h(s);return}const i=Number(r);Number.isFinite(i)&&p(s,i,{fromManual:!0})}const d=W(()=>({direction:"ltr",unicodeBidi:"isolate"}));return _e(H),ge(()=>D.lang,()=>{x.value||(U.value=null)}),(s,r)=>(l(),o("div",{class:"challenge4 challenge-surface","data-theme":D.theme},[e("h2",fl,t(n[a.value].title),1),e("p",ml,t(n[a.value].rule),1),e("div",gl,[e("div",_l,[(l(!0),o(te,null,ne(Oe+1,i=>(l(),o("div",{class:"row",key:"r"+i},[(l(!0),o(te,null,ne(Oe+1,_=>{var f;return l(),o("div",{class:oe(["cell",{head:i===1||_===1,corner:i===1&&_===1,body:!(i===1||_===1)}]),key:"c"+i+"-"+_},[i===1&&_===1?(l(),o(te,{key:0},[J("×")],64)):T.value.has(i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`)?(l(),o(te,{key:2},[e("div",{class:"dropzone",onDragover:b,onDrop:k=>c(k,i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`)},[m.value[i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`]!=null?(l(),o("span",{key:0,class:"num",style:ue(d.value)},t(m.value[i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`]),5)):(l(),o("span",bl,"؟"))],40,yl),e("input",{class:"manual-entry",type:"number",value:(f=v.value[i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`])!=null?f:"",onInput:k=>$(i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`,k.target.value),onChange:k=>R(i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`),onBlur:k=>R(i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,kl),e("button",{class:"clear",onClick:k=>h(i===1||_===1?`h:${i-1},${_-1}`:`c:${i-1},${_-1}`)},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)],8,wl)],64)):(l(),o("span",{key:1,class:"num",style:ue(d.value)},t(P(i-1,_-1)),5))],2)}),128))]))),128))]),e("div",$l,[e("div",Cl,t(n[a.value].bank),1),e("div",xl,[(l(!0),o(te,null,ne(O.value,i=>(l(),o("button",{key:i+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:_=>S(_,i),style:ue(d.value)},t(i),45,Sl))),128))]),e("div",Al,[e("button",{class:"btn",onClick:u},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn primary",onClick:g},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:H},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),U.value?(l(),o("div",{key:0,class:oe(["toast",{ok:x.value}])},t(U.value),3)):ie("",!0)])]),x.value?(l(),o("div",Dl,[e("div",Tl,[e("div",Ml,t(n[a.value].correct),1),e("button",{class:"btn primary",onClick:H},t(n[a.value].newQ),1)])])):ie("",!0)],8,pl))}},Nl=me(Ll,[["__scopeId","data-v-dac8e647"]]),Pl="/assets/mathematics_leaders/frontend/assets/wrong5.mp3",El=["data-theme"],zl={class:"title"},Bl={class:"rule"},Ol={class:"tri-wrap"},jl={class:"square left-sq"},Rl={key:1,class:"placeholder"},Il=["value","placeholder"],Fl={class:"square right-sq"},Ul={key:1,class:"placeholder"},ql=["value","placeholder"],Ql={class:"square base-sq"},Hl={key:1,class:"placeholder"},Gl=["value","placeholder"],Wl={class:"side"},Vl={class:"bank-title"},Kl={class:"bank-items"},Yl=["onDragstart"],Jl={class:"actions"},Xl={key:0,class:"overlay"},Zl={class:"card"},es={class:"big"},ts=4,as={__name:"challenge_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"التحدي 5: مخطط مثلث (ضرب)",rule:"كل مربع على الضلع يساوي حاصل ضرب العدديْن في الدائرتيْن المجاورتين له. اسحب القيم المفقودة إلى المربعات.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 5: Triangle product",rule:"Each edge-square equals the product of the two adjacent circles. Drag missing values into the squares.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check your values",clear:"Clear cell"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(ze):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Pl):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");function E(d,s){return Math.floor(Math.random()*(s-d+1))+d}function Y(d){const s=d.slice();for(let r=s.length-1;r>0;r--){const i=Math.floor(Math.random()*(r+1));[s[r],s[i]]=[s[i],s[r]]}return s}const N=z([2,3,4]),T=z({t:0,l:0,r:0}),m=z(new Set),v=z({}),L=z({}),x=z({}),U=z(!1),P=z(null);function q(){const d=Y([2,3,4,5,6,7,8,9]).slice(0,3);N.value=[d[0],d[1],d[2]];const[s,r,i]=N.value;T.value={l:s*r,r:s*i,t:r*i}}function Z(){const d=["l","r","t"],s=E(2,3);m.value=new Set(Y(d).slice(0,s))}function F(){const d={};m.value.forEach(r=>{const i=T.value[r];d[i]=(d[i]||0)+1});for(const[r,i]of Object.entries(v.value))d[i]=(d[i]||0)-1;for(const[r,i]of Object.entries(d))i<=0&&delete d[r];const s=ts;{const r=new Set(Object.keys(d).map(Number)),i=new Set(Object.values(T.value)),_=[];for(let f=4;f<=81;f++)!r.has(f)&&!i.has(f)&&_.push(f);for(let f=0;f<s&&_.length;f++){const k=Math.floor(Math.random()*_.length),y=_.splice(k,1)[0];d[y]=(d[y]||0)+1}}x.value=d}const I=W(()=>{const d=[];for(const[s,r]of Object.entries(x.value))for(let i=0;i<r;i++)d.push(Number(s));return Y(d)});function O(){U.value=!1,P.value=null,v.value={},L.value={},q(),Z(),F()}function H(){for(const d of m.value)if(v.value[d]==null)return!1;return!0}function X(){if(!H())return!1;for(const d of m.value)if(v.value[d]!==T.value[d])return!1;return!0}async function j(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function w(){if(!H()){P.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",C&&C.play();return}X()?(U.value=!0,P.value=n[a.value].correct,A&&A.play(),B&&B.play(),await j()):(P.value=n[a.value].wrong,C&&C.play())}function g(){v.value={},F(),P.value=null,U.value=!1}function u(d,s){d.dataTransfer.setData("text/plain",String(s))}function p(d){d.preventDefault()}function S(d,s,{fromManual:r=!1}={}){if(!Number.isNaN(s)){if(v.value[d]!=null){const i=v.value[d];x.value[i]=(x.value[i]||0)+1}if(r)(x.value[s]||0)>0&&(x.value[s]-=1);else{if((x.value[s]||0)===0)return;x.value[s]-=1}v.value[d]=s,L.value={...L.value,[d]:String(s)},P.value=null}}function b(d,s){d.preventDefault();const r=Number(d.dataTransfer.getData("text/plain"));S(s,r)}function c(d){if(v.value[d]!=null){const s=v.value[d];x.value[s]=(x.value[s]||0)+1,delete v.value[d]}L.value={...L.value,[d]:""}}function h(d,s){L.value={...L.value,[d]:s}}function $(d){var i;const s=((i=L.value[d])!=null?i:"").trim();if(s===""){c(d);return}const r=Number(s);Number.isFinite(r)&&S(d,r,{fromManual:!0})}const R=W(()=>({direction:"ltr",unicodeBidi:"isolate"}));return _e(O),ge(()=>D.lang,()=>{}),(d,s)=>{var r,i,_;return l(),o("div",{class:"challenge5 challenge-surface","data-theme":D.theme},[e("h2",zl,t(n[a.value].title),1),e("p",Bl,t(n[a.value].rule),1),e("div",Ol,[s[15]||(s[15]=e("svg",{class:"links",viewBox:"0 0 300 260",preserveAspectRatio:"none"},[e("line",{x1:"150",y1:"40",x2:"60",y2:"140"}),e("line",{x1:"150",y1:"40",x2:"240",y2:"140"}),e("line",{x1:"60",y1:"140",x2:"240",y2:"140"})],-1)),e("div",{class:"circle top",style:ue(R.value)},t(N.value[0]),5),e("div",{class:"circle left",style:ue(R.value)},t(N.value[1]),5),e("div",{class:"circle right",style:ue(R.value)},t(N.value[2]),5),e("div",jl,[m.value.has("l")?(l(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:p,onDrop:s[0]||(s[0]=f=>b(f,"l"))},[v.value.l!=null?(l(),o("span",{key:0,class:"num",style:ue(R.value)},t(v.value.l),5)):(l(),o("span",Rl,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(r=L.value.l)!=null?r:"",onInput:s[1]||(s[1]=f=>h("l",f.target.value)),onChange:s[2]||(s[2]=f=>$("l")),onBlur:s[3]||(s[3]=f=>$("l")),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,Il),e("button",{class:"clear",onClick:s[4]||(s[4]=f=>c("l"))},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)])],64)):(l(),o("span",{key:0,class:"num",style:ue(R.value)},t(T.value.l),5))]),e("div",Fl,[m.value.has("r")?(l(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:p,onDrop:s[5]||(s[5]=f=>b(f,"r"))},[v.value.r!=null?(l(),o("span",{key:0,class:"num",style:ue(R.value)},t(v.value.r),5)):(l(),o("span",Ul,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(i=L.value.r)!=null?i:"",onInput:s[6]||(s[6]=f=>h("r",f.target.value)),onChange:s[7]||(s[7]=f=>$("r")),onBlur:s[8]||(s[8]=f=>$("r")),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,ql),e("button",{class:"clear",onClick:s[9]||(s[9]=f=>c("r"))},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)])],64)):(l(),o("span",{key:0,class:"num",style:ue(R.value)},t(T.value.r),5))]),e("div",Ql,[m.value.has("t")?(l(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:p,onDrop:s[10]||(s[10]=f=>b(f,"t"))},[v.value.t!=null?(l(),o("span",{key:0,class:"num",style:ue(R.value)},t(v.value.t),5)):(l(),o("span",Hl,"؟"))],32),e("input",{class:"manual-entry",type:"number",value:(_=L.value.t)!=null?_:"",onInput:s[11]||(s[11]=f=>h("t",f.target.value)),onChange:s[12]||(s[12]=f=>$("t")),onBlur:s[13]||(s[13]=f=>$("t")),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,Gl),e("button",{class:"clear",onClick:s[14]||(s[14]=f=>c("t"))},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)])],64)):(l(),o("span",{key:0,class:"num",style:ue(R.value)},t(T.value.t),5))])]),e("div",Wl,[e("div",Vl,t(n[a.value].bank),1),e("div",Kl,[(l(!0),o(te,null,ne(I.value,f=>(l(),o("button",{key:f+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:k=>u(k,f),style:ue(R.value)},t(f),45,Yl))),128))]),e("div",Jl,[e("button",{class:"btn",onClick:g},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn",onClick:w},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:O},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),P.value?(l(),o("div",{key:0,class:oe(["toast",{ok:U.value}])},t(P.value),3)):ie("",!0)]),U.value?(l(),o("div",Xl,[e("div",Zl,[e("div",es,t(n[a.value].correct),1),e("button",{class:"btn",onClick:O},t(n[a.value].newQ),1)])])):ie("",!0)],8,El)}}},ns=me(as,[["__scopeId","data-v-d3434538"]]),ls=["data-theme"],ss={class:"title"},os={class:"rule"},rs=["aria-pressed","onClick"],is={class:"panel"},cs={class:"actions"},us={__name:"challenge_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"التحدي 6: اختر ثلاث خلايا من شبكة بحيث لا تكون في الصف أو العمود نفسه ويكون مجموعها الهدف",rule:(w,g)=>`شبكة ${w}×${w}. اختر ثلاث خلايا كلٌّ منها في صف وعمود مختلفين بحيث يساوي مجموعها ${g}.`,newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيود أو من المجموع",pick3:"اختر ثلاث خلايا"},en:{title:"Challenge 6: Pick 3 cells in different rows and columns to reach the target",rule:(w,g)=>`A ${w}×${w} grid. Pick three cells, one per distinct row and column, that sum to ${g}.`,newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check constraints or sum",pick3:"Pick three cells"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(kt):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Fe):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");function E(w,g){return Math.floor(Math.random()*(g-w+1))+w}function Y(w){const g=w.slice();for(let u=g.length-1;u>0;u--){const p=Math.floor(Math.random()*(u+1));[g[u],g[p]]=[g[p],g[u]]}return g}const N=z(3),T=z([]),m=z(0),v=z([]),L=z(!1),x=z(null),U=W(()=>({direction:"ltr",unicodeBidi:"isolate"})),P=W(()=>T.value.flatMap((w,g)=>w.map((u,p)=>({v:u,r:g,c:p})))),q=W(()=>v.value.reduce((w,g)=>w+T.value[g.r][g.c],0));function Z(){L.value=!1,x.value=null,v.value=[],N.value=[3,4][E(0,1)],T.value=Array.from({length:N.value},()=>Array.from({length:N.value},()=>E(1,9)));const w=Y([...Array(N.value).keys()]).slice(0,3),g=Y([...Array(N.value).keys()]).slice(0,3),u=Y(g.slice()),p=w.map((S,b)=>({r:S,c:u[b]}));m.value=p.reduce((S,b)=>S+T.value[b.r][b.c],0)}_e(Z);function F(){v.value=[],x.value=null,L.value=!1}function I(w,g){if(L.value)return;const u=v.value.findIndex(p=>p.r===w&&p.c===g);if(u>=0){v.value.splice(u,1);return}v.value.length!==3&&v.value.push({r:w,c:g})}function O(){return new Set(v.value.map(w=>w.r)).size===v.value.length}function H(){return new Set(v.value.map(w=>w.c)).size===v.value.length}async function X(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function j(){if(v.value.length!==3){x.value=n[a.value].pick3,C&&C.play();return}if(!O()||!H()){x.value=n[a.value].wrong,C&&C.play();return}q.value===m.value?(L.value=!0,x.value=n[a.value].correct,A&&A.play(),B&&B.play(),await X()):(x.value=n[a.value].wrong,C&&C.play())}return(w,g)=>(l(),o("div",{class:"challenge6 challenge-surface","data-theme":D.theme},[e("h2",ss,t(n[a.value].title),1),e("p",os,t(n[a.value].rule(N.value,m.value)),1),e("div",{class:"grid",style:ue({"--n":N.value})},[(l(!0),o(te,null,ne(P.value,u=>(l(),o("button",{key:u.r+"-"+u.c,class:oe(["cell",{picked:v.value.some(p=>p.r===u.r&&p.c===u.c)}]),"aria-pressed":v.value.some(p=>p.r===u.r&&p.c===u.c),onClick:p=>I(u.r,u.c),style:ue(U.value)},t(u.v),15,rs))),128))],4),e("div",is,[e("div",cs,[e("button",{class:"btn",onClick:F},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn primary",onClick:j},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:Z},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),x.value?(l(),o("div",{key:0,class:oe(["toast",{ok:L.value}])},t(x.value),3)):ie("",!0)])],8,ls))}},ds=me(us,[["__scopeId","data-v-eae91c5a"]]),vs=["data-theme"],hs={class:"title"},ps={class:"rule"},fs={class:"pyramid"},ms=["onDrop"],gs={key:1,class:"placeholder"},_s=["value","onInput","onChange","onBlur","placeholder"],ys=["onClick"],bs={class:"side"},ks={class:"bank-title"},ws={class:"bank-items"},$s=["onDragstart"],Cs={class:"actions"},xs=6,Ss={__name:"challenge_7",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"التحدي 7: جدار أعداد (هرم جمع)",rule:"كل خانة تساوي مجموع الخليتين اللتين تحتها مباشرة. اسحب القيم المفقودة لإكمال الهرم.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Challenge 7: Sum Pyramid",rule:"Each cell equals the sum of the two cells directly below. Drag missing values to complete the pyramid.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check your values",clear:"Clear cell"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(Pe):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(at):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");function E(s,r){return Math.floor(Math.random()*(r-s+1))+s}function Y(s){const r=s.slice();for(let i=r.length-1;i>0;i--){const _=Math.floor(Math.random()*(i+1));[r[i],r[_]]=[r[_],r[i]]}return r}const N=z(4),T=z([]),m=z(new Set),v=z({}),L=z({}),x=z({}),U=z(!1),P=z(null),q=W(()=>({direction:"ltr",unicodeBidi:"isolate"}));function Z(s){const r=[];r[0]=Array.from({length:s},()=>E(1,9));for(let i=1;i<s;i++)r[i]=Array.from({length:s-i},(_,f)=>r[i-1][f]+r[i-1][f+1]);return r}const F=(s,r)=>`${s},${r}`;function I(s){const r=new Set;for(let f=1;f<s;f++){const k=E(0,T.value[f].length-1);r.add(F(f,k))}const i=[];for(let f=1;f<s;f++)for(let k=0;k<T.value[f].length;k++)r.has(F(f,k))||i.push([f,k]);const _=E(4,6);return new Set(Y(i).slice(0,_).map(([f,k])=>F(f,k)))}function O(){const s={};m.value.forEach(f=>{const[k,y]=f.split(",").map(Number),M=T.value[k][y];s[M]=(s[M]||0)+1});for(const f of Object.values(v.value))s[f]=(s[f]||0)-1;for(const[f,k]of Object.entries(s))k<=0&&delete s[f];const r=new Set(Object.keys(s).map(Number)),i=new Set(T.value.flat()),_=[];for(let f=2;f<=150;f++)!r.has(f)&&!i.has(f)&&_.push(f);Y(_).slice(0,xs).forEach(f=>{s[f]=(s[f]||0)+1}),x.value=s}const H=W(()=>{const s=[];for(const[r,i]of Object.entries(x.value))for(let _=0;_<i;_++)s.push(Number(r));return Y(s)});function X(){U.value=!1,P.value=null,v.value={},L.value={},T.value=Z(N.value),m.value=I(N.value),O()}_e(X),ge(()=>D.lang,()=>{U.value||(P.value=null)});function j(){for(const s of m.value)if(v.value[s]==null)return!1;return!0}function w(){if(!j())return!1;for(const s of m.value){const[r,i]=s.split(",").map(Number);if(v.value[s]!==T.value[r][i])return!1}return!0}async function g(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function u(){if(!j()){P.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",C&&C.play();return}w()?(U.value=!0,P.value=n[a.value].correct,A&&A.play(),B&&B.play(),await g()):(P.value=n[a.value].wrong,C&&C.play())}function p(){v.value={},L.value={},O(),P.value=null,U.value=!1}function S(s,r){s.dataTransfer.setData("text/plain",String(r))}function b(s){s.preventDefault()}function c(s,r,{fromManual:i=!1}={}){if(!Number.isNaN(r)){if(v.value[s]!=null){const _=v.value[s];x.value[_]=(x.value[_]||0)+1}!i&&(x.value[r]||0)===0||(x.value[r]=(x.value[r]||0)-1,x.value[r]<0&&(x.value[r]=0),v.value[s]=r,L.value={...L.value,[s]:String(r)},P.value=null)}}function h(s,r){s.preventDefault();const i=Number(s.dataTransfer.getData("text/plain"));c(r,i)}function $(s){if(v.value[s]!=null){const r=v.value[s];x.value[r]=(x.value[r]||0)+1,delete v.value[s]}L.value={...L.value,[s]:""}}function R(s,r){L.value={...L.value,[s]:r}}function d(s){var _;const r=((_=L.value[s])!=null?_:"").trim();if(r===""){$(s);return}const i=Number(r);Number.isFinite(i)&&c(s,i,{fromManual:!0})}return(s,r)=>(l(),o("div",{class:"challenge7 challenge-surface","data-theme":D.theme},[e("h2",hs,t(n[a.value].title),1),e("p",ps,t(n[a.value].rule),1),e("div",fs,[(l(!0),o(te,null,ne(T.value,(i,_)=>(l(),o("div",{class:"prow",key:"r"+_,style:ue({"--cols":i.length})},[(l(!0),o(te,null,ne(i,(f,k)=>{var y;return l(),o("div",{class:"cell",key:_+"-"+k},[m.value.has(`${_},${k}`)?(l(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:b,onDrop:M=>h(M,`${_},${k}`)},[v.value[`${_},${k}`]!=null?(l(),o("span",{key:0,class:"num",style:ue(q.value)},t(v.value[`${_},${k}`]),5)):(l(),o("span",gs,"؟"))],40,ms),e("input",{class:"manual-entry",type:"number",value:(y=L.value[`${_},${k}`])!=null?y:"",onInput:M=>R(`${_},${k}`,M.target.value),onChange:M=>d(`${_},${k}`),onBlur:M=>d(`${_},${k}`),placeholder:D.lang==="ar"?"أدخل رقمًا":"Enter value"},null,40,_s),e("button",{class:"clear",onClick:M=>$(`${_},${k}`)},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)],8,ys)],64)):(l(),o("span",{key:0,class:"num",style:ue(q.value)},t(f),5))])}),128))],4))),128))]),e("div",bs,[e("div",ks,t(n[a.value].bank),1),e("div",ws,[(l(!0),o(te,null,ne(H.value,i=>(l(),o("button",{key:i+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:_=>S(_,i),style:ue(q.value)},t(i),45,$s))),128))]),e("div",Cs,[e("button",{class:"btn",onClick:p},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn primary",onClick:u},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:X},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),P.value?(l(),o("div",{key:0,class:oe(["toast",{ok:U.value}])},t(P.value),3)):ie("",!0)])],8,vs))}},As=me(Ss,[["__scopeId","data-v-3e993bb9"]]),Ds="/assets/mathematics_leaders/frontend/assets/oh_no.mp3",Ts=["data-theme"],Ms={class:"title"},Ls={class:"rule"},Ns={class:"panel"},Ps=["placeholder"],Es={class:"usage"},zs={class:"keypad"},Bs={class:"label"},Os={class:"row"},js=["onClick"],Rs=["onClick"],Is={class:"actions"},Fs={class:"hint"},Us={__name:"challenge_level_two_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"التحدي 1 (المستوى الثاني): كوّن جملة عددية تستعمل 1،2،3،4،5 دون تكرار",rule:j=>`اكتب تعبيراً حسابياً يستخدم الأرقام ١،٢،٣،٤،٥ مرة واحدة فقط ويكون ناتجه ${j}. المسموح: + − × ÷ والأقواس. لا أرقام أخرى أو تكرار.`,inputPH:"اكتب التعبير هنا… مثل: (5*4)*(3+2)*1",keys:"لوحة المفاتيح",newQ:"سؤال جديد",reset:"مسح",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من الشروط أو من النتيجة",used:"استخدام الأرقام:",note:"تلميح: يمكنك دائماً استعمال ×1 دون تغيير النتيجة."},en:{title:"Level 2 – Challenge 1: Build an expression with 1..5 once each",rule:j=>`Write an expression that uses digits 1,2,3,4,5 exactly once and evaluates to ${j}. Allowed: + - * / and parentheses. No other digits or repeats.`,inputPH:"Type expression… e.g., (5*4)*(3+2)*1",keys:"Keypad",newQ:"New puzzle",reset:"Clear",check:"Check",correct:"Correct",wrong:"Check constraints or value",used:"Digits usage:",note:"Hint: multiplying by 1 keeps the value unchanged."}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(ze):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Ds):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");function E(j,w){return Math.floor(Math.random()*(w-j+1))+j}function Y(j){const w=j.slice();for(let g=w.length-1;g>0;g--){const u=Math.floor(Math.random()*(g+1));[w[g],w[u]]=[w[u],w[g]]}return w}const N=z(""),T=z(0),m=z(null),v=z(!1),L=[1,2,3,4,5],x=["+","-","*","/","(",")"];function U(){const j=Y([2,3,4,5]),[w,g,u,p]=j,S=i=>i[E(0,i.length-1)],b=S(["+","-","*","/"]),c=S(["+","-","*","/"]),h=S(["+","-","*","/"]),$=i=>{try{return Function(`"use strict";return(${i})`)()}catch{return null}};let R=`( ${w} ${b} ${g} ) ${c} ( ${u} ${h} ${p} )`,d=$(R),s=0;for(;(d==null||!isFinite(d))&&s<20;){const i=Y([2,3,4,5]),[_,f,k,y]=i,M=S(["+","-","*","/"]),G=S(["+","-","*","/"]),K=S(["+","-","*","/"]);R=`( ${_} ${M} ${f} ) ${G} ( ${k} ${K} ${y} )`,d=$(R),s++}const r=Math.random()<.7?`(${R}) * 1`:`((${R}) + 1) - 1`;T.value=$(r),N.value="",m.value=null,v.value=!1}function P(j){N.value+=j}function q(){N.value=N.value.slice(0,-1)}function Z(){N.value="",m.value=null,v.value=!1}const F=W(()=>{const j={1:0,2:0,3:0,4:0,5:0};for(const w of N.value)"12345".includes(w)&&j[w]++;return j});function I(j){return/^[\d\+\-\*\/\(\)\s×÷]*$/.test(j)}function O(){if(/[06789]/.test(N.value))return!1;const j=F.value;return L.every(w=>j[w]===1)}function H(j){try{return!I(j)||(j=j.replace(/×/g,"*").replace(/÷/g,"/"),/\b(?![1-5]\b)\d+\b/.test(j))?null:Function(`"use strict";return(${j})`)()}catch{return null}}async function X(){const j=H(N.value);if(j==null||!isFinite(j)||!O()){m.value=n[a.value].wrong,C&&C.play();return}if(Math.abs(j-T.value)<1e-9){v.value=!0,m.value=n[a.value].correct,A&&A.play(),B&&B.play();try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}else m.value=n[a.value].wrong,C&&C.play()}return _e(U),(j,w)=>(l(),o("div",{class:"lvl2c1 challenge-surface","data-theme":D.theme},[e("h2",Ms,t(n[a.value].title),1),e("p",Ls,t(n[a.value].rule(T.value)),1),e("div",Ns,[Me(e("input",{class:"expr",placeholder:n[a.value].inputPH,"onUpdate:modelValue":w[0]||(w[0]=g=>N.value=g),dir:"ltr",inputmode:"numeric",autocomplete:"off",spellcheck:"false"},null,8,Ps),[[Le,N.value]]),e("div",Es,[J(t(n[a.value].used)+" ",1),(l(),o(te,null,ne(L,g=>e("span",{key:g,class:oe(["u",{ok:F.value[g]===1,bad:F.value[g]>1}])},t(g)+": "+t(F.value[g]),3)),64))]),e("div",zs,[e("div",Bs,t(n[a.value].keys),1),e("div",Os,[(l(),o(te,null,ne(L,g=>e("button",{class:"k",key:"d"+g,onClick:u=>P(String(g))},t(g),9,js)),64)),(l(),o(te,null,ne(x,g=>e("button",{class:"k",key:"o"+g,onClick:u=>P(g)},t(g),9,Rs)),64)),e("button",{class:"k wide",onClick:q},"⌫")])]),e("div",Is,[e("button",{class:"btn",onClick:Z},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn primary",onClick:X},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:U},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),e("div",Fs,t(n[a.value].note),1),m.value?(l(),o("div",{key:0,class:oe(["toast",{ok:v.value}])},t(m.value),3)):ie("",!0)])],8,Ts))}},qs=me(Us,[["__scopeId","data-v-206c1ce3"]]),Qs=["data-theme"],Hs={class:"title"},Gs={class:"rule"},Ws={class:"board"},Vs=["onDrop"],Ks={key:1,class:"placeholder"},Ys=["onClick"],Js={class:"side"},Xs={class:"bank-title"},Zs={class:"bank-items"},eo=["onDragstart"],to={class:"actions"},ao={__name:"challenge_level_two_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثاني – التحدي 2: أكمل مربعاً سحرياً",rule:r=>`ضع الأعداد بحيث يكون مجموع كل صف وعمود وقطر مساوياً ${r}. اسحب القيم المفقودة إلى أماكنها. الأعداد جميعها مختلفة.`,bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من المجاميع أو التكرار",clear:"تفريغ الخلية"},en:{title:"Level 2 – Challenge 2: Complete a magic square",rule:r=>`Place numbers so each row, column, and diagonal sums to ${r}. Drag the missing values into place. All numbers are distinct.`,bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check sums or duplicates",clear:"Clear cell"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(ze):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Ne):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");function E(r,i){return Math.floor(Math.random()*(i-r+1))+r}function Y(r){const i=r.slice();for(let _=i.length-1;_>0;_--){const f=Math.floor(Math.random()*(_+1));[i[_],i[f]]=[i[f],i[_]]}return i}const N=[[8,1,6],[3,5,7],[4,9,2]];function T(r){const i=G=>[[G[2][0],G[1][0],G[0][0]],[G[2][1],G[1][1],G[0][1]],[G[2][2],G[1][2],G[0][2]]],_=G=>G.map(K=>K.slice().reverse()),f=[];let k=r;for(let G=0;G<4;G++)f.push(k),f.push(_(k)),k=i(k);const y=new Set,M=[];for(const G of f){const K=JSON.stringify(G);y.has(K)||(M.push(G),y.add(K))}return M}const m=T(N),v=z([[0,0,0],[0,0,0],[0,0,0]]),L=z(0),x=z(new Set),U=z({}),P=z({}),q=z(!1),Z=z(null),F=W(()=>({direction:"ltr",unicodeBidi:"isolate"})),I=(r,i)=>`${r},${i}`;function O(){const r=m[E(0,m.length-1)],i=[1,2,3,4,5][E(0,4)],_=E(0,6),f=Array.from({length:3},()=>Array(3).fill(0));for(let k=0;k<3;k++)for(let y=0;y<3;y++)f[k][y]=_+i*r[k][y];v.value=f,L.value=i*15+3*_}function H(){const r=[];for(let f=0;f<3;f++)for(let k=0;k<3;k++)r.push([f,k]);const i=new Set(Y(r).slice(0,E(3,4)).map(([f,k])=>I(f,k))),_=r.filter(([f,k])=>!i.has(I(f,k)));x.value=new Set(_.map(([f,k])=>I(f,k)))}function X(){const r={};x.value.forEach(i=>{const[_,f]=i.split(",").map(Number),k=v.value[_][f];r[k]=(r[k]||0)+1});for(const[i,_]of Object.entries(U.value))r[_]=(r[_]||0)-1;for(const[i,_]of Object.entries(r))_<=0&&delete r[i];P.value=r}const j=W(()=>{const r=[];for(const[i,_]of Object.entries(P.value))for(let f=0;f<_;f++)r.push(Number(i));return Y(r)});function w(){q.value=!1,Z.value=null,U.value={},O(),H(),X()}function g(){for(const r of x.value)if(U.value[r]==null)return!1;return!0}function u(){const r=v.value.map(i=>i.slice());for(const i of x.value){const[_,f]=i.split(",").map(Number);r[_][f]=U.value[i]}return r}function p(r){const i=new Set;for(const _ of r)for(const f of _){if(i.has(f))return!1;i.add(f)}return!0}function S(r){const i=(_,f,k)=>_+f+k;for(let _=0;_<3;_++)if(i(r[_][0],r[_][1],r[_][2])!==L.value||i(r[0][_],r[1][_],r[2][_])!==L.value)return!1;return!(i(r[0][0],r[1][1],r[2][2])!==L.value||i(r[0][2],r[1][1],r[2][0])!==L.value)}async function b(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function c(){if(!g()){Z.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",C&&C.play();return}const r=u();p(r)&&S(r)?(q.value=!0,Z.value=n[a.value].correct,A&&A.play(),B&&B.play(),await b()):(Z.value=n[a.value].wrong,C&&C.play())}function h(){U.value={},X(),Z.value=null,q.value=!1}function $(r,i){r.dataTransfer.setData("text/plain",String(i))}function R(r){r.preventDefault()}function d(r,i){r.preventDefault();const _=Number(r.dataTransfer.getData("text/plain"));if(U.value[i]!=null){const f=U.value[i];P.value[f]=(P.value[f]||0)+1}(P.value[_]||0)!==0&&(P.value[_]-=1,U.value[i]=_,Z.value=null)}function s(r){if(U.value[r]!=null){const i=U.value[r];P.value[i]=(P.value[i]||0)+1,delete U.value[r]}}return _e(w),ge(()=>D.lang,()=>{}),(r,i)=>(l(),o("div",{class:"lvl2c2 challenge-surface","data-theme":D.theme},[e("h2",Hs,t(n[a.value].title),1),e("p",Gs,t(n[a.value].rule(L.value)),1),e("div",Ws,[(l(),o(te,null,ne(3,_=>e("div",{class:"row",key:"r"+_},[(l(),o(te,null,ne(3,f=>e("div",{class:"cell",key:"c"+_+"-"+f},[x.value.has(`${_-1},${f-1}`)?(l(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:R,onDrop:k=>d(k,`${_-1},${f-1}`)},[U.value[`${_-1},${f-1}`]!=null?(l(),o("span",{key:0,class:"num",style:ue(F.value)},t(U.value[`${_-1},${f-1}`]),5)):(l(),o("span",Ks,"؟"))],40,Vs),e("button",{class:"clear",onClick:k=>s(`${_-1},${f-1}`)},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)],8,Ys)],64)):(l(),o("span",{key:0,class:"num",style:ue(F.value)},t(v.value[_-1][f-1]),5))])),64))])),64))]),e("div",Js,[e("div",Xs,t(n[a.value].bank),1),e("div",Zs,[(l(!0),o(te,null,ne(j.value,_=>(l(),o("button",{key:_+"_"+Math.random(),class:"chip",draggable:"true",onDragstart:f=>$(f,_),style:ue(F.value)},t(_),45,eo))),128))]),e("div",to,[e("button",{class:"btn",onClick:h},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn primary",onClick:c},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:w},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),Z.value?(l(),o("div",{key:0,class:oe(["toast",{ok:q.value}])},t(Z.value),3)):ie("",!0)])],8,Qs))}},no=me(ao,[["__scopeId","data-v-4175342f"]]),lo=["data-theme"],so={class:"title"},oo={class:"rule"},ro={class:"cards"},io={class:"card"},co={class:"label"},uo={key:0,class:"num"},vo={key:1,class:"placeholder"},ho={class:"card"},po={class:"label"},fo={key:0,class:"num"},mo={key:1,class:"placeholder"},go={class:"card"},_o={class:"label"},yo={key:0,class:"num"},bo={key:1,class:"placeholder"},ko={class:"card"},wo={class:"label"},$o={key:0,class:"num"},Co={key:1,class:"placeholder"},xo={class:"bank"},So={class:"bank-title"},Ao={class:"bank-items"},Do=["disabled","onDragstart"],To={key:0},Mo={class:"actions"},Lo={__name:"challenge_level_two_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثاني – التحدي 3: أوصل المسألة بالنتيجة الصحيحة",rule:"اسحب عدداً من ستة أرقام إلى كل خانة بحسب الخاصية المطلوبة: مضاعف 2، 3، 4، 5. كل عدد يُستخدم مرة واحدة.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من الخواص",clear:"تفريغ الخلية",lab2:"مضاعفًا للعدد 2",lab3:"مضاعفًا للعدد 3",lab4:"مضاعفًا للعدد 4",lab5:"مضاعفًا للعدد 5"},en:{title:"Level 2 – Challenge 3: Match each rule to a six-digit number",rule:"Drag one six-digit number to each rule: multiple of 2, 3, 4, 5. Each number can be used once.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Check the properties",clear:"Clear cell",lab2:"Multiple of 2",lab3:"Multiple of 3",lab4:"Multiple of 4",lab5:"Multiple of 5"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(Pe):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Ne):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");function E(b,c){return Math.floor(Math.random()*(c-b+1))+b}function Y(b){const c=b.slice();for(let h=c.length-1;h>0;h--){const $=Math.floor(Math.random()*(h+1));[c[h],c[$]]=[c[$],c[h]]}return c}const N=z([]),T=z({}),m=z({m2:null,m3:null,m4:null,m5:null}),v=z(null),L=z(!1),x=b=>b%2===0,U=b=>String(b).split("").reduce((c,h)=>c+ +h,0)%3===0,P=b=>b%100%4===0,q=b=>b%10===0||b%10===5;function Z(b=c=>!0){for(;;){const c=E(1,9);let h=String(c);for(let R=0;R<5;R++)h+=String(E(0,9));const $=Number(h);if(b($))return $}}function F(b,c=()=>!0){for(;;){const h=E(1,9);let $=String(h);for(let d=0;d<4;d++)$+=String(E(0,9));$+=String(b);const R=Number($);if(c(R))return R}}function I(){L.value=!1,v.value=null,m.value={m2:null,m3:null,m4:null,m5:null};const b=new Set,c=i=>{const _=String(i);return b.has(_)?!1:(b.add(_),!0)};let h=F(5,i=>!U(i)||E(0,1));for(;!c(h);)h=F(5);let $=F([0,2,4,6,8][E(0,4)],i=>!q(i)&&!P(i));for(;!c($);)$=F([0,2,4,6,8][E(0,4)],i=>!q(i)&&!P(i));let R=Z(i=>P(i));for(;!c(R);)R=Z(i=>P(i));let d=Z(i=>U(i)&&!q(i));for(;!c(d);)d=Z(i=>U(i)&&!q(i));const s=[$,d,R,h],r=[];for(;r.length<4;){let i=Z(_=>_%2!==0&&!U(_)&&!q(_)&&!P(_));c(i)&&r.push(i)}N.value=Y(s.concat(r)),T.value=Object.fromEntries(N.value.map(i=>[i,1]))}function O(b,c){b.dataTransfer.setData("text/plain",String(c))}function H(b){b.preventDefault()}function X(b,c){c.preventDefault();const h=Number(c.dataTransfer.getData("text/plain"));(T.value[h]||0)!==0&&(m.value[b]!=null&&(T.value[m.value[b]]=(T.value[m.value[b]]||0)+1),m.value[b]=h,T.value[h]-=1,v.value=null)}function j(b){m.value[b]!=null&&(T.value[m.value[b]]=(T.value[m.value[b]]||0)+1,m.value[b]=null)}function w(){return["m2","m3","m4","m5"].every(b=>m.value[b]!=null)}function g(){return x(m.value.m2)&&U(m.value.m3)&&P(m.value.m4)&&q(m.value.m5)}async function u(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function p(){if(!w()){v.value=a.value==="ar"?"أكمل كل الخانات":"Fill all blanks",C&&C.play();return}g()?(L.value=!0,v.value=n[a.value].correct,A&&A.play(),B&&B.play(),await u()):(v.value=n[a.value].wrong,C&&C.play())}function S(){m.value={m2:null,m3:null,m4:null,m5:null},T.value=Object.fromEntries(N.value.map(b=>[b,1])),v.value=null,L.value=!1}return _e(I),ge(()=>D.lang,()=>{}),(b,c)=>(l(),o("div",{class:"lvl2c3 challenge-surface","data-theme":D.theme},[e("h2",so,t(n[a.value].title),1),e("p",oo,t(n[a.value].rule),1),e("div",ro,[e("div",io,[e("div",co,t(n[a.value].lab2),1),e("div",{class:"drop",onDragover:H,onDrop:c[0]||(c[0]=h=>X("m2",h))},[m.value.m2!=null?(l(),o("span",uo,t(m.value.m2),1)):(l(),o("span",vo,"؟"))],32),e("button",{class:"clear",onClick:c[1]||(c[1]=h=>j("m2"))},[Q(V(Se),{class:"ic"}),J(t(n[a.value].clear),1)])]),e("div",ho,[e("div",po,t(n[a.value].lab3),1),e("div",{class:"drop",onDragover:H,onDrop:c[2]||(c[2]=h=>X("m3",h))},[m.value.m3!=null?(l(),o("span",fo,t(m.value.m3),1)):(l(),o("span",mo,"؟"))],32),e("button",{class:"clear",onClick:c[3]||(c[3]=h=>j("m3"))},[Q(V(Se),{class:"ic"}),J(t(n[a.value].clear),1)])]),e("div",go,[e("div",_o,t(n[a.value].lab4),1),e("div",{class:"drop",onDragover:H,onDrop:c[4]||(c[4]=h=>X("m4",h))},[m.value.m4!=null?(l(),o("span",yo,t(m.value.m4),1)):(l(),o("span",bo,"؟"))],32),e("button",{class:"clear",onClick:c[5]||(c[5]=h=>j("m4"))},[Q(V(Se),{class:"ic"}),J(t(n[a.value].clear),1)])]),e("div",ko,[e("div",wo,t(n[a.value].lab5),1),e("div",{class:"drop",onDragover:H,onDrop:c[6]||(c[6]=h=>X("m5",h))},[m.value.m5!=null?(l(),o("span",$o,t(m.value.m5),1)):(l(),o("span",Co,"؟"))],32),e("button",{class:"clear",onClick:c[7]||(c[7]=h=>j("m5"))},[Q(V(Se),{class:"ic"}),J(t(n[a.value].clear),1)])])]),e("div",xo,[e("div",So,t(n[a.value].bank),1),e("div",Ao,[(l(!0),o(te,null,ne(N.value,h=>(l(),o("button",{key:h,class:"chip",disabled:(T.value[h]||0)===0,draggable:"true",onDragstart:$=>O($,h)},[J(t(h)+" ",1),(T.value[h]||0)===0?(l(),o("small",To,"✓")):ie("",!0)],40,Do))),128))])]),e("div",Mo,[e("button",{class:"btn",onClick:S},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn",onClick:p},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:I},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),v.value?(l(),o("div",{key:0,class:oe(["toast",{ok:L.value}])},t(v.value),3)):ie("",!0)],8,lo))}},No=me(Lo,[["__scopeId","data-v-a01ad243"]]),Po=["data-theme"],Eo={class:"title"},zo={class:"rule"},Bo={class:"choices",role:"list"},Oo=["onClick"],jo={class:"pair",style:{direction:"ltr",unicodeBidi:"isolate"}},Ro={class:"actions"},Io={__name:"challenge_level_two_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثاني – التحدي 4: اختر الإجابة الصحيحة",rule:(I,O)=>`ما العددان اللذان حاصل جمعهما ${I} والفرق بينهما ${O}؟ اختر الزوج الصحيح.`,choices:"الخيارات",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"إجابة غير صحيحة"},en:{title:"Level 2 – Challenge 4: Pick the correct pair",rule:(I,O)=>`Which two numbers have sum ${I} and difference ${O}? Pick the correct pair.`,choices:"Choices",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct",wrong:"Incorrect"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(wt):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio($t):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");function E(I,O){return Math.floor(Math.random()*(O-I+1))+I}function Y(I){const O=I.slice();for(let H=O.length-1;H>0;H--){const X=Math.floor(Math.random()*(H+1));[O[H],O[X]]=[O[X],O[H]]}return O}const N=z(0),T=z(0),m=z([0,0]),v=z([]),L=z(null),x=z(null),U=z(!1);function P(){U.value=!1,x.value=null,L.value=null;const I=E(6,60),O=E(1,I-1),H=Math.max(I,O),X=Math.min(I,O);N.value=H+X,T.value=H-X,m.value=[H,X];const j=[[H,X]],w=()=>{const u=N.value,p=E(1,u-1),S=u-p,b=[Math.max(p,S),Math.min(p,S)];return b[0]-b[1]===T.value?w():b},g=()=>{const u=T.value,p=E(1,60),b=[p+u,p];return b[0]+b[1]===N.value?g():b};for(;j.length<6;){const u=Math.random()<.5?w():g();j.some(p=>p[0]===u[0]&&p[1]===u[1])||j.push(u)}v.value=Y(j)}async function q(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function Z(){if(L.value==null){x.value=a.value==="ar"?"اختر إجابة":"Pick an answer",C&&C.play();return}const[I,O]=v.value[L.value];I+O===N.value&&I-O===T.value?(U.value=!0,x.value=n[a.value].correct,A&&A.play(),B&&B.play(),await q()):(x.value=n[a.value].wrong,C&&C.play())}function F(){L.value=null,x.value=null,U.value=!1}return _e(P),ge(()=>D.lang,()=>{}),(I,O)=>(l(),o("div",{class:"lvl2c4 challenge-surface","data-theme":D.theme},[e("h2",Eo,t(n[a.value].title),1),e("p",zo,t(n[a.value].rule(N.value,T.value)),1),e("div",Bo,[(l(!0),o(te,null,ne(v.value,(H,X)=>(l(),o("button",{key:X,class:oe(["choice",{sel:L.value===X}]),onClick:j=>L.value=X,role:"listitem"},[O[0]||(O[0]=e("span",{class:"dot","aria-hidden":"true"},null,-1)),e("span",jo,t(H[0])+" , "+t(H[1]),1)],10,Oo))),128))]),e("div",Ro,[e("button",{class:"btn",onClick:F},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn primary",onClick:Z},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:P},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),x.value?(l(),o("div",{key:0,class:oe(["toast",{ok:U.value}])},t(x.value),3)):ie("",!0)],8,Po))}},Fo=me(Io,[["__scopeId","data-v-241569ec"]]),Uo=["data-theme"],qo={class:"title"},Qo={class:"rule"},Ho=["dir"],Go={class:"frac"},Wo={class:"top"},Vo={key:0,class:"num"},Ko={key:1,class:"placeholder"},Yo={class:"bot"},Jo={class:"frac"},Xo={class:"top"},Zo={class:"bot"},er={key:0,class:"num"},tr={key:1,class:"placeholder"},ar={class:"frac"},nr={class:"bot"},lr={key:0,class:"num"},sr={key:1,class:"placeholder"},or={class:"frac"},rr={class:"top"},ir={key:0,class:"num"},cr={key:1,class:"placeholder"},ur={class:"bot"},dr={class:"frac"},vr={class:"top"},hr={class:"bot"},pr={class:"bank"},fr={class:"bank-title"},mr={class:"bank-items"},gr=["onDragstart"],_r={class:"actions"},yr="⁦",br="⁩",kr={__name:"challenge_level_two_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثاني – التحدي 5: أكمل طرح الكسور",rule:c=>`ضع عددًا كليًا في كل مربع لتصبح المعادلة صحيحة:  ${c.num}/${c.den} =  ١/□  −  □/${c.d2}.  اسحب الرقمين من لوحة الأعداد.`,bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة",wrong:"تحقق من القيم",clear:"تفريغ الخلية"},en:{title:"Level 2 – Challenge 5: Complete the fraction subtraction",rule:c=>`Place integers to make the equation true:  ${c.num}/${c.den} =  1/□  −  □/${c.d2}.  Drag the two numbers from the bank.`,bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Correct answer",wrong:"Check values",clear:"Clear"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(ze):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Ne):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");function E(c,h){return Math.floor(Math.random()*(h-c+1))+c}function Y(c){const h=c.slice();for(let $=h.length-1;$>0;$--){const R=Math.floor(Math.random()*($+1));[h[$],h[R]]=[h[R],h[$]]}return h}const N=z({num:1,den:6,d2:6}),T=z([]),m=z({A:null,N:null}),v=z(null),L=z(!1),x=[{id:"p1",target:{num:1,den:6},d2:6,solution:{A:2,N:2},extras:[1,3,4,5,7,8]},{id:"p2",target:{num:1,den:6},d2:9,solution:{A:2,N:3},extras:[1,4,5,6,7,8]},{id:"p3",target:{num:1,den:6},d2:12,solution:{A:2,N:4},extras:[1,3,5,6,7,9]},{id:"p4",target:{num:1,den:6},d2:6,solution:{A:3,N:1},extras:[2,4,5,7,8,9]},{id:"p5",target:{num:2,den:6},d2:6,solution:{A:2,N:1},extras:[3,4,5,7,8,9]},{id:"p6",target:{num:1,den:8},d2:8,solution:{A:2,N:3},extras:[1,2,4,5,6,7]},{id:"p7",target:{num:3,den:8},d2:8,solution:{A:2,N:1},extras:[2,4,5,6,7,9]},{id:"p8",target:{num:1,den:9},d2:9,solution:{A:3,N:2},extras:[1,3,4,5,6,7]},{id:"p9",target:{num:3,den:9},d2:6,solution:{A:2,N:1},extras:[2,4,5,7,8,9]},{id:"p10",target:{num:1,den:10},d2:5,solution:{A:2,N:2},extras:[1,3,4,6,7,8]},{id:"p11",target:{num:2,den:10},d2:10,solution:{A:2,N:3},extras:[1,4,5,6,7,9]},{id:"p12",target:{num:1,den:12},d2:4,solution:{A:3,N:1},extras:[2,5,6,7,8,9]}],U=z(x[0]),P=z(null);function q(){let c;do c=x[Math.floor(Math.random()*x.length)];while(c.id===P.value);return P.value=c.id,c}function Z(c){const h=new Set([c.solution.A,c.solution.N,...c.extras||[]]);for(;h.size<8;)h.add(E(1,15));return Y([...h])}const F=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function I(c){const h=String(c);return D.lang==="ar"?yr+h.replace(/[0-9]/g,$=>F[+$])+br:h}const O=W(()=>a.value==="ar"?`ضع عددًا كليًا في كل مربع لتصبح المعادلة صحيحة:  ${I(N.value.num)}/${I(N.value.den)} =  ${I(1)}/□  −  □/${I(N.value.d2)}.`:`Place integers to make the equation true:  ${N.value.num}/${N.value.den} =  1/□  −  □/${N.value.d2}.`);function H(){L.value=!1,v.value=null,m.value={A:null,N:null};const c=q();U.value=c,N.value={num:c.target.num,den:c.target.den,d2:c.d2},T.value=Z(c)}function X(c,h){c.dataTransfer.setData("text/plain",String(h))}function j(c){c.preventDefault()}function w(c,h){h.preventDefault(),m.value[c]=Number(h.dataTransfer.getData("text/plain")),v.value=null}function g(){return m.value.A!=null&&m.value.N!=null}function u(){if(!g())return!1;const c=1/m.value.A-m.value.N/N.value.d2,h=N.value.num/N.value.den;return Math.abs(c-h)<1e-9}async function p(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function S(){if(!g()){v.value=a.value==="ar"?"أكمل الخانتين":"Fill both blanks",C&&C.play();return}u()?(L.value=!0,v.value=n[a.value].correct,A&&A.play(),B&&B.play(),await p()):(v.value=n[a.value].wrong,C&&C.play())}function b(){m.value={A:null,N:null},v.value=null,L.value=!1}return _e(H),(c,h)=>(l(),o("div",{class:"lvl2c5 challenge-surface","data-theme":D.theme},[e("h2",qo,t(n[a.value].title),1),e("p",Qo,t(O.value),1),e("div",{class:"equation",dir:a.value==="ar"?"rtl":"ltr"},[a.value==="ar"?(l(),o(te,{key:0},[e("div",Go,[e("div",Wo,[e("div",{class:"drop",onDragover:j,onDrop:h[0]||(h[0]=$=>w("N",$))},[m.value.N!=null?(l(),o("span",Vo,t(I(m.value.N)),1)):(l(),o("span",Ko,"□"))],32)]),h[4]||(h[4]=e("div",{class:"bar"},null,-1)),e("div",Yo,t(I(N.value.d2)),1)]),h[6]||(h[6]=e("span",{class:"minus"},"−",-1)),e("div",Jo,[e("div",Xo,t(I(1)),1),h[5]||(h[5]=e("div",{class:"bar"},null,-1)),e("div",Zo,[e("div",{class:"drop",onDragover:j,onDrop:h[1]||(h[1]=$=>w("A",$))},[m.value.A!=null?(l(),o("span",er,t(I(m.value.A)),1)):(l(),o("span",tr,"□"))],32)])])],64)):(l(),o(te,{key:1},[e("div",ar,[h[7]||(h[7]=e("div",{class:"top"},"1",-1)),h[8]||(h[8]=e("div",{class:"bar"},null,-1)),e("div",nr,[e("div",{class:"drop",onDragover:j,onDrop:h[2]||(h[2]=$=>w("A",$))},[m.value.A!=null?(l(),o("span",lr,t(I(m.value.A)),1)):(l(),o("span",sr,"□"))],32)])]),h[10]||(h[10]=e("span",{class:"minus"},"−",-1)),e("div",or,[e("div",rr,[e("div",{class:"drop",onDragover:j,onDrop:h[3]||(h[3]=$=>w("N",$))},[m.value.N!=null?(l(),o("span",ir,t(I(m.value.N)),1)):(l(),o("span",cr,"□"))],32)]),h[9]||(h[9]=e("div",{class:"bar"},null,-1)),e("div",ur,t(I(N.value.d2)),1)])],64)),h[12]||(h[12]=e("span",{class:"eq"},"=",-1)),e("div",dr,[e("div",vr,t(I(N.value.num)),1),h[11]||(h[11]=e("div",{class:"bar"},null,-1)),e("div",hr,t(I(N.value.den)),1)])],8,Ho),e("div",pr,[e("div",fr,t(n[a.value].bank),1),e("div",mr,[(l(!0),o(te,null,ne(T.value,$=>(l(),o("button",{key:$,class:"chip",draggable:"true",onDragstart:R=>X(R,$)},t(I($)),41,gr))),128))])]),e("div",_r,[e("button",{class:"btn",onClick:b},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn primary",onClick:S},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:H},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),v.value?(l(),o("div",{key:0,class:oe(["toast",{ok:L.value}])},t(v.value),3)):ie("",!0)],8,Uo))}},wr=me(kr,[["__scopeId","data-v-c08f1cfd"]]),$r=["data-theme"],Cr={class:"head"},xr={class:"title"},Sr={class:"question"},Ar={class:"options"},Dr=["value"],Tr={class:"text"},Mr={class:"actions"},Lr={__name:"challenge_level_two_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثاني – التحدي 6: مقارنة الأوزان",question:"ما وزن المربع الواحد مقارنة بالمثلث؟",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"إجابة صحيحة! أحسنت في مقارنة الأوزان.",wrong:"إجابة غير صحيحة. أعد التفكير في المعادلات.",pick:"اختر إجابة أولاً."},en:{title:"Level 2 – Challenge 6: Comparing weights",question:"How does the weight of the square compare to the triangle?",newQ:"New question",reset:"Reset",check:"Check",correct:"Correct! Great job comparing the weights.",wrong:"That is incorrect. Revisit the equations.",pick:"Select an option first."}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(ze):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Ne):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");const E=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function Y(c){return String(c).replace(/[0-9]/g,h=>E[Number(h)])}function N(c,h){return h==="ar"?Y(c):String(c)}function T(c,h){return h==="ar"?c<=2?"وحدة":"وحدات":c===1?"unit":"units"}const m={ar:{double:"ضعف وزن المثلث",equal:"يساوي وزن المثلث",half:"نصف وزن المثلث",less:c=>`أقل بـ${Y(c)} ${T(c,"ar")} من وزن المثلث`,more:c=>`أكثر بـ${Y(c)} ${T(c,"ar")} من وزن المثلث`},en:{double:"Twice the triangle",equal:"Equal to the triangle",half:"Half the triangle",less:c=>`${c} ${T(c,"en")} less than the triangle`,more:c=>`${c} ${T(c,"en")} more than the triangle`}};function v(c,h){const $=Math.abs(c.difference),R=m[h];return[{id:"a",text:R.double},{id:"b",text:R.equal},{id:"c",text:R.half},{id:"d",text:R.less($)},{id:"e",text:R.more($)}]}function L(c,h){const $=N(c.totals.square,h),R=N(c.totals.triangle,h);return h==="ar"?[`وزن كرتان ومربع واحد يساويان ${$} وحدات.`,`وزن كرتان ومثلث واحد يساويان ${R} وحدات.`]:[`Two balls and one square weigh ${$} units.`,`Two balls and one triangle weigh ${R} units.`]}const x=[{id:"p1",totals:{square:8,triangle:6},difference:2,correctId:"e"},{id:"p2",totals:{square:10,triangle:7},difference:3,correctId:"e"},{id:"p3",totals:{square:9,triangle:11},difference:-2,correctId:"d"},{id:"p4",totals:{square:12,triangle:8},difference:4,correctId:"e"},{id:"p5",totals:{square:7,triangle:10},difference:-3,correctId:"d"}],U=z(x[0]),P=z(null),q=W(()=>U.value.correctId);function Z(){if(x.length===1)return P.value=x[0].id,x[0];let c;do c=x[Math.floor(Math.random()*x.length)];while(c.id===P.value);return P.value=c.id,c}function F(c){return c.slice().sort(()=>Math.random()-.5)}const I=z(null),O=z(null),H=z(!1),X=z(null);function j(){X.value=F(v(U.value,a.value))}function w(){I.value=null,O.value=null,H.value=!1}async function g(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function u(){if(!I.value){O.value=n[a.value].pick,C&&C.play();return}if(I.value===q.value){const c=H.value;H.value=!0,O.value=n[a.value].correct,A&&A.play(),B&&B.play(),c||await g()}else H.value=!1,O.value=n[a.value].wrong,C&&C.play()}function p(){const c=Z();U.value=c,w(),j()}ge(()=>D.lang,()=>{w(),j()});const S=W(()=>X.value||v(U.value,a.value)),b=W(()=>L(U.value,a.value));return _e(()=>{p()}),(c,h)=>(l(),o("div",{class:"lvl2c6 challenge-surface","data-theme":D.theme},[e("header",Cr,[e("h2",xr,t(n[a.value].title),1),(l(!0),o(te,null,ne(b.value,($,R)=>(l(),o("p",{key:R,class:"premise"},t($),1))),128)),e("p",Sr,t(n[a.value].question),1)]),e("section",Ar,[(l(!0),o(te,null,ne(S.value,$=>(l(),o("label",{key:$.id,class:oe(["option",{selected:I.value===$.id}])},[Me(e("input",{type:"radio",name:"weight-comparison",value:$.id,"onUpdate:modelValue":h[0]||(h[0]=R=>I.value=R)},null,8,Dr),[[zt,I.value]]),h[1]||(h[1]=e("span",{class:"mark"},null,-1)),e("span",Tr,t($.text),1)],2))),128))]),e("section",Mr,[e("button",{class:"btn",onClick:u},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:w},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn",onClick:p},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),Q($e,{name:"fade"},{default:ke(()=>[O.value?(l(),o("div",{key:0,class:oe(["feedback",{ok:H.value}])},t(O.value),3)):ie("",!0)]),_:1})],8,$r))}},Nr=me(Lr,[["__scopeId","data-v-15b62468"]]),Pr=["data-theme"],Er={class:"title"},zr={class:"rule"},Br={class:"hint"},Or=["dir"],jr=["onDrop"],Rr={key:1,class:"placeholder"},Ir=["onClick"],Fr={class:"bank"},Ur={class:"bank-title"},qr={class:"bank-items"},Qr=["onDragstart"],Hr={class:"actions"},Gr={__name:"challenge_level_three_1",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثالث – التحدي 1: هرم الضرب",rule:"املأ مربعات الهرم بحيث يساوي كل مربع أعلى حاصل ضرب الخليتين تحته. اسحب الأرقام الصحيحة من اللوحة حتى يكتمل الهرم.",hint:"تذكّر أن كل خطوة نحو الأعلى هي نتيجة ضرب الخليتين في الأسفل مباشرة.",bank:"لوحة الأرقام",newQ:"سؤال جديد",reset:"إعادة تعيين",check:"تحقّق",correct:"أحسنت! اكتمل الهرم.",wrong:"تحقّق مرة أخرى، هناك قيمة في غير مكانها.",clear:"تفريغ الخلية"},en:{title:"Level 3 – Challenge 1: Multiplication Pyramid",rule:"Fill the pyramid so every cell above equals the product of the two cells directly beneath it.",hint:"Each step upward = product of the two numbers underneath.",bank:"Number bank",newQ:"New puzzle",reset:"Reset",check:"Check",correct:"Great! The pyramid is complete.",wrong:"Something is off. Recheck placements.",clear:"Clear cell"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(Pe):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Fe):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");function E($,R){return Math.floor(Math.random()*(R-$+1))+$}function Y($){const R=$.slice();for(let d=R.length-1;d>0;d--){const s=Math.floor(Math.random()*(d+1));[R[d],R[s]]=[R[s],R[d]]}return R}function N($,R){return`${$},${R}`}const T=z([]),m=z(new Set),v=ve({}),L=ve({}),x=ve({}),U=z(null),P=z(!1),q=W(()=>({direction:"ltr",unicodeBidi:"isolate"})),Z=W(()=>T.value.map(($,R)=>({cells:$,index:R})).slice().reverse());function F($){let R=0;for(const d in v)v[d]===$&&R++;return R}function I(){const $={};for(const[R,d]of Object.entries(L)){const s=Number(R),r=d-F(s);r>0&&($[s]=r)}for(const R in x)delete x[R];Object.entries($).forEach(([R,d])=>x[R]=d)}function O(){for(;;){const R=[Array.from({length:4},()=>E(2,6))];for(let d=1;d<4;d++){const s=R[d-1],r=[];for(let i=0;i<s.length-1;i++)r.push(s[i]*s[i+1]);R.push(r)}if(R[3][0]<=5e4)return R}}function H(){P.value=!1,U.value=null;const $=O();T.value=$,m.value=new Set;for(const d in v)delete v[d];for(let d=1;d<T.value.length;d++)for(let s=0;s<T.value[d].length;s++)m.value.add(N(d,s));const R={};m.value.forEach(d=>{const[s,r]=d.split(",").map(Number),i=T.value[s][r];R[i]=(R[i]||0)+1});for(const d in L)delete L[d];Object.entries(R).forEach(([d,s])=>L[d]=s),I()}function X($){$.preventDefault()}function j($,R){$.dataTransfer.setData("text/plain",String(R))}function w($,R){if(R.preventDefault(),!m.value.has($))return;const d=Number(R.dataTransfer.getData("text/plain"));Number.isNaN(d)||!L[d]||v[$]!==d&&(F(d)>=L[d]||(v[$]=d,I(),U.value=null))}function g($){v[$]!=null&&(delete v[$],I())}function u(){for(const $ of m.value)if(v[$]==null)return!1;return!0}function p(){for(const $ of m.value){const[R,d]=$.split(",").map(Number);if(v[$]!==T.value[R][d])return!1}return!0}async function S(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function b(){if(!u()){U.value=a.value==="ar"?"أكمل كل الخانات أولاً.":"Fill all blanks first.",C&&C.play();return}p()?(P.value=!0,U.value=n[a.value].correct,A&&A.play(),B&&B.play(),await S()):(U.value=n[a.value].wrong,C&&C.play())}function c(){for(const $ in v)delete v[$];P.value=!1,U.value=null,I()}const h=W(()=>{const $=[];for(const[R,d]of Object.entries(x))for(let s=0;s<d;s++)$.push(Number(R));return Y($)});return _e(H),ge(()=>D.lang,()=>{U.value&&(U.value=null)}),($,R)=>(l(),o("div",{class:"lvl3c1 challenge-surface","data-theme":D.theme},[e("h2",Er,t(n[a.value].title),1),e("p",zr,t(n[a.value].rule),1),e("p",Br,t(n[a.value].hint),1),e("div",{class:"pyramid",dir:D.lang==="ar"?"rtl":"ltr"},[(l(!0),o(te,null,ne(Z.value,d=>(l(),o("div",{class:"p-row",key:d.index},[(l(!0),o(te,null,ne(d.cells,(s,r)=>(l(),o("div",{class:"brick",key:d.index+"-"+r},[m.value.has(N(d.index,r))?(l(),o(te,{key:1},[e("div",{class:"dropzone",onDragover:X,onDrop:i=>w(N(d.index,r),i)},[v[N(d.index,r)]!=null?(l(),o("span",{key:0,class:"num",style:ue(q.value)},t(v[N(d.index,r)]),5)):(l(),o("span",Rr,"؟"))],40,jr),e("button",{class:"clear",onClick:i=>g(N(d.index,r))},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)],8,Ir)],64)):(l(),o("span",{key:0,class:"num",style:ue(q.value)},t(s),5))]))),128))]))),128))],8,Or),e("div",Fr,[e("div",Ur,t(n[a.value].bank),1),e("div",qr,[(l(!0),o(te,null,ne(h.value,(d,s)=>(l(),o("button",{key:d+"_"+s,class:"chip",draggable:"true",onDragstart:r=>j(r,d),style:ue(q.value)},t(d),45,Qr))),128))])]),e("div",Hr,[e("button",{class:"btn",onClick:c},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn primary",onClick:b},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:H},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),U.value?(l(),o("div",{key:0,class:oe(["toast",{ok:P.value}])},t(U.value),3)):ie("",!0)],8,Pr))}},Wr=me(Gr,[["__scopeId","data-v-e7c52a8a"]]),Vr=["data-theme"],Kr={class:"head"},Yr={class:"title"},Jr={class:"rule"},Xr={class:"board"},Zr={class:"cards"},ei=["onDrop"],ti={key:0,class:"num"},ai={key:1,class:"placeholder"},ni=["value","onInput","onChange","onBlur","placeholder"],li=["onClick"],si={class:"facts"},oi={class:"bank"},ri={class:"bank-title"},ii={class:"bank-items"},ci=["onDragstart"],ui={class:"actions"},di=4,vi={__name:"challenge_level_three_2",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثالث – التحدي 2: الأرقام المفقودة على البطاقات",rule:"أمامك بطاقات ملوّنة بأرقام مفقودة. استخدم المعلومات المعطاة (المجموع، المتوسط، الوسيط، المدى) لتحديد الرقم المناسب لكل بطاقة، ثم اسحبه من لوحة الأعداد أو اكتبه يدويًا.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"مسح",check:"تحقّق",correct:"أحسنت! الأرقام صحيحة.",wrong:"تحقّق من القيم مرة أخرى.",clear:"تفريغ البطاقة",hints:{sum:"المجموع",mean:"المتوسط الحسابي",median:"الوسيط",range:"المدى"},manualPlaceholder:"أدخل رقمًا"},en:{title:"Level 3 – Challenge 2: Missing numbers on the cards",rule:"Each coloured card is missing its number. Use the given information (sum, mean, median, range) to deduce the correct value for every card, then drag a number from the bank or type it manually.",bank:"Number bank",newQ:"New puzzle",reset:"Clear",check:"Check",correct:"Great! All numbers are correct.",wrong:"Something is off – recheck the values.",clear:"Clear card",hints:{sum:"Sum",mean:"Mean",median:"Median",range:"Range"},manualPlaceholder:"Type value"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=W(()=>D.lang==="ar"?"ar-EG":"en-US"),B=typeof Audio!="undefined"?new Audio(Pe):null,C=typeof Audio!="undefined"?new Audio(xe):null,E=typeof Audio!="undefined"?new Audio(Ne):null;B&&(B.preload="auto"),C&&(C.preload="auto"),E&&(E.preload="auto");const Y=["green","gold","teal","magenta","sky","orange","crimson"],N=[{numbers:[4,8,12,16,20]},{numbers:[5,9,11,13,22]},{numbers:[7,10,12,18,23]},{numbers:[6,8,15,19,22]},{numbers:[9,11,14,20,26]}];function T(k){const y=k.slice().sort((re,ce)=>re-ce),M=y.reduce((re,ce)=>re+ce,0),G=M/y.length,K=y[Math.floor(y.length/2)],le=y[y.length-1]-y[0];return{sum:M,mean:G,median:K,range:le}}const m=z([]),v=ve({}),L=z(new Set),x=ve({}),U=ve({}),P=ve({}),q=ve({}),Z=ve({}),F=ve({}),I=z({sum:0,mean:0,median:0,range:0}),O=z(null),H=z(!1);function X(k){for(const y of Object.keys(k))delete k[y]}function j(){const y=N[Math.floor(Math.random()*N.length)].numbers.slice(),M=Y.slice(0,y.length).sort(()=>Math.random()-.5),G=y.slice().sort(()=>Math.random()-.5);m.value=[],L.value=new Set,X(v),X(q),X(Z),X(F),X(x),X(U),X(P),G.forEach((he,pe)=>{const Te=`card-${pe}`;m.value.push({id:Te,value:he,color:M[pe%M.length]}),v[Te]=he,L.value.add(Te),x[he]=(x[he]||0)+1});for(const[he,pe]of Object.entries(x))P[he]=pe;const K=Math.min(...y),le=Math.max(...y),re=Math.max(1,K-12),ce=le+12,be=new Set;for(;be.size<di;){const he=Math.floor(Math.random()*(ce-re+1))+re;x[he]||be.add(he)}be.forEach(he=>{U[he]=(U[he]||0)+1,P[he]=(P[he]||0)+1}),I.value=T(y),O.value=null,H.value=!1}function w(k,y){k.dataTransfer.setData("text/plain",String(y))}function g(k){k.preventDefault()}function u(k,y,M){if(Number.isNaN(y))return!1;if(q[k]!=null&&Z[k]==="bank"){const G=q[k];P[G]=(P[G]||0)+1}if(M==="bank"){if((P[y]||0)<=0)return!1;P[y]=(P[y]||0)-1}return q[k]=y,Z[k]=M,F[k]=String(y),O.value=null,H.value=!1,!0}function p(k,y){k.preventDefault();const M=Number(k.dataTransfer.getData("text/plain"));Number.isNaN(M)||u(y,M,"bank")}function S(k){if(q[k]!=null&&Z[k]==="bank"){const y=q[k];P[y]=(P[y]||0)+1}delete q[k],delete Z[k],F[k]="",O.value=null,H.value=!1}function b(){for(const k of L.value)if(q[k]==null)return!1;return!0}function c(){const k={};for(const y of L.value){const M=q[y];if(M==null)return!1;k[M]=(k[M]||0)+1}for(const[y,M]of Object.entries(x))if((k[y]||0)!==M)return!1;return!0}async function h(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function $(){if(!b()){O.value=a.value==="ar"?"أكمل كل البطاقات أولاً.":"Fill every card first.",E&&E.play();return}c()?(H.value=!0,O.value=n[a.value].correct,B&&B.play(),C&&C.play(),await h()):(O.value=n[a.value].wrong,E&&E.play())}function R(){X(q),X(Z),X(F),X(P);for(const[k,y]of Object.entries(x))P[k]=y;for(const[k,y]of Object.entries(U))P[k]=(P[k]||0)+y;O.value=null,H.value=!1}const d=W(()=>{const k=[];for(const[y,M]of Object.entries(P))for(let G=0;G<M;G++)k.push({value:Number(y),key:`${y}-${G}`});return k});function s(k,y){F[k]=y}function r(k){var G;const y=((G=F[k])!=null?G:"").trim();if(y===""){S(k);return}const M=Number(y);Number.isFinite(M)&&u(k,M,"manual")}const i=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function _(k){const y=String(k);return D.lang!=="ar"?y:y.replace(/[0-9]/g,M=>i[Number(M)])}function f(k,y={}){return new Intl.NumberFormat(A.value,y).format(k)}return _e(j),ge(()=>D.lang,()=>{O.value&&H.value||(O.value=null)}),(k,y)=>(l(),o("div",{class:"lvl3c2 challenge-surface","data-theme":D.theme},[e("header",Kr,[e("h2",Yr,t(n[a.value].title),1),e("p",Jr,t(n[a.value].rule),1)]),e("section",Xr,[e("div",Zr,[(l(!0),o(te,null,ne(m.value,M=>{var G;return l(),o("div",{key:M.id,class:oe(["card","color-"+M.color])},[e("div",{class:"drop",onDragover:g,onDrop:K=>p(K,M.id)},[q[M.id]!=null?(l(),o("span",ti,t(_(q[M.id])),1)):(l(),o("span",ai,"؟"))],40,ei),e("input",{class:"manual-entry",type:"number",inputmode:"numeric",value:(G=F[M.id])!=null?G:"",onInput:K=>s(M.id,K.target.value),onChange:K=>r(M.id),onBlur:K=>r(M.id),placeholder:n[a.value].manualPlaceholder},null,40,ni),e("button",{class:"clear",onClick:K=>S(M.id)},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)],8,li)],2)}),128))]),e("aside",si,[e("h3",null,t(D.lang==="ar"?"المعلومات المتاحة":"Given facts"),1),e("ul",null,[e("li",null,[e("strong",null,t(n[a.value].hints.sum)+":",1),J(" "+t(f(I.value.sum)),1)]),e("li",null,[e("strong",null,t(n[a.value].hints.mean)+":",1),J(" "+t(f(I.value.mean,{maximumFractionDigits:2})),1)]),e("li",null,[e("strong",null,t(n[a.value].hints.median)+":",1),J(" "+t(f(I.value.median)),1)]),e("li",null,[e("strong",null,t(n[a.value].hints.range)+":",1),J(" "+t(f(I.value.range)),1)])])])]),e("section",oi,[e("div",ri,t(n[a.value].bank),1),e("div",ii,[(l(!0),o(te,null,ne(d.value,M=>(l(),o("button",{key:M.key,class:"chip",draggable:"true",onDragstart:G=>w(G,M.value)},t(_(M.value)),41,ci))),128))])]),e("section",ui,[e("button",{class:"btn",onClick:R},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn primary",onClick:$},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:j},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),Q($e,{name:"fade"},{default:ke(()=>[O.value?(l(),o("div",{key:0,class:oe(["toast",{ok:H.value}])},t(O.value),3)):ie("",!0)]),_:1})],8,Vr))}},hi=me(vi,[["__scopeId","data-v-70cc11ae"]]),pi=["data-theme"],fi={class:"head"},mi={class:"title"},gi={class:"rule"},_i={class:"status"},yi={class:"chip target"},bi={class:"chip sum"},ki={class:"grid"},wi=["onClick"],$i={class:"actions"},Ci={__name:"challenge_level_three_3",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثالث – التحدي 3: خطوط المجموع العشري",rule:"اختر أرقامًا متجاورة على خط مستقيم (أفقي، عمودي أو قطري) بحيث يساوي مجموعها القيمة المطلوبة.",targetLabel:"المجموع المطلوب",selected:"المجموع الحالي",check:"تحقّق",reset:"إعادة اختيار",newQ:"سؤال جديد",needSelection:"اختر خانات أولاً.",wrongLine:"يجب أن تكون الخانات المختارة على خط مستقيم ومتجاورة.",wrongSum:"المجموع لا يساوي القيمة المطلوبة.",correct:"رائع! خط صحيح."},en:{title:"Level 3 – Challenge 3: Decimal Sum Lines",rule:"Pick numbers lying on one straight line (horizontal, vertical, or diagonal) so their sum equals the target.",targetLabel:"Target sum",selected:"Current sum",check:"Check",reset:"Reset selection",newQ:"New puzzle",needSelection:"Select cells first.",wrongLine:"Selections must be contiguous on a straight line.",wrongSum:"The sum does not match the target.",correct:"Great! You found a valid line."}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(Pe):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(at):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");const E=[{id:"p1",target:10,grid:[[1.2,.8,2.5,1.3,.9],[2.1,3.4,2,.6,1.5],[1.8,2.2,1.5,3,1.1],[.5,1.6,1.7,2,3.5],[1.4,1.3,2.3,1.8,2.7]],solution:[{r:0,c:2},{r:1,c:2},{r:2,c:2},{r:3,c:2},{r:4,c:2}]},{id:"p2",target:10,grid:[[.8,1.7,2.1,.9,1.4],[2.6,1.5,1.9,1.1,2.9],[1.3,2.4,1.2,2.2,1.6],[.7,1.8,2.5,1.7,2.3],[1.9,.6,1.8,2.6,.9]],solution:[{r:1,c:0},{r:1,c:1},{r:1,c:2},{r:1,c:3},{r:1,c:4}]},{id:"p3",target:10,grid:[[2.5,1.1,.8,1.4,1.2],[.9,2,1.3,1.7,1],[1.6,1.2,1.8,1.1,1.3],[1.4,1.9,1.5,1.5,1.8],[1.3,1.4,.9,1.6,2.2]],solution:[{r:0,c:0},{r:1,c:1},{r:2,c:2},{r:3,c:3},{r:4,c:4}]},{id:"p4",target:10,grid:[[1.1,.9,1.7,1.3,2.1],[2,1.4,2,1.1,1.6],[1.5,2.2,1.8,1.4,1.3],[.8,1.9,2.3,1.2,1.1],[1.6,1.5,2.2,1.7,.9]],solution:[{r:0,c:2},{r:1,c:2},{r:2,c:2},{r:3,c:2},{r:4,c:2}]},{id:"p5",target:10.2,grid:[[1,1.3,.9,1.5,1.9],[1.6,1.2,1.4,1.8,1],[1.7,1.1,2.1,1.4,1.2],[2.4,2,1.5,1.3,.8],[2.4,1.5,1.6,1.1,.7]],solution:[{r:0,c:4},{r:1,c:3},{r:2,c:2},{r:3,c:1},{r:4,c:0}]},{id:"p6",target:9,grid:[[1.8,2.2,1.6,1.5,1.9],[1.3,.9,2.1,2.5,1.1],[1.4,1.7,1.2,1.8,1.6],[1,2.3,1.5,1.4,2.2],[1.6,1.1,2,1.7,.8]],solution:[{r:0,c:0},{r:0,c:1},{r:0,c:2},{r:0,c:3},{r:0,c:4}]},{id:"p7",target:9.3,grid:[[1.2,1.5,2.1,1,1.4],[.9,2,1.7,1.9,1.2],[1.3,1.8,2.2,1.6,1.1],[1.5,1.9,1.4,1.7,2.3],[1,2.1,1.5,1.2,1.8]],solution:[{r:0,c:1},{r:1,c:1},{r:2,c:1},{r:3,c:1},{r:4,c:1}]},{id:"p8",target:9,grid:[[1.4,1.2,2,1.6,.9],[1.1,1.8,1.4,2.3,1.5],[2.2,1.3,1.7,1.2,1.1],[1.5,2.4,1.6,1.5,1.9],[2,1.7,1.5,1.4,2.6]],solution:[{r:0,c:0},{r:1,c:1},{r:2,c:2},{r:3,c:3},{r:4,c:4}]},{id:"p9",target:10,grid:[[1.6,1,1.2,1.9,2.1],[1.3,1.5,2.2,1.8,1.1],[2,1.8,1.4,1.5,1.7],[1.2,2.3,1.6,1.7,1],[2.4,1.9,1.5,1.2,.8]],solution:[{r:0,c:4},{r:1,c:3},{r:2,c:2},{r:3,c:1},{r:4,c:0}]},{id:"p10",target:9,grid:[[1,1.7,1.3,2.1,1.6],[1.5,1.1,2.4,1.6,1.8],[1.9,2,1.5,1.2,1.3],[1.4,1.9,1.7,2,1.1],[2.1,2,1.8,1.5,1.6]],solution:[{r:4,c:0},{r:4,c:1},{r:4,c:2},{r:4,c:3},{r:4,c:4}]}],Y=z(E[0]),N=z(null),T=z(new Set),m=z(!1),v=z(null);function L(j,w){return`${j},${w}`}function x(){if(E.length===1)return N.value=E[0].id,E[0];let j;do j=E[Math.floor(Math.random()*E.length)];while(j.id===N.value);return N.value=j.id,j}function U(){T.value=new Set,m.value=!1,v.value=null}function P(){const j=x();Y.value=j,U()}function q(j,w){const g=L(j,w),u=new Set(T.value);u.has(g)?u.delete(g):u.add(g),T.value=u,m.value=!1,v.value=null}const Z=W(()=>Array.from(T.value).map(j=>{const[w,g]=j.split(",").map(Number);return{r:w,c:g}})),F=W(()=>Z.value.reduce((j,w)=>j+Y.value.grid[w.r][w.c],0));function I(j){if(j.length<2)return!0;const w=j.map(h=>h.r),g=j.map(h=>h.c),u=w.every(h=>h===w[0]),p=g.every(h=>h===g[0]),S=w.every((h,$)=>h-g[$]===w[0]-g[0]),b=w.every((h,$)=>h+g[$]===w[0]+g[0]);if(!u&&!p&&!S&&!b)return!1;const c=[...j];if(u){c.sort((h,$)=>h.c-$.c);for(let h=1;h<c.length;h++)if(c[h].c-c[h-1].c!==1)return!1;return!0}if(p){c.sort((h,$)=>h.r-$.r);for(let h=1;h<c.length;h++)if(c[h].r-c[h-1].r!==1)return!1;return!0}if(S){c.sort((h,$)=>h.r-$.r);for(let h=1;h<c.length;h++)if(c[h].r-c[h-1].r!==1||c[h].c-c[h-1].c!==1)return!1;return!0}c.sort((h,$)=>h.r-$.r);for(let h=1;h<c.length;h++)if(c[h].r-c[h-1].r!==1||c[h-1].c-c[h].c!==1)return!1;return!0}async function O(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function H(){if(!T.value.size){v.value=n[a.value].needSelection,C&&C.play();return}const j=Z.value;if(!I(j)){v.value=n[a.value].wrongLine,C&&C.play();return}const w=F.value;if(Math.abs(w-Y.value.target)>1e-6){v.value=n[a.value].wrongSum,C&&C.play();return}m.value=!0,v.value=n[a.value].correct,A&&A.play(),B&&B.play(),await O()}function X(j,w){return Y.value.solution.some(g=>g.r===j&&g.c===w)}return _e(()=>{P()}),(j,w)=>(l(),o("div",{class:"lvl3c3 challenge-surface","data-theme":D.theme},[e("header",fi,[e("h2",mi,t(n[a.value].title),1),e("p",gi,t(n[a.value].rule),1)]),e("section",_i,[e("div",yi,[J(t(n[a.value].targetLabel)+": ",1),e("strong",null,t(Y.value.target.toFixed(1)),1)]),e("div",bi,[J(t(n[a.value].selected)+": ",1),e("strong",null,t(F.value.toFixed(1)),1)])]),e("section",ki,[(l(!0),o(te,null,ne(Y.value.grid,(g,u)=>(l(),o("div",{key:u,class:"row"},[(l(!0),o(te,null,ne(g,(p,S)=>(l(),o("button",{key:S,class:oe(["cell",{selected:T.value.has(L(u,S)),success:m.value&&X(u,S)}]),onClick:b=>q(u,S)},t(p.toFixed(1)),11,wi))),128))]))),128))]),e("section",$i,[e("button",{class:"btn",onClick:H},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:U},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn",onClick:P},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),Q($e,{name:"fade"},{default:ke(()=>[v.value?(l(),o("div",{key:0,class:oe(["feedback",{ok:m.value}])},t(v.value),3)):ie("",!0)]),_:1})],8,pi))}},xi=me(Ci,[["__scopeId","data-v-413d5506"]]),Si=["data-theme"],Ai={class:"head"},Di={class:"title"},Ti={class:"equations"},Mi={class:"expression"},Li=["innerHTML"],Ni=["onDrop"],Pi=["innerHTML"],Ei={key:1,class:"placeholder"},zi=["onClick"],Bi={class:"bank"},Oi={class:"bank-title"},ji={class:"bank-items"},Ri=["onDragstart","innerHTML"],Ii={class:"actions"},mt="⁦",gt="⁩",_t=" ",Fi={__name:"challenge_level_three_4",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثالث – التحدي 4: أزل النقطة الحمراء",intro:["هذه المعادلات للتفكير في العمليات على الأعداد العشرية.","كل نقطة ● تمثل رقمًا واحدًا. اسحب الرقم الصحيح من لوحة الأرقام إلى مكانه حتى تصبح المعادلات صحيحة."],check:"تحقّق",reset:"مسح الكل",newQ:"سؤال جديد",incomplete:"أكمل كل الخانات أولًا.",wrong:"هناك معادلة غير صحيحة.",correct:"أحسنت! جميع المعادلات صحيحة.",bank:"لوحة الأرقام",clear:"تفريغ"},en:{title:"Level 3 – Challenge 4: Replace the red dot",intro:["These equations practice decimal operations.","Each red dot ● hides a single digit. Drag the correct digit from the number bank to make every equation true."],check:"Check",reset:"Clear all",newQ:"New puzzle",incomplete:"Fill every blank first.",wrong:"One or more equations are incorrect.",correct:"Great! All equations are valid.",bank:"Number bank",clear:"Clear"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(ze):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Ne):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");const E=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function Y(d,s){const i=(typeof d=="number"&&s!=null?d.toFixed(s):String(d)).replace(/[0-9]/g,_=>E[+_]).replace(/\./g,`${_t}٫${_t}`);return mt+i+gt}function N(d){const s=String(d);return D.lang==="ar"?mt+s.replace(/[0-9]/g,r=>E[+r])+gt:s}function T({multiplier:d,offset:s,aDigit:r,bDigit:i}){const _=Y(d,1),f=d.toFixed(1),y=s.toFixed(2).slice(1),M=Y(y);return{id:"eqA",slots:{a:r,b:i},order:["a","b"],template:{ar:["أ. ",{num:!0,text:_}," × ",{num:!0,text:"٠"},"٫",{slot:"a"}," = ",{slot:"b"},{num:!0,text:M}],en:["A. ",{num:!0,text:f}," × 0.",{slot:"a"}," = ",{slot:"b"},y]},evaluate(G){const K=d*(G.a/10),le=G.b+s;return Math.abs(K-le)<1e-6}}}function m({baseLeft:d,baseRight:s,cDigit:r,dDigit:i,result:_,decimals:f=2}){const k=Y(d,0),y=Y(s,0),M=`${d}`,G=`${s}`,K=f!=null?_.toFixed(f):String(_),le=Y(K);return{id:"eqB",slots:{c:r,d:i},order:["c","d"],template:{ar:["ب. ",{num:!0,text:k},"٫",{slot:"c"}," × ",{num:!0,text:y},"٫",{slot:"d"}," = ",{num:!0,text:le}],en:["B. ",{num:!0,text:M},".",{slot:"c"}," × ",{num:!0,text:G},".",{slot:"d"}," = ",K]},evaluate(re){const ce=(d+re.c/10)*(s+re.d/10);return Math.abs(ce-_)<1e-6}}}function v({secondBase:d,eDigit:s,fDigit:r,result:i,decimals:_=2}){const f=Y(d,0),k=`${d}`,y=_!=null?i.toFixed(_):String(i),M=Y(y);return{id:"eqC",slots:{e:s,f:r},order:["e","f"],template:{ar:["ج. ",{slot:"e"},"٫",{num:!0,text:Y(9,0)}," × ",{num:!0,text:f},"٫",{slot:"f"}," = ",{num:!0,text:M}],en:["C. ",{slot:"e"},".9 × ",{num:!0,text:k},".",{slot:"f"}," = ",y]},evaluate(G){const K=(G.e+.9)*(d+G.f/10);return Math.abs(K-i)<1e-6}}}function L({gDigit:d,hDigit:s}){return{id:"eqD",slots:{g:d,h:s},order:["g","h"],template:{ar:["د. ",{num:!0,text:"٤"},"٫",{slot:"g"}," + ",{num:!0,text:"١٫٢٥"}," = ",{num:!0,text:"٥"},"٫",{slot:"h"},{num:!0,text:"٥"}],en:["D. 4.",{slot:"g"}," + 1.25 = 5.",{slot:"h"},"5"]},evaluate(r){const i=4+r.g/10+1.25,_=5+r.h/10+.05;return Math.abs(i-_)<1e-6}}}const x=[{id:"p1",equations:[T({multiplier:9.3,offset:.44,aDigit:8,bDigit:7}),m({baseLeft:2,baseRight:2,cDigit:4,dDigit:9,result:6.96,decimals:2}),v({secondBase:3,eDigit:4,fDigit:7,result:18.13,decimals:2}),L({gDigit:7,hDigit:9})]},{id:"p2",equations:[T({multiplier:8.6,offset:.16,aDigit:6,bDigit:5}),m({baseLeft:2,baseRight:2,cDigit:1,dDigit:6,result:5.46,decimals:2}),v({secondBase:3,eDigit:2,fDigit:5,result:10.15,decimals:2}),L({gDigit:3,hDigit:5})]},{id:"p3",equations:[T({multiplier:7.8,offset:.24,aDigit:8,bDigit:6}),m({baseLeft:2,baseRight:2,cDigit:5,dDigit:2,result:5.5,decimals:2}),v({secondBase:3,eDigit:3,fDigit:6,result:14.04,decimals:2}),L({gDigit:2,hDigit:4})]},{id:"p4",equations:[T({multiplier:6.4,offset:.28,aDigit:2,bDigit:1}),m({baseLeft:2,baseRight:2,cDigit:8,dDigit:3,result:6.44,decimals:2}),v({secondBase:3,eDigit:5,fDigit:2,result:18.88,decimals:2}),L({gDigit:4,hDigit:6})]},{id:"p5",equations:[T({multiplier:6.4,offset:.12,aDigit:8,bDigit:5}),m({baseLeft:2,baseRight:2,cDigit:0,dDigit:9,result:5.8,decimals:2}),v({secondBase:3,eDigit:6,fDigit:1,result:21.39,decimals:2}),L({gDigit:1,hDigit:3})]}],U=z(x[0]),P=z(null),q=ve({}),Z=ve({}),F=ve({}),I=z([]),O=z(null),H=z(!1);function X(d){return d.slice().sort(()=>Math.random()-.5)}function j(){if(x.length===1)return P.value=x[0].id,x[0];let d;do d=x[Math.floor(Math.random()*x.length)];while(d.id===P.value);return P.value=d.id,d}function w(){const d=j();U.value=d,O.value=null,H.value=!1,Object.keys(q).forEach(r=>delete q[r]),Object.keys(Z).forEach(r=>delete Z[r]),Object.keys(F).forEach(r=>delete F[r]);const s=[];d.equations.forEach(r=>{r.order.forEach(i=>{const _=`${r.id}-${i}`;s.push({key:_,eq:r,slotName:i}),q[_]=null;const f=r.slots[i];Z[f]=(Z[f]||0)+1,F[f]=(F[f]||0)+1})}),I.value=s}function g(d){d.preventDefault()}function u(d,s){d.dataTransfer.setData("text/plain",String(s))}function p(d,s){d.preventDefault();const r=Number(d.dataTransfer.getData("text/plain"));if(!Number.isNaN(r)&&!((F[r]||0)<=0&&q[s]!==r)){if(q[s]!=null){const i=q[s];F[i]=(F[i]||0)+1}q[s]!==r&&(F[r]=(F[r]||0)-1,F[r]<0&&(F[r]=0)),q[s]=r,O.value=null,H.value=!1}}function S(d){if(q[d]!=null){const s=q[d];F[s]=(F[s]||0)+1,q[d]=null,O.value=null,H.value=!1}}const b=W(()=>{const d=[];for(const[s,r]of Object.entries(F))for(let i=0;i<r;i++)d.push({value:Number(s),key:`${s}-${i}`});return X(d)});function c(){return I.value.every(d=>q[d.key]!=null)}async function h(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function $(){if(!c()){O.value=n[a.value].incomplete,C&&C.play();return}const{equations:d}=U.value;for(const s of d){const r={};for(const i of s.order)r[i]=q[`${s.id}-${i}`];if(!s.evaluate(r)){O.value=n[a.value].wrong,C&&C.play();return}}O.value=n[a.value].correct,H.value=!0,A&&A.play(),B&&B.play(),await h()}function R(){I.value.forEach(d=>{if(q[d.key]!=null){const s=q[d.key];F[s]=(F[s]||0)+1,q[d.key]=null}}),O.value=null,H.value=!1}return _e(w),ge(()=>D.lang,()=>{H.value||(O.value=null)}),(d,s)=>(l(),o("div",{class:"lvl3c4 challenge-surface","data-theme":D.theme},[e("header",Ai,[e("h2",Di,t(n[a.value].title),1),(l(!0),o(te,null,ne(n[a.value].intro,(r,i)=>(l(),o("p",{key:i,class:"intro"},t(r),1))),128))]),e("section",Ti,[(l(!0),o(te,null,ne(U.value.equations,r=>(l(),o("div",{key:r.id,class:"card"},[e("div",Mi,[(l(!0),o(te,null,ne(D.lang==="ar"?r.template.ar:r.template.en,(i,_)=>(l(),o("span",{key:_},[typeof i=="string"?(l(),o(te,{key:0},[J(t(i),1)],64)):i.num?(l(),o("span",{key:1,class:"num",innerHTML:i.text},null,8,Li)):(l(),o(te,{key:2},[e("span",{class:"slot",onDragover:g,onDrop:f=>p(f,r.id+"-"+i.slot)},[q[r.id+"-"+i.slot]!=null?(l(),o("span",{key:0,class:"digit",innerHTML:N(q[r.id+"-"+i.slot])},null,8,Pi)):(l(),o("span",Ei,"●"))],40,Ni),e("button",{class:"clear",onClick:f=>S(r.id+"-"+i.slot)},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)],8,zi)],64))]))),128))])]))),128))]),e("section",Bi,[e("div",Oi,t(n[a.value].bank),1),e("div",ji,[(l(!0),o(te,null,ne(b.value,r=>(l(),o("button",{key:r.key,class:"chip",draggable:"true",onDragstart:i=>u(i,r.value),innerHTML:N(r.value)},null,40,Ri))),128))])]),e("section",Ii,[e("button",{class:"btn",onClick:$},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:R},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn",onClick:w},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),Q($e,{name:"fade"},{default:ke(()=>[O.value?(l(),o("div",{key:0,class:oe(["feedback",{ok:H.value}])},t(O.value),3)):ie("",!0)]),_:1})],8,Si))}},Ui=me(Fi,[["__scopeId","data-v-be117a7f"]]),qi=["data-theme"],Qi={class:"head"},Hi={class:"title"},Gi={class:"equation"},Wi={class:"fraction"},Vi={class:"row"},Ki=["onDrop"],Yi={key:0,class:"digit"},Ji={key:1,class:"placeholder"},Xi={class:"row"},Zi=["onDrop"],ec={key:0,class:"digit"},tc={key:1,class:"placeholder"},ac={class:"fraction"},nc={class:"row"},lc=["onDrop"],sc={key:0,class:"digit"},oc={key:1,class:"placeholder"},rc={class:"row"},ic=["onDrop"],cc={key:0,class:"digit"},uc={key:1,class:"placeholder"},dc={key:0,class:"digit"},vc={key:1,class:"placeholder"},hc={class:"controls"},pc={class:"bank"},fc={class:"bank-title"},mc={class:"bank-items"},gc=["onDragstart"],_c={__name:"challenge_level_three_5",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثالث – التحدي 5: بطاقات الكسر المفقود",intro:["استخدم البطاقات المرقّمة من ١ إلى ٩ مرة واحدة فقط لتكوين الكسرين بحيث يكون الناتج مساويًا للقيمة المطلوبة.","اسحب الرقم المناسب إلى كل خانة للبسط أو المقام، ثم تحقّق من صحة الناتج."],bank:"البطاقات المتاحة",check:"تحقّق",reset:"مسح الاختيار",newQ:"تحدٍ جديد",clear:"تفريغ",needAll:"املأ كل الخانات أولًا.",wrong:"المعادلة غير صحيحة، جرّب ترتيبًا آخر.",correct:"أحسنت! أنتجت الكسور الصحيحة."},en:{title:"Level 3 – Challenge 5: Missing Fraction Cards",intro:["Use the cards labelled 1 through 9 exactly once to build two fractions whose sum matches the target.","Drag each digit into the correct numerator or denominator, then check your result."],bank:"Available cards",check:"Check",reset:"Reset selection",newQ:"New challenge",clear:"Clear",needAll:"Fill every slot first.",wrong:"The equation is not satisfied—try another arrangement.",correct:"Great! The fractions are correct."}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(Pe):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Fe):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");const E={n1:["n1a","n1b"],d1:["d1a","d1b"],n2:["n2a","n2b"],d2:["d2a","d2b"],res:["res"]},Y=[{id:"p1",solution:{n1:["2","9"],d1:["1","6"],n2:["5","7"],d2:["4","8"],res:["3"]}},{id:"p2",solution:{n1:["3","9"],d1:["2","7"],n2:["6","4"],d2:["1","8"],res:["5"]}},{id:"p3",solution:{n1:["5","7"],d1:["1","3"],n2:["9","4"],d2:["2","6"],res:["8"]}}],N=z(Y[0]),T=ve({}),m=ve({}),v=ve({}),L=z(null),x=z(!1),U=["1","2","3","4","5","6","7","8","9"],P=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function q(S){if(S==null)return"";const b=String(S);return D.lang==="ar"?b.replace(/[0-9]/g,c=>P[Number(c)]):b}function Z(){Object.keys(T).forEach(S=>delete T[S]),Object.keys(m).forEach(S=>delete m[S]),Object.keys(v).forEach(S=>delete v[S])}function F(){const S=Y[Math.floor(Math.random()*Y.length)];N.value=S,Z(),L.value=null,x.value=!1,U.forEach(b=>{v[b]=1});for(const[b,c]of Object.entries(E)){const h=S.solution[b];h&&c.forEach(($,R)=>{T[$]=null,m[$]=h[R]})}}function I(S){S.preventDefault()}function O(S,b){S.dataTransfer.setData("text/plain",b)}function H(S,b){S.preventDefault();const c=S.dataTransfer.getData("text/plain");if(c&&!((v[c]||0)<=0&&T[b]!==c)){if(T[b]!=null){const h=T[b];v[h]=(v[h]||0)+1}T[b]!==c&&(v[c]=(v[c]||0)-1,v[c]<0&&(v[c]=0)),T[b]=c,L.value=null,x.value=!1}}const X=W(()=>{const S=[];for(const[b,c]of Object.entries(v))for(let h=0;h<c;h++)S.push({digit:b,key:`${b}-${h}`});return S});function j(){return Object.keys(m).every(S=>T[S]!=null)}function w(S){const c=E[S].map(h=>T[h]);return Number(c.join(""))}async function g(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function u(){if(!j()){L.value=n[a.value].needAll,C&&C.play();return}const S=w("n1"),b=w("d1"),c=w("n2"),h=w("d2"),$=Number(T.res);if(!b||!h){L.value=n[a.value].wrong,C&&C.play();return}const R=S/b+c/h;Math.abs(R-$)<1e-6?(L.value=n[a.value].correct,x.value=!0,A&&A.play(),B&&B.play(),await g()):(L.value=n[a.value].wrong,C&&C.play())}function p(){for(const S of Object.keys(T))if(T[S]!=null){const b=T[S];v[b]=(v[b]||0)+1,T[S]=null}L.value=null,x.value=!1}return _e(F),ge(()=>D.lang,()=>{x.value||(L.value=null)}),(S,b)=>(l(),o("div",{class:"lvl3c5 challenge-surface","data-theme":D.theme},[e("header",Qi,[e("h2",Hi,t(n[a.value].title),1),(l(!0),o(te,null,ne(n[a.value].intro,(c,h)=>(l(),o("p",{key:h,class:"intro"},t(c),1))),128))]),e("section",Gi,[e("div",Wi,[e("div",Vi,[(l(!0),o(te,null,ne(E.n1,c=>(l(),o("div",{key:c,class:"slot",onDragover:I,onDrop:h=>H(h,c)},[T[c]?(l(),o("span",Yi,t(q(T[c])),1)):(l(),o("span",Ji,"?"))],40,Ki))),128))]),b[1]||(b[1]=e("div",{class:"bar"},null,-1)),e("div",Xi,[(l(!0),o(te,null,ne(E.d1,c=>(l(),o("div",{key:c,class:"slot",onDragover:I,onDrop:h=>H(h,c)},[T[c]?(l(),o("span",ec,t(q(T[c])),1)):(l(),o("span",tc,"?"))],40,Zi))),128))])]),b[3]||(b[3]=e("span",{class:"op"},"+",-1)),e("div",ac,[e("div",nc,[(l(!0),o(te,null,ne(E.n2,c=>(l(),o("div",{key:c,class:"slot",onDragover:I,onDrop:h=>H(h,c)},[T[c]?(l(),o("span",sc,t(q(T[c])),1)):(l(),o("span",oc,"?"))],40,lc))),128))]),b[2]||(b[2]=e("div",{class:"bar"},null,-1)),e("div",rc,[(l(!0),o(te,null,ne(E.d2,c=>(l(),o("div",{key:c,class:"slot",onDragover:I,onDrop:h=>H(h,c)},[T[c]?(l(),o("span",cc,t(q(T[c])),1)):(l(),o("span",uc,"?"))],40,ic))),128))])]),b[4]||(b[4]=e("span",{class:"op"},"=",-1)),e("div",{class:"target-slot",onDragover:I,onDrop:b[0]||(b[0]=c=>H(c,"res"))},[T.res?(l(),o("span",dc,t(q(T.res)),1)):(l(),o("span",vc,"?"))],32)]),e("section",hc,[e("button",{class:"btn",onClick:u},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:p},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn",onClick:F},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),e("section",pc,[e("div",fc,t(n[a.value].bank),1),e("div",mc,[(l(!0),o(te,null,ne(X.value,c=>(l(),o("button",{key:c.key,class:"chip",draggable:"true",onDragstart:h=>O(h,c.digit)},t(q(c.digit)),41,gc))),128))])]),Q($e,{name:"fade"},{default:ke(()=>[L.value?(l(),o("div",{key:0,class:oe(["feedback",{ok:x.value}])},t(L.value),3)):ie("",!0)]),_:1})],8,qi))}},yc=me(_c,[["__scopeId","data-v-7304f2b0"]]),bc=["data-theme"],kc={class:"head"},wc={class:"title"},$c={class:"intro"},Cc={class:"problem"},xc={class:"decimal-card"},Sc={class:"label"},Ac={class:"decimal-display"},Dc={class:"slots"},Tc=["onDrop"],Mc={key:0,class:"digit"},Lc={key:1,class:"placeholder"},Nc=["onClick"],Pc={class:"fraction-card"},Ec={class:"label"},zc={class:"fraction"},Bc={class:"row"},Oc=["onDrop"],jc={key:0,class:"digit"},Rc={key:1,class:"placeholder"},Ic=["onClick"],Fc={class:"row"},Uc=["onDrop"],qc={key:0,class:"digit"},Qc={key:1,class:"placeholder"},Hc=["onClick"],Gc={class:"controls"},Wc={class:"bank"},Vc={class:"bank-title"},Kc={class:"bank-items"},Yc=["onDragstart"],Jc={__name:"challenge_level_three_6",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثالث – التحدي 6: كسور مكافئة",intro:"اسحب الأرقام المتاحة وضعها في الخانات بحيث يكون الكسر الاعتيادي مساويًا للقيمة العشرية المعطاة.",decimals:"القيمة العشرية",fraction:"الكسر المكافئ",bank:"البطاقات المتاحة",check:"تحقّق",reset:"مسح",newQ:"تحدٍ جديد",clear:"تفريغ",needAll:"املأ كل الخانات أولًا.",wrong:"القيم غير متكافئة، حاول ترتيبًا مختلفًا.",correct:"أحسنت! الكسور مكافئة."},en:{title:"Level 3 – Challenge 6: Equivalent Fractions",intro:"Drag the available digits into the slots so the fraction equals the given decimal value.",decimals:"Decimal value",fraction:"Equivalent fraction",bank:"Available cards",check:"Check",reset:"Clear",newQ:"New challenge",clear:"Clear",needAll:"Fill every slot first.",wrong:"Values are not equivalent. Try another arrangement.",correct:"Great! They are equivalent."}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(ze):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Ne):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");const E=[{id:"p1",decimal:{slots:["dec1","dec2"],digits:["2","5"]},fraction:{num:{slots:["num1"],digits:["1"]},den:{slots:["den1"],digits:["4"]}},digits:["1","2","4","5"]},{id:"p2",decimal:{slots:["dec1","dec2"],digits:["7","5"]},fraction:{num:{slots:["num1"],digits:["3"]},den:{slots:["den1"],digits:["4"]}},digits:["3","4","5","7"]},{id:"p3",decimal:{slots:["dec1"],digits:["6"]},fraction:{num:{slots:["num1"],digits:["3"]},den:{slots:["den1"],digits:["5"]}},digits:["3","5","6"]},{id:"p4",decimal:{slots:["dec1","dec2"],digits:["3","3"]},fraction:{num:{slots:["num1"],digits:["1"]},den:{slots:["den1"],digits:["3"]}},digits:["1","3"]}],Y=z(E[0]),N=ve({}),T=ve({}),m=ve({}),v=z(null),L=z(!1);function x(){Object.keys(N).forEach(u=>delete N[u]),Object.keys(T).forEach(u=>delete T[u]),Object.keys(m).forEach(u=>delete m[u])}function U(){const u=E[Math.floor(Math.random()*E.length)];Y.value=u,x(),v.value=null,L.value=!1;const{decimal:p,fraction:S}=u;p.slots.forEach((b,c)=>{N[b]=null,T[b]=p.digits[c]}),S.num.slots.forEach((b,c)=>{N[b]=null,T[b]=S.num.digits[c]}),S.den.slots.forEach((b,c)=>{N[b]=null,T[b]=S.den.digits[c]}),u.digits.forEach(b=>{m[b]=(m[b]||0)+1})}function P(u){u.preventDefault()}function q(u,p){u.dataTransfer.setData("text/plain",p)}function Z(u,p){u.preventDefault();const S=u.dataTransfer.getData("text/plain");if(S&&!((m[S]||0)<=0&&N[p]!==S)){if(N[p]!=null){const b=N[p];m[b]=(m[b]||0)+1}N[p]!==S&&(m[S]=(m[S]||0)-1,m[S]<0&&(m[S]=0)),N[p]=S,L.value=!1,v.value=null}}function F(u){if(N[u]!=null){const p=N[u];m[p]=(m[p]||0)+1,N[u]=null,L.value=!1,v.value=null}}const I=W(()=>{const u=[];for(const[p,S]of Object.entries(m))for(let b=0;b<S;b++)u.push({digit:p,key:`${p}-${b}`});return u});function O(){return Object.keys(T).every(u=>N[u]!=null)}function H(){return+`0.${Y.value.decimal.slots.map(S=>N[S]).join("")}`}function X(){const{fraction:u}=Y.value,p=u.num.slots.map(h=>N[h]).join(""),S=u.den.slots.map(h=>N[h]).join(""),b=Number(p),c=Number(S);return c?b/c:null}async function j(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function w(){if(!O()){v.value=n[a.value].needAll,C&&C.play();return}const u=H(),p=X();if(p==null){v.value=n[a.value].wrong,C&&C.play();return}Math.abs(u-p)<1e-6?(v.value=n[a.value].correct,L.value=!0,A&&A.play(),B&&B.play(),await j()):(v.value=n[a.value].wrong,C&&C.play())}function g(){Object.keys(N).forEach(u=>{if(N[u]!=null){const p=N[u];m[p]=(m[p]||0)+1,N[u]=null}}),L.value=!1,v.value=null}return _e(U),ge(()=>D.lang,()=>{L.value||(v.value=null)}),(u,p)=>(l(),o("div",{class:"lvl3c6 challenge-surface","data-theme":D.theme},[e("header",kc,[e("h2",wc,t(n[a.value].title),1),e("p",$c,t(n[a.value].intro),1)]),e("section",Cc,[e("div",xc,[e("div",Sc,t(n[a.value].decimals),1),e("div",Ac,[p[0]||(p[0]=e("span",{class:"fixed"},"0.",-1)),e("div",Dc,[(l(!0),o(te,null,ne(Y.value.decimal.slots,S=>(l(),o("div",{key:S,class:"slot",onDragover:P,onDrop:b=>Z(b,S)},[N[S]?(l(),o("span",Mc,t(N[S]),1)):(l(),o("span",Lc,"?")),e("button",{class:"clear",onClick:b=>F(S)},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)],8,Nc)],40,Tc))),128))])])]),p[2]||(p[2]=e("span",{class:"equals"},"=",-1)),e("div",Pc,[e("div",Ec,t(n[a.value].fraction),1),e("div",zc,[e("div",Bc,[(l(!0),o(te,null,ne(Y.value.fraction.num.slots,S=>(l(),o("div",{key:S,class:"slot",onDragover:P,onDrop:b=>Z(b,S)},[N[S]?(l(),o("span",jc,t(N[S]),1)):(l(),o("span",Rc,"?")),e("button",{class:"clear",onClick:b=>F(S)},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)],8,Ic)],40,Oc))),128))]),p[1]||(p[1]=e("div",{class:"bar"},null,-1)),e("div",Fc,[(l(!0),o(te,null,ne(Y.value.fraction.den.slots,S=>(l(),o("div",{key:S,class:"slot",onDragover:P,onDrop:b=>Z(b,S)},[N[S]?(l(),o("span",qc,t(N[S]),1)):(l(),o("span",Qc,"?")),e("button",{class:"clear",onClick:b=>F(S)},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)],8,Hc)],40,Uc))),128))])])])]),e("section",Gc,[e("button",{class:"btn",onClick:w},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:g},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn",onClick:U},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),e("section",Wc,[e("div",Vc,t(n[a.value].bank),1),e("div",Kc,[(l(!0),o(te,null,ne(I.value,S=>(l(),o("button",{key:S.key,class:"chip",draggable:"true",onDragstart:b=>q(b,S.digit)},t(S.digit),41,Yc))),128))])]),Q($e,{name:"fade"},{default:ke(()=>[v.value?(l(),o("div",{key:0,class:oe(["feedback",{ok:L.value}])},t(v.value),3)):ie("",!0)]),_:1})],8,bc))}},Xc=me(Jc,[["__scopeId","data-v-46279352"]]),Zc=["data-theme"],eu={class:"head"},tu={class:"title"},au={class:"intro"},nu={class:"status"},lu={class:"chip"},su={class:"chip"},ou={class:"graph"},ru={viewBox:"0 0 500 300"},iu=["x1","y1","x2","y2"],cu=["x","y"],uu=["onClick"],du=["cx","cy","r"],vu=["x","y"],hu={class:"controls"},pu={__name:"challenge_level_three_7",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثالث – التحدي 7: مسار الضرب",intro:"ابدأ من النقطة أ ثم اختر نقاطًا متصلة للوصول إلى ب بحيث يكون حاصل ضرب الأرقام على الأضلاع مساويًا للقيمة المطلوبة.",target:"القيمة المطلوبة",current:"الحاصل الحالي",check:"تحقّق",reset:"مسح آخر نقطة",newQ:"تحدٍ جديد",clearAll:"إعادة المسار",needStart:"ابدأ من النقطة أ.",invalid:"يجب اختيار نقطة متصلة.",wrong:"المسار لا يعطي القيمة المطلوبة، حاول مرة أخرى.",correct:"أحسنت! المسار يعطي القيمة المطلوبة."},en:{title:"Level 3 – Challenge 7: Multiplication Path",intro:"Start at point A and travel along connected nodes to reach B so the product of edge values equals the required target.",target:"Target product",current:"Current product",check:"Check",reset:"Undo last",newQ:"New challenge",clearAll:"Clear path",needStart:"Start from node A.",invalid:"Pick a connected node.",wrong:"Path does not meet the target—try again.",correct:"Great! The path matches the target."}},a=W(()=>n[D.lang]?D.lang:"ar"),A=typeof Audio!="undefined"?new Audio(Pe):null,B=typeof Audio!="undefined"?new Audio(xe):null,C=typeof Audio!="undefined"?new Audio(Fe):null;A&&(A.preload="auto"),B&&(B.preload="auto"),C&&(C.preload="auto");const E=[{id:"p1",target:5,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:90},{id:"RB",x:340,y:210},{id:"CT",x:260,y:70},{id:"C",x:260,y:150},{id:"CB",x:260,y:230},{id:"LT",x:180,y:90},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:.5},{from:"RT",to:"CT",value:1},{from:"CT",to:"C",value:.5},{from:"C",to:"LT",value:2},{from:"LT",to:"B",value:2.5},{from:"A",to:"RB",value:2},{from:"RB",to:"CB",value:1.25},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1},{from:"LB",to:"B",value:2},{from:"CT",to:"CB",value:2},{from:"RT",to:"C",value:1.4},{from:"C",to:"LT",value:1.6}]},{id:"p2",target:6,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:100},{id:"RB",x:340,y:200},{id:"CT",x:260,y:60},{id:"C",x:260,y:150},{id:"CB",x:260,y:240},{id:"LT",x:180,y:100},{id:"LB",x:180,y:200}],edges:[{from:"A",to:"RT",value:1.5},{from:"RT",to:"CT",value:2},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:.5},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:2},{from:"C",to:"LB",value:1},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.2},{from:"C",to:"LT",value:1.5}]},{id:"p3",target:5.4,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:90},{id:"RB",x:340,y:210},{id:"CT",x:260,y:70},{id:"C",x:260,y:150},{id:"CB",x:260,y:230},{id:"LT",x:180,y:90},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:1.2},{from:"RT",to:"CT",value:1.5},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1.5},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:1.4},{from:"RB",to:"CB",value:1.1},{from:"CB",to:"C",value:1.2},{from:"C",to:"LB",value:1.3},{from:"LB",to:"B",value:1.8},{from:"RT",to:"C",value:1.3},{from:"CT",to:"CB",value:1.4}]},{id:"p4",target:4.5,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:110},{id:"RB",x:340,y:210},{id:"CT",x:260,y:90},{id:"C",x:260,y:160},{id:"CB",x:260,y:240},{id:"LT",x:180,y:120},{id:"LB",x:180,y:210}],edges:[{from:"A",to:"RT",value:1.1},{from:"RT",to:"CT",value:1.3},{from:"CT",to:"C",value:1.2},{from:"C",to:"LT",value:1.25},{from:"LT",to:"B",value:2},{from:"A",to:"RB",value:1.5},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1.4},{from:"LB",to:"B",value:1.8},{from:"RT",to:"C",value:1.4},{from:"CT",to:"CB",value:1.1}]},{id:"p5",target:7.2,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:95},{id:"RB",x:340,y:205},{id:"CT",x:260,y:65},{id:"C",x:260,y:150},{id:"CB",x:260,y:235},{id:"LT",x:180,y:105},{id:"LB",x:180,y:205}],edges:[{from:"A",to:"RT",value:1.2},{from:"RT",to:"CT",value:1.5},{from:"CT",to:"C",value:1},{from:"C",to:"LT",value:1.2},{from:"LT",to:"B",value:1.6},{from:"A",to:"RB",value:.9},{from:"RB",to:"CB",value:1.4},{from:"CB",to:"C",value:1.3},{from:"C",to:"LB",value:2},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.3},{from:"CT",to:"CB",value:1.2}]},{id:"p6",target:4.8,start:"A",end:"B",nodes:[{id:"A",label:"أ",x:420,y:150,type:"start"},{id:"B",label:"ب",x:80,y:150,type:"end"},{id:"RT",x:340,y:105},{id:"RB",x:340,y:215},{id:"CT",x:260,y:75},{id:"C",x:260,y:155},{id:"CB",x:260,y:235},{id:"LT",x:180,y:110},{id:"LB",x:180,y:215}],edges:[{from:"A",to:"RT",value:1.3},{from:"RT",to:"CT",value:1.2},{from:"CT",to:"C",value:1.1},{from:"C",to:"LT",value:1.4},{from:"LT",to:"B",value:1.7},{from:"A",to:"RB",value:1.25},{from:"RB",to:"CB",value:1.2},{from:"CB",to:"C",value:1},{from:"C",to:"LB",value:1.6},{from:"LB",to:"B",value:2},{from:"RT",to:"C",value:1.2},{from:"CT",to:"CB",value:1.3}]}];function Y(g,u){const p=u.find(b=>b.id===g.from),S=u.find(b=>b.id===g.to);return{...g,x1:p.x,y1:p.y,x2:S.x,y2:S.y,midX:(p.x+S.x)/2,midY:(p.y+S.y)/2}}const N=z(E[0]),T=z(null),m=z([]),v=z(null),L=z(!1),x=W(()=>N.value.nodes),U=W(()=>N.value.edges.map(g=>Y(g,x.value))),P=W(()=>{const g=[];for(let u=0;u<m.value.length-1;u++){const p=m.value[u],S=m.value[u+1],b=U.value.find(c=>c.from===p&&c.to===S||c.from===S&&c.to===p);b&&g.push(b)}return g}),q=W(()=>P.value.reduce((g,u)=>g*u.value,1));function Z(g,u){return U.value.some(p=>p.from===g&&p.to===u||p.from===u&&p.to===g)}function F(){if(E.length===1)return T.value=E[0].id,E[0];let g;do g=E[Math.floor(Math.random()*E.length)];while(g.id===T.value);return T.value=g.id,g}function I(){m.value=[],L.value=!1,v.value=null}function O(){m.value.length>0&&(m.value=m.value.slice(0,-1),L.value=!1,v.value=null)}async function H(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}function X(g){const{start:u,end:p}=N.value;if(!m.value.length){if(g.id!==u){v.value=n[a.value].needStart,C&&C.play();return}m.value=[g.id],v.value=null;return}const S=m.value[m.value.length-1];if(g.id===S)return;if(!Z(S,g.id)){v.value=n[a.value].invalid,C&&C.play();return}const b=m.value.slice();b.push(g.id),m.value=b,v.value=null,g.id===p&&j()}async function j(){const{end:g,target:u}=N.value;if(m.value[m.value.length-1]!==g){v.value=n[a.value].wrong,C&&C.play();return}Math.abs(q.value-u)<1e-6?(v.value=n[a.value].correct,L.value=!0,A&&A.play(),B&&B.play(),await H()):(v.value=n[a.value].wrong,L.value=!1,C&&C.play())}function w(){const g=F();N.value=g,I()}return _e(w),ge(()=>D.lang,()=>{L.value||(v.value=null)}),(g,u)=>(l(),o("div",{class:"lvl3c8 challenge-surface","data-theme":D.theme},[e("header",eu,[e("h2",tu,t(n[a.value].title),1),e("p",au,t(n[a.value].intro),1)]),e("section",nu,[e("div",lu,[J(t(n[a.value].target)+": ",1),e("strong",null,t(N.value.target),1)]),e("div",su,[J(t(n[a.value].current)+": ",1),e("strong",null,t(q.value.toFixed(3)),1)])]),e("section",ou,[(l(),o("svg",ru,[(l(!0),o(te,null,ne(U.value,p=>(l(),o("g",{key:p.from+p.to},[e("line",{x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,class:oe(["edge",{active:P.value.includes(p)}])},null,10,iu),e("text",{x:p.midX,y:p.midY,class:"edge-label"},t(p.value),9,cu)]))),128)),(l(!0),o(te,null,ne(x.value,p=>(l(),o("g",{key:p.id,class:"node",onClick:S=>X(p)},[e("circle",{cx:p.x,cy:p.y,r:p.type?20:12,class:oe(["point",p.type,{selected:m.value.includes(p.id)}])},null,10,du),e("text",{x:p.x,y:p.y+4,class:"node-label"},t(p.label||""),9,vu)],8,uu))),128))]))]),e("section",hu,[e("button",{class:"btn",onClick:j},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:O},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn",onClick:I},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].clearAll),1)]),e("button",{class:"btn",onClick:w},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),Q($e,{name:"fade"},{default:ke(()=>[v.value?(l(),o("div",{key:0,class:oe(["feedback",{ok:L.value}])},t(v.value),3)):ie("",!0)]),_:1})],8,Zc))}},fu=me(pu,[["__scopeId","data-v-db47ac07"]]),mu=["data-theme"],gu={class:"head"},_u={class:"title"},yu={class:"rule"},bu={class:"board"},ku={class:"cards"},wu=["onDrop"],$u={key:1,class:"placeholder"},Cu=["value","onInput","onChange","onBlur","placeholder"],xu=["onClick"],Su={class:"facts"},Au={class:"bank"},Du={class:"bank-title"},Tu={class:"bank-items"},Mu=["onDragstart"],Lu={class:"actions"},Nu=4,Pu={__name:"challenge_level_three_8",props:{lang:{type:String,default:"ar"},theme:{type:String,default:"light"}},setup(ee){const D=ee,n={ar:{title:"المستوى الثالث – التحدي 2: الأرقام المفقودة على البطاقات",rule:"أمامك بطاقات ملوّنة بأرقام مفقودة. استخدم المعلومات المعطاة (المجموع، المتوسط، الوسيط، المدى) لتحديد الرقم المناسب لكل بطاقة، ثم اسحبه من لوحة الأعداد أو اكتبه يدويًا.",bank:"لوحة الأعداد",newQ:"سؤال جديد",reset:"مسح",check:"تحقّق",correct:"أحسنت! الأرقام صحيحة.",wrong:"تحقّق من القيم مرة أخرى.",clear:"تفريغ البطاقة",hints:{sum:"المجموع",mean:"المتوسط الحسابي",median:"الوسيط",range:"المدى"},manualPlaceholder:"أدخل رقمًا"},en:{title:"Level 3 – Challenge 2: Missing numbers on the cards",rule:"Each coloured card is missing its number. Use the given information (sum, mean, median, range) to deduce the correct value for every card, then drag a number from the bank or type it manually.",bank:"Number bank",newQ:"New puzzle",reset:"Clear",check:"Check",correct:"Great! All numbers are correct.",wrong:"Something is off – recheck the values.",clear:"Clear card",hints:{sum:"Sum",mean:"Mean",median:"Median",range:"Range"},manualPlaceholder:"Type value"}},a=W(()=>n[D.lang]?D.lang:"ar"),A=W(()=>D.lang==="ar"?"ar-EG":"en-US"),B=W(()=>({direction:"ltr",unicodeBidi:"isolate"})),C=typeof Audio!="undefined"?new Audio(Pe):null,E=typeof Audio!="undefined"?new Audio(xe):null,Y=typeof Audio!="undefined"?new Audio(Ne):null;C&&(C.preload="auto"),E&&(E.preload="auto"),Y&&(Y.preload="auto");const N=["green","gold","teal","magenta","sky","orange","crimson"],T=[{numbers:[4,8,12,16,20]},{numbers:[5,9,11,13,22]},{numbers:[7,10,12,18,23]},{numbers:[6,8,15,19,22]},{numbers:[9,11,14,20,26]}];function m(y){const M=y.slice().sort((ce,be)=>ce-be),G=M.reduce((ce,be)=>ce+be,0),K=G/M.length,le=M[Math.floor(M.length/2)],re=M.at(-1)-M[0];return{sum:G,mean:K,median:le,range:re}}const v=z([]),L=ve({}),x=z(new Set),U=ve({}),P=ve({}),q=ve({}),Z=ve({}),F=ve({}),I=ve({}),O=z({sum:0,mean:0,median:0,range:0}),H=z(null),X=z(!1);function j(y){for(const M of Object.keys(y))delete y[M]}function w(){const M=T[Math.floor(Math.random()*T.length)].numbers.slice(),G=N.slice(0,M.length).sort(()=>Math.random()-.5),K=M.slice().sort(()=>Math.random()-.5);v.value=[],x.value=new Set,j(L),j(Z),j(F),j(I),j(U),j(P),j(q),K.forEach((pe,Te)=>{const Ee=`card-${Te}`;v.value.push({id:Ee,value:pe,color:G[Te%G.length]}),L[Ee]=pe,x.value.add(Ee),U[pe]=(U[pe]||0)+1});for(const[pe,Te]of Object.entries(U))q[pe]=Te;const le=Math.min(...M),re=Math.max(...M),ce=Math.max(1,le-12),be=re+12,he=new Set;for(;he.size<Nu;){const pe=Math.floor(Math.random()*(be-ce+1))+ce;U[pe]||he.add(pe)}he.forEach(pe=>{P[pe]=(P[pe]||0)+1,q[pe]=(q[pe]||0)+1}),O.value=m(M),H.value=null,X.value=!1}function g(y,M){y.dataTransfer.setData("text/plain",String(M))}function u(y){y.preventDefault()}function p(y,M,G){if(!Number.isFinite(M))return!1;if(Z[y]!=null&&F[y]==="bank"){const K=Z[y];q[K]=(q[K]||0)+1}if(G==="bank"){if((q[M]||0)<=0)return!1;q[M]=Math.max(0,(q[M]||0)-1)}return Z[y]=M,F[y]=G,I[y]=String(M),H.value=null,X.value=!1,!0}function S(y,M){y.preventDefault();const G=Number(y.dataTransfer.getData("text/plain"));Number.isNaN(G)||p(M,G,"bank")}function b(y){if(Z[y]!=null&&F[y]==="bank"){const M=Z[y];q[M]=(q[M]||0)+1}delete Z[y],delete F[y],I[y]="",H.value=null,X.value=!1}function c(){for(const y of x.value)if(Z[y]==null)return!1;return!0}function h(){for(const y of x.value)if(Z[y]!==L[y])return!1;return!0}async function $(){try{await fetch("/api/method/mathematics_leaders.api.game_points.add_point?amount=1",{method:"GET",credentials:"include"})}catch{}}async function R(){if(!c()){H.value=a.value==="ar"?"أكمل كل البطاقات أولاً.":"Fill every card first.",Y&&Y.play();return}h()?(X.value=!0,H.value=n[a.value].correct,C&&C.play(),E&&E.play(),await $()):(H.value=n[a.value].wrong,Y&&Y.play())}function d(){j(Z),j(F),j(I),j(q);for(const[y,M]of Object.entries(U))q[y]=M;for(const[y,M]of Object.entries(P))q[y]=(q[y]||0)+M;H.value=null,X.value=!1}const s=W(()=>{const y=[];for(const[M,G]of Object.entries(q))for(let K=0;K<G;K++)y.push({value:Number(M),key:`${M}-${K}`});return y.sort((M,G)=>M.value-G.value)});function r(y,M){I[y]=M}function i(y){var K;const M=((K=I[y])!=null?K:"").trim();if(M===""){b(y);return}const G=Number(M);Number.isFinite(G)&&p(y,G,"manual")}const _=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"];function f(y){const M=String(y);return D.lang==="ar"?M.replace(/[0-9]/g,G=>_[Number(G)]):M}function k(y,M={}){return new Intl.NumberFormat(A.value,M).format(y)}return _e(w),ge(()=>D.lang,()=>{X.value||(H.value=null)}),(y,M)=>(l(),o("div",{class:"lvl3c2 challenge-surface","data-theme":D.theme},[e("header",gu,[e("h2",_u,t(n[a.value].title),1),e("p",yu,t(n[a.value].rule),1)]),e("section",bu,[e("div",ku,[(l(!0),o(te,null,ne(v.value,G=>{var K;return l(),o("div",{key:G.id,class:oe(["card","color-"+G.color])},[e("div",{class:"drop",onDragover:u,onDrop:le=>S(le,G.id)},[Z[G.id]!=null?(l(),o("span",{key:0,class:"num",style:ue(B.value)},t(f(Z[G.id])),5)):(l(),o("span",$u,"؟"))],40,wu),e("input",{class:"manual-entry",type:"number",inputmode:"numeric",style:ue(B.value),value:(K=I[G.id])!=null?K:"",onInput:le=>r(G.id,le.target.value),onChange:le=>i(G.id),onBlur:le=>i(G.id),placeholder:n[a.value].manualPlaceholder},null,44,Cu),e("button",{class:"clear",onClick:le=>b(G.id)},[Q(V(Se),{class:"ic"}),J(" "+t(n[a.value].clear),1)],8,xu)],2)}),128))]),e("aside",Su,[e("h3",null,t(D.lang==="ar"?"المعلومات المتاحة":"Given facts"),1),e("ul",null,[e("li",null,[e("strong",null,t(n[a.value].hints.sum)+":",1),M[0]||(M[0]=J()),e("span",{style:ue(B.value)},t(k(O.value.sum)),5)]),e("li",null,[e("strong",null,t(n[a.value].hints.mean)+":",1),M[1]||(M[1]=J()),e("span",{style:ue(B.value)},t(k(O.value.mean,{maximumFractionDigits:2})),5)]),e("li",null,[e("strong",null,t(n[a.value].hints.median)+":",1),M[2]||(M[2]=J()),e("span",{style:ue(B.value)},t(k(O.value.median)),5)]),e("li",null,[e("strong",null,t(n[a.value].hints.range)+":",1),M[3]||(M[3]=J()),e("span",{style:ue(B.value)},t(k(O.value.range)),5)])])])]),e("section",Au,[e("div",Du,t(n[a.value].bank),1),e("div",Tu,[(l(!0),o(te,null,ne(s.value,G=>(l(),o("button",{key:G.key,class:"chip",draggable:"true",onDragstart:K=>g(K,G.value),style:ue(B.value)},t(f(G.value)),45,Mu))),128))])]),e("section",Lu,[e("button",{class:"btn",onClick:d},[Q(V(Ce),{class:"ic"}),J(" "+t(n[a.value].reset),1)]),e("button",{class:"btn",onClick:R},[Q(V(we),{class:"ic"}),J(" "+t(n[a.value].check),1)]),e("button",{class:"btn",onClick:w},[Q(V(ye),{class:"ic"}),J(" "+t(n[a.value].newQ),1)])]),Q($e,{name:"fade"},{default:ke(()=>[H.value?(l(),o("div",{key:0,class:oe(["toast",{ok:X.value}])},t(H.value),3)):ie("",!0)]),_:1})],8,mu))}},Eu=me(Pu,[["__scopeId","data-v-abb006e5"]]),Xe="ml-toast";function Ie({message:ee,type:D="info",duration:n=2600}={}){var a;ee&&window.dispatchEvent(new CustomEvent(Xe,{detail:{message:ee,type:D,duration:n,id:((a=crypto.randomUUID)==null?void 0:a.call(crypto))||Math.random().toString(36).slice(2),timestamp:Date.now()}}))}function zu(ee){return window.addEventListener(Xe,ee),()=>window.removeEventListener(Xe,ee)}const Ze=z(null),Ct=z(null),xt=z(null),St=z(null),Qe=z(!1),He=z(null),et=z(0),At=z(null),Dt=z(null),Tt=z(null);async function Bu(ee=!1){var n;const D=Date.now();if(!(!ee&&Ze.value!==null&&D-et.value<6e4)&&!Qe.value){Qe.value=!0,He.value=null;try{const a=await fetch("/api/method/mathematics_leaders.api.game_points.get_points",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),A=await a.json();if(!a.ok||!((n=A==null?void 0:A.message)!=null&&n.ok))throw new Error((A==null?void 0:A.message)||"Unable to load score");const B=A.message;Ze.value=Number(B.points||0),Ct.value=B.rank||1,xt.value=B.players||1,St.value=Number(B.best||B.points||0),At.value=B.profile_image||null,Dt.value=B.username||null,Tt.value=B.game_user_name||null,et.value=D}catch(a){He.value=a instanceof Error?a.message:String(a),Ie({message:He.value,type:"danger"})}finally{Qe.value=!1}}}function nt(){return{score:Ze,rank:Ct,totalPlayers:xt,bestScore:St,loading:Qe,error:He,lastUpdated:et,profileImage:At,username:Dt,gameUserName:Tt,refresh:Bu}}const Ou=["dir","data-theme"],ju={class:"overview"},Ru={class:"panel donut-panel"},Iu={class:"panel__header"},Fu={class:"tier-chip"},Uu=["disabled"],qu={class:"donut"},Qu={viewBox:"0 0 160 160","aria-hidden":"true"},Hu={class:"donut__label"},Gu={class:"panel__footer"},Wu={class:"progress-caption"},Vu={class:"timestamp"},Ku={class:"panel spark-panel"},Yu={class:"panel__header"},Ju={class:"panel__title"},Xu={class:"spark"},Zu={viewBox:"0 0 180 72","aria-hidden":"true"},ed=["d"],td=["d"],ad={class:"spark__meta"},nd={class:"spark__hint"},ld={class:"metrics"},sd={class:"metric__label"},od={class:"metric__value"},rd={class:"insights"},id={class:"insights__grid"},cd={class:"insight-card__icon"},ud={class:"insight-card__body"},dd={key:0,class:"error"},yt=9,Ke=58,vd={__name:"my_scores",setup(ee){const{score:D,rank:n,totalPlayers:a,bestScore:A,loading:B,error:C,lastUpdated:E,refresh:Y}=nt(),N=()=>(document.documentElement.lang||"").toLowerCase().startsWith("en")||(localStorage.getItem("ml_lang")||"").toLowerCase().startsWith("en")?"en":"ar",T=()=>localStorage.getItem("ml_theme")||"light",m=z(N()),v=z(T()),L=W(()=>m.value==="ar"),x=W(()=>m.value==="ar"?{totalPoints:"إجمالي النقاط",progressLabel:"التقدم نحو الرتبة التالية",refresh:"تحديث النقاط",lastUpdated:"آخر تحديث",insightHeading:"تحليلات سريعة",scoreTrendTitle:"منحنى الأداء",scoreTrendCopy:"يميل الأداء إلى التحسن خلال آخر المحاولات.",percentRankTitle:"موقعك بين اللاعبين",topTierCopy:"لقد بلغت أعلى رتبة متاحة! استمر في التألق.",nextTierLabel:"المتبقي للوصول للرتبة التالية",recordTitle:"أفضل نتيجة مسجلة",sparkLabel:"تحوّل النقاط (آخر الجلسات)",metricsHeading:"مؤشرات سريعة",playersLabel:"عدد اللاعبين",rankLabel:"ترتيبك",recordLabel:"رقمك القياسي",minutesAgo:"منذ دقائق",justNow:"الآن"}:{totalPoints:"Total points",progressLabel:"Progress to next tier",refresh:"Refresh score",lastUpdated:"Last updated",insightHeading:"Quick insights",scoreTrendTitle:"Performance trend",scoreTrendCopy:"Your recent attempts show an upward trend.",percentRankTitle:"Position among players",topTierCopy:"You already sit at the highest tier—keep shining!",nextTierLabel:"To reach the next tier",recordTitle:"Best recorded score",sparkLabel:"Score changes (recent sessions)",metricsHeading:"Key metrics",playersLabel:"Players",rankLabel:"Your rank",recordLabel:"Personal best",minutesAgo:"minutes ago",justNow:"just now"}),U=[{threshold:0,title:{ar:"مبتدئ الأرقام",en:"Number Novice"}},{threshold:25,title:{ar:"مستكشف الأنماط",en:"Pattern Explorer"}},{threshold:75,title:{ar:"مايسترو الرياضيات",en:"Math Maestro"}},{threshold:150,title:{ar:"أسطورة التحديات",en:"Challenge Legend"}}],P=W(()=>Number(D.value||0)),q=W(()=>Number(A.value||0)),Z=W(()=>{let K=0;return U.forEach((le,re)=>{P.value>=le.threshold&&(K=re)}),K}),F=W(()=>U[Z.value]),I=W(()=>U[Z.value+1]||null),O=W(()=>{var K,le,re,ce;return((le=(K=F.value)==null?void 0:K.title)==null?void 0:le[m.value])||((ce=(re=F.value)==null?void 0:re.title)==null?void 0:ce.en)||""}),H=W(()=>{if(!I.value)return 1;const K=I.value.threshold-F.value.threshold;return K<=0?1:Math.min(1,(P.value-F.value.threshold)/K)}),X=new Intl.NumberFormat("en-US",{maximumFractionDigits:0}),j=W(()=>X.format(P.value)),w=W(()=>X.format(q.value)),g=W(()=>n.value!=null?`#${n.value}`:"--"),u=W(()=>a.value!=null?X.format(a.value):"--"),p=W(()=>{if(!E.value)return"--";const K=Date.now()-E.value;return K<6e4?x.value.justNow:`${Math.round(K/6e4)} ${x.value.minutesAgo}`}),S=W(()=>{const K=Math.max(P.value,q.value,1),le=Math.max(10,K*.45),re=[];for(let ce=0;ce<yt;ce+=1){const be=ce/(yt-1),he=Math.sin((P.value+ce)*.35)*K*.05,pe=Math.max(0,le+(K-le)*be+he);re.push(Math.round(pe))}return re[re.length-1]=Math.max(P.value,0),re}),b=W(()=>{const K=S.value;if(!K.length)return[];const le=180,re=54,ce=Math.max(...K),be=Math.min(...K),he=ce-be||1;return K.map((pe,Te)=>{const Ee=K.length===1?le:le/(K.length-1)*Te,Ue=re-(pe-be)/he*re;return{x:Number(Ee.toFixed(2)),y:Number(Ue.toFixed(2)),value:pe}})}),c=W(()=>{const K=b.value;return K.length?K.map((le,re)=>`${re===0?"M":"L"}${le.x},${le.y}`).join(" "):""}),h=W(()=>{const K=b.value;if(!K.length)return"";const le=54,re=K[0],ce=K[K.length-1],be=K.map((he,pe)=>`L${he.x},${he.y}`).join(" ");return`M${re.x},${le} ${be} L${ce.x},${le} Z`}),$=W(()=>{const K=S.value;return K.length<2?0:K[K.length-1]-K[0]}),R=2*Math.PI*Ke,d=W(()=>R*(1-H.value)),s=W(()=>Math.round(H.value*100)),r=W(()=>!n.value||!a.value?null:Math.max(0,100-Math.round((n.value-1)/a.value*100))),i={trend:on,award:Ka,activity:Va,target:bt},_=W(()=>{const K=[];if(I.value){const le=Math.max(0,I.value.threshold-P.value);K.push({icon:"target",title:x.value.nextTierLabel,body:m.value==="ar"?`تبقى ${X.format(le)} نقطة للوصول إلى «${I.value.title.ar}».`:`${X.format(le)} pts to unlock “${I.value.title.en}”.`})}else K.push({icon:"target",title:x.value.nextTierLabel,body:(m.value==="ar",x.value.topTierCopy)});return K.push({icon:"trend",title:x.value.scoreTrendTitle,body:m.value==="ar"?`${x.value.scoreTrendCopy} (+${X.format(Math.max(0,$.value))}).`:`${x.value.scoreTrendCopy} (+${X.format(Math.max(0,$.value))}).`}),r.value!=null&&K.push({icon:"award",title:x.value.percentRankTitle,body:m.value==="ar"?`أنت ضمن أفضل ${r.value}% من اللاعبين.`:`You currently outperform ${r.value}% of players.`}),K.push({icon:"activity",title:x.value.recordTitle,body:m.value==="ar"?`أفضل نتيجة حققتها هي ${w.value} نقطة.`:`Your personal best sits at ${w.value} pts.`}),K}),f=W(()=>[{label:x.value.rankLabel,value:g.value},{label:x.value.playersLabel,value:u.value},{label:x.value.recordLabel,value:w.value}]);function k(){Y(!0)}let y=null,M=null,G=null;return _e(()=>{Y(!0);const K=()=>{m.value=N()},le=()=>{v.value=T()};y=new MutationObserver(K),y.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"]}),M=new MutationObserver(le),M.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),G=()=>{K(),le()},window.addEventListener("storage",G)}),tt(()=>{y&&y.disconnect(),M&&M.disconnect(),G&&window.removeEventListener("storage",G)}),(K,le)=>(l(),o("div",{class:"scores-page",dir:L.value?"rtl":"ltr","data-theme":v.value},[e("section",ju,[e("article",Ru,[e("header",Iu,[e("span",Fu,t(O.value),1),e("button",{class:"refresh","data-ripple":"",disabled:V(B),onClick:k},[Q(V(ye),{class:oe(["ic",{spin:V(B)}])},null,8,["class"]),J(" "+t(x.value.refresh),1)],8,Uu)]),e("div",qu,[(l(),o("svg",Qu,[le[0]||(le[0]=e("defs",null,[e("linearGradient",{id:"donutGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"#c8a03b"}),e("stop",{offset:"100%","stop-color":"#0f8a3e"})])],-1)),e("circle",{class:"track",cx:"80",cy:"80",r:Ke}),e("circle",{class:"progress",cx:"80",cy:"80",r:Ke,style:ue({strokeDasharray:`${R}px`,strokeDashoffset:`${d.value}px`})},null,4)])),e("div",Hu,[e("strong",null,t(j.value),1),e("span",null,t(x.value.totalPoints),1)])]),e("footer",Gu,[e("div",Wu,[e("span",null,t(x.value.progressLabel),1),e("span",null,t(s.value)+"%",1)]),e("div",Vu,t(x.value.lastUpdated)+" · "+t(p.value),1)])]),e("article",Ku,[e("header",Yu,[e("span",Ju,t(x.value.sparkLabel),1)]),e("div",Xu,[(l(),o("svg",Zu,[le[1]||(le[1]=e("defs",null,[e("linearGradient",{id:"sparkFill",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"rgba(15,138,62,0.35)"}),e("stop",{offset:"100%","stop-color":"rgba(200,160,59,0.05)"})])],-1)),h.value?(l(),o("path",{key:0,class:"spark__area",d:h.value,fill:"url(#sparkFill)"},null,8,ed)):ie("",!0),c.value?(l(),o("path",{key:1,class:"spark__path",d:c.value},null,8,td)):ie("",!0)])),e("div",ad,[e("span",{class:oe(["spark__delta",{up:$.value>=0}])},t($.value>=0?"+":"")+t(V(X).format($.value)),3),e("span",nd,t(x.value.scoreTrendCopy),1)])]),e("div",ld,[(l(!0),o(te,null,ne(f.value,re=>(l(),o("div",{key:re.label,class:"metric"},[e("span",sd,t(re.label),1),e("strong",od,t(re.value),1)]))),128))])])]),e("section",rd,[e("h3",null,t(x.value.insightHeading),1),e("div",id,[(l(!0),o(te,null,ne(_.value,(re,ce)=>(l(),o("article",{key:ce,class:"insight-card"},[e("div",cd,[(l(),De(je(i[re.icon]),{class:"glyph"}))]),e("div",ud,[e("h4",null,t(re.title),1),e("p",null,t(re.body),1)])]))),128))]),V(C)?(l(),o("p",dd,t(V(C)),1)):ie("",!0)])],8,Ou))}},hd=me(vd,[["__scopeId","data-v-d7a1a530"]]),pd=["dir","data-theme"],fd={class:"settings__header"},md={class:"page-title"},gd={class:"settings__grid"},_d={class:"settings-card profile-card"},yd={class:"card-header"},bd={class:"title"},kd={class:"card-body"},wd={class:"avatar-stack"},$d={class:"avatar-orbit"},Cd={class:"avatar-ring"},xd=["src"],Sd={key:1},Ad={class:"display-name"},Dd={class:"controls"},Td={class:"btn ghost","data-ripple":""},Md=["disabled"],Ld={key:"avatar-ok",class:"status success"},Nd={key:"avatar-err",class:"status error"},Pd={class:"settings-card password-card"},Ed={class:"card-header"},zd={class:"title"},Bd={class:"verify-block"},Od=["disabled"],jd={key:"verify-ok",class:"status success"},Rd={key:"verify-err",class:"status error"},Id={key:0,class:"password-fields"},Fd={class:"form-actions"},Ud=["disabled"],qd={key:"pass-ok",class:"status success"},Qd={key:"pass-err",class:"status error"},Hd={__name:"settings",setup(ee){const D=nt(),n=()=>(document.documentElement.lang||"").toLowerCase().startsWith("en")||(localStorage.getItem("ml_lang")||"").toLowerCase().startsWith("en")?"en":"ar",a=()=>localStorage.getItem("ml_theme")||"light",A=z(n()),B=z(a()),C=W(()=>A.value==="ar"),E=W(()=>A.value==="ar"?{title:"إعدادات الحساب",avatarTitle:"صورة البروفايل",avatarHint:"ارفع صورة مربعة بدقة جيدة (حتى 2 م.ب).",chooseFile:"اختر صورة",cancel:"إزالة التحديد",upload:"حفظ الصورة",loading:"جارٍ الرفع...",changeSuccess:"تم تحديث الصورة بنجاح.",changeError:"تعذر تحديث الصورة، حاول لاحقًا.",passwordTitle:"تغيير كلمة المرور",formHint:"استخدم كلمة مرور قوية تجمع بين الأحرف والأرقام والرموز.",currentPassword:"كلمة المرور الحالية",newPassword:"كلمة المرور الجديدة",confirmPassword:"تأكيد كلمة المرور",verify:"تحقّق",verified:"تم التحقق من كلمة المرور.",verifyError:"تحقق من كلمة المرور الحالية أولًا.",savePassword:"حفظ كلمة المرور",reset:"إعادة التعيين",passwordSuccess:"تم تغيير كلمة المرور بنجاح.",passwordError:"تعذر تغيير كلمة المرور، تحقق من البيانات.",selectImageFirst:"اختر صورة أولًا.",notImage:"الملف ليس صورة.",tooLarge:"حجم الصورة يتجاوز 2 م.ب.",missingPlayer:"تعذر إيجاد ملف اللاعب."}:{title:"Account settings",avatarTitle:"Profile picture",avatarHint:"Upload a crisp square image (up to 2 MB).",chooseFile:"Choose image",cancel:"Remove selection",upload:"Save avatar",loading:"Uploading...",changeSuccess:"Profile picture updated successfully.",changeError:"We could not update your picture. Try again later.",passwordTitle:"Change password",formHint:"Use a strong password that mixes letters, numbers, and symbols.",currentPassword:"Current password",newPassword:"New password",confirmPassword:"Confirm password",verify:"Verify",verified:"Password verified.",verifyError:"Verify your current password first.",savePassword:"Save password",reset:"Reset form",passwordSuccess:"Password updated successfully.",passwordError:"Unable to change password. Check your entries.",selectImageFirst:"Select an image first.",notImage:"The selected file is not an image.",tooLarge:"Image size exceeds 2 MB.",missingPlayer:"Unable to identify player record."}),Y=z(null),N=z(""),T=ve({loading:!1,message:"",error:""}),m=ve({current:"",next:"",confirm:""}),v=ve({loading:!1,verified:!1,message:"",error:""}),L=ve({loading:!1,message:"",error:""}),x=W(()=>D.username.value||"Player"),U=W(()=>x.value.trim().charAt(0).toUpperCase()||"P"),P=W(()=>N.value||D.profileImage.value||null);function q(g){var p;T.message="",T.error="";const u=(p=g.target.files)==null?void 0:p[0];if(!u){Z();return}if(!u.type.startsWith("image/")){T.error=E.value.notImage;return}if(u.size>2*1024*1024){T.error=E.value.tooLarge;return}N.value&&URL.revokeObjectURL(N.value),Y.value=u,N.value=URL.createObjectURL(u)}function Z(){N.value&&URL.revokeObjectURL(N.value),Y.value=null,N.value="",T.message="",T.error=""}async function F(){var u,p;if(!Y.value){T.error=E.value.selectImageFirst;return}D.gameUserName.value||await D.refresh(!0);const g=D.gameUserName.value;if(!g){T.error=E.value.missingPlayer;return}T.loading=!0,T.error="",T.message="";try{const S=new FormData;S.append("file",Y.value),S.append("filename",Y.value.name),S.append("is_private","0"),S.append("attached_to_doctype","Game Users"),S.append("attached_to_name",g);const b=await fetch("/api/method/upload_file",{method:"POST",credentials:"include",body:S}),c=await b.json();if(!b.ok||!((u=c==null?void 0:c.message)!=null&&u.file_url))throw new Error((c==null?void 0:c._server_messages)||(c==null?void 0:c.message)||"Upload failed");const h=c.message.file_url,$=await fetch("/api/method/mathematics_leaders.api.profile.set_profile_image",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_url:h})}),R=await $.json();if(!$.ok||!((p=R==null?void 0:R.message)!=null&&p.ok))throw new Error((R==null?void 0:R.message)||"Unable to store profile image");T.message=E.value.changeSuccess,Ie({message:E.value.changeSuccess,type:"success"}),await D.refresh(!0),Z()}catch(S){T.error=S instanceof Error?S.message:E.value.changeError,Ie({message:T.error,type:"danger"})}finally{T.loading=!1}}async function I(){var g;v.loading=!0,v.error="",v.message="";try{if(!m.current)throw new Error(E.value.verifyError);const u=await fetch("/api/method/mathematics_leaders.api.profile.verify_current_password",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:m.current})}),p=await u.json();if(!u.ok||!((g=p==null?void 0:p.message)!=null&&g.ok))throw new Error((p==null?void 0:p.message)||E.value.verifyError);v.verified=!0,v.message=E.value.verified,L.error=""}catch(u){v.verified=!1,v.error=u instanceof Error?u.message:E.value.verifyError}finally{v.loading=!1}}async function O(){var S;if(!v.verified){v.error=E.value.verifyError;return}L.loading=!0,L.message="",L.error="";const{current:g,next:u,confirm:p}=m;try{if(!g||!u||!p)throw new Error(A.value==="ar"?"املأ كل الحقول.":"Fill in every field.");if(u!==p)throw new Error(A.value==="ar"?"كلمتا المرور غير متطابقتين.":"Passwords do not match.");if(u.length<8)throw new Error(A.value==="ar"?"كلمة المرور يجب أن تكون 8 أحرف على الأقل.":"Password must be at least 8 characters.");const b=await fetch("/api/method/mathematics_leaders.api.profile.change_password",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:g,new_password:u})}),c=await b.json();if(!b.ok||!((S=c==null?void 0:c.message)!=null&&S.ok))throw new Error((c==null?void 0:c.message)||E.value.passwordError);L.message=E.value.passwordSuccess,Ie({message:E.value.passwordSuccess,type:"success"}),m.current="",m.next="",m.confirm="",v.verified=!1,v.message=""}catch(b){L.error=b instanceof Error?b.message:E.value.passwordError,Ie({message:L.error,type:"danger"})}finally{L.loading=!1}}function H(){m.current="",m.next="",m.confirm="",v.loading=!1,v.verified=!1,v.message="",v.error="",L.loading=!1,L.message="",L.error=""}let X=null,j=null,w=null;return _e(()=>{D.score.value==null&&D.refresh(!0);const g=()=>{A.value=n()},u=()=>{B.value=a()};X=new MutationObserver(g),X.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"]}),j=new MutationObserver(u),j.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),w=()=>{g(),u()},window.addEventListener("storage",w)}),tt(()=>{N.value&&URL.revokeObjectURL(N.value),X&&X.disconnect(),j&&j.disconnect(),w&&window.removeEventListener("storage",w)}),(g,u)=>(l(),o("div",{class:"settings",dir:C.value?"rtl":"ltr","data-theme":B.value},[e("header",fd,[Q(V(nn),{class:"heading-icon"}),e("h1",md,t(E.value.title),1)]),e("div",gd,[e("section",_d,[e("header",yd,[e("div",bd,[Q(V(pt),{class:"icon"}),e("div",null,[e("h2",null,t(E.value.avatarTitle),1),e("p",null,t(E.value.avatarHint),1)])])]),e("div",kd,[e("div",wd,[e("div",$d,[e("div",Cd,[P.value?(l(),o("img",{key:0,src:P.value,alt:"avatar preview"},null,8,xd)):(l(),o("span",Sd,t(U.value),1))])]),e("span",Ad,t(x.value),1)]),e("div",Dd,[e("label",Td,[Q(V(cn),{class:"icon"}),e("span",null,t(E.value.chooseFile),1),e("input",{type:"file",accept:"image/*",onChange:q,hidden:""},null,32)]),Y.value?(l(),o("button",{key:0,type:"button",class:"btn subtle","data-ripple":"",onClick:Z},t(E.value.cancel),1)):ie("",!0),e("button",{type:"button",class:"btn solid","data-ripple":"",disabled:T.loading,onClick:F},[T.loading?(l(),De(V(qe),{key:0,class:"icon spinner"})):(l(),De(V(pt),{key:1,class:"icon"})),e("span",null,t(T.loading?E.value.loading:E.value.upload),1)],8,Md)]),Q($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[T.message?(l(),o("p",Ld,[Q(V(Ve),{class:"icon"}),e("span",null,t(T.message),1)])):ie("",!0)]),_:1}),Q($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[T.error?(l(),o("p",Nd,t(T.error),1)):ie("",!0)]),_:1})])]),e("section",Pd,[e("header",Ed,[e("div",zd,[Q(V(Za),{class:"icon"}),e("div",null,[e("h2",null,t(E.value.passwordTitle),1),e("p",null,t(E.value.formHint),1)])])]),e("form",{class:"card-body password-form",onSubmit:Ge(O,["prevent"])},[e("div",Bd,[e("label",null,[e("span",null,t(E.value.currentPassword),1),Me(e("input",{type:"password","onUpdate:modelValue":u[0]||(u[0]=p=>m.current=p),autocomplete:"current-password"},null,512),[[Le,m.current]])]),e("button",{type:"button",class:"btn solid","data-ripple":"",disabled:v.loading,onClick:I},[v.loading?(l(),De(V(qe),{key:0,class:"icon spinner"})):(l(),De(V(we),{key:1,class:"icon"})),e("span",null,t(v.loading?E.value.loading:E.value.verify),1)],8,Od),Q($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[v.message?(l(),o("p",jd,[Q(V(Ve),{class:"icon"}),e("span",null,t(v.message),1)])):ie("",!0)]),_:1}),Q($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[v.error?(l(),o("p",Rd,t(v.error),1)):ie("",!0)]),_:1})]),Q($e,{name:"panel-grow"},{default:ke(()=>[v.verified?(l(),o("div",Id,[e("label",null,[e("span",null,t(E.value.newPassword),1),Me(e("input",{type:"password","onUpdate:modelValue":u[1]||(u[1]=p=>m.next=p),autocomplete:"new-password",required:""},null,512),[[Le,m.next]])]),e("label",null,[e("span",null,t(E.value.confirmPassword),1),Me(e("input",{type:"password","onUpdate:modelValue":u[2]||(u[2]=p=>m.confirm=p),autocomplete:"new-password",required:""},null,512),[[Le,m.confirm]])]),e("div",Fd,[e("button",{class:"btn success","data-ripple":"",type:"submit",disabled:L.loading},[L.loading?(l(),De(V(qe),{key:0,class:"icon spinner"})):(l(),De(V(we),{key:1,class:"icon"})),e("span",null,t(L.loading?E.value.loading:E.value.savePassword),1)],8,Ud),e("button",{type:"button",class:"btn subtle","data-ripple":"",onClick:H},[Q(V(ye),{class:"icon"}),e("span",null,t(E.value.reset),1)])]),Q($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[L.message?(l(),o("p",qd,[Q(V(Ve),{class:"icon"}),e("span",null,t(L.message),1)])):ie("",!0)]),_:1}),Q($e,{name:"fade-slide",mode:"out-in"},{default:ke(()=>[L.error?(l(),o("p",Qd,t(L.error),1)):ie("",!0)]),_:1})])):ie("",!0)]),_:1})],32)])])],8,pd))}},Gd=me(Hd,[["__scopeId","data-v-29b78927"]]),Wd=["dir"],Vd=["onClick"],Kd={class:"dashboard__topbar"},Yd={class:"topbar__left"},Jd=["aria-expanded","aria-label"],Xd={class:"brand-chip"},Zd={class:"brand-chip__logo"},ev=["src"],tv={class:"brand-chip__text"},av={class:"brand-chip__title"},nv={class:"brand-chip__subtitle"},lv={class:"topbar__center"},sv={class:"greet"},ov={class:"topbar__actions"},rv=["aria-label"],iv=["aria-label"],cv={class:"avatar"},uv={key:1,class:"avatar__initial"},dv={class:"profile__text"},vv={class:"profile__name"},hv={class:"profile__meta"},pv={key:0,class:"profile__menu"},fv={class:"dashboard__main"},mv={class:"overview-grid"},gv={class:"welcome-card"},_v={class:"welcome-card__icon"},yv={class:"welcome-card__copy"},bv={class:"welcome-card__metrics"},kv={class:"metric"},wv={class:"metric__label"},$v={class:"metric"},Cv={class:"metric__label"},xv=["aria-busy"],Sv={key:0,class:"score-card__overlay","aria-hidden":"true"},Av={class:"score-card__ring"},Dv={viewBox:"0 0 120 120",role:"presentation"},Tv={class:"score-card__center"},Mv={class:"score-card__details"},Lv={class:"score-card__tier"},Nv={class:"score-card__subtitle"},Pv=["aria-valuenow"],Ev={class:"progress__track"},zv={class:"progress__meta"},Bv={class:"mentor-card"},Ov={class:"mentor-card__badge"},jv={class:"challenge-section"},Rv={class:"challenge-list__header"},Iv={class:"levels"},Fv=["onClick"],Uv={class:"level-head__info"},qv={class:"level-head__title"},Qv={class:"level-head__count"},Hv={key:0,class:"challenge-cards"},Gv=["onClick"],Wv={class:"challenge-card__symbol"},Vv={class:"challenge-card__body"},Kv={class:"challenge-card__title"},Yv={class:"challenge-card__summary"},Jv={class:"challenge-card__cta"},Xv={class:"logout-block"},Zv={class:"challenge-preview"},eh={class:"preview-header"},th={key:0,class:"preview-pill"},ah={class:"preview-text"},nh={key:0},lh={key:1},sh={key:2},oh={key:3},rh={key:4},ih={key:5},ch={key:6},uh={key:7},dh={class:"preview-surface"},vh={class:"preview-placeholder",key:"placeholder"},hh={__name:"Dashboard",props:{view:{type:String,default:""}},setup(ee){var ot;const D=Ot(),n=ee,a=[{id:"level1",label:{ar:"المستوى الأول",en:"Level One"},challenges:[{id:"challenge_1",component:Pn,symbol:"∑",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"إكمال عملية جمع عمودية بأرقام مخفية.",en:"Complete a column addition puzzle with hidden digits."}},{id:"challenge_2",component:Xn,symbol:"√",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"شبكة أعداد تتزايد بمقدار ثابت، أعد القيم المفقودة.",en:"Fill a number grid that increases by a fixed step."}},{id:"challenge_3",component:hl,symbol:"π",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"اختر زوج الأعداد الصحيح حسب المجموع والفرق.",en:"Pick the number pair that matches the given sum and difference."}},{id:"challenge_4",component:Nl,symbol:"×",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"استكمل جدول ضرب مصغر.",en:"Complete the mini multiplication table."}},{id:"challenge_5",component:ns,symbol:"Δ",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"املأ مثلث الضرب على الأضلاع.",en:"Fill in the edge products of the triangle."}},{id:"challenge_6",component:ds,symbol:"≡",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"اختر ثلاث خلايا مختلفة الصف والعمود لتحقيق مجموع محدد.",en:"Pick three distinct-row/column cells to reach the target sum."}},{id:"challenge_7",component:As,symbol:"∴",label:{ar:"التحدي 7",en:"Challenge 7"},summary:{ar:"أكمل هرم الجمع بإسقاط القيم الصحيحة.",en:"Complete the sum pyramid with the correct values."}}]},{id:"level2",label:{ar:"المستوى الثاني",en:"Level Two"},challenges:[{id:"challenge_level_two_1",component:qs,symbol:"∫",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"كوّن تعبيرًا يستخدم الأرقام 1 إلى 5 مرة واحدة.",en:"Build an expression that uses digits 1–5 exactly once."}},{id:"challenge_level_two_2",component:no,symbol:"≠",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"أكمل مربّعًا سحريًا بمجاميع متساوية.",en:"Complete a magic square with equal sums."}},{id:"challenge_level_two_3",component:No,symbol:"≈",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"طابق أعدادًا سداسية مع خواص القسمة.",en:"Match six-digit numbers to divisibility rules."}},{id:"challenge_level_two_4",component:Fo,symbol:"∞",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"اختر الزوج الذي يطابق المجموع والفرق.",en:"Choose the pair that matches the required sum and difference."}},{id:"challenge_level_two_5",component:wr,symbol:"∂",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"اكمل طرح الكسور بوضع الأعداد الصحيحة.",en:"Complete the fraction subtraction by placing the right integers."}},{id:"challenge_level_two_6",component:Nr,symbol:"⊗",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"رتّب خطوات حل معادلة الموازين.",en:"Order the solution steps for the balance puzzle."}}]},{id:"level3",label:{ar:"المستوى الثالث",en:"Level Three"},challenges:[{id:"challenge_level_three_1",component:Wr,symbol:"Φ",label:{ar:"التحدي 1",en:"Challenge 1"},summary:{ar:"ابن هرم الضرب من أرقام مبعثرة.",en:"Rebuild the multiplication pyramid from scattered numbers."}},{id:"challenge_level_three_2",component:hi,symbol:"Ψ",label:{ar:"التحدي 2",en:"Challenge 2"},summary:{ar:"لغز تفكير متقدم في الأعداد.",en:"An advanced numerical reasoning puzzle."}},{id:"challenge_level_three_3",component:xi,symbol:"Λ",label:{ar:"التحدي 3",en:"Challenge 3"},summary:{ar:"لغز منطق متقدم لاختبار السرعة.",en:"Advanced logic to test your speed."}},{id:"challenge_level_three_4",component:Ui,symbol:"Ξ",label:{ar:"التحدي 4",en:"Challenge 4"},summary:{ar:"تحدٍ عالي المستوى لربط الأنماط.",en:"High-level challenge for spotting patterns."}},{id:"challenge_level_three_5",component:yc,symbol:"Θ",label:{ar:"التحدي 5",en:"Challenge 5"},summary:{ar:"مسألة حسابية تحتاج إلى خطوات دقيقة.",en:"A numeric problem that needs careful steps."}},{id:"challenge_level_three_6",component:Xc,symbol:"β",label:{ar:"التحدي 6",en:"Challenge 6"},summary:{ar:"إستراتيجية جديدة لبناء الحل خطوة بخطوة.",en:"Strategic puzzle solved step by step."}},{id:"challenge_level_three_7",component:fu,symbol:"η",label:{ar:"التحدي 7",en:"Challenge 7"},summary:{ar:"اختبار المنطق السريع بالأرقام.",en:"Fast-paced numeric logic test."}},{id:"challenge_level_three_8",component:Eu,symbol:"ζ",label:{ar:"التحدي 8",en:"Challenge 8"},summary:{ar:"لغز أخير يجمع بين التفكير والسرعة.",en:"A final puzzle mixing reasoning with speed."}}]}],A=nt(),B=[{threshold:0,title:{ar:"مبتدئ",en:"Novice"}},{threshold:25,title:{ar:"متقدم",en:"Skilled"}},{threshold:80,title:{ar:"قائد",en:"Leader"}},{threshold:160,title:{ar:"أسطورة",en:"Legend"}}],C=W(()=>Number(A.score.value||0)),E=W(()=>{let ae=0;return B.forEach((se,de)=>{C.value>=se.threshold&&(ae=de)}),ae}),Y=W(()=>B[E.value]),N=W(()=>B[E.value+1]||null),T=W(()=>{var ae,se,de,Ae;return((se=(ae=Y.value)==null?void 0:ae.title)==null?void 0:se[w.value])||((Ae=(de=Y.value)==null?void 0:de.title)==null?void 0:Ae.en)||""}),m=W(()=>{if(!N.value)return 1;const ae=N.value.threshold-Y.value.threshold;return ae<=0?1:Math.min(1,(C.value-Y.value.threshold)/ae)}),v=new Intl.NumberFormat("en-US",{maximumFractionDigits:0}),L=W(()=>v.format(C.value));W(()=>{const ae=A.rank.value;return ae?`#${ae}`:"--"});const x=W(()=>{const ae=A.totalPlayers.value;return ae?v.format(ae):"--"}),U=W(()=>A.loading.value),P=W(()=>Math.round(m.value*100)),q=W(()=>A.profileImage.value||null),Z=W(()=>(G.value||A.username.value||M.value||"P").trim().charAt(0).toUpperCase()||"P"),F=W(()=>U.value?"loading":`score-${C.value}`),I=z(0),O=z(!1);ge(m,ae=>{I.value=ae},{immediate:!0}),ge(()=>A.score.value,(ae,se)=>{se==null||Number(ae)===Number(se)||(O.value=!1,requestAnimationFrame(()=>{O.value=!0,setTimeout(()=>{O.value=!1},720)}))});function H(){Ee("/scores")}const X={};a.forEach(ae=>{ae.challenges.forEach(se=>{X[se.id]=se.component})});const j={scores:hd,settings:Gd},w=z(localStorage.getItem("ml_lang")||"ar"),g=W(()=>w.value==="ar"?"rtl":"ltr"),u={ar:{challenges:"المستوى الأول",challenges2:"المستوى الثاني",myScores:"درجاتي",settings:"الإعدادات",logout:"خروج",hello:"مرحبًا",sub:"اختر تحديًا وابدأ اللعب!",challenge:"التحدي",brand:"زعماء الرياضيات",tagline:"رحلة إنجاز رقمية",pickPrompt:"اختر تحديًا من البطاقات أدناه للبدء.",cardCTA:"ابدأ التحدي",scoreWidgetTitle:"نقاطي",scoreWidgetSubtitle:"نظرة سريعة على تقدّمك",scoreWidgetRank:"الترتيب",scoreWidgetPlayers:"عدد اللاعبين",scoreWidgetProgress:"نحو الرتبة التالية",scoreWidgetView:"عرض التفاصيل",scoreWidgetLoading:"جار تحديث النقاط...",teacherTitle:"الشريك التربوي",teacherSubtitle:"ميعاد سفر المالكي",teacherMessage:"✨ “من هنا بدأت الرحلة… رحلة شغف صاغتها الأستاذة ميعاد سفر المالكي لتلهم طلابها نحو الإبداع والتفكير."},en:{challenges:"Level One",challenges2:"Level Two",myScores:"My Scores",settings:"Settings",logout:"Log out",hello:"Hello",sub:"Pick a challenge and start!",challenge:"Challenge",brand:"Math Leaders",tagline:"Interactive mastery journey",pickPrompt:"Select a challenge from the cards below to get started.",cardCTA:"Start challenge",scoreWidgetTitle:"My points",scoreWidgetSubtitle:"Quick glance at your progress",scoreWidgetRank:"Rank",scoreWidgetPlayers:"Players",scoreWidgetProgress:"To next tier",scoreWidgetView:"View details",scoreWidgetLoading:"Refreshing score...",teacherTitle:"Presented by",teacherSubtitle:"Miyaad Safar Al-Malki",teacherMessage:"A heartfelt thanks to Ms. Miyaad Safar Al-Malki for curating these inspiring challenges."}},p=ae=>u[w.value][ae],S=W(()=>n.view||"");ge(w,ae=>{localStorage.setItem("ml_lang",ae),document.documentElement.dir=g.value,document.documentElement.lang=ae});const b=z(localStorage.getItem("ml_theme")||"light"),c=z(!1),h=z(!1),$=z([]);function R(ae){document.documentElement.setAttribute("data-ml-theme",ae)}let d=null;function s(){c.value=!0,window.clearTimeout(s.timer),s.timer=window.setTimeout(()=>{c.value=!1},360)}function r(ae){$.value=$.value.filter(se=>se.id!==ae)}function i(){s(),w.value=w.value==="ar"?"en":"ar"}function _(){s(),b.value=b.value==="light"?"dark":"light"}ge(b,ae=>{localStorage.setItem("ml_theme",ae),R(ae)});function f(){if(typeof window=="undefined")return;const ae=window.matchMedia("(max-width: 1024px)").matches;h.value=ae,ae||(ce.value=!1)}function k(ae){re.value&&(re.value.contains(ae.target)||(le.value=!1))}async function y(ae,se={}){const de=new URLSearchParams(se).toString(),Ae=await fetch(ae+(de?`?${de}`:""),{method:"GET",credentials:"include"}),We=await Ae.json().catch(()=>({}));if(!Ae.ok)throw We;return We}const M=z("player"),G=z("");async function K(){try{const ae=await y("/api/method/mathematics_leaders.api.get_my_details.get_me"),se=ae==null?void 0:ae.message;if(!(se!=null&&se.ok)){D.replace("/");return}const de=se.profile||{};M.value=de.username||"player",G.value=de.full_name||"",de.language&&!localStorage.getItem("ml_lang")&&(w.value=de.language)}catch{D.replace("/")}}const le=z(!1),re=z(null),ce=z(!1),be=ve(Object.fromEntries(a.map(ae=>[ae.id,!1]))),he=z(((ot=a[0])==null?void 0:ot.id)||"level1"),pe=z(null);function Te(){ce.value=!ce.value}function Ee(ae){D.push(ae)}async function Ue(){await y("/api/method/logout"),D.replace("/")}function Mt(ae){be[ae]=!be[ae]}function lt(ae){return!!be[ae]}function Lt(ae,se){be[ae]=!0,he.value=ae,pe.value=se,h.value&&(ce.value=!0),D.currentRoute.value.path!=="/home"&&D.push("/home")}function Nt(ae,se){return he.value===ae&&pe.value===se}const Be=W(()=>{if(n.view&&j[n.view])return{level:null,challenge:null};if(!pe.value)return{level:a.find(se=>se.id===he.value)||null,challenge:null};for(const ae of a){const se=ae.challenges.find(de=>de.id===pe.value);if(se)return{level:ae,challenge:se}}return{level:a.find(ae=>ae.id===he.value)||null,challenge:null}}),st=W(()=>{if(n.view&&j[n.view])return j[n.view];const ae=pe.value;return ae?X[ae]:null});_e(()=>{document.documentElement.dir=g.value,document.documentElement.lang=w.value,R(b.value),K(),A.refresh(),f(),h.value&&(ce.value=!0),typeof window!="undefined"&&window.addEventListener("resize",f),document.addEventListener("click",k),d=zu(ae=>{const se=ae.detail||{};if(!se.message)return;const de={id:se.id||Math.random().toString(36).slice(2),message:se.message,type:se.type||"info"};$.value.push(de),$.value.length>4&&$.value.shift();const Ae=Math.max(1500,se.duration||2600);window.setTimeout(()=>r(de.id),Ae)})}),tt(()=>{d&&d(),window.clearTimeout(s.timer),typeof window!="undefined"&&window.removeEventListener("resize",f),document.removeEventListener("click",k)});const Pt=new URL("/assets/mathematics_leaders/frontend/assets/logo3.jpeg",import.meta.url).href;return(ae,se)=>(l(),o("div",{class:oe(["dashboard",b.value,{transitioning:c.value}]),dir:g.value},[se[7]||(se[7]=Ye('<div class="dashboard__background" aria-hidden="true" data-v-7999c0c0><span class="glow glow-one" data-v-7999c0c0></span><span class="glow glow-two" data-v-7999c0c0></span><span class="glow glow-three" data-v-7999c0c0></span><span class="mesh" data-v-7999c0c0></span></div>',1)),Q(Bt,{name:"toast-fade",tag:"div",class:"toasts","aria-live":"polite"},{default:ke(()=>[(l(!0),o(te,null,ne($.value,de=>(l(),o("div",{key:de.id,class:oe(["toast",de.type])},[se[2]||(se[2]=e("span",{class:"toast__dot"},null,-1)),e("p",null,t(de.message),1),e("button",{type:"button",class:"toast__close",onClick:Ae=>r(de.id)},"×",8,Vd)],2))),128))]),_:1}),e("header",Kd,[e("div",Yd,[h.value?(l(),o("button",{key:0,class:"topbar__menu",type:"button",onClick:Te,"aria-expanded":!ce.value,"aria-label":ce.value?w.value==="ar"?"فتح قائمة التحديات":"Open challenges":w.value==="ar"?"إخفاء قائمة التحديات":"Hide challenges"},[ce.value?(l(),De(V(en),{key:0})):(l(),De(V(Ya),{key:1,style:ue({transform:g.value==="rtl"?"scaleX(-1)":""})},null,8,["style"]))],8,Jd)):ie("",!0),e("div",Xd,[e("div",Zd,[e("img",{src:V(Pt),alt:"logo"},null,8,ev)]),e("div",tv,[e("span",av,t(u[w.value].brand),1),e("span",nv,t(u[w.value].tagline),1)])])]),e("div",lv,[Q(V(Xa),{class:"wave"}),e("div",sv,[e("h1",null,t(u[w.value].hello)+" "+t(G.value||M.value),1),e("p",null,t(p("sub")),1)])]),e("div",ov,[e("button",{class:"action-btn",type:"button","aria-label":b.value==="dark"?w.value==="ar"?"التبديل إلى الوضع الفاتح":"Switch to light theme":w.value==="ar"?"التبديل إلى الوضع الداكن":"Switch to dark theme",onClick:_},[b.value==="light"?(l(),De(V(sn),{key:0})):(l(),De(V(tn),{key:1}))],8,rv),e("button",{class:"action-btn",type:"button","aria-label":w.value==="ar"?"Switch to English":"التبديل إلى العربية",onClick:i},t(w.value==="ar"?"EN":"ع"),9,iv),e("div",{class:"profile",ref_key:"profileRef",ref:re,onClick:se[1]||(se[1]=Ge(de=>le.value=!le.value,["stop"]))},[e("div",cv,[q.value?(l(),o("span",{key:0,class:"avatar__image",style:ue({backgroundImage:`url(${q.value})`})},null,4)):(l(),o("span",uv,t(Z.value),1))]),e("div",dv,[e("span",vv,t(G.value||M.value),1),e("span",hv,t(u[w.value].brand),1)]),Q(V(dt),{class:oe(["profile__chevron",{open:le.value}])},null,8,["class"]),Q($e,{name:"fade"},{default:ke(()=>[le.value?(l(),o("ul",pv,[e("li",null,[e("button",{type:"button",onClick:se[0]||(se[0]=de=>Ee("/settings"))},[Q(V(an)),se[3]||(se[3]=J()),e("span",null,t(u[w.value].settings),1)])]),e("li",null,[e("button",{type:"button",class:"danger",onClick:Ue},[Q(V(ft)),se[4]||(se[4]=J()),e("span",null,t(u[w.value].logout),1)])])])):ie("",!0)]),_:1})],512)])]),e("main",fv,[e("section",mv,[e("article",gv,[e("div",_v,[Q(V(ht))]),e("div",yv,[e("h2",null,t(u[w.value].brand),1),e("p",null,t(u[w.value].pickPrompt),1)]),e("div",bv,[e("div",kv,[e("span",wv,t(u[w.value].scoreWidgetRank),1),e("strong",null,t(ae.scoreRankDisplay),1)]),e("div",$v,[e("span",Cv,t(u[w.value].scoreWidgetPlayers),1),e("strong",null,t(x.value),1)])])]),e("article",{class:oe(["score-card",{loading:U.value,pulse:O.value}]),"aria-busy":U.value},[U.value?(l(),o("div",Sv,[Q(V(qe),{class:"overlay-spinner"})])):ie("",!0),e("div",Av,[(l(),o("svg",Dv,[se[5]||(se[5]=e("defs",null,[e("linearGradient",{id:"dashboardScoreGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"#c6a034"}),e("stop",{offset:"100%","stop-color":"#0f8a3e"})])],-1)),se[6]||(se[6]=e("circle",{class:"ring-bg",cx:"60",cy:"60",r:"52"},null,-1)),e("circle",{class:"ring-fg",cx:"60",cy:"60",r:"52",stroke:"url(#dashboardScoreGradient)",style:ue({"--progress":I.value})},null,4)])),e("div",Tv,[Q($e,{name:"score-flip",mode:"out-in"},{default:ke(()=>[(l(),o("span",{class:"score-card__points",key:F.value},t(U.value?"...":L.value),1))]),_:1}),e("small",null,t(u[w.value].scoreWidgetTitle),1)])]),e("div",Mv,[e("span",Lv,t(T.value),1),e("p",Nv,t(U.value?u[w.value].scoreWidgetLoading:u[w.value].scoreWidgetSubtitle),1),e("div",{class:"progress",role:"progressbar","aria-valuenow":P.value,"aria-valuemin":"0","aria-valuemax":"100"},[e("div",Ev,[e("div",{class:"progress__fill",style:ue({"--progress":I.value})},null,4)]),e("div",zv,[e("span",null,t(P.value)+"%",1),e("button",{type:"button",class:"progress__link",onClick:H},t(u[w.value].scoreWidgetView),1)])],8,Pv)])],10,xv),e("article",Bv,[e("div",Ov,t(u[w.value].teacherTitle),1),e("h3",null,t(u[w.value].teacherSubtitle),1),e("p",null,t(u[w.value].teacherMessage),1)])]),e("section",jv,[e("aside",{class:oe(["challenge-list",{collapsed:ce.value&&h.value}])},[e("header",Rv,[e("h2",null,t(u[w.value].challenge),1),e("p",null,t(u[w.value].pickPrompt),1)]),e("div",Iv,[(l(),o(te,null,ne(a,de=>e("div",{class:"level-block",key:de.id},[e("button",{type:"button",class:"level-head",onClick:Ae=>Mt(de.id)},[e("div",Uv,[Q(V(bt),{class:"level-head__icon"}),e("span",qv,t(de.label[w.value]),1)]),e("span",Qv,t(de.challenges.length),1),Q(V(dt),{class:oe(["level-head__chevron",{open:lt(de.id)}])},null,8,["class"])],8,Fv),Q($e,{name:"fade"},{default:ke(()=>[lt(de.id)?(l(),o("div",Hv,[(l(!0),o(te,null,ne(de.challenges,Ae=>(l(),o("button",{key:Ae.id,type:"button",class:oe(["challenge-card",{active:Nt(de.id,Ae.id)}]),onClick:We=>Lt(de.id,Ae.id)},[e("span",Wv,t(Ae.symbol),1),e("div",Vv,[e("span",Kv,t(Ae.label[w.value]),1),e("p",Yv,t(Ae.summary[w.value]),1)]),e("span",Jv,t(u[w.value].cardCTA),1)],10,Gv))),128))])):ie("",!0)]),_:2},1024)])),64))]),e("div",Xv,[e("button",{type:"button",class:"logout-btn",onClick:Ue},[Q(V(ft)),e("span",null,t(u[w.value].logout),1)])])],2),e("div",Zv,[e("div",eh,[Be.value.level?(l(),o("span",th,t(Be.value.level.label[w.value]),1)):ie("",!0),e("div",ah,[S.value==="scores"?(l(),o("h3",nh,t(u[w.value].myScores),1)):S.value==="settings"?(l(),o("h3",lh,t(u[w.value].settings),1)):Be.value.challenge?(l(),o("h3",sh,t(Be.value.challenge.label[w.value]),1)):(l(),o("h3",oh,t(u[w.value].brand),1)),Be.value.challenge?(l(),o("p",rh,t(Be.value.challenge.summary[w.value]),1)):S.value==="scores"?(l(),o("p",ih,t(u[w.value].scoreWidgetSubtitle),1)):S.value==="settings"?(l(),o("p",ch,t(u[w.value].settings),1)):(l(),o("p",uh,t(u[w.value].pickPrompt),1))])]),e("div",dh,[Q($e,{name:"preview-fade",mode:"out-in"},{default:ke(()=>{var de;return[st.value?(l(),De(je(st.value),jt({key:S.value||((de=Be.value.challenge)==null?void 0:de.id)||"welcome",class:"preview-component"},{lang:w.value,theme:b.value}),null,16)):(l(),o("div",vh,[Q(V(ht)),e("p",null,t(u[w.value].pickPrompt),1)]))]}),_:1})])])])])],10,Wd))}},ph=me(hh,[["__scopeId","data-v-7999c0c0"]]),fh=Rt({history:It("/math-leaders-games/"),routes:[{path:"/",redirect:"/login"},{path:"/login",component:qa},{path:"/home",component:ph},{path:"/scores",component:()=>it(()=>import("./ScoresView.js"),__vite__mapDeps([0,1]))},{path:"/settings",component:()=>it(()=>import("./SettingsView.js"),__vite__mapDeps([2,1]))}]});Ft(Ht).use(fh).mount("#app");export{ph as D};
//# sourceMappingURL=platform.js.map
